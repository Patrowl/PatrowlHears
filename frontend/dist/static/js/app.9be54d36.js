(function(t){function e(e){for(var i,o,r=e[0],l=e[1],c=e[2],u=0,v=[];u<r.length;u++)o=r[u],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&v.push(s[o][0]),s[o]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);d&&d(e);while(v.length)v.shift()();return n.push.apply(n,c||[]),a()}function a(){for(var t,e=0;e<n.length;e++){for(var a=n[e],i=!0,r=1;r<a.length;r++){var l=a[r];0!==s[l]&&(i=!1)}i&&(n.splice(e--,1),t=o(o.s=a[0]))}return t}var i={},s={app:0},n=[];function o(e){if(i[e])return i[e].exports;var a=i[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=t,o.c=i,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(a,i,function(e){return t[e]}.bind(null,i));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var d=l;n.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},1234:function(t,e,a){},1256:function(t,e,a){},"19ec":function(t,e,a){},3437:function(t,e,a){"use strict";var i=a("1234"),s=a.n(i);s.a},"3d91":function(t,e,a){"use strict";var i=a("f748"),s=a.n(i);s.a},"3f07":function(t,e,a){"use strict";var i=a("4b96"),s=a.n(i);s.a},4678:function(t,e,a){var i={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-SG":"cdab","./en-SG.js":"cdab","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-nz":"6f50","./en-nz.js":"6f50","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-tw":"90ea","./zh-tw.js":"90ea"};function s(t){var e=n(t);return a(e)}function n(t){if(!a.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}s.keys=function(){return Object.keys(i)},s.resolve=n,t.exports=s,s.id="4678"},"4b68":function(t,e,a){},"4b96":function(t,e,a){},"55e7":function(t,e,a){"use strict";var i=a("4b68"),s=a.n(i);s.a},"56d7":function(t,e,a){"use strict";a.r(e);a("4de4"),a("fb6a"),a("d3b7"),a("25f0"),a("e260"),a("e6cf"),a("cca6"),a("a79d");var i=a("2b0e"),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("router-view")],1)},n=[],o={name:"App",data:function(){return{section:"AppLayout"}},created:function(){document.title="PatrowlHears"},methods:{logout:function(){this.$store.commit("removeToken"),this.$router.push("/auth")}}},r=o,l=(a("cf25"),a("2877")),c=a("6544"),d=a.n(c),u=a("7496"),v=Object(l["a"])(r,s,n,!1,null,null,null),m=v.exports;d()(v,{VApp:u["a"]});var p=a("0628"),_=a.n(p),h=(a("15f5"),a("5363"),a("f309"));i["a"].use(h["a"]);var g=new h["a"]({icons:{iconfont:"mdi"}}),f=a("8c4f"),b=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{"grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:"","align-center":"","justify-center":"","fill-height":""}},[a("v-flex",{attrs:{xs12:"",sm8:"",lg4:"",md5:""}},[a("v-card",{staticClass:"login-card"},[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Login to PatrowlHears")])]),a("v-spacer"),a("v-card-text",[t.loading?a("v-layout",{attrs:{row:"","fill-height":"","justify-center":"","align-center":""}},[a("v-progress-circular",{attrs:{size:50,color:"primary",indeterminate:""}})],1):a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-container",[a("v-text-field",{attrs:{counter:70,label:"username",maxlength:"70",autocomplete:"username",required:""},model:{value:t.credentials.username,callback:function(e){t.$set(t.credentials,"username",e)},expression:"credentials.username"}}),a("v-text-field",{attrs:{type:"password",counter:256,label:"password",rules:t.rules.password,maxlength:"256",autocomplete:"current-password",required:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.login(e)}},model:{value:t.credentials.password,callback:function(e){t.$set(t.credentials,"password",e)},expression:"credentials.password"}}),a("v-checkbox",{attrs:{label:"First visit"},model:{value:t.credentials.enable_firststeps,callback:function(e){t.$set(t.credentials,"enable_firststeps",e)},expression:"credentials.enable_firststeps"}})],1),a("v-btn",{staticClass:"deep-orange white--text",attrs:{disabled:!t.valid},on:{click:t.login}},[t._v("Login")])],1)],1)],1)],1)],1)],1)},k=[],x=a("3d20"),y=a.n(x),w={name:"AuthLayout",data:function(){return{credentials:{username:"",password:"",use_default_organization:!0,enable_firststeps:!0},valid:!0,loading:!1,rules:{username:[function(t){return!!t||"Username is required"},function(t){return t&&t.length>3||"A username must be more than 3 characters long"},function(t){return/^[a-z0-9_]+$/.test(t)||"A username can only contain letters and digits"}],password:[function(t){return!!t||"Password is required"},function(t){return t&&t.length>7||"The password must be longer than 7 characters"}]}}},methods:{login:function(){var t=this;this.$refs.form.validate()&&(this.loading=!0,this.$store.commit("removeToken"),this.$api.post(this.$store.state.endpoints.obtainJWT,this.credentials).then((function(e){t.$store.commit("updateToken",e.data.access);t.$api.get("/users/set-org").then((function(e){e&&200===e.status&&"set"===e.data.status?(localStorage.setItem("org_id",e.data.org_id),localStorage.setItem("org_name",e.data.org_name),t.$api.get("/users/api/current").then((function(e){localStorage.setItem("username",e.data.username),localStorage.setItem("is_admin",e.data.is_superuser),localStorage.setItem("is_org_admin",e.data.is_org_admin),localStorage.setItem("orgs",JSON.stringify(e.data.orgs)),localStorage.setItem("org_name",e.data.current_org.org_name),localStorage.setItem("profile",JSON.stringify(e.data.profile)),1==e.data.is_superuser&&localStorage.setItem("is_org_admin",!0),t.$store.commit("setAuthUser",{authUser:e.data,isAuthenticated:!0}),1==t.credentials.enable_firststeps?t.$router.push({name:"Homepage",query:{firststeps:"1"}}):t.$router.push({name:"Homepage"})}))):console.log("ERROR: Unable to set organization")}))})).catch((function(e){t.$store.commit("removeToken"),t.loading=!1,y.a.fire({title:"Error",text:"Wrong username or password",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})))}}},C=w,V=a("8336"),I=a("b0af"),T=a("99d9"),P=a("ac7c"),S=a("a523"),E=a("0e8f"),$=a("4bd4"),A=a("a722"),M=a("490a"),D=a("2fa4"),O=a("8654"),j=Object(l["a"])(C,b,k,!1,null,null,null),B=j.exports;d()(j,{VBtn:V["a"],VCard:I["a"],VCardText:T["d"],VCardTitle:T["e"],VCheckbox:P["a"],VContainer:S["a"],VFlex:E["a"],VForm:$["a"],VLayout:A["a"],VProgressCircular:M["a"],VSpacer:D["a"],VTextField:O["a"]});var U=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{"grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:"","align-center":"","justify-center":"","fill-height":""}},[a("v-flex",{attrs:{xs12:"",sm8:"",lg4:"",md5:""}},[a("v-card",{staticClass:"registration-card"},[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Register to PatrowlHears")])]),a("v-spacer"),a("v-card-text",[t.loading?a("v-layout",{attrs:{row:"","fill-height":"","justify-center":"","align-center":""}},[a("v-progress-circular",{attrs:{size:50,color:"primary",indeterminate:""}})],1):a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-container",[a("v-text-field",{attrs:{label:"Email",rules:t.rules.email,required:"",disabled:""},model:{value:t.registration.email,callback:function(e){t.$set(t.registration,"email",e)},expression:"registration.email"}}),a("v-text-field",{attrs:{counter:128,label:"Username",maxlength:"128",required:"",autocomplete:"username"},model:{value:t.registration.username,callback:function(e){t.$set(t.registration,"username",e)},expression:"registration.username"}}),a("v-text-field",{attrs:{type:"password",rules:t.rules.password,label:"Password",maxlength:"256",required:"",autocomplete:"new-password"},model:{value:t.registration.password,callback:function(e){t.$set(t.registration,"password",e)},expression:"registration.password"}}),a("v-text-field",{attrs:{type:"password",rules:t.rules.password,label:"Password (again)",required:"",autocomplete:"new-password"},model:{value:t.registration.password_confirm,callback:function(e){t.$set(t.registration,"password_confirm",e)},expression:"registration.password_confirm"}}),a("v-text-field",{attrs:{counter:128,label:"Firstname",maxlength:"128",autocomplete:"firstname"},model:{value:t.registration.first_name,callback:function(e){t.$set(t.registration,"first_name",e)},expression:"registration.first_name"}}),a("v-text-field",{attrs:{counter:128,label:"Lastname",maxlength:"128",autocomplete:"lastname"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.register(e)}},model:{value:t.registration.last_name,callback:function(e){t.$set(t.registration,"last_name",e)},expression:"registration.last_name"}})],1),a("v-btn",{staticClass:"deep-orange white--text",attrs:{disabled:!t.valid},on:{click:t.register}},[t._v("Register")])],1)],1)],1)],1)],1)],1)},L=[],F={name:"UserRegistrationLayout",data:function(){return{loading:!1,valid:!0,registration:{email:"",username:"",password:"",password_confirm:"",first_name:"",last_name:""},rules:{username:[function(t){return!!t||"Username is required"},function(t){return t&&t.length>3||"A username must be more than 3 characters long"},function(t){return/^[a-z0-9_]+$/.test(t)||"A username can only contain letters and digits"}],password:[function(t){return!!t||"Password is required"},function(t){return t&&t.length>8||"The password must be longer than 8 characters"},function(t){return/(?=.*[A-Z])/.test(t)||"Must have one uppercase character"},function(t){return/(?=.*\d)/.test(t)||"Must have one number"},function(t){return/([!@#$%-_])/.test(t)||"Must have one special character [!@#$%-_]"}],email:[function(t){return!!t||"E-mail is required"},function(t){return/.+@.+\..+/.test(t)||"E-mail must be valid"}]}}},beforeRouteUpdate:function(t){this.invitation_token=t.query.token,this.checkToken()},mounted:function(){this.invitation_token=this.$router.currentRoute.query.token,this.checkToken()},methods:{checkToken:function(){var t=this;this.$api.get("/users/activate/"+this.invitation_token).then((function(e){e&&200===e.status&&"valid"===e.data.status?t.registration.email=e.data.email:t.$router.push("/auth")})).catch((function(e){t.$router.push("/auth")}))},register:function(){var t=this;this.$api.post("/users/activate/"+this.invitation_token,this.registration).then((function(e){e&&200===e.status&&"success"===e.data.status&&t.$router.push("/auth")})).catch((function(t){}))}}},N=F,R=Object(l["a"])(N,U,L,!1,null,null,null),Y=R.exports;d()(R,{VBtn:V["a"],VCard:I["a"],VCardText:T["d"],VCardTitle:T["e"],VContainer:S["a"],VFlex:E["a"],VForm:$["a"],VLayout:A["a"],VProgressCircular:M["a"],VSpacer:D["a"],VTextField:O["a"]});var z=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("v-navigation-drawer",{attrs:{clipped:"",app:"",color:"grey lighten-4"},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[a("v-list",{staticClass:"grey lighten-4",attrs:{dense:""}},[t._l(t.menu_items,(function(e,i){return[e.submenu?a("v-list-group",{attrs:{"no-action":"","prepend-icon":e.icon},scopedSlots:t._u([{key:"activator",fn:function(){return[a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:t._s(e.text)}})],1)]},proxy:!0}],null,!0)},t._l(e.submenu,(function(e,i){return a("v-list-item",{key:i,attrs:{to:e.to}},[a("v-list-item-content",[a("v-list-item-title",{attrs:{link:"",to:e.to},domProps:{textContent:t._s(e.text)}})],1)],1)})),1):e.divider?a("v-divider",{key:i}):a("v-list-item",{key:i,attrs:{link:"",to:e.to}},[a("v-list-item-action",[a("v-icon",[t._v(t._s(e.icon))])],1),a("v-list-item-content",[a("v-list-item-title",{staticClass:"grey-darken-3--text"},[t._v(" "+t._s(e.text)+" ")])],1)],1)]}))],2)],1),a("v-app-bar",{attrs:{app:"","clipped-left":"",color:"grey lighten-2",dense:""}},[a("v-app-bar-nav-icon",{on:{click:function(e){t.drawer=!t.drawer}}}),a("span",{staticClass:"title ml-3 mr-5 deep-orange--text"},[a("span",{staticClass:"font-weight-light deep"},[t._v("Patrowl")]),t._v("Hears")]),a("v-text-field",{attrs:{"solo-inverted":"",flat:"","hide-details":"",label:"Search","prepend-inner-icon":"mdi-magnify",dense:""},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search()}},model:{value:t.appsearch,callback:function(e){t.appsearch=e},expression:"appsearch"}}),a("v-spacer"),a("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[a("v-btn",t._g({attrs:{tile:""}},i),[t._v(" "+t._s(t.username)+"@"+t._s(t.user_organization)+" ")])]}}])},[a("v-list",t._l(t.orgs,(function(e,i){return a("v-list-item",{key:i,on:{click:function(a){return t.setOrganization(e)}}},[a("v-list-item-title",[t._v(t._s(e.slug))])],1)})),1)],1),a("v-btn",{attrs:{icon:""},on:{click:t.logout}},[a("v-icon",[t._v("mdi-logout")])],1)],1),a("v-main",[a("v-container",{attrs:{fluid:""}},[a("router-view")],1)],1),a("v-footer",[a("v-spacer"),a("div",{staticClass:"caption"},[t._v("Â© "+t._s((new Date).getFullYear())+" - PatrowlHears - "+t._s(t.app_version.version)+" - "+t._s(t._f("capitalize")(t.app_version.edition))+" Edition "+t._s(t.app_version.build))])],1)],1)},X=[],H=(a("b0c0"),a("8248")),W={name:"AppLayout",data:function(){return{drawer:null,app_version:"",appsearch:"",menu_items:[{icon:"mdi-home",text:"Home",to:"/homepage"},{icon:"mdi-magnify",text:"Search",to:"/search"},{divider:!0},{icon:"mdi-file-multiple",text:"Monitoring",to:"/monitoring"},{icon:"mdi-file-find",text:"Vulnerabilities",to:"/vulns"},{icon:"mdi-knife-military",text:"Exploits",to:"/exploits"},{icon:"mdi-security",text:"Ratings",to:"/ratings"},{icon:"mdi-bookmark",text:"Public feeds",to:"",submenu:[{icon:"mdi-bookmark",text:"CVE",to:"/kb/cves"},{icon:"mdi-bookmark",text:"Bulletins",to:"/kb/bulletins"},{icon:"mdi-apps",text:"Vendors & Products",to:"/vendors"},{icon:"mdi-package-variant",text:"Packages",to:"/packages"}]},{divider:!0},{icon:"mdi-toggle-switch",text:"Settings",to:"/settings"},{icon:"mdi-help-circle",text:"Help",to:"/help"}],username:"",user_organization:"",orgs:[]}},mounted:function(){this.getUsername(),this.getOrganization(),this.getOrganizations(),this.app_version=H},methods:{logout:function(){this.$store.commit("removeToken"),localStorage.removeItem("authToken"),localStorage.removeItem("username"),localStorage.removeItem("is_admin"),localStorage.removeItem("is_org_admin"),localStorage.removeItem("orgs"),localStorage.removeItem("org_id"),localStorage.removeItem("org_name"),this.$session.destroy(),this.$router.push("/auth")},getUsername:function(){this.username=localStorage.getItem("username")},getOrganization:function(){this.user_organization=localStorage.getItem("org_name")},getOrganizations:function(){this.orgs=JSON.parse(localStorage.getItem("orgs"))},search:function(){this.$route.path==="/search/"+this.appsearch?this.$router.go():this.$router.push({path:"/search/"+this.appsearch})},setOrganization:function(t){var e=this;this.$api.get("/users/set-org/"+t.id).then((function(a){a&&200===a.status&&"set"===a.data.status&&(localStorage.setItem("org_id",t.id),localStorage.setItem("org_name",t.name),e.user_organization=t.name,e.$router.go())}))}}},q=W,J=a("40dc"),K=a("5bc1"),G=a("ce7e"),Z=a("553a"),Q=a("132d"),tt=a("8860"),et=a("56b0"),at=a("da13"),it=a("1800"),st=a("5d23"),nt=a("f6c4"),ot=a("e449"),rt=a("f774"),lt=Object(l["a"])(q,z,X,!1,null,null,null),ct=lt.exports;d()(lt,{VApp:u["a"],VAppBar:J["a"],VAppBarNavIcon:K["a"],VBtn:V["a"],VContainer:S["a"],VDivider:G["a"],VFooter:Z["a"],VIcon:Q["a"],VList:tt["a"],VListGroup:et["a"],VListItem:at["a"],VListItemAction:it["a"],VListItemContent:st["g"],VListItemTitle:st["k"],VMain:nt["a"],VMenu:ot["a"],VNavigationDrawer:rt["a"],VSpacer:D["a"],VTextField:O["a"]});var dt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md4:""}},[a("v-card",{attrs:{color:"deep-orange"}},[a("v-card-title",[t._v("Vulnerabilities")]),a("v-card-subtitle",{attrs:{primary:""}},[t._v("CVE, 0days, ...")]),a("v-card-text",{staticClass:"display-3 text-center"},[t._v(" "+t._s(t.stats.vulns)+" ")])],1)],1),a("v-flex",{attrs:{md4:""}},[a("v-card",{attrs:{color:"lime"}},[a("v-card-title",{attrs:{primary:""}},[t._v("Metadata")]),a("v-card-subtitle",{attrs:{primary:""}},[t._v("Exploits, Threats activities, News, Blog posts")]),a("v-card-text",{staticClass:"display-3 text-center"},[t._v(" "+t._s(t.stats.exploits+t.stats.threats)+" ")])],1)],1),a("v-flex",{attrs:{md4:""}},[a("v-card",{attrs:{color:"teal"}},[a("v-card-title",{attrs:{primary:""}},[t._v("Monitored items")]),a("v-card-subtitle",{attrs:{primary:""}},[t._v("Vendors, Products, Vulnerabilites, Bulletins")]),a("v-card-text",{staticClass:"display-3 text-center"},[t._v(" "+t._s(t.stats.monitored)+" ")])],1)],1)],1),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md12:""}},[a("v-card",{attrs:{outlined:""}},[a("v-card-title",[t._v("Latest monitored vulnerabilities and products (< 30 days)")]),a("v-card-text",{staticClass:"text-center"},[a("v-data-table",{attrs:{headers:t.monitored_vulns_headers,items:t.monitored_vulns,"items-per-page":5,loading:t.loading_last_vulns},on:{"click:row":t.viewVuln},scopedSlots:t._u([{key:"item.score",fn:function(e){var i=e.item;return[a("v-chip",{staticClass:"text-center font-weight-bold",attrs:{color:t.getRatingColor(i.score),label:""}},[t._v(t._s(i.score)+"/100")]),a("br"),a("span",{staticClass:"text-caption"},[t._v("CVSSv2: "+t._s(i.cvss))]),a("br"),a("span",{staticClass:"text-caption"},[t._v("CVSSv3: "+t._s(i.cvss3))])]}},{key:"item.summary",fn:function(e){var i=e.item;return[a("div",{staticClass:"py-2"},[a("div",{staticClass:"pb-2"},[a("span",{staticClass:"deep-orange--text font-weight-medium"},[t._v(t._s(i.cveid))]),t._v(" / PH-"+t._s(i.id)+" "),a("v-btn",{attrs:{color:"deep-orange",icon:"",small:""}},[a("v-icon",{attrs:{title:"View details"},on:{click:function(e){return t.viewVuln(i)}}},[t._v("mdi-arrow-right-bold-circle-outline")])],1)],1),a("div",[t._v(" "+t._s(i.summary)+" ")]),t._l(i.products,(function(e){return a("v-chip",{key:e.id,staticClass:"vendor-chip",attrs:{label:"",small:"",link:""},on:{click:function(a){return t.$router.push({path:"/product/"+e.id})}}},[t._v(" "+t._s(e.vendor)+": "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(e.name))])])}))],2)]}},{key:"item.metadata",fn:function(e){var i=e.item;return[a("v-chip",{staticClass:"font-weight-bold",attrs:{label:"",link:"",small:"",color:i.exploit_count>0?"deep-orange":"grey",title:"Is exploitable?"}},[t._v(t._s(i.exploit_count))]),a("v-btn",{attrs:{color:"NETWORK"==i.access.vector?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Is exploitable remotely?"}},[t._v("mdi-cloud")])],1),a("v-btn",{attrs:{color:"NONE"==i.access.authentication?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Require authentication?"}},[t._v("mdi-shield-account")])],1),a("v-btn",{attrs:{color:i.is_in_the_news||i.is_in_the_wild?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Is in the news or exploited in the wild?"}},[t._v("mdi-star")])],1)]}},{key:"item.updated_at",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.updated_at).format("YYYY-MM-DD, hh:mm:ss")))])]}}])})],1)],1)],1)],1),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md6:""}},[a("v-card",{attrs:{outlined:""}},[a("v-card-title",[t._v(" Latest vulnerabilities (Top 20) "),a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:function(e){return t.viewVulns()}}},[t._v("See all")])],1),a("v-card-text",{staticClass:"text-center"},[a("v-data-table",{attrs:{headers:t.vulns_headers,items:t.vulns,"items-per-page":5,"item-class":t.rowColor,loading:t.loading_last_vulns},on:{"click:row":t.viewVuln},scopedSlots:t._u([{key:"item.summary",fn:function(e){var i=e.item;return[a("v-clamp",{attrs:{autoresize:"","max-lines":1}},[t._v(" "+t._s(i.summary)+" ")])]}}])})],1)],1)],1),a("v-flex",{attrs:{md6:""}},[a("v-card",{attrs:{outlined:""}},[a("v-card-title",{attrs:{primary:""}},[t._v("Latest exploits metadata (Top 20)")]),a("v-card-text",{staticClass:"text-center"},[a("v-data-table",{attrs:{headers:t.exploits_headers,items:t.exploits,"items-per-page":5,loading:t.loading_last_vulns},scopedSlots:t._u([{key:"item.relevancy_level",fn:function(e){var i=e.item;return[t._l(1,(function(e){return 1==i.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"yellow"}}):t._e()})),t._l(4,(function(e){return 1==i.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six-outline",attrs:{"x-small":"",color:"grey"}}):t._e()})),t._l(2,(function(e){return 2==i.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"orange"}}):t._e()})),t._l(3,(function(e){return 2==i.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six-outline",attrs:{"x-small":"",color:"grey"}}):t._e()})),t._l(3,(function(e){return 3==i.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"orange darken-4"}}):t._e()})),t._l(2,(function(e){return 3==i.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six-outline",attrs:{"x-small":"",color:"grey"}}):t._e()})),t._l(4,(function(e){return 4==i.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"red"}}):t._e()})),t._l(1,(function(e){return 4==i.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six-outline",attrs:{"x-small":"",color:"grey"}}):t._e()})),t._l(5,(function(e){return 5==i.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"red darken-4"}}):t._e()}))]}},{key:"item.link",fn:function(e){var i=e.item;return[a("v-clamp",{attrs:{autoresize:"","max-lines":1}},[t._v(" "+t._s(i.link)+" ")])]}}])})],1)],1)],1),a("v-dialog",{attrs:{width:"600"},model:{value:t.firststeps_overlay,callback:function(e){t.firststeps_overlay=e},expression:"firststeps_overlay"}},[a("first-steps")],1)],1)],1)},ut=[],vt=(a("96cf"),a("1da1")),mt=a("3f87"),pt={methods:{getCVSSColor:function(t){return t>=9?"red darken-4":t>=7?"red":t>=4?"orange":t>=.1?"yellow":"grey"},getTLPColor:function(t){return"white"===t?"":"green"===t?"green":"amber"===t?"orange":"red"===t?"red":"black"===t?"black":"grey"},getRatingColor:function(t){return t>=80?"red":t>=60?"orange":t>=40?"yellow":t>=0?"blue":"grey"},getBoolColor:function(t){return t?"deep-orange":"grey"}},mounted:function(){},destroyed:function(){}},_t=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-stepper",{attrs:{"non-linear":"",light:""},model:{value:t.stepper_fs,callback:function(e){t.stepper_fs=e},expression:"stepper_fs"}},[a("v-stepper-header",[a("v-stepper-step",{attrs:{editable:"",step:"1",color:"deep-orange"}},[t._v("Welcome")]),a("v-divider"),a("v-stepper-step",{attrs:{editable:"",step:"2",color:"deep-orange"}},[t._v("Monitoring")]),a("v-divider"),a("v-stepper-step",{attrs:{editable:"",step:"3",color:"deep-orange"}},[t._v("Alerting")]),a("v-divider"),a("v-stepper-step",{attrs:{editable:"",step:"4",color:"deep-orange"}},[t._v("Finish")])],1),a("v-stepper-content",{attrs:{step:"1"}},[a("v-card",{staticClass:"mb-6",attrs:{height:"200px",tile:""}},[a("v-card-title",[t._v(" Welcome in PatrowlHears ! ")]),a("v-card-text",[a("strong",[t._v("PatrowlHears")]),t._v(" is an advanced platform offering a continuous watch on vulnerabilities found on your IT assets, enriched by cyber-threat Intelligence data."),a("br"),a("br"),t._v(" Let's get started. Click 'Next' button to continue. ")])],1),a("v-btn",{attrs:{color:"grey"},on:{click:function(e){return t.nextStep(1)}}},[t._v("Next"),a("v-icon",[t._v("mdi-chevron-right")])],1)],1),a("v-stepper-content",{attrs:{step:"2"}},[a("v-card",{staticClass:"mb-6",attrs:{height:"auto",tile:""}},[a("v-card-title",[t._v(" Monitor your assets ")]),a("v-card-text",[t._v(" First, you have to select products to monitor. You will be advised when new vulnerabilities are found or a change has been detected by our platform."),a("br"),t._v(" Select 3 products (max.). Don't panic, it's just a start ;)"),a("br")]),a("v-card-text",[a("v-autocomplete",{attrs:{items:t.products_items,loading:t.products_isLoading,"search-input":t.products_search,chips:"","cache-items":"","hide-details":"","hide-selected":"","hide-no-data":"","item-text":"name","item-value":"id",label:"Search for a product...",multiple:""},on:{"update:searchInput":function(e){t.products_search=e},"update:search-input":function(e){t.products_search=e}},scopedSlots:t._u([{key:"selection",fn:function(e){return[a("v-chip",t._b({attrs:{"input-value":e.selected,close:""},on:{click:e.select,"click:close":function(a){return t.removeSelectedProduct(e.item)}}},"v-chip",e.attrs,!1),[t._v(" "+t._s(e.item.vendor)+"/"+t._s(e.item.name)+" ")])]}},{key:"item",fn:function(e){return[t._v(" "+t._s(e.item.vendor)+"/"+t._s(e.item.name)+" ")]}}]),model:{value:t.products_autocomplete,callback:function(e){t.products_autocomplete=e},expression:"products_autocomplete"}})],1),a("v-divider")],1),a("v-btn",{attrs:{color:"grey"},on:{click:function(e){return t.nextStep(2,"saveMonitoredProducts")}}},[t._v("Next"),a("v-icon",[t._v("mdi-chevron-right")])],1),a("v-btn",{attrs:{text:""},on:{click:function(e){return t.nextStep(0)}}},[t._v("Cancel")])],1),a("v-stepper-content",{attrs:{step:"3"}},[a("v-card",{staticClass:"mb-6",attrs:{height:"200px",tile:""}},[a("v-card-title",[t._v(" Alert me ")]),a("v-card-text",[t._v(" You have successfuly added your products to your monitoring list. Now, let us set a contact email for receiving alerts. Other alert channels are also available (Slack, TheHive, ...) in the 'Settings' page. "),a("v-combobox",{attrs:{clearable:"",label:"Contact Emails",multiple:"",rules:t.emailRules},scopedSlots:t._u([{key:"selection",fn:function(e){var i=e.attrs,s=e.item,n=e.select,o=e.selected;return[a("v-chip",t._b({attrs:{"input-value":o,close:""},on:{click:n,"click:close":function(e){return t.removeContactEmail(s)}}},"v-chip",i,!1),[a("strong",[t._v(t._s(s))])])]}}]),model:{value:t.org_settings.alerts_emails,callback:function(e){t.$set(t.org_settings,"alerts_emails",e)},expression:"org_settings.alerts_emails"}})],1)],1),a("v-btn",{attrs:{color:"grey"},on:{click:function(e){return t.nextStep(3,"saveAlertEmails")}}},[t._v("Next"),a("v-icon",[t._v("mdi-chevron-right")])],1),a("v-btn",{attrs:{text:""},on:{click:function(e){return t.nextStep(1)}}},[t._v("Cancel")])],1),a("v-stepper-content",{attrs:{step:"4"}},[a("v-card",{staticClass:"mb-6",attrs:{height:"200px",tile:""}},[a("v-card-title",[t._v(" It's done ! ")]),a("v-card-text",[t._v(" That's all! You just finished the inital configuration."),a("br"),t._v(" Want help ? go "),a("a",{attrs:{href:"/#/help"}},[t._v("there")])])],1),a("v-btn",{attrs:{color:"deep-orange"},on:{click:function(e){return t.closeMe()}}},[t._v("Close"),a("v-icon",[t._v("mdi-chevron-right")])],1),a("v-btn",{attrs:{text:""},on:{click:function(e){return t.nextStep(2)}}},[t._v("Cancel")])],1)],1),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)},ht=[],gt=(a("c975"),a("a434"),a("2909")),ft=a("2ef0"),bt=a.n(ft),kt={name:"FirstSteps",data:function(){return{stepper_fs:1,steps:4,descriptionLimit:60,products_isLoading:!1,products_autocomplete:null,products_items:[],products_search:null,emailRules:[function(t){return!!t||"E-mail is required"},function(t){return/.+@.+\..+/.test(t)||"E-mail must be valid"}],org_settings:{alerts_emails:[]},snack:!1,snackColor:"",snackText:""}},watch:{steps:function(t){this.stepper_fs>t&&(this.stepper_fs=t)},products_search:bt.a.debounce((function(t){var e=this;null!=t&&(t.length<3||this.products_isLoading||(this.products_isLoading=!0,this.$api.get("/api/kb/products/?limit=30&search="+this.products_search).then((function(t){e.products_items=t.data.results})).catch((function(t){console.log(t)})).finally((function(){return e.products_isLoading=!1}))))}),500)},mounted:function(){},methods:{nextStep:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";t===this.steps?this.stepper_fs=1:this.stepper_fs=t+1,"saveMonitoredProducts"==e&&this.toggleMonitoredProducts(),"saveAlertEmails"==e&&this.updateContactEmails()},closeMe:function(){this.$vnode.context.firststeps_overlay=!1,this.$router.push("/homepage")},removeSelectedProduct:function(t){var e=this.products_autocomplete.indexOf(t.name);e>=0&&this.products_autocomplete.splice(e,1)},removeContactEmail:function(t){this.org_settings.alerts_emails.splice(this.org_settings.alerts_emails.indexOf(t),1),this.org_settings.alerts_emails=Object(gt["a"])(this.org_settings.alerts_emails)},toggleMonitoredProducts:function(){var t,e,a=this;for(t=0;t<this.products_autocomplete.length;t++){var i=this.products_autocomplete[t];for(e=0;e<this.products_items.length;e++)if(this.products_items[e]["id"]==i){var s={vendor_name:this.products_items[e].vendor,product_name:this.products_items[e].name,monitored:!0,organization_id:localStorage.getItem("org_id")};this.$api.post("/api/monitor/product/toggle",s).then((function(t){a.loading=!1,t?(a.snack=!0,a.snackColor="success",a.snackText="Monitoring status successfuly updated."):(a.snack=!0,a.snackColor="error",a.snackText="Unable to change the monitoring status")})).catch((function(t){a.loading=!1,console.log(t)}))}}},updateContactEmails:function(){var t=this,e=new FormData;e.set("org_id",localStorage.getItem("org_id")),e.set("alerts_emails",this.org_settings.alerts_emails),this.$api.post("/users/org/update",e).then((function(e){e&&200!=e.status&&(t.snack=!0,t.snackColor="error",t.snackText="Unable to update organization settings :/")})).catch((function(e){t.snack=!0,t.snackColor="error",t.snackText="Unable to update organization settings :/"}))}}},xt=kt,yt=a("c6a6"),wt=a("cc20"),Ct=a("2b5d"),Vt=a("2db4"),It=a("7e85"),Tt=a("e516"),Pt=a("9c54"),St=a("56a4"),Et=Object(l["a"])(xt,_t,ht,!1,null,null,null),$t=Et.exports;d()(Et,{VAutocomplete:yt["a"],VBtn:V["a"],VCard:I["a"],VCardText:T["d"],VCardTitle:T["e"],VChip:wt["a"],VCombobox:Ct["a"],VDivider:G["a"],VIcon:Q["a"],VSnackbar:Vt["a"],VStepper:It["a"],VStepperContent:Tt["a"],VStepperHeader:Pt["c"],VStepperStep:St["a"]});var At={name:"Home",mixins:[pt],components:{VClamp:mt["a"],FirstSteps:$t},data:function(){return{stats:{vulns:"...",exploits:"...",threats:"...",monitored:"...",vulns_exploitable:"n/a"},vulns:[],vulns_headers:[{text:"CVE",value:"cveid",fixed:!0},{text:"Summary",value:"summary"}],monitored_vulns:[],monitored_vulns_headers:[{text:"Score",value:"score",align:"center",width:"10%"},{text:"Summary",value:"summary"},{text:"Metadata",value:"metadata",align:"center",width:"9%",sortable:!1},{text:"Last update",value:"updated_at",align:"center",width:"10%"}],loading_monitored_vulns:!0,loading_last_vulns:!0,exploits:[],exploits_headers:[{text:"Relevancy",value:"relevancy_level",fixed:!0},{text:"Link",value:"link",fixed:!0}],firststeps:!1,firststeps_overlay:!1}},watch:{firststeps:function(){1==this.firststeps?this.firststeps_overlay=!0:this.firststeps_overlay=!1}},mounted:function(){this.firststeps=this.$route.query.firststeps,this.getStats(),this.getLastVulns()},methods:{getStats:function(){var t=this;return Object(vt["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$api.get("/api/vulns/stats").then((function(e){e&&200===e.status&&(t.stats=e.data,t.loading_last_vulns=!1)})).catch((function(t){y.a.fire({title:"Error",text:"Unable to get stats",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}));case 2:case"end":return e.stop()}}),e)})))()},getLastVulns:function(){var t=this;return Object(vt["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$api.get("/api/vulns/latest?timedelta=30").then((function(e){e&&200===e.status&&(t.vulns=e.data.vulns,t.exploits=e.data.exploits,t.monitored_vulns=e.data.monitored_vulns,t.loading_last_vulns=!1)})).catch((function(t){y.a.fire({title:"Error",text:"Unable to get vulnerabilities and exploits",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}));case 2:case"end":return e.stop()}}),e)})))()},viewVuln:function(t){this.$router.push({name:"VulnDetails",params:{vuln_id:t.id}})},viewVulns:function(){this.$router.push({name:"Vulns"})},rowColor:function(t){return this.getRatingColor(t.score)}}},Mt=At,Dt=(a("3437"),a("8fea")),Ot=a("169a"),jt=Object(l["a"])(Mt,dt,ut,!1,null,null,null),Bt=jt.exports;d()(jt,{VBtn:V["a"],VCard:I["a"],VCardSubtitle:T["c"],VCardText:T["d"],VCardTitle:T["e"],VChip:wt["a"],VContainer:S["a"],VDataTable:Dt["a"],VDialog:Ot["a"],VFlex:E["a"],VIcon:Q["a"],VLayout:A["a"]});var Ut=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._v(" Alert Page - TODO ")])},Lt=[],Ft={name:"Alerts",mounted:function(){},methods:{}},Nt=Ft,Rt=Object(l["a"])(Nt,Ut,Lt,!1,null,null,null),Yt=Rt.exports,zt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md8:"","d-flex":"","align-stretch":""}},[a("v-card",{staticClass:"flex-grow-1",attrs:{color:"grey lighten-1",raised:""}},[a("v-card-title",[t._v("Vector")]),a("v-card-text",[t._v(t._s(t.rating_vector))])],1)],1),a("v-flex",{attrs:{md3:"","align-stretch":""}},[a("v-card",{attrs:{color:t.getRatingColor(parseInt(t.score)),raised:""}},[a("v-card-title",[t._v("Global Score")]),a("v-card-text",{staticClass:"display-2 text-center"},[t._v(t._s(parseInt(t.score)))])],1)],1)],1),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md8:""}},[a("v-card",{attrs:{color:"grey lighten-5"}},[a("v-card-title",[t._v("Vulnerability metrics")]),a("v-card-text",[a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Access - Attack Vector ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.vulnerability.access.vector,callback:function(e){t.$set(t.vulnerability.access,"vector",e)},expression:"vulnerability.access.vector"}},[a("v-btn",{attrs:{small:"",value:"L"}},[t._v("Local (AV:L)")]),a("v-btn",{attrs:{small:"",value:"A"}},[t._v("Adjacent Network (AV:A)")]),a("v-btn",{attrs:{small:"",value:"N"}},[t._v("Network (AV:N)")])],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Access - Attack Complexity ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.vulnerability.access.complexity,callback:function(e){t.$set(t.vulnerability.access,"complexity",e)},expression:"vulnerability.access.complexity"}},[a("v-btn",{attrs:{small:"",value:"H"}},[t._v("High (AC:H)")]),a("v-btn",{attrs:{small:"",value:"M"}},[t._v("Medium (AC:M)")]),a("v-btn",{attrs:{small:"",value:"L"}},[t._v("Low (AC:L)")])],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Access - Authentication ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.vulnerability.access.authentication,callback:function(e){t.$set(t.vulnerability.access,"authentication",e)},expression:"vulnerability.access.authentication"}},[a("v-btn",{attrs:{small:"",value:"M"}},[t._v("Multiple (Au:M)")]),a("v-btn",{attrs:{small:"",value:"S"}},[t._v("Single (Au:S)")]),a("v-btn",{attrs:{small:"",value:"N"}},[t._v("None (Au:N)")])],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Impact - Confidentiality ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.vulnerability.impact.confidentiality,callback:function(e){t.$set(t.vulnerability.impact,"confidentiality",e)},expression:"vulnerability.impact.confidentiality"}},[a("v-btn",{attrs:{small:"",value:"N"}},[t._v("None (C:N)")]),a("v-btn",{attrs:{small:"",value:"L"}},[t._v("Low (C:L)")]),a("v-btn",{attrs:{small:"",value:"C"}},[t._v("Complete (C:C)")])],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Impact - Integrity ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.vulnerability.impact.integrity,callback:function(e){t.$set(t.vulnerability.impact,"integrity",e)},expression:"vulnerability.impact.integrity"}},[a("v-btn",{attrs:{small:"",value:"N"}},[t._v("None (I:N)")]),a("v-btn",{attrs:{small:"",value:"L"}},[t._v("Low (I:L)")]),a("v-btn",{attrs:{small:"",value:"C"}},[t._v("Complete (I:C)")])],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Impact - Availability ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.vulnerability.impact.availability,callback:function(e){t.$set(t.vulnerability.impact,"availability",e)},expression:"vulnerability.impact.availability"}},[a("v-btn",{attrs:{small:"",value:"N"}},[t._v("None (A:N)")]),a("v-btn",{attrs:{small:"",value:"L"}},[t._v("Low (A:L)")]),a("v-btn",{attrs:{small:"",value:"C"}},[t._v("Complete (A:C)")])],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Remediation ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.vulnerability.remediation,callback:function(e){t.$set(t.vulnerability,"remediation",e)},expression:"vulnerability.remediation"}},[a("v-btn",{attrs:{small:"",value:"X"}},[t._v("Unknown (R:X)")]),a("v-btn",{attrs:{small:"",value:"U"}},[t._v("Unavailable (R:H)")]),a("v-btn",{attrs:{small:"",value:"W"}},[t._v("Workaround (R:W)")]),a("v-btn",{attrs:{small:"",value:"T"}},[t._v("Temporary (R:T)")]),a("v-btn",{attrs:{small:"",value:"O"}},[t._v("Official (R:O)")])],1)],1),a("v-row",[a("v-col",{staticClass:"py-2 pa-6",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Vulnerability Age ")]),a("v-menu",{ref:"menu_vage",attrs:{"close-on-content-click":!1,"return-value":t.vulnerability.age,transition:"scale-transition","offset-y":"","min-width":"290px"},on:{"update:returnValue":function(e){return t.$set(t.vulnerability,"age",e)},"update:return-value":function(e){return t.$set(t.vulnerability,"age",e)}},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[a("v-text-field",t._g({model:{value:t.vulnerability.age,callback:function(e){t.$set(t.vulnerability,"age",e)},expression:"vulnerability.age"}},i))]}}]),model:{value:t.menu_vage,callback:function(e){t.menu_vage=e},expression:"menu_vage"}},[a("v-date-picker",{attrs:{scrollable:"",landscape:""},model:{value:t.vulnerability.age,callback:function(e){t.$set(t.vulnerability,"age",e)},expression:"vulnerability.age"}},[a("v-spacer"),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){t.menu_vage=!1}}},[t._v("Cancel")]),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){return t.$refs.menu_vage.save("")}}},[t._v("Reset")]),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){return t.$refs.menu_vage.save(t.vulnerability.age)}}},[t._v("OK")])],1)],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"8"}},[a("span",{staticClass:"subtitle-1"},[t._v("Confirmation ")]),a("v-row",[a("v-col",{staticClass:"py-2",attrs:{cols:"12"}},[a("v-switch",{attrs:{label:"Confirmed by trusted parties: "+t.vulnerability.confirmation.toString(),color:"deep-orange"},model:{value:t.vulnerability.confirmation,callback:function(e){t.$set(t.vulnerability,"confirmation",e)},expression:"vulnerability.confirmation"}})],1)],1)],1)],1)],1)],1)],1),a("v-flex",{attrs:{md3:"","d-flex":"","align-stretch":""}},[a("v-card",{staticClass:"flex-grow-1 flex-shrink-0",attrs:{color:"grey lighten-5"}},[a("v-card-title",[t._v("Vulnerability Score")]),a("v-card-text",{staticClass:"text-center"},[a("v-progress-circular",{attrs:{value:20*t.vuln_score,size:100,width:5,color:"deep-orange"}},[t._v(t._s(parseInt(20*t.vuln_score))+" ")])],1)],1)],1)],1),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md8:""}},[a("v-card",{attrs:{color:"grey lighten-5"}},[a("v-card-title",[t._v("Threat metrics")]),a("v-card-text",[a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Exploit Availability ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.threat.exploit_availability,callback:function(e){t.$set(t.threat,"exploit_availability",e)},expression:"threat.exploit_availability"}},[a("v-btn",{attrs:{small:"",value:"X"}},[t._v("Unknown (EA:X)")]),a("v-btn",{attrs:{small:"",value:"R"}},[t._v("Private (EA:R)")]),a("v-btn",{attrs:{small:"",value:"U"}},[t._v("Public (EA:U)")])],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Exploit Maturity ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.threat.exploit_maturity,callback:function(e){t.$set(t.threat,"exploit_maturity",e)},expression:"threat.exploit_maturity"}},[a("v-btn",{attrs:{small:"",value:"X"}},[t._v("Unknown (EM:X)")]),a("v-btn",{attrs:{small:"",value:"U"}},[t._v("Unproven (EM:U)")]),a("v-btn",{attrs:{small:"",value:"P"}},[t._v("PoC (EM:P)")]),a("v-btn",{attrs:{small:"",value:"F"}},[t._v("Functional (EM:F)")])],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Exploit Confidence ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.threat.exploit_trust,callback:function(e){t.$set(t.threat,"exploit_trust",e)},expression:"threat.exploit_trust"}},[a("v-btn",{attrs:{small:"",value:"X"}},[t._v("Unknown (ET:X)")]),a("v-btn",{attrs:{small:"",value:"L"}},[t._v("Low (ET:L)")]),a("v-btn",{attrs:{small:"",value:"M"}},[t._v("Medium (ET:M)")]),a("v-btn",{attrs:{small:"",value:"H"}},[t._v("High (ET:H)")])],1)],1),a("v-row",[a("v-col",{staticClass:"py-2 pa-6",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Exploit Age ")]),a("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,"return-value":t.threat.exploit_age,transition:"scale-transition","offset-y":"","min-width":"290px"},on:{"update:returnValue":function(e){return t.$set(t.threat,"exploit_age",e)},"update:return-value":function(e){return t.$set(t.threat,"exploit_age",e)}},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[a("v-text-field",t._g({model:{value:t.threat.exploit_age,callback:function(e){t.$set(t.threat,"exploit_age",e)},expression:"threat.exploit_age"}},i))]}}]),model:{value:t.menu,callback:function(e){t.menu=e},expression:"menu"}},[a("v-date-picker",{attrs:{scrollable:"",landscape:""},model:{value:t.threat.exploit_age,callback:function(e){t.$set(t.threat,"exploit_age",e)},expression:"threat.exploit_age"}},[a("v-spacer"),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){t.menu}}},[t._v("Cancel")]),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){return t.$refs.menu.save("")}}},[t._v("Reset")]),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){return t.$refs.menu.save(t.threat.exploit_age)}}},[t._v("OK")])],1)],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"8"}},[a("span",{staticClass:"subtitle-1"},[t._v("Mediatisation ")]),a("v-row",[a("v-col",{staticClass:"py-2",attrs:{cols:"6"}},[a("v-switch",{attrs:{label:"In the News ? : "+t.threat.in_the_news.toString(),color:"deep-orange"},model:{value:t.threat.in_the_news,callback:function(e){t.$set(t.threat,"in_the_news",e)},expression:"threat.in_the_news"}})],1),a("v-col",{staticClass:"py-2",attrs:{cols:"6"}},[a("v-switch",{attrs:{label:"In the Wild ? : "+t.threat.in_the_wild.toString(),color:"deep-orange"},model:{value:t.threat.in_the_wild,callback:function(e){t.$set(t.threat,"in_the_wild",e)},expression:"threat.in_the_wild"}})],1)],1)],1)],1)],1)],1)],1),a("v-flex",{attrs:{md3:"","d-flex":"","align-stretch":""}},[a("v-card",{staticClass:"flex-grow-1 flex-shrink-0",attrs:{color:"grey lighten-5"}},[a("v-card-title",[t._v("Threat Score")]),a("v-card-text",{staticClass:"text-center"},[a("v-progress-circular",{attrs:{value:20*t.threat_score,size:100,width:5,color:"deep-orange"}},[t._v(t._s(parseInt(20*t.threat_score))+" ")])],1)],1)],1)],1),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md8:""}},[a("v-card",{attrs:{color:"grey lighten-5"}},[a("v-card-title",[t._v("Asset metrics")]),a("v-card-text",[a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Criticality ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.asset.criticality,callback:function(e){t.$set(t.asset,"criticality",e)},expression:"asset.criticality"}},[a("v-btn",{attrs:{small:"",value:"X"}},[t._v("Unknown (Cr:X)")]),a("v-btn",{attrs:{small:"",value:"L"}},[t._v("Low (Cr:L)")]),a("v-btn",{attrs:{small:"",value:"M"}},[t._v("Medium (Cr:M)")]),a("v-btn",{attrs:{small:"",value:"H"}},[t._v("High (Cr:H)")])],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Exposure ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.asset.exposure,callback:function(e){t.$set(t.asset,"exposure",e)},expression:"asset.exposure"}},[a("v-btn",{attrs:{small:"",value:"X"}},[t._v("Unknown (E:X)")]),a("v-btn",{attrs:{small:"",value:"R"}},[t._v("Restricted/DMZ (E:R)")]),a("v-btn",{attrs:{small:"",value:"I"}},[t._v("Internal (E:I)")]),a("v-btn",{attrs:{small:"",value:"E"}},[t._v("External (E:E)")])],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Distribution ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.asset.distribution,callback:function(e){t.$set(t.asset,"distribution",e)},expression:"asset.distribution"}},[a("v-btn",{attrs:{small:"",value:"X"}},[t._v("Unknown (D:X)")]),a("v-btn",{attrs:{small:"",value:"L"}},[t._v("Low <15 (D:L)")]),a("v-btn",{attrs:{small:"",value:"M"}},[t._v("Medium <45 (D:M)")]),a("v-btn",{attrs:{small:"",value:"H"}},[t._v("High â¥45 (D:H)")])],1)],1)],1)],1)],1),a("v-flex",{attrs:{md3:"","d-flex":"","align-stretch":""}},[a("v-card",{staticClass:"flex-grow-1 flex-shrink-0",attrs:{color:"grey lighten-5"}},[a("v-card-title",[t._v("Asset Score")]),a("v-card-text",{staticClass:"text-center"},[a("v-progress-circular",{attrs:{value:25*t.asset_score,size:100,width:5,color:"deep-orange"}},[t._v(t._s(parseInt(25*t.asset_score))+" ")])],1)],1)],1)],1)],1)},Xt=[],Ht=(a("99af"),a("a15b"),a("b64b"),a("ac1f"),a("1276"),a("caad"),a("b680"),{methods:{calcVulnScore:function(t,e){if(void 0==e||0===Object.keys(e).length)return 0;for(var a=0,i={vector:0,complexity:0,authentication:0,confidentiality:0,integrity:0,availability:0},s="",n=[],o=0;o<t.length;o++)s=t[o].split(":"),"AV"===s[0]&&!["N","A","L"].includes(s[1])&&(i.vector+=e.cvss2.access.vector.default),"AV"===s[0]&&"N"===s[1]&&(i.vector+=e.cvss2.access.vector.network),"AV"===s[0]&&"A"===s[1]&&(i.vector+=e.cvss2.access.vector.adjacent),"AV"===s[0]&&"L"===s[1]&&(i.vector+=e.cvss2.access.vector.local),"AV"===s[0]&&n.push("AV"),"AC"===s[0]&&!["L","M","H"].includes(s[1])&&(i.complexity+=e.cvss2.access.complexity.default),"AC"===s[0]&&"L"===s[1]&&(i.complexity+=e.cvss2.access.complexity.low),"AC"===s[0]&&"M"===s[1]&&(i.complexity+=e.cvss2.access.complexity.medium),"AC"===s[0]&&"H"===s[1]&&(i.complexity+=e.cvss2.access.complexity.high),"AC"===s[0]&&n.push("AC"),"Au"===s[0]&&!["N","S","M"].includes(s[1])&&(i.authentication+=e.cvss2.access.authentication.default),"Au"===s[0]&&"N"===s[1]&&(i.authentication+=e.cvss2.access.authentication.none),"Au"===s[0]&&"S"===s[1]&&(i.authentication+=e.cvss2.access.authentication.single),"Au"===s[0]&&"M"===s[1]&&(i.authentication+=e.cvss2.access.authentication.multiple),"Au"===s[0]&&n.push("Au"),"C"===s[0]&&!["N","L","P","C","H"].includes(s[1])&&(i.confidentiality+=e.cvss2.impact.confidentiality.default),"C"===s[0]&&"N"===s[1]&&(i.confidentiality+=e.cvss2.impact.confidentiality.none),"C"===s[0]&&"L"===s[1]&&(i.confidentiality+=e.cvss2.impact.confidentiality.partial),"C"===s[0]&&"P"===s[1]&&(i.confidentiality+=e.cvss2.impact.confidentiality.partial),"C"===s[0]&&"C"===s[1]&&(i.confidentiality+=e.cvss2.impact.confidentiality.complete),"C"===s[0]&&"H"===s[1]&&(i.confidentiality+=e.cvss2.impact.confidentiality.complete),"C"===s[0]&&n.push("C"),"I"===s[0]&&!["N","L","P","C","H"].includes(s[1])&&(i.integrity+=e.cvss2.impact.integrity.default),"I"===s[0]&&"N"===s[1]&&(i.integrity+=e.cvss2.impact.integrity.none),"I"===s[0]&&"L"===s[1]&&(i.integrity+=e.cvss2.impact.integrity.partial),"I"===s[0]&&"P"===s[1]&&(i.integrity+=e.cvss2.impact.integrity.partial),"I"===s[0]&&"C"===s[1]&&(i.integrity+=e.cvss2.impact.integrity.complete),"I"===s[0]&&"H"===s[1]&&(i.integrity+=e.cvss2.impact.integrity.complete),"I"===s[0]&&n.push("I"),"A"===s[0]&&!["N","L","P","C","H"].includes(s[1])&&(i.availability+=e.cvss2.impact.availability.default),"A"===s[0]&&"N"===s[1]&&(i.availability+=e.cvss2.impact.availability.none),"A"===s[0]&&"L"===s[1]&&(i.availability+=e.cvss2.impact.availability.partial),"A"===s[0]&&"P"===s[1]&&(i.availability+=e.cvss2.impact.availability.partial),"A"===s[0]&&"C"===s[1]&&(i.availability+=e.cvss2.impact.availability.complete),"A"===s[0]&&"H"===s[1]&&(i.availability+=e.cvss2.impact.availability.complete),"A"===s[0]&&n.push("A"),"R"===s[0]&&!["U","W","T","O"].includes(s[1])&&(a+=e.remediation.default),"R"===s[0]&&"U"===s[1]&&(a+=e.remediation.unavailable),"R"===s[0]&&"W"===s[1]&&(a+=e.remediation.workaround),"R"===s[0]&&"T"===s[1]&&(a+=e.remediation.temporary),"R"===s[0]&&"O"===s[1]&&(a+=e.remediation.official),"R"===s[0]&&n.push("R"),"VX"===s[0]&&s[1]<=15&&(a+=e.age.caps["15"]),"VX"===s[0]&&s[1]>15&&s[1]<=45&&(a+=e.age.caps["45"]),"VX"===s[0]&&s[1]>45&&(a+=e.age.caps["10000000"]),"VX"===s[0]&&n.push("VX"),"CL"===s[0]&&"Y"===s[1]&&(a+=e.confirmation.is_confirmed),n.push("CL");!n.includes("AV")&&(i.vector=e.cvss2.access.vector.default),!n.includes("AC")&&(i.complexity=e.cvss2.access.complexity.default),!n.includes("Au")&&(i.authentication=e.cvss2.access.authentication.default),!n.includes("C")&&(i.confidentiality=e.cvss2.impact.confidentiality.default),!n.includes("I")&&(i.integrity=e.cvss2.impact.integrity.default),!n.includes("A")&&(i.availability=e.cvss2.impact.availability.default),!n.includes("VX")&&(a+=e.age.default),!n.includes("R")&&(a+=e.remediation.default);var r=10.41*(1-(1-i.confidentiality)*(1-i.integrity)*(1-i.availability)),l=20*i.complexity*i.vector*i.authentication,c=0;c=0==r?0:1.176;var d=(.6*r+.4*l-1.5)*c;return a+=80*parseFloat(d).toFixed(1)/100/2,a>e.max_score&&(a=e.max_score),parseFloat(a).toFixed(1)},calcThreatScore:function(t,e){if(void 0==e||0===Object.keys(e).length)return 0;for(var a=0,i="",s=[],n=0;n<t.length;n++)i=t[n].split(":"),"EA"===i[0]&&!["X","R","U"].includes(i[1])&&(a+=e.exploit_availability.default),"EA"===i[0]&&"X"===i[1]&&(a+=e.exploit_availability.unknown),"EA"===i[0]&&"R"===i[1]&&(a+=e.exploit_availability.private),"EA"===i[0]&&"U"===i[1]&&(a+=e.exploit_availability.public),"EA"===i[0]&&s.push("EA"),"EM"===i[0]&&!["X","U","P","F"].includes(i[1])&&(a+=e.exploit_maturity.default),"EM"===i[0]&&"X"===i[1]&&(a+=e.exploit_maturity.unknown),"EM"===i[0]&&"U"===i[1]&&(a+=e.exploit_maturity.unproven),"EM"===i[0]&&"P"===i[1]&&(a+=e.exploit_maturity.poc),"EM"===i[0]&&"F"===i[1]&&(a+=e.exploit_maturity.functional),"EM"===i[0]&&s.push("EM"),"ET"===i[0]&&!["X","L","M","H"].includes(i[1])&&(a+=e.exploit_trust.default),"ET"===i[0]&&"X"===i[1]&&(a+=e.exploit_trust.unknown),"ET"===i[0]&&"L"===i[1]&&(a+=e.exploit_trust.low),"ET"===i[0]&&"M"===i[1]&&(a+=e.exploit_trust.medium),"ET"===i[0]&&"H"===i[1]&&(a+=e.exploit_trust.high),"ET"===i[0]&&s.push("ET"),"EX"===i[0]&&i[1]<=15&&(a+=e.exploit_age.caps["15"]),"EX"===i[0]&&i[1]>15&&i[1]<=45&&(a+=e.exploit_age.caps["45"]),"EX"===i[0]&&i[1]>45&&(a+=e.exploit_age.caps["10000000"]),"EX"===i[0]&&s.push("EX"),"N"===i[0]&&"Y"===i[1]&&(a+=e.threat_intensity.is_in_the_news),"W"===i[0]&&"Y"===i[1]&&(a+=e.threat_intensity.is_in_the_wild);return!s.includes("EA")&&(a+=e.exploit_availability.default),!s.includes("EM")&&(a+=e.exploit_maturity.default),!s.includes("ET")&&(a+=e.exploit_trust.default),!s.includes("EX")&&(a+=e.exploit_age.default),a>e.max_score&&(a=e.max_score),parseFloat(a).toFixed(1)},calcAssetScore:function(t,e){if(void 0==e||0===Object.keys(e).length)return 0;for(var a=0,i="",s=[],n=0;n<t.length;n++)i=t[n].split(":"),"Cr"===i[0]&&!["L","M","H"].includes(i[1])&&(a+=e.criticality.default),"Cr"===i[0]&&"L"===i[1]&&(a+=e.criticality.low),"Cr"===i[0]&&"M"===i[1]&&(a+=e.criticality.medium),"Cr"===i[0]&&"H"===i[1]&&(a+=e.criticality.high),"Cr"===i[0]&&s.push("Cr"),"E"===i[0]&&!["R","I","E"].includes(i[1])&&(a+=e.exposure.default),"E"===i[0]&&"R"===i[1]&&(a+=e.exposure.restricted),"E"===i[0]&&"I"===i[1]&&(a+=e.exposure.internal),"E"===i[0]&&"E"===i[1]&&(a+=e.exposure.external),"E"===i[0]&&s.push("E"),"D"===i[0]&&!["L","M","H"].includes(i[1])&&(a+=e.distribution.default),"D"===i[0]&&"L"===i[1]&&(a+=e.distribution.low),"D"===i[0]&&"M"===i[1]&&(a+=e.distribution.medium),"D"===i[0]&&"H"===i[1]&&(a+=e.distribution.high),"D"===i[0]&&s.push("D");return!s.includes("Cr")&&(a+=e.criticality.default),!s.includes("E")&&(a+=e.exposure.default),!s.includes("D")&&(a+=e.distribution.default),a>e.max_score&&(a=e.max_score),parseFloat(a).toFixed(1)}},mounted:function(){},destroyed:function(){}}),Wt=a("c1df"),qt=a.n(Wt),Jt={name:"Ratings",mixins:[pt,Ht],data:function(){return{loading:!1,vulnerability:{access:{vector:"N",complexity:"L",authentication:"N"},impact:{confidentiality:"N",integrity:"N",availability:"N"},confirmation:!1,remediation:"X",age:(new Date).toISOString().substr(0,10)},threat:{exploit_availability:"X",exploit_maturity:"X",exploit_trust:"X",exploit_age:(new Date).toISOString().substr(0,10),in_the_news:!1,in_the_wild:!1},asset:{criticality:"M",exposure:"I",distribution:"M"},metrics_values:{},base_vector:"",base_vector_format:"VPRv1",score:"n/a",vuln_score:80,threat_score:0,asset_score:0,menu:!1,menu_vage:!1}},mounted:function(){this.base_vector=this.$route.query.vector,this.getDataFromApi(),null==this.base_vector&&""==this.base_vector||this.init_vector(this.base_vector)},computed:{rating_vector:function(){var t=[],e=[];e.push("AV:"+this.vulnerability.access.vector),e.push("AC:"+this.vulnerability.access.complexity),e.push("Au:"+this.vulnerability.access.authentication),e.push("C:"+this.vulnerability.impact.confidentiality),e.push("I:"+this.vulnerability.impact.integrity),e.push("A:"+this.vulnerability.impact.availability),1==this.vulnerability.confirmation&&e.push("CL:Y"),"X"!=this.vulnerability.remediation&&e.push("R:"+this.vulnerability.remediation),""!=this.vulnerability.age&&e.push("VX:"+qt()().diff(this.vulnerability.age,"days")),this.vuln_score=this.calcVulnScore(e,this.metrics_values.vulnerability),t=t.concat(e);var a=[];"X"!=this.threat.exploit_availability&&a.push("EA:"+this.threat.exploit_availability),"X"!=this.threat.exploit_maturity&&a.push("EM:"+this.threat.exploit_maturity),"X"!=this.threat.exploit_trust&&a.push("ET:"+this.threat.exploit_trust),!0===this.threat.in_the_news&&a.push("N:Y"),!0===this.threat.in_the_wild&&a.push("W:Y"),""!=this.threat.exploit_age&&a.push("EX:"+qt()().diff(this.threat.exploit_age,"days")),this.threat_score=this.calcThreatScore(a,this.metrics_values.threat),t=t.concat(a);var i=[];return"X"!=this.asset.criticality&&i.push("Cr:"+this.asset.criticality),"X"!=this.asset.exposure&&i.push("E:"+this.asset.exposure),"X"!=this.asset.distribution&&i.push("D:"+this.asset.distribution),this.asset_score=this.calcAssetScore(i,this.metrics_values.asset),t=t.concat(i),this.score=12*this.vuln_score+4*this.threat_score+5*this.asset_score,t.join("/")}},methods:{init_vector:function(t){if(void 0==t||0===Object.keys(t).length)return 0;for(var e="",a=t.split("/"),i=0;i<a.length;i++)e=a[i].split(":"),"AV"==e[0]&&(this.vulnerability.access.vector=e[1]),"AC"==e[0]&&(this.vulnerability.access.complexity=e[1]),"Au"==e[0]&&(this.vulnerability.access.authentication=e[1]),"C"==e[0]&&(this.vulnerability.impact.confidentiality=e[1]),"P"==this.vulnerability.impact.confidentiality&&(this.vulnerability.impact.confidentiality="L"),"I"==e[0]&&(this.vulnerability.impact.integrity=e[1]),"P"==this.vulnerability.impact.integrity&&(this.vulnerability.impact.integrity="L"),"A"==e[0]&&(this.vulnerability.impact.availability=e[1]),"P"==this.vulnerability.impact.availability&&(this.vulnerability.impact.availability="L"),"CL:Y"==a[i]&&(this.vulnerability.confirmation=!0),"R"==e[0]&&(this.vulnerability.remediation=e[1]),"VX"==e[0]&&(this.vulnerability.age=qt()().subtract(e[1],"days").toISOString(!0).substr(0,10)),"EA"==e[0]&&(this.threat.exploit_availability=e[1]),"EM"==e[0]&&(this.threat.exploit_maturity=e[1]),"ET"==e[0]&&(this.threat.exploit_trust=e[1]),"N:Y"==a[i]&&(this.threat.in_the_news=!0),"W:Y"==a[i]&&(this.threat.in_the_wild=!0),"EX"==e[0]&&(this.threat.exploit_age=qt()().subtract(e[1],"days").toISOString(!0).substr(0,10)),"Cr"==e[0]&&(this.asset.criticality=e[1]),"E"==e[0]&&(this.asset.exposure=e[1]),"D"==e[0]&&(this.asset.distribution=e[1])},getDataFromApi:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var i=t.getMetricValues();setTimeout((function(){e({metrics_values:i})}),300)}))},getMetricValues:function(){var t=this;this.$api.get("/api/ratings/metrics").then((function(e){return t.metrics_values=e.data,t.loading=!1,t.metrics_values})).catch((function(e){t.metrics_values={},t.loading=!1,swal.fire({title:"Error",text:"unable to get metrics values",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))}}},Kt=Jt,Gt=a("a609"),Zt=a("62ad"),Qt=a("2e4b"),te=a("0fd9"),ee=a("b73d"),ae=Object(l["a"])(Kt,zt,Xt,!1,null,null,null),ie=ae.exports;d()(ae,{VBtn:V["a"],VBtnToggle:Gt["a"],VCard:I["a"],VCardText:T["d"],VCardTitle:T["e"],VCol:Zt["a"],VContainer:S["a"],VDatePicker:Qt["a"],VFlex:E["a"],VLayout:A["a"],VMenu:ot["a"],VProgressCircular:M["a"],VRow:te["a"],VSpacer:D["a"],VSwitch:ee["a"],VTextField:O["a"]});var se=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-tabs",{attrs:{left:"","background-color":"white",color:"deep-orange accent-4"}},[a("v-tab",[t._v("Profile")]),t.isAlertAdmin()?a("v-tab",[t._v("Alerting")]):t._e(),"notsupported"==t.isAdmin()?a("v-tab",[t._v("Sync")]):t._e(),t.isTeamOrgAdmin()?a("v-tab",[t._v("Orgs + Users")]):t._e(),a("v-tab-item",[a("v-row",[a("v-col",{attrs:{cols:"8"}},[a("v-list-item",[a("v-list-item-content",[a("v-list-item-title",[t._v("Username")]),a("v-list-item-subtitle",[t._v(t._s(t.user_profile.username))])],1),a("v-list-item-content",[a("v-list-item-title",[t._v("Email")]),a("v-list-item-subtitle",[t._v(t._s(t.user_profile.email))])],1)],1),a("v-list-item",[a("v-list-item-content",[a("v-list-item-title",[t._v("Permissions")]),t._l(t.user_profile.profile,(function(e,i){return a("v-list-item-subtitle",{key:i},[t._v(" "+t._s(i)+": "+t._s(e)+" ")])}))],2)],1)],1),a("v-col",{attrs:{cols:"4"}},[a("v-card",{staticClass:"ma-2"},[a("v-card-title",{on:{click:function(e){t.showEditProfileCard=!t.showEditProfileCard}}},[t._v(" Edit user profile "),a("v-icon",{attrs:{left:""}},[t._v("mdi-chevron-double-right")])],1),t.showEditProfileCard?a("v-card-text",[a("v-text-field",{attrs:{disabled:"",label:"Username"},model:{value:t.user_profile.username,callback:function(e){t.$set(t.user_profile,"username",e)},expression:"user_profile.username"}}),a("v-text-field",{attrs:{disabled:"",label:"Email Address"},model:{value:t.user_profile.email,callback:function(e){t.$set(t.user_profile,"email",e)},expression:"user_profile.email"}}),a("v-text-field",{attrs:{label:"First Name"},model:{value:t.user_profile.first_name,callback:function(e){t.$set(t.user_profile,"first_name",e)},expression:"user_profile.first_name"}}),a("v-text-field",{attrs:{label:"Last Name"},model:{value:t.user_profile.last_name,callback:function(e){t.$set(t.user_profile,"last_name",e)},expression:"user_profile.last_name"}})],1):t._e(),t.showEditProfileCard?a("v-card-actions",{staticClass:"justify-center"},[a("v-btn",{attrs:{color:"grey",loading:t.loading,block:""},nativeOn:{click:function(e){return t.updateUserProfile(e)}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Update Profile ")],1)],1):t._e()],1),a("v-card",{staticClass:"ma-2"},[a("v-card-title",{on:{click:function(e){t.showEditTokenCard=!t.showEditTokenCard}}},[t._v(" Edit API token "),a("v-icon",{attrs:{left:""}},[t._v("mdi-chevron-double-right")])],1),t.showEditTokenCard?a("v-card-text",[a("v-text-field",{attrs:{"append-icon":t.show_authtoken?"mdi-eye":"mdi-eye-off",type:t.show_authtoken?"text":"password",label:"API Token"},on:{"click:append":function(e){t.show_authtoken=!t.show_authtoken}},model:{value:t.user_profile.auth_token,callback:function(e){t.$set(t.user_profile,"auth_token",e)},expression:"user_profile.auth_token"}})],1):t._e(),t.showEditTokenCard?a("v-card-actions",{staticClass:"justify-center"},[a("v-btn",{attrs:{color:"red",loading:t.loading},nativeOn:{click:function(e){return t.deleteUserToken(e)}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-delete-outline")]),t._v(" Delete Token ")],1),a("v-btn",{attrs:{color:"grey",loading:t.loading},nativeOn:{click:function(e){return t.updateUserToken(e)}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-autorenew")]),t._v(" Renew Token ")],1)],1):t._e()],1),a("v-card",{staticClass:"ma-2"},[a("v-card-title",{on:{click:function(e){t.showEditPasswordCard=!t.showEditPasswordCard}}},[t._v(" Edit password "),a("v-icon",{attrs:{left:""}},[t._v("mdi-chevron-double-right")])],1),t.showEditPasswordCard?a("v-card-text",[a("v-text-field",{attrs:{"append-icon":t.showPassword_old?"mdi-eye":"mdi-eye-off",type:t.showPassword_old?"text":"password",counter:"",label:"Old Password"},on:{"click:append":function(e){t.showPassword_old=!t.showPassword_old}},model:{value:t.user_profile_chpwd.oldpassword,callback:function(e){t.$set(t.user_profile_chpwd,"oldpassword",e)},expression:"user_profile_chpwd.oldpassword"}}),a("v-text-field",{attrs:{"append-icon":t.showPassword_new1?"mdi-eye":"mdi-eye-off",type:t.showPassword_new1?"text":"password",counter:"",label:"New Password"},on:{"click:append":function(e){t.showPassword_new1=!t.showPassword_new1}},model:{value:t.user_profile_chpwd.new_password1,callback:function(e){t.$set(t.user_profile_chpwd,"new_password1",e)},expression:"user_profile_chpwd.new_password1"}}),a("v-text-field",{attrs:{"append-icon":t.showPassword_new2?"mdi-eye":"mdi-eye-off",type:t.showPassword_new2?"text":"password",counter:"",label:"New Password (again)"},on:{"click:append":function(e){t.showPassword_new2=!t.showPassword_new2}},model:{value:t.user_profile_chpwd.new_password2,callback:function(e){t.$set(t.user_profile_chpwd,"new_password2",e)},expression:"user_profile_chpwd.new_password2"}})],1):t._e(),t.showEditPasswordCard?a("v-card-actions",{staticClass:"justify-center"},[a("v-btn",{attrs:{color:"grey",loading:t.loading,disabled:t.user_profile_chpwd.new_password1!=t.user_profile_chpwd.new_password2,block:""},nativeOn:{click:function(e){return t.updateUserPassword(e)}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Update Password ")],1)],1):t._e()],1)],1)],1)],1),t.isAlertAdmin()?a("v-tab-item",[a("v-row",[a("v-col",{attrs:{cols:"10"}},[a("v-card",[a("v-card-title",[t._v(" Email alerting ")]),a("v-card-text",[a("v-combobox",{attrs:{clearable:"",label:"Contact emails (press Enter to confirm)",multiple:"",rules:t.emailRules},scopedSlots:t._u([{key:"selection",fn:function(e){var i=e.attrs,s=e.item,n=e.select,o=e.selected;return[a("v-chip",t._b({attrs:{"input-value":o,close:""},on:{click:n,"click:close":function(e){return t.removeContactEmail(s)}}},"v-chip",i,!1),[a("strong",[t._v(t._s(s))])])]}}],null,!1,3141613500),model:{value:t.org_settings.alerts_emails,callback:function(e){t.$set(t.org_settings,"alerts_emails",e)},expression:"org_settings.alerts_emails"}}),a("v-checkbox",{attrs:{label:"Enable daily report by email on monitored assets",dense:"","hide-details":""},model:{value:t.org_settings.enable_daily_email_report,callback:function(e){t.$set(t.org_settings,"enable_daily_email_report",e)},expression:"org_settings.enable_daily_email_report"}}),a("v-checkbox",{attrs:{label:"Enable weekly report by email on monitored assets",dense:"","hide-details":""},model:{value:t.org_settings.enable_weekly_email_report,callback:function(e){t.$set(t.org_settings,"enable_weekly_email_report",e)},expression:"org_settings.enable_weekly_email_report"}}),a("v-checkbox",{attrs:{label:"Enable monthly report by email on monitored assets",dense:"","hide-details":""},model:{value:t.org_settings.enable_monthly_email_report,callback:function(e){t.$set(t.org_settings,"enable_monthly_email_report",e)},expression:"org_settings.enable_monthly_email_report"}})],1),a("v-card-actions",[a("v-btn",{attrs:{color:"grey",loading:t.loading},nativeOn:{click:function(e){return t.updateOrgSettings(e)}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Save Changes ")],1)],1)],1)],1)],1),this.org_settings.show_slack_settings?a("v-row",[a("v-col",{attrs:{cols:"10"}},[a("v-card",[a("v-card-title",[t._v(" Slack alerting ")]),a("v-card-text",[a("v-text-field",{attrs:{label:"Slack Webhook URL",placeholder:"Ex: https://hooks.slack.com/services/T00000000/B00000000/XXXXXXXXXXXXXXXXXXXXXXXX"},model:{value:t.org_settings.alerts_slack_url,callback:function(e){t.$set(t.org_settings,"alerts_slack_url",e)},expression:"org_settings.alerts_slack_url"}}),a("v-checkbox",{attrs:{label:"Enable notifications when detecting new vulnerabilities (monitored assets)",dense:"","hide-details":""},model:{value:t.org_settings.enable_slack_new_vuln,callback:function(e){t.$set(t.org_settings,"enable_slack_new_vuln",e)},expression:"org_settings.enable_slack_new_vuln"}}),a("v-checkbox",{attrs:{label:"Enable notifications when detecting changes in vulnerabilities (monitored assets)",dense:"","hide-details":""},model:{value:t.org_settings.enable_slack_update_vuln,callback:function(e){t.$set(t.org_settings,"enable_slack_update_vuln",e)},expression:"org_settings.enable_slack_update_vuln"}})],1),a("v-card-actions",[a("v-btn",{attrs:{color:"grey",loading:t.loading},nativeOn:{click:function(e){return t.updateOrgSettings(e)}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Save Changes ")],1)],1)],1)],1)],1):t._e(),this.org_settings.show_thehive_settings?a("v-row",[a("v-col",{attrs:{cols:"10"}},[a("v-card",[a("v-card-title",[t._v(" TheHive alerting ")]),a("v-card-text",[a("v-text-field",{attrs:{label:"TheHive URL",placeholder:"Ex: https://thehive.example.com"},model:{value:t.org_settings.alerts_thehive_url,callback:function(e){t.$set(t.org_settings,"alerts_thehive_url",e)},expression:"org_settings.alerts_thehive_url"}}),a("v-text-field",{attrs:{label:"TheHive API Key (token)",type:"password"},model:{value:t.org_settings.alerts_thehive_apikey,callback:function(e){t.$set(t.org_settings,"alerts_thehive_apikey",e)},expression:"org_settings.alerts_thehive_apikey"}}),a("v-checkbox",{attrs:{label:"Enable notifications when detecting new vulnerabilities (monitored assets)",dense:"","hide-details":""},model:{value:t.org_settings.enable_thehive_new_vuln,callback:function(e){t.$set(t.org_settings,"enable_thehive_new_vuln",e)},expression:"org_settings.enable_thehive_new_vuln"}}),a("v-checkbox",{attrs:{label:"Enable notifications when detecting changes in vulnerabilities (monitored assets)",dense:"","hide-details":""},model:{value:t.org_settings.enable_thehive_update_vuln,callback:function(e){t.$set(t.org_settings,"enable_thehive_update_vuln",e)},expression:"org_settings.enable_thehive_update_vuln"}})],1),a("v-card-actions",[a("v-btn",{attrs:{color:"grey",loading:t.loading},nativeOn:{click:function(e){return t.updateOrgSettings(e)}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Save Changes ")],1)],1)],1)],1)],1):t._e(),this.org_settings.show_misp_settings?a("v-row",[a("v-col",{attrs:{cols:"10"}},[a("v-card",[a("v-card-title",[t._v(" MISP alerting ")]),a("v-card-text",[a("v-text-field",{attrs:{label:"MISP URL",placeholder:"Ex: https://misp.example.com"},model:{value:t.org_settings.alerts_misp_url,callback:function(e){t.$set(t.org_settings,"alerts_misp_url",e)},expression:"org_settings.alerts_misp_url"}}),a("v-text-field",{attrs:{label:"MISP API Key",type:"password"},model:{value:t.org_settings.alerts_misp_apikey,callback:function(e){t.$set(t.org_settings,"alerts_misp_apikey",e)},expression:"org_settings.alerts_misp_apikey"}}),a("v-checkbox",{attrs:{label:"Enable notifications when detecting new vulnerabilities (monitored assets)",dense:"","hide-details":""},model:{value:t.org_settings.enable_misp_new_vuln,callback:function(e){t.$set(t.org_settings,"enable_misp_new_vuln",e)},expression:"org_settings.enable_misp_new_vuln"}}),a("v-checkbox",{attrs:{label:"Enable notifications when detecting changes in vulnerabilities (monitored assets)",dense:"","hide-details":""},model:{value:t.org_settings.enable_misp_update_vuln,callback:function(e){t.$set(t.org_settings,"enable_misp_update_vuln",e)},expression:"org_settings.enable_misp_update_vuln"}})],1),a("v-card-actions",[a("v-btn",{attrs:{color:"grey",loading:t.loading},nativeOn:{click:function(e){return t.updateOrgSettings(e)}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Save Changes ")],1)],1)],1)],1)],1):t._e()],1):t._e(),"notsupported"==t.isAdmin()?a("v-tab-item",[a("v-row",[a("v-col",{attrs:{cols:"3"}},[a("v-card",{staticClass:"mx-auto"},[a("v-subheader",[t._v("Synchronize data from feed")]),a("v-card-text",[a("v-btn",{attrs:{color:"deep-orange",loading:t.loading,"x-small":""},nativeOn:{click:function(e){return t.syncFromRemote("")}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Sync All from remote ")],1),a("br"),a("v-btn",{attrs:{color:"light-orange",loading:t.loading,"x-small":""},nativeOn:{click:function(e){return t.syncFromRemote("kb_vendor")}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Sync Vendor ")],1),a("br"),a("v-btn",{attrs:{color:"light-orange",loading:t.loading,"x-small":""},nativeOn:{click:function(e){return t.syncFromRemote("kb_product")}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Sync Product ")],1),a("br"),a("v-btn",{attrs:{color:"light-orange",loading:t.loading,"x-small":""},nativeOn:{click:function(e){return t.syncFromRemote("kb_product_version")}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Sync ProductVersion ")],1),a("br"),a("v-btn",{attrs:{color:"light-orange",loading:t.loading,"x-small":""},nativeOn:{click:function(e){return t.syncFromRemote("kb_bulletin")}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Sync Bulletin ")],1),a("br"),a("v-btn",{attrs:{color:"light-orange",loading:t.loading,"x-small":""},nativeOn:{click:function(e){return t.syncFromRemote("kb_cwe")}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Sync CWE ")],1),a("br"),a("v-btn",{attrs:{color:"light-orange",loading:t.loading,"x-small":""},nativeOn:{click:function(e){return t.syncFromRemote("kb_cpe")}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Sync CPE ")],1),a("br"),a("v-btn",{attrs:{color:"light-orange",loading:t.loading,"x-small":""},nativeOn:{click:function(e){return t.syncFromRemote("kb_cve")}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Sync CVE ")],1),a("br"),a("v-btn",{attrs:{color:"light-orange",loading:t.loading,"x-small":""},nativeOn:{click:function(e){return t.syncFromRemote("vulns")}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Sync Vuln ")],1),a("br"),a("v-btn",{attrs:{color:"light-orange",loading:t.loading,"x-small":""},nativeOn:{click:function(e){return t.syncFromRemote("exploits")}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Sync Exploits ")],1),a("br"),a("v-btn",{attrs:{color:"light-orange",loading:t.loading,"x-small":""},nativeOn:{click:function(e){return t.syncFromRemote("threats")}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Sync Threats ")],1)],1)],1)],1),a("v-col",{attrs:{cols:"3"}},[a("v-card",{staticClass:"mx-auto"},[a("v-list",{attrs:{dense:""}},[a("v-subheader",[t._v("Synchronize data from local")]),a("v-list-item-group",{attrs:{color:"primary"},model:{value:t.async_item,callback:function(e){t.async_item=e},expression:"async_item"}},t._l(t.async_items,(function(e,i){return a("v-list-item",{key:i,on:{click:function(a){return t.callAction(e)}}},[a("v-list-item-icon",[a("v-icon",{attrs:{color:"deep-orange"},domProps:{textContent:t._s(e.icon)}})],1),a("v-list-item-content",[a("v-list-item-title",{attrs:{link:"",to:e.to},domProps:{textContent:t._s(e.text)}})],1)],1)})),1)],1)],1)],1),a("v-col",{attrs:{cols:"3"}},[a("v-card",{staticClass:"mx-auto"},[a("v-list",{attrs:{dense:""}},[a("v-subheader",[t._v("Synchronize CVEs from year")]),a("v-list-item-group",{attrs:{color:"primary"}},t._l(t.cves_years,(function(e,i){return a("v-list-item",{key:i,on:{click:function(a){return t.callAction({to:"/api/kb/cves/async/from/"+e})}}},[a("v-list-item-icon",[a("v-icon",{attrs:{color:"deep-orange"},domProps:{textContent:t._s("mdi-clock")}})],1),a("v-list-item-content",[a("v-list-item-title",{attrs:{link:""},domProps:{textContent:t._s(e)}})],1)],1)})),1)],1)],1)],1),a("v-col",{attrs:{cols:"3"}},[a("v-card",{staticClass:"mx-auto"},[a("v-list",{attrs:{dense:""}},[a("v-subheader",[t._v("Synchronize CVEs at year")]),a("v-list-item-group",{attrs:{color:"primary"}},t._l(t.cves_years,(function(e,i){return a("v-list-item",{key:i,on:{click:function(a){return t.callAction({to:"/api/kb/cves/async/"+e})}}},[a("v-list-item-icon",[a("v-icon",{attrs:{color:"deep-orange"},domProps:{textContent:t._s("mdi-clock")}})],1),a("v-list-item-content",[a("v-list-item-title",{attrs:{link:""},domProps:{textContent:t._s(e)}})],1)],1)})),1)],1)],1)],1)],1)],1):t._e(),t.isTeamOrgAdmin()?a("v-tab-item",[a("v-card",[a("v-card-title",[t._v(" Organizations ")]),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.orgs_headers,items:t.orgs.results,options:t.orgs_options,"server-items-length":t.orgs.count,"items-per-page":5,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"id"},on:{"update:options":function(e){t.orgs_options=e}},scopedSlots:t._u([{key:"item.is_active",fn:function(e){var i=e.item;return[1==i.is_active?a("v-icon",{staticClass:"mdi mdi-check-circle",attrs:{small:"",color:"green",title:"Enable Organization"},on:{click:function(e){"true"==t.isAdmin()&&t.disableOrg(i)}}}):t._e(),0==i.is_active?a("v-icon",{staticClass:"mdi mdi-checkbox-blank-circle",attrs:{small:"",color:"red",title:"Disable Organization"},on:{click:function(e){"true"==t.isAdmin()&&t.enableOrg(i)}}}):t._e()]}},{key:"item.action",fn:function(e){var i=e.item;return["true"==t.isAdmin()||"Private"!=i.name?a("v-icon",{staticClass:"mdi mdi-account-plus",attrs:{small:"",color:"green",title:"Add user in Organization"},on:{click:function(e){return t.openInvitationDialog(i.id,i.name)}}}):t._e(),t._v(" "),"true"==t.isAdmin()?a("v-icon",{staticClass:"mdi mdi-close-circle",attrs:{small:"",title:"Remove Organization",color:"red"},on:{click:function(e){return t.removeOrg(i)}}}):t._e()]}}],null,!1,1301545186)}),"true"==t.isAdmin()?a("v-dialog",{attrs:{"max-width":"500px"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[a("v-btn",t._g({attrs:{absolute:"",dark:"",fab:"",top:"",right:"",color:"deep-orange",small:""}},i),[a("v-icon",{attrs:{small:""}},[t._v("mdi-plus")])],1)]}}],null,!1,1321426347),model:{value:t.dialog_new_organization,callback:function(e){t.dialog_new_organization=e},expression:"dialog_new_organization"}},[a("v-card",[a("v-card-title",[t._v(" Create new organization ")]),a("v-card-text",[a("v-container",[a("v-form",{ref:"form-new-organization"},[a("v-text-field",{attrs:{label:"Name"},model:{value:t.org_form.name,callback:function(e){t.$set(t.org_form,"name",e)},expression:"org_form.name"}}),a("v-checkbox",{attrs:{label:"is active ?"},model:{value:t.org_form.is_active,callback:function(e){t.$set(t.org_form,"is_active",e)},expression:"org_form.is_active"}}),a("v-divider"),a("v-text-field",{attrs:{label:"Email owner",rules:t.emailRules,required:""},model:{value:t.org_form.email,callback:function(e){t.$set(t.org_form,"email",e)},expression:"org_form.email"}}),a("v-btn",{attrs:{color:"success"},on:{click:t.createOrg}},[t._v("Save")]),a("v-btn",{attrs:{color:"warning",type:"reset"}},[t._v("Reset")])],1)],1)],1),a("v-card-actions",[a("v-spacer")],1)],1)],1):t._e(),a("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.dialog_invitation,callback:function(e){t.dialog_invitation=e},expression:"dialog_invitation"}},[a("v-card",[a("v-card-title",[t._v(" Invite people to organization '"+t._s(t.invitation.org_name)+"' ")]),a("v-card-text",[a("v-container",[a("v-form",{ref:"form-user-invitation"},[a("v-textarea",{attrs:{label:"Emails",hint:"Users emails separated with comma or 1 per line. 50 emails max",required:""},model:{value:t.invitation.emails,callback:function(e){t.$set(t.invitation,"emails",e)},expression:"invitation.emails"}}),a("v-btn",{attrs:{color:"success",small:""},on:{click:t.addUserToOrg}},[t._v("Invite")]),a("v-btn",{attrs:{color:"warning",type:"reset",small:""}},[t._v("Reset")])],1)],1)],1),a("v-card-actions",[a("v-spacer")],1)],1)],1)],1),a("br"),a("v-card",[a("v-card-title",[t._v(" Organization Users ")]),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.users_headers,items:t.users.results,options:t.users_options,"server-items-length":t.users.count,"items-per-page":20,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"id"},on:{"update:options":function(e){t.users_options=e}},scopedSlots:t._u([{key:"item.is_admin",fn:function(e){var i=e.item;return[1==i.is_admin?a("v-icon",{staticClass:"mdi mdi-shield-check",attrs:{small:"",title:"Promote user as Org admin",color:"deep-orange"},on:{click:function(e){"true"==t.isAdmin()&&t.disableOrgAdmin(i.org_id,i.user,i)}}}):t._e(),0==i.is_admin?a("v-icon",{staticClass:"mdi mdi-shield-check",attrs:{small:"",title:"Demote user from Org admin",color:"grey"},on:{click:function(e){"true"==t.isAdmin()&&t.enableOrgAdmin(i.org_id,i.user,i)}}}):t._e()]}},{key:"item.is_active",fn:function(e){var i=e.item;return[1==i.is_active?a("v-icon",{staticClass:"mdi mdi-check-circle",attrs:{small:"",color:"green"}}):t._e(),0==i.is_active?a("v-icon",{staticClass:"mdi mdi-checkbox-blank-circle",attrs:{small:"",color:"grey"}}):t._e()]}},{key:"item.action",fn:function(e){var i=e.item;return[a("v-icon",{staticClass:"mdi mdi-account-box",attrs:{small:"",title:"View or Update user"},on:{click:function(e){return t.viewUser(i.user)}}}),i.username!=t.user_profile.username?a("v-icon",{staticClass:"mdi mdi-account-remove",attrs:{small:"",title:"Remove user",color:"red"},on:{click:function(e){return t.delUserFromOrg(i.org_id,i.user,i)}}}):t._e()]}}],null,!1,4010060456)})],1),a("v-dialog",{attrs:{"max-width":"600px"},model:{value:t.dialog_edituser,callback:function(e){t.dialog_edituser=e},expression:"dialog_edituser"}},[a("user-edit",{attrs:{user_id:t.dialog_edituser_user_id}})],1)],1):t._e()],1),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)},ne=[],oe={methods:{isAdmin:function(){return localStorage.getItem("is_admin")},isOrgAdmin:function(){return localStorage.getItem("is_org_admin")},getUserProfile:function(){return localStorage.getItem("profile")}},mounted:function(){},destroyed:function(){}},re=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("User information")])]),a("v-card-text",[a("v-form",{ref:"form-user"},[a("v-container",[a("v-row",[a("v-col",{attrs:{md:"10"}},[a("v-text-field",{attrs:{label:"Username",disabled:""},model:{value:t.user_profile.username,callback:function(e){t.$set(t.user_profile,"username",e)},expression:"user_profile.username"}}),a("v-text-field",{attrs:{label:"Firstname",disabled:""},model:{value:t.user_profile.first_name,callback:function(e){t.$set(t.user_profile,"first_name",e)},expression:"user_profile.first_name"}}),a("v-text-field",{attrs:{label:"Lastname",disabled:""},model:{value:t.user_profile.last_name,callback:function(e){t.$set(t.user_profile,"last_name",e)},expression:"user_profile.last_name"}}),a("v-text-field",{attrs:{label:"email",disabled:""},model:{value:t.user_profile.email,callback:function(e){t.$set(t.user_profile,"email",e)},expression:"user_profile.email"}}),a("v-text-field",{attrs:{label:"last_login",disabled:""},model:{value:t.moment(t.user_profile.last_login).format("YYYY-MM-DD, hh:mm:ss"),callback:function(e){t.$set(t.moment(t.user_profile.last_login),"format('YYYY-MM-DD, hh:mm:ss')",e)},expression:"moment(user_profile.last_login).format('YYYY-MM-DD, hh:mm:ss')"}})],1)],1),a("v-btn",{attrs:{color:"deep-orange"},on:{click:t.renewUserPassword}},[t._v("Renew password")]),t._v(" "+t._s(t.new_password)+" ")],1)],1)],1),a("v-card-actions",[a("v-spacer")],1),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor,dense:""},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)},le=[],ce={name:"UserEdit",props:["user_id"],data:function(){return{snack:!1,snackColor:"",snackText:"",user_profile:{},user_profile_default:{username:"",email:"",last_login:"",first_name:"",last_name:"",orgs:[]},new_password:""}},mounted:function(){this.loadUserProfile()},watch:{user_id:function(t,e){this.loadUserProfile()}},computed:{},methods:{loadUserProfile:function(){var t=this;this.$api.get("/api/users/"+this.user_id).then((function(e){e&&200===e.status&&(t.user_profile=e.data)})).catch((function(e){t.snack=!0,t.snackColor="error",t.snackText="Unable to retreive user's info"}))},renewUserPassword:function(){var t=this;this.$api.get("/api/users/profile/"+this.user_id+"/renewpassword").then((function(e){e&&200===e.status&&"success"==e.data.status&&(t.new_password='New password: "'+e.data.password+'"')})).catch((function(e){t.snack=!0,t.snackColor="error",t.snackText="Unable to retreive user's info"}))}}},de=ce,ue=(a("c2fc"),Object(l["a"])(de,re,le,!1,null,null,null)),ve=ue.exports;d()(ue,{VBtn:V["a"],VCard:I["a"],VCardActions:T["b"],VCardText:T["d"],VCardTitle:T["e"],VCol:Zt["a"],VContainer:S["a"],VForm:$["a"],VRow:te["a"],VSnackbar:Vt["a"],VSpacer:D["a"],VTextField:O["a"]});var me={name:"Settings",mixins:[oe],components:{UserEdit:ve},data:function(){return{loading:!1,showEditProfileCard:!1,showEditPasswordCard:!1,showEditTokenCard:!1,user_profile:{username:"",email:"",first_name:"",last_name:"",last_login:"",profile:{manage_organization:!1,manage_alert_email:!1}},user_profile_chpwd:{},show_authtoken:!1,showPassword:!1,showPassword_old:!1,showPassword_new1:!1,showPassword_new2:!1,rules:{password:[function(t){return!!t||"Password is required"},function(t){return t&&t.length>8||"The password must be longer than 8 characters"},function(t){return/(?=.*[A-Z])/.test(t)||"Must have one uppercase character"},function(t){return/(?=.*\d)/.test(t)||"Must have one number"},function(t){return/([!@$%])/.test(t)||"Must have one special character [!@#$%]"}],email:[function(t){return!!t||"E-mail is required"},function(t){return/.+@.+\..+/.test(t)||"E-mail must be valid"}]},org_settings_default:{alerts_emails:[],alerts_emails_max:3,enable_email_alert_new_vuln:!1,enable_email_alert_update_vuln:!1,enable_daily_email_report:!1,enable_weekly_email_report:!1,enable_monthly_email_report:!1,show_slack_settings:!0,alerts_slack_url:"",enable_slack_new_vuln:!1,enable_slack_update_vuln:!1,show_thehive_settings:!1,alerts_thehive_url:"",alerts_thehive_apikey:"",enable_thehive_new_vuln:!1,enable_thehive_update_vuln:!1,show_misp_settings:!1,alerts_misp_url:"",alerts_misp_apikey:"",enable_misp_new_vuln:!1,enable_misp_update_vuln:!1},org_settings:{alerts_emails:[],alerts_emails_max:3,enable_email_alert_new_vuln:!1,enable_email_alert_update_vuln:!1,enable_daily_email_report:!1,enable_weekly_email_report:!1,enable_monthly_email_report:!1,show_slack_settings:!0,alerts_slack_url:"",enable_slack_new_vuln:!1,enable_slack_update_vuln:!1,show_thehive_settings:!1,alerts_thehive_url:"",alerts_thehive_apikey:"",enable_thehive_new_vuln:!1,enable_thehive_update_vuln:!1,show_misp_settings:!1,alerts_misp_url:"",alerts_misp_apikey:"",enable_misp_new_vuln:!1,enable_misp_update_vuln:!1},async_item:1,async_items:[{text:"CWE",icon:"mdi-clock",to:"/api/kb/cwes/async"},{text:"CPE",icon:"mdi-clock",to:"/api/kb/cpes/async"},{text:"Bulletins",icon:"mdi-clock",to:"/api/kb/bulletins/async"},{text:"CVE",icon:"mdi-clock",to:"/api/kb/cves/async"},{text:"VIA",icon:"mdi-clock",to:"/api/kb/vias/async"},{text:"Vuln / Scores",icon:"mdi-clock",to:"/api/vulns/refresh_scores"},{text:"Vuln / Product versions",icon:"mdi-clock",to:"/api/vulns/refresh_vulnerable_versions"}],cves_years:["1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017","2018","2019","2020"],orgs:[],orgs_options:{},org_selected:"",orgs_headers:[{text:"Name",value:"name"},{text:"Slug",value:"slug"},{text:"Owner",value:"owner"},{text:"Users",value:"nb_users"},{text:"Active",value:"is_active",align:"center"},{text:"Actions",value:"action",align:"center",sortable:!1}],dialog_new_organization:!1,org_form:{name:"",is_active:!0},users:[],users_options:{},users_headers:[{text:"Organization name",value:"org_name"},{text:"Username",value:"username"},{text:"Email",value:"email"},{text:"Admin ?",value:"is_admin",align:"center"},{text:"Active ?",value:"is_active",align:"center"},{text:"Actions",value:"action",align:"center",sortable:!1}],invitation:{org_name:"",org_id:0,email:"",emails:"",is_admin:!1},emailRules:[function(t){return!!t||"E-mail is required"},function(t){return/.+@.+\..+/.test(t)||"E-mail must be valid"}],rowsPerPageItems:[5,10,20,50,100],dialog_invitation:!1,dialog_edituser:!1,dialog_edituser_user_id:0,snack:!1,snackColor:"",snackText:""}},mounted:function(){this.getUserProfile(),this.getOrgSettings()},watch:{orgs_options:{handler:function(){this.getDataFromApiOrgs().then((function(t){}))},deep:!0},users_options:{handler:function(){this.getDataFromApiUsers().then((function(t){}))},deep:!0}},methods:{getDataFromApiOrgs:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var i=t.orgs_options,s=i.sortBy,n=i.sortDesc,o=i.page,r=i.itemsPerPage;t.limit=r;var l=t.getOrgs(o,t.limit,s,n);setTimeout((function(){e({orgs:l})}),300),t.loading=!1}))},getDataFromApiUsers:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var i=t.users_options,s=i.sortBy,n=i.sortDesc,o=i.page,r=i.itemsPerPage;t.limit=r;var l=t.getUsers(o,t.limit,s,n);setTimeout((function(){e({users:l})}),300),t.loading=!1}))},getDataFromApiUserProfile:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var i=t.getUserProfile();setTimeout((function(){e({user_profile_api:i})}),300),t.loading=!1}))},callAction:function(t){var e=this;this.$api.get(t.to).then((function(t){t&&200===t.status?(e.snack=!0,e.snackColor="success",e.snackText="Sync successfuly enqueued."):(e.snack=!0,e.snackColor="error",e.snackText="Unable to sync :/")})).catch((function(t){swal.fire({title:"Error",text:"Unable to call action",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))},getOrgs:function(t,e,a,i){var s=this,n="";a.length>0&&(n=!0===i[0]?"&sorted_by=-"+a:"&sorted_by="+a),this.$api.get("/api/orgs/?limit="+e+"&page="+t+n).then((function(t){t&&200===t.status&&(s.orgs=t.data)})).catch((function(t){s.orgs=[],swal.fire({title:"Error",text:"Unable to get org users",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))},getUsers:function(t,e,a,i){var s=this,n="";a.length>0&&(n=!0===i[0]?"sorted_by=-"+a:"sorted_by="+a),this.$api.get("/api/org-users/?limit="+e+"&page="+t+"&"+n).then((function(t){t&&200===t.status&&(s.users=t.data)})).catch((function(t){s.users=[],swal.fire({title:"Error",text:"Unable to get org users",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))},getUserProfile:function(){var t=this;this.$api.get("/users/profile").then((function(e){e&&200===e.status&&(t.user_profile=e.data)})).catch((function(e){t.user_profile={},swal.fire({title:"Error",text:"Unable to get user profile",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))},isAlertAdmin:function(){return this.user_profile.profile.manage_alert_email},isTeamOrgAdmin:function(){return"true"==this.isAdmin()||this.user_profile.profile.manage_organization},updateUserProfile:function(){var t=this,e=new FormData;e.set("first_name",this.user_profile.first_name),e.set("last_name",this.user_profile.last_name),this.$api.post("/users/profile/update",e).then((function(e){e&&200===e.status?(t.snack=!0,t.snackColor="success",t.snackText="User profile updated !"):(t.snack=!0,t.snackColor="error",t.snackText="Unable to update user profile :/")})).catch((function(e){t.snack=!0,t.snackColor="error",t.snackText="Unable to update user profile :/"}))},updateUserToken:function(){var t=this;new FormData;this.$api.get("/users/token/renew").then((function(e){e&&200===e.status?(t.user_profile.auth_token=e.data.token,t.snack=!0,t.snackColor="success",t.snackText="User's API Token updated !"):(t.snack=!0,t.snackColor="error",t.snackText="Unable to update user's API Token :/")})).catch((function(e){t.snack=!0,t.snackColor="error",t.snackText="Unable to update user profile :/"}))},deleteUserToken:function(){var t=this;new FormData;this.$api.get("/users/token/delete").then((function(e){e&&200===e.status?(t.user_profile.auth_token="",t.snack=!0,t.snackColor="success",t.snackText="User's API Token updated !"):(t.snack=!0,t.snackColor="error",t.snackText="Unable to update user's API Token :/")})).catch((function(e){t.snack=!0,t.snackColor="error",t.snackText="Unable to update user profile :/"}))},updateUserPassword:function(){var t=this,e=new FormData;e.set("old_password",this.user_profile_chpwd.oldpassword),e.set("new_password1",this.user_profile_chpwd.new_password1),e.set("new_password2",this.user_profile_chpwd.new_password2),this.$api.post("/users/profile/chpwd",e).then((function(e){e&&200===e.status?(t.snack=!0,t.snackColor="success",t.snackText="User profile updated !"):(t.snack=!0,t.snackColor="error",t.snackText="Unable to update user profile :/")})).catch((function(e){t.snack=!0,t.snackColor="error",t.snackText="Unable to update user profile :/"}))},getOrgSettings:function(){var t=this,e=localStorage.getItem("org_id");this.$api.get("/users/org/"+e+"/settings").then((function(e){if(e&&200===e.status){for(var a in e.data)t.org_settings[a]=e.data[a];t.org_settings.alerts_slack_url=e.data["alerts_slack"]["url"],t.org_settings.enable_slack_new_vuln=e.data["alerts_slack"]["new_vuln"],t.org_settings.enable_slack_update_vuln=e.data["alerts_slack"]["update_vuln"]}})).catch((function(e){Object.assign(t.org_settings,t.org_settings_default),swal.fire({title:"Error",text:"Unable to get org settings profile",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))},updateOrgSettings:function(){var t=this,e=new FormData;e.set("org_id",localStorage.getItem("org_id")),e.set("alerts_emails",this.org_settings.alerts_emails),e.set("enable_email_alert_new_vuln",this.org_settings.enable_email_alert_new_vuln),e.set("enable_email_alert_update_vuln",this.org_settings.enable_email_alert_update_vuln),e.set("enable_daily_email_report",this.org_settings.enable_daily_email_report),e.set("enable_weekly_email_report",this.org_settings.enable_weekly_email_report),e.set("enable_monthly_email_report",this.org_settings.enable_monthly_email_report),e.set("alerts_slack_url",this.org_settings.alerts_slack_url),e.set("enable_slack_new_vuln",this.org_settings.enable_slack_new_vuln),e.set("enable_slack_update_vuln",this.org_settings.enable_slack_update_vuln),e.set("alerts_thehive_url",this.org_settings.alerts_thehive_url),e.set("alerts_thehive_apikey",this.org_settings.alerts_thehive_apikey),e.set("enable_thehive_new_vuln",this.org_settings.enable_thehive_new_vuln),e.set("enable_thehive_update_vuln",this.org_settings.enable_thehive_update_vuln),e.set("alerts_misp_url",this.org_settings.alerts_misp_url),e.set("alerts_misp_apikey",this.org_settings.alerts_misp_apikey),e.set("enable_misp_new_vuln",this.org_settings.enable_misp_new_vuln),e.set("enable_misp_update_vuln",this.org_settings.enable_misp_update_vuln),this.$api.post("/users/org/update",e).then((function(e){e&&200===e.status?(t.org_settings.alerts_emails=e.data.alerts_emails,t.org_settings.enable_email_alert_new_vuln=e.data.enable_email_alert_new_vuln,t.org_settings.enable_email_alert_update_vuln=e.data.enable_email_alert_update_vuln,t.org_settings.enable_daily_email_report=e.data.enable_daily_email_report,t.org_settings.enable_weekly_email_report=e.data.enable_weekly_email_report,t.org_settings.enable_monthly_email_report=e.data.enable_monthly_email_report,t.org_settings.alerts_slack_url=e.data.alerts_slack_url,t.snack=!0,t.snackColor="success",t.snackText="Organization settings updated !"):(t.snack=!0,t.snackColor="error",t.snackText="Unable to update organization settings :/")})).catch((function(e){t.snack=!0,t.snackColor="error",t.snackText="Unable to update organization settings :/"}))},openInvitationDialog:function(t,e){this.invitation.org_id=t,this.invitation.org_name=e,this.dialog_invitation=!0},addUserToOrg:function(t){var e=this;this.dialog_invitation=!1,this.snack=!0,this.snackColor="grey",this.snackText="Processing user invitation into organization";var a=new FormData;a.set("emails",this.invitation.emails),this.$api.post("/users/"+this.invitation.org_id+"/adduser",a).then((function(t){t&&200===t.status&&"success"==t.data.status?(e.snack=!0,e.snackColor="success",e.snackText="Invitation(s) successfuly sent to valid email addresses.",e.$router.go()):t&&200===t.status&&"error"==t.data.status?(e.snack=!0,e.snackColor="error",e.snackText="An error occured during the invitation: "+t.data.reason):(e.snack=!0,e.snackColor="error",e.snackText="An error occured during the invitation.")})).catch((function(t){swal.fire({title:"Error",text:"Unable to add users",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))},delUserFromOrg:function(t,e,a){var i=this;return Object(vt["a"])(regeneratorRuntime.mark((function s(){var n;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,i.$confirm("Do you really want to delete user ?",{title:"Warning"});case 2:n=s.sent,n&&i.$api.get("/users/"+t+"/delete/"+e).then((function(t){if(t&&200===t.status){var e=i.users.results.indexOf(a);i.users.results.splice(e,1)}}));case 4:case"end":return s.stop()}}),s)})))()},disableOrg:function(t){var e=this;this.$api.get("/users/"+t.id+"/disable").then((function(a){a&&200===a.status?(t.is_active=!1,e.snack=!0,e.snackColor="success",e.snackText="Organization successfuly disabled."):(e.snack=!0,e.snackColor="error",e.snackText="Unable to disable the Organization.")}))},enableOrg:function(t){var e=this;this.$api.get("/users/"+t.id+"/enable").then((function(a){a&&200===a.status?(t.is_active=!0,e.snack=!0,e.snackColor="success",e.snackText="Organization successfuly enabled."):(e.snack=!0,e.snackColor="error",e.snackText="Unable to enable the Organization.")}))},enableOrgAdmin:function(t,e,a){var i=this;this.$api.get("/users/"+t+"/"+e+"/admin/enable").then((function(t){t&&200===t.status?(a.is_admin=!0,i.snack=!0,i.snackColor="success",i.snackText="Organization admin successfuly enabled."):(i.snack=!0,i.snackColor="error",i.snackText="Unable to enable the Organization admin.")}))},disableOrgAdmin:function(t,e,a){var i=this;this.$api.get("/users/"+t+"/"+e+"/admin/disable").then((function(t){t&&200===t.status?(a.is_admin=!1,i.snack=!0,i.snackColor="success",i.snackText="Organization admin successfuly disabled."):(i.snack=!0,i.snackColor="error",i.snackText="Unable to disable the Organization admin.")}))},createOrg:function(t){var e=this;this.dialog_new_organization=!1;var a=new FormData;a.set("name",this.org_form.name),a.set("is_active",this.org_form.is_active),a.set("email",this.org_form.email),this.$api.post("/users/addorg",a).then((function(t){t&&200===t.status?(e.snack=!0,e.snackColor="success",e.snackText="Organization successfuly created.",e.$router.go()):(e.snack=!0,e.snackColor="error",e.snackText="Unable to create the Organization.")}))},syncFromRemote:function(t){var e=this,a="/api/data/sync/run";""!=t&&(a=a+"?model="+t),this.$api.get(a).then((function(t){t&&200===t.status?(e.snack=!0,e.snackColor="success",e.snackText="Sync successfuly enqueued.",e.$router.go()):(e.snack=!0,e.snackColor="error",e.snackText="Unable to start data sync from remote.")}))},removeOrg:function(t){var e=this;return Object(vt["a"])(regeneratorRuntime.mark((function a(){var i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,e.$confirm("Do you really want to delete organization ?",{title:"Warning"});case 2:i=a.sent,i&&e.$api.get("/users/"+t.id+"/remove").then((function(a){if(a&&200===a.status){var i=e.orgs.results.indexOf(t);e.orgs.results.splice(i,1),e.snack=!0,e.snackColor="success",e.snackText="Organization successfuly removed."}else e.snack=!0,e.snackColor="error",e.snackText="Unable to remove the Organization."}));case 4:case"end":return a.stop()}}),a)})))()},removeContactEmail:function(t){this.org_settings.alerts_emails.splice(this.org_settings.alerts_emails.indexOf(t),1),this.org_settings.alerts_emails=Object(gt["a"])(this.org_settings.alerts_emails)},viewUser:function(t){this.dialog_edituser=!0,this.dialog_edituser_user_id=t},showManageAlertsEmail:function(){return JSON.parse(this.getUserProfile()).manage_alert_email},showManageAlertsSlack:function(){return JSON.parse(this.getUserProfile()).manage_alert_slack}}},pe=me,_e=a("1baa"),he=a("34c3"),ge=a("e0c7"),fe=a("71a3"),be=a("c671"),ke=a("fe57"),xe=a("a844"),ye=Object(l["a"])(pe,se,ne,!1,null,null,null),we=ye.exports;d()(ye,{VBtn:V["a"],VCard:I["a"],VCardActions:T["b"],VCardText:T["d"],VCardTitle:T["e"],VCheckbox:P["a"],VChip:wt["a"],VCol:Zt["a"],VCombobox:Ct["a"],VContainer:S["a"],VDataTable:Dt["a"],VDialog:Ot["a"],VDivider:G["a"],VForm:$["a"],VIcon:Q["a"],VList:tt["a"],VListItem:at["a"],VListItemContent:st["g"],VListItemGroup:_e["a"],VListItemIcon:he["a"],VListItemSubtitle:st["j"],VListItemTitle:st["k"],VRow:te["a"],VSnackbar:Vt["a"],VSpacer:D["a"],VSubheader:ge["a"],VTab:fe["a"],VTabItem:be["a"],VTabs:ke["a"],VTextField:O["a"],VTextarea:xe["a"]});var Ce=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{staticClass:"pa-2",attrs:{cols:"10"}},[a("v-text-field",{staticClass:"pt-0",attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.appsearch,callback:function(e){t.appsearch=e},expression:"appsearch"}})],1),a("v-col",{staticClass:"pa-2",attrs:{md:"2"}},[a("v-slider",{attrs:{label:"Min Score",min:"0",max:"100",color:"deep-orange","track-color":"grey","thumb-label":"","hide-details":""},model:{value:t.search_slider_min,callback:function(e){t.search_slider_min=e},expression:"search_slider_min"}}),a("v-slider",{attrs:{label:"Max Score",min:"0",max:"100",color:"grey","thumb-color":"deep-orange","track-color":"deep-orange","thumb-label":"","hide-details":""},model:{value:t.search_slider_max,callback:function(e){t.search_slider_max=e},expression:"search_slider_max"}})],1)],1),t.showAdvancedFilters?a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-divider"),a("advanced-search",{attrs:{scope:"vulns"},on:{advanced_search_filters:t.updateAdvancedSearchFilters}})],1)],1):t._e(),t.showAdvancedFilters?a("v-btn",{attrs:{depressed:"",tile:"",block:"",label:"coic"},on:{click:function(e){t.showAdvancedFilters=!t.showAdvancedFilters}}},[a("v-icon",[t._v("mdi-chevron-up")]),t._v("Hide advanced filters"),a("v-icon",[t._v("mdi-chevron-up")])],1):a("v-btn",{attrs:{depressed:"",tile:"",block:"",label:"coic"},on:{click:function(e){t.showAdvancedFilters=!0}}},[a("v-icon",[t._v("mdi-chevron-down")]),t._v("Show advanced filters"),a("v-icon",[t._v("mdi-chevron-down")])],1),a("v-tabs",{staticClass:"mt-1",attrs:{left:"","background-color":"white",color:"deep-orange accent-4"}},[a("v-tab",[this.vulns.count>0?a("v-badge",{attrs:{color:"deep-orange",content:this.vulns.count}},[t._v("Vulnerabilities")]):t._e(),null==this.vulns.count||0==this.vulns.count?a("v-badge",{attrs:{color:"grey",content:"0"}},[t._v("Vulnerabilities")]):t._e()],1),a("v-tab",[this.exploits.count>0?a("v-badge",{attrs:{color:"deep-orange",content:this.exploits.count}},[t._v("Exploits")]):t._e(),null==this.exploits.count||0==this.exploits.count?a("v-badge",{attrs:{color:"grey",content:"0"}},[t._v("Exploits")]):t._e()],1),a("v-tab",[this.threats.count>0?a("v-badge",{attrs:{color:"deep-orange",content:this.threats.count}},[t._v("Threat activities")]):t._e(),null==this.threats.count||0==this.threats.count?a("v-badge",{attrs:{color:"grey",content:"0"}},[t._v("Threat activities")]):t._e()],1),a("v-tab",[this.advisories.count>0?a("v-badge",{attrs:{color:"deep-orange",content:this.advisories.count}},[t._v("Advisories")]):t._e(),null==this.advisories.count||0==this.advisories.count?a("v-badge",{attrs:{color:"grey",content:"0"}},[t._v("Advisories")]):t._e()],1),a("v-tab",[this.tools.count>0?a("v-badge",{attrs:{color:"deep-orange",content:this.tools.count}},[t._v("Tools")]):t._e(),null==this.tools.count||0==this.tools.count?a("v-badge",{attrs:{color:"grey",content:"0"}},[t._v("Tools")]):t._e()],1),a("v-tab-item",[a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers_vulns,items:t.vulns.results,options:t.options_vulns,"server-items-length":t.vulns.count,"items-per-page":t.limit_vulns,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading_vulns,"item-key":"id","multi-sort":""},on:{"update:options":function(e){t.options_vulns=e}},scopedSlots:t._u([{key:"item.score",fn:function(e){var i=e.item;return[a("v-chip",{staticClass:"text-center font-weight-bold",attrs:{color:t.getRatingColor(i.score),label:""}},[t._v(t._s(i.score)+"/100")]),a("br"),a("span",{staticClass:"text-caption"},[t._v("CVSSv2: "+t._s(i.cvss))])]}},{key:"item.summary",fn:function(e){var i=e.item;return[a("div",{staticClass:"py-2"},[a("div",{staticClass:"pb-2"},[a("span",{staticClass:"deep-orange--text font-weight-medium"},[t._v(t._s(i.cveid))]),t._v(" / PH-"+t._s(i.id)+" "),a("v-btn",{attrs:{color:"deep-orange",icon:"",small:""}},[a("v-icon",{attrs:{title:"View details"},on:{click:function(e){return t.viewVuln(i.id)}}},[t._v("mdi-arrow-right-bold-circle-outline")])],1),a("v-icon",{attrs:{color:"deep-orange",title:"Download as JSON file"},on:{click:function(e){return t.downloadVuln(i.id,"json")}}},[t._v("mdi-download")]),a("v-icon",{attrs:{color:"deep-orange",title:"Send vulnerabilty as email"},on:{click:function(e){t.selected_vuln_id=i.id,t.dialog_sendmail=!0}}},[t._v("mdi-email-send-outline")])],1),a("div",[t._v(" "+t._s(i.summary)+" ")]),t._l(i.products,(function(e){return a("v-chip",{key:e.id,staticClass:"vendor-chip",attrs:{label:"",small:"",link:""},on:{click:function(a){return t.$router.push({path:"/product/"+e.id})}}},[t._v(" "+t._s(e.vendor)+": "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(e.name))])])}))],2)]}},{key:"item.metadata",fn:function(e){var i=e.item;return[a("v-chip",{staticClass:"font-weight-bold",attrs:{label:"",link:"",small:"",color:i.exploit_count>0?"deep-orange":"grey",title:"Is exploitable?"}},[t._v(t._s(i.exploit_count))]),a("v-btn",{attrs:{color:"NETWORK"==i.access.vector?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Is exploitable remotely?"}},[t._v("mdi-cloud")])],1),a("v-btn",{attrs:{color:"NONE"==i.access.authentication?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Require authentication?"}},[t._v("mdi-shield-account")])],1),a("v-btn",{attrs:{color:i.is_in_the_news||i.is_in_the_wild?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Is in the news or exploited in the wild?"}},[t._v("mdi-star")])],1)]}},{key:"item.monitored",fn:function(e){var i=e.item;return[i.monitored?a("v-chip",{staticClass:"text-center font-weight-bold",attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:function(e){return t.toggleMonitoredVuln(i)}}},[t._v("Yes")]):t._e(),i.monitored?t._e():a("v-chip",{staticClass:"text-center font-weight-bold",attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:function(e){return t.toggleMonitoredVuln(i)}}},[t._v("No")])]}},{key:"item.updated_at",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.updated_at).format("YYYY-MM-DD, hh:mm")))])]}}])})],1),a("v-tab-item",[a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers_exploits,items:t.exploits.results,options:t.options_exploits,"server-items-length":t.exploits.count,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading_exploits,"item-key":"id"},on:{"update:options":function(e){t.options_exploits=e}},scopedSlots:t._u([{key:"item.relevancy_level",fn:function(e){var i=e.item;return[t._l(1,(function(e){return 1==i.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"yellow"}}):t._e()})),t._l(4,(function(e){return 1==i.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six-outline",attrs:{"x-small":"",color:"grey"}}):t._e()})),t._l(2,(function(e){return 2==i.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"orange"}}):t._e()})),t._l(3,(function(e){return 2==i.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six-outline",attrs:{"x-small":"",color:"grey"}}):t._e()})),t._l(3,(function(e){return 3==i.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"orange darken-4"}}):t._e()})),t._l(2,(function(e){return 3==i.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six-outline",attrs:{"x-small":"",color:"grey"}}):t._e()})),t._l(4,(function(e){return 4==i.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"red"}}):t._e()})),t._l(1,(function(e){return 4==i.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six-outline",attrs:{"x-small":"",color:"grey"}}):t._e()})),t._l(5,(function(e){return 5==i.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"red darken-4"}}):t._e()}))]}},{key:"item.vp",fn:function(e){var i=e.item;return t._l(i.products,(function(e){return a("v-chip",{key:e.id,staticClass:"vendor-chip",attrs:{label:"",small:"",link:""},on:{click:function(a){return t.$router.push({path:"/product/"+e.id})}}},[t._v(" "+t._s(e.vendor)+": "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(e.name))])])}))}},{key:"item.updated_at",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.updated_at).format("YYYY-MM-DD")))])]}},{key:"item.action",fn:function(e){var i=e.item;return[a("v-icon",{staticClass:"mdi mdi-eye",attrs:{small:"",color:"blue"},on:{click:function(e){return t.viewVuln(i.vuln_id)}}})]}}])})],1),a("v-tab-item"),a("v-tab-item"),a("v-tab-item")],1),a("DialogSendVulnByEmail",{attrs:{vuln_id:t.selected_vuln_id,visible:t.dialog_sendmail},on:{close:function(e){t.dialog_sendmail=!1}}})],1)},Ve=[],Ie=(a("3ca3"),a("ddb0"),a("2b3d"),{methods:{forceFileDownload:function(t,e){var a=window.URL.createObjectURL(new Blob([t.data],{type:"application/*"})),i=document.createElement("a");i.href=a,i.setAttribute("download",e),document.body.appendChild(i),i.click()}},mounted:function(){},destroyed:function(){}}),Te=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{attrs:{"max-width":"600px"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Send vulnerability by emaile")])]),a("v-card-text",[a("v-form",{ref:"form-vuln-sendmail"},[a("v-row",[a("v-textarea",{attrs:{rows:"3",label:"Emails",hint:"Email addresses separated with comma or 1 per line. 10 emails max","prepend-icon":"mdi-email"},model:{value:t.notification_data.emails,callback:function(e){t.$set(t.notification_data,"emails",e)},expression:"notification_data.emails"}})],1),a("v-btn",{attrs:{color:"success"},on:{click:t.sendEmailVuln}},[t._v("Send")]),a("v-btn",{attrs:{color:"warning",type:"reset"}},[t._v("Reset")])],1)],1)],1),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor,dense:""},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)},Pe=[],Se={name:"DialogSendVulnByEmail",props:["vuln_id","visible"],data:function(){return{notification_data:{emails:""},snack:!1,snackColor:"",snackText:""}},mounted:function(){},computed:{show:{get:function(){return this.visible},set:function(t){t||this.$emit("close")}}},watch:{},methods:{sendEmailVuln:function(){var t=this;this.$api.post("/api/vulns/"+this.vuln_id+"/export/email",this.notification_data).then((function(e){t.snack=!0,t.snackColor="success",t.snackText="Vulnerability details successfuly sent by mail."})).catch((function(e){t.snack=!0,t.snackColor="error",t.snackText="Unable to send vulnerability details."})),this.show=!1}}},Ee=Se,$e=Object(l["a"])(Ee,Te,Pe,!1,null,null,null),Ae=$e.exports;d()($e,{VBtn:V["a"],VCard:I["a"],VCardText:T["d"],VCardTitle:T["e"],VDialog:Ot["a"],VForm:$["a"],VRow:te["a"],VSnackbar:Vt["a"],VTextarea:xe["a"]});var Me=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-row",{staticClass:"py-0"},[a("v-col",{staticClass:"py-0",attrs:{cols:"12"}},[a("span",{staticClass:"subtitle-1"},[t._v("Add a new filter:")])])],1),a("v-row",[a("v-col",{attrs:{cols:"4"}},[a("v-select",{attrs:{hint:"Filter",items:t.filters_options["vulns"],"item-text":"name","item-value":"attribute",label:"Select","persistent-hint":"","return-object":"","single-line":"",outlined:"",dense:"",clearable:""},model:{value:t.new_filter.filter,callback:function(e){t.$set(t.new_filter,"filter",e)},expression:"new_filter.filter"}})],1),a("v-col",{attrs:{cols:"3"}},[a("v-select",{attrs:{disabled:""==t.new_filter.filter,hint:"Criteria",items:t.new_filter_criterias,"item-text":"text","item-value":"value",label:"Criteria","persistent-hint":"","single-line":"",outlined:"",dense:""},model:{value:t.new_filter.criteria,callback:function(e){t.$set(t.new_filter,"criteria",e)},expression:"new_filter.criteria"}})],1),"text"==this.new_filter.filter.criteria||"numeric"==this.new_filter.filter.criteria?a("v-col",{attrs:{cols:"4"}},["bool"!=this.new_filter.filter.criteria?a("v-text-field",{attrs:{disabled:""==t.new_filter.filter||null==t.new_filter.criteria,type:"numeric"==this.new_filter.filter.criteria?"number":"",hint:"Value",label:"...",outlined:"",dense:""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addFilter(e)}},model:{value:t.new_filter.value,callback:function(e){t.$set(t.new_filter,"value",e)},expression:"new_filter.value"}}):t._e()],1):t._e(),"date"==this.new_filter.filter.criteria?a("v-col",{attrs:{cols:"4"}},[a("v-menu",{attrs:{"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[a("v-text-field",t._g(t._b({attrs:{"append-icon":"mdi-calendar",outlined:"",dense:""},model:{value:t.new_filter_date,callback:function(e){t.new_filter_date=e},expression:"new_filter_date"}},"v-text-field",s,!1),i))]}}],null,!1,1825579829),model:{value:t.new_filter_date_menu,callback:function(e){t.new_filter_date_menu=e},expression:"new_filter_date_menu"}},[a("v-date-picker",{on:{input:function(e){t.new_filter_date_menu=!1}},model:{value:t.new_filter.value,callback:function(e){t.$set(t.new_filter,"value",e)},expression:"new_filter.value"}})],1)],1):t._e(),a("v-col",{attrs:{cols:"1"}},[a("v-btn",{staticClass:"mt-0",attrs:{disabled:""==t.new_filter.value&&"bool"!=t.new_filter.filter.criteria||null==t.new_filter.criteria,fab:"",small:"",outlined:"",color:"deep-orange",title:"Add new filter"},on:{click:t.addFilter}},[a("v-icon",[t._v("mdi-plus")])],1)],1)],1),a("v-row",{staticClass:"pt-2"},[t.filters.length>0?a("v-col",{staticClass:"py-0",attrs:{cols:"12"}},[a("span",{staticClass:"subtitle-1"},[t._v("Applied filters:")])]):a("v-col",{staticClass:"py-0",attrs:{cols:"12"}},[a("span",{staticClass:"subtitle-2 font-italic"},[t._v("No filter applied yet")])])],1),t._l(t.filters,(function(e,i){return a("v-row",{key:i,attrs:{align:"center"}},[a("v-col",{attrs:{cols:"auto"}},[a("v-icon",{on:{click:function(e){return t.removeFilter(i)}}},[t._v("mdi-delete-outline")])],1),a("v-col",{attrs:{cols:"4"}},[a("v-select",{attrs:{items:t.filters_options[t.scope],"item-text":"name","item-value":"attribute","return-object":"","single-line":"",outlined:"",dense:"","hide-details":""},model:{value:e.filter,callback:function(a){t.$set(e,"filter",a)},expression:"f.filter"}})],1),a("v-col",{attrs:{cols:"3"}},[a("v-select",{attrs:{items:t.criterias[e.filter.criteria],"item-text":"text","item-value":"value","single-line":"",outlined:"",dense:"","hide-details":""},model:{value:e.criteria,callback:function(a){t.$set(e,"criteria",a)},expression:"f.criteria"}})],1),a("v-col",{attrs:{cols:"4"}},["bool"!=e.filter.criteria?a("v-text-field",{attrs:{outlined:"",dense:"","hide-details":""},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"f.value"}}):t._e()],1)],1)})),a("v-row",{attrs:{align:"start",justify:"start"}},[a("v-col",[a("v-btn",{staticClass:"mr-2",attrs:{color:"deep-orange",disabled:0==t.filters.length,small:""},on:{click:t.applySearchFilters}},[t._v("Search")])],1)],1)],2)},De=[],Oe=(a("4160"),a("159b"),{name:"AdvancedSearch",props:{scope:{type:String,default:"vulns"}},data:function(){return{new_filter_date:(new Date).toISOString().substr(0,10),new_filter_date_menu:!1,new_filter:{filter:"",criteria:null,value:""},new_filter_criterias:[],filters:[],filters_options:{vulns:[{name:"CVE",attribute:"cveid",criteria:"text"},{name:"Summary",attribute:"summary",criteria:"text"},{name:"Score",attribute:"score",criteria:"numeric"},{name:"CVSSv2",attribute:"cvss",criteria:"numeric"},{name:"CVSS Vector",attribute:"cvss_vector",criteria:"text"},{name:"Is monitored ?",attribute:"monitored",criteria:"bool"},{name:"Is exploitable ?",attribute:"is_exploitable",criteria:"bool"},{name:"Is confirmed ?",attribute:"is_confirmed",criteria:"bool"},{name:"Is in the News ?",attribute:"is_in_the_news",criteria:"bool"},{name:"Is in the Wild ?",attribute:"is_in_the_wild",criteria:"bool"},{name:"Published at",attribute:"published",criteria:"date"}]},criterias:{text:[{text:"Equals",value:""},{text:"Contains",value:"contains"},{text:"Contains (ignore case)",value:"icontains"}],numeric:[{text:"Equals",value:""},{text:"Greater than",value:"gt"},{text:"Greater than or equals",value:"gte"},{text:"Less than",value:"lt"},{text:"Less than or equals",value:"lte"}],date:[{text:"At",value:"date"},{text:"After",value:"date__gt"},{text:"After or at",value:"date__gte"},{text:"Before",value:"date__lt"},{text:"Before or at",value:"date__lte"}],bool:[{text:"Yes",value:"true"},{text:"No",value:"false"}]}}},mounted:function(){},watch:{new_filter:{handler:function(){this.new_filter_criterias=this.criterias[this.new_filter.filter.criteria]},deep:!0}},computed:{},methods:{addFilter:function(){this.filters.push(this.new_filter),this.new_filter={filter:"",criteria:null,value:""}},removeFilter:function(t){this.filters.splice(t)},applySearchFilters:function(){var t="";this.filters.forEach((function(e){var a="";a="bool"==e.filter.criteria?"&"+e.filter.attribute+"="+e.criteria:""==e.criteria?"&"+e.filter.attribute+"="+e.value:"&"+e.filter.attribute+"__"+e.criteria+"="+e.value,t+=a})),this.$emit("advanced_search_filters",t)}}}),je=Oe,Be=a("b974"),Ue=Object(l["a"])(je,Me,De,!1,null,null,null),Le=Ue.exports;d()(Ue,{VBtn:V["a"],VCol:Zt["a"],VDatePicker:Qt["a"],VIcon:Q["a"],VMenu:ot["a"],VRow:te["a"],VSelect:Be["a"],VTextField:O["a"]});var Fe={name:"Search",mixins:[pt,Ie],components:{AdvancedSearch:Le,DialogSendVulnByEmail:Ae},data:function(){return{results:[],vulns:[],exploits:[],threats:[],advisories:[],tools:[],loading_vulns:!0,limit_vulns:10,options_vulns:{sortBy:[]},headers_vulns:[{text:"Score",value:"score",align:"center",width:"10%"},{text:"Summary",value:"summary"},{text:"Metadata",value:"metadata",align:"center",width:"8%",sortable:!1},{text:"Monitored",value:"monitored",align:"center"},{text:"Last update",value:"updated_at",align:"center",width:"12%"}],loading_exploits:!0,limit_exploits:10,options_exploits:{sortBy:[]},headers_exploits:[{text:"Relevancy",value:"relevancy_level"},{text:"Link",value:"link",width:"50%"},{text:"Products",value:"vp",sortable:!1},{text:"Last update",value:"updated_at"},{text:"Actions",value:"action",sortable:!1}],loading_threats:!0,limit_threats:10,options_threats:{sortBy:[]},headers_threats:[{text:"Link",value:"link",width:"50%"},{text:"Products",value:"vp",sortable:!1},{text:"Last update",value:"updated_at"},{text:"Actions",value:"action",sortable:!1}],rowsPerPageItems:[10,25,50,100],appsearch:"",showAdvancedFilters:!1,extra_filters:"",search_slider_min:0,search_slider_max:100,dialog_sendmail:!1,selected_vuln_id:null,notification_data:{emails:""},snack:!1,snackColor:"",snackText:""}},beforeRouteUpdate:function(t){this.appsearch=t.params.appsearch},mounted:function(){this.appsearch=this.$router.currentRoute.params.appsearch},watch:{appsearch:{handler:function(t){this.appsearch=t,null!=this.appsearch?(this.options_vulns.page=1,this.options_exploits.page=1,this.options_threats.page=1):(this.loading_vulns=!1,this.loading_exploits=!1,this.loading_threats=!1)}},options_vulns:{handler:function(){null!=this.appsearch&&this.getDataFromApi(this.extra_filters)},deep:!0}},methods:{getDataFromApi:function(t){this.getDataFromApiVuln(t),this.getDataFromApiExploits(t),this.getDataFromApiThreats(t)},getDataFromApiVuln:function(t){var e=this;return this.loading_vulns=!0,new Promise((function(a,i){var s=e.options_vulns,n=s.sortBy,o=s.sortDesc,r=s.page,l=(s.itemsPerPage,e.getVulns(r,e.limit_vulns,n,o,t));setTimeout((function(){a({vulns:l})}),300)}))},getDataFromApiExploits:function(t){var e=this;return this.loading_exploits=!0,new Promise((function(a,i){var s=e.options_exploits,n=s.sortBy,o=s.sortDesc,r=s.page,l=(s.itemsPerPage,e.getExploits(r,e.limit_exploits,n,o,t));setTimeout((function(){a({exploits:l})}),300)}))},getDataFromApiThreats:function(t){var e=this;return this.loading_threats=!0,new Promise((function(a,i){var s=e.options_threats,n=s.sortBy,o=s.sortDesc,r=s.page,l=(s.itemsPerPage,e.getThreats(r,e.limit_threats,n,o,t));setTimeout((function(){a({threats:l})}),300)}))},updateAdvancedSearchFilters:function(t){this.extra_filters=t,this.getDataFromApi(t)},getVulns:function(t,e,a,i,s){var n=this,o="";a.length>0&&(o=!0===i[0]?"&sorted_by=-"+a:"&sorted_by="+a),null!=s&&""!=s||(s="&score__gte="+this.search_slider_min+"&score__lte="+this.search_slider_max),this.$api.get("/api/vulns/?limit="+e+"&page="+t+"&search="+this.appsearch+o+s).then((function(t){return n.vulns=t.data,n.loading_vulns=!1,n.vulns})).catch((function(t){n.vulns=[],n.loading_vulns=!1,n.snack=!0,n.snackColor="error",n.snackText="Unable to get vulns."}))},viewVuln:function(t){this.$router.push({name:"VulnDetails",params:{vuln_id:t}})},downloadVuln:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"json";this.$api.get("/api/vulns/"+t+"/export/"+a,{responseType:"arraybuffer"}).then((function(i){e.forceFileDownload(i,"vuln_export_"+t+"."+a),e.snack=!0,e.snackColor="success",e.snackText="Vulnerability details available."})).catch((function(t){e.snack=!0,e.snackColor="error",e.snackText="Unable to download vulnerability details."})),this.loading=!1},sendEmailVuln:function(t){var e=this;this.$api.post("/api/vulns/"+t+"/export/email",this.notification_data).then((function(t){e.snack=!0,e.snackColor="success",e.snackText="Vulnerability details successfuly sent by mail."})).catch((function(t){e.snack=!0,e.snackColor="error",e.snackText="Unable to send vulnerability details."})),this.dialog_sendmail=!1},getExploits:function(t,e,a,i,s){var n=this,o="";a.length>0&&(o=!0===i[0]?"&sorted_by=-"+a:"&sorted_by="+a),this.$api.get("/api/exploits/?limit="+e+"&page="+t+"&search="+this.appsearch+o+s).then((function(t){return n.exploits=t.data,n.loading_exploits=!1,n.exploits})).catch((function(t){n.exploits=[],n.loading_exploits=!1,n.snack=!0,n.snackColor="error",n.snackText="Unable to get exploits."}))},getThreats:function(t,e,a,i,s){var n=this,o="";a.length>0&&(o=!0===i[0]?"&sorted_by=-"+a:"&sorted_by="+a),this.$api.get("/api/threats/?limit="+e+"&page="+t+"&search="+this.appsearch+o+s).then((function(t){return n.threats=t.data,n.loading_threats=!1,n.threats})).catch((function(t){n.threats=[],n.loading_threats=!1,n.snack=!0,n.snackColor="error",n.snackText="Unable to get threat news."}))},toggleMonitoredVuln:function(t){var e=this,a={monitored:!t.monitored,vuln_id:t.id,organization_id:localStorage.getItem("org_id")};this.$api.put("/api/vulns/"+t.id+"/toggle",a).then((function(a){a?(t.monitored=!t.monitored,e.snack=!0,e.snackColor="success",e.snackText="Vulnerability monitoring successfuly updated."):(e.snack=!0,e.snackColor="error",e.snackText="Unable to change the vulnerability monitoring status")})).catch((function(t){e.loading=!1,y.a.fire({title:"Error",text:"Unable to change the vulnerability monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))},getBoolValue:function(t){return t?"Yes":"No"}}},Ne=Fe,Re=(a("3f07"),a("4ca6")),Ye=a("ba0d"),ze=Object(l["a"])(Ne,Ce,Ve,!1,null,null,null),Xe=ze.exports;d()(ze,{VBadge:Re["a"],VBtn:V["a"],VChip:wt["a"],VCol:Zt["a"],VContainer:S["a"],VDataTable:Dt["a"],VDivider:G["a"],VIcon:Q["a"],VRow:te["a"],VSlider:Ye["a"],VTab:fe["a"],VTabItem:be["a"],VTabs:ke["a"],VTextField:O["a"]});var He=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-card",[a("v-card-title",{staticClass:"py-0"},[a("v-container",[a("v-row",[a("v-col",{staticClass:"pa-2",attrs:{md:"auto"}},[t._v(" Vulnerabilities"),a("br"),a("v-chip",{attrs:{small:"",label:"",outlined:"",color:t.getBoolColor(this.show_all)},on:{click:function(e){return t.toggleShowAll()}}},[t._v("All")]),t._v(" "),a("v-chip",{attrs:{small:"",label:"",outlined:"",color:t.getBoolColor(this.show_last_day)},on:{click:function(e){return t.toggleShowLastDay()}}},[t._v("Last 24h")]),t._v(" "),a("v-chip",{attrs:{small:"",label:"",outlined:"",color:t.getBoolColor(this.show_last_week)},on:{click:function(e){return t.toggleShowLastWeek()}}},[t._v("Last Week")])],1),a("v-col",{staticClass:"pa-2",attrs:{md:"6"}},[a("v-text-field",{staticClass:"pt-0",attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-col",{staticClass:"pa-2",attrs:{md:"2"}},[a("v-slider",{attrs:{label:"Min Score",min:"0",max:"100",color:"deep-orange","track-color":"grey","thumb-label":"","hide-details":""},model:{value:t.search_slider_min,callback:function(e){t.search_slider_min=e},expression:"search_slider_min"}}),a("v-slider",{attrs:{label:"Max Score",min:"0",max:"100",color:"grey","thumb-color":"deep-orange","track-color":"deep-orange","thumb-label":"","hide-details":""},model:{value:t.search_slider_max,callback:function(e){t.search_slider_max=e},expression:"search_slider_max"}})],1)],1),t.showAdvancedFilters?a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-divider"),a("advanced-search",{attrs:{scope:"vulns"},on:{advanced_search_filters:t.updateAdvancedSearchFilters}})],1)],1):t._e()],1)],1),t.showAdvancedFilters?a("v-btn",{attrs:{depressed:"",tile:"",block:"",label:"coic"},on:{click:function(e){t.showAdvancedFilters=!t.showAdvancedFilters}}},[a("v-icon",[t._v("mdi-chevron-up")]),t._v("Hide advanced filters"),a("v-icon",[t._v("mdi-chevron-up")])],1):a("v-btn",{attrs:{depressed:"",tile:"",block:"",label:"coic"},on:{click:function(e){t.showAdvancedFilters=!0}}},[a("v-icon",[t._v("mdi-chevron-down")]),t._v("Show advanced filters"),a("v-icon",[t._v("mdi-chevron-down")])],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers,items:t.vulns.results,options:t.options,"server-items-length":t.vulns.count,search:t.search,"items-per-page":t.limit,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"id","multi-sort":""},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.score",fn:function(e){var i=e.item;return[a("v-chip",{staticClass:"text-center font-weight-bold",attrs:{color:t.getRatingColor(i.score),label:""}},[t._v(t._s(i.score)+"/100")]),a("br"),a("span",{staticClass:"text-caption"},[t._v("CVSSv2: "+t._s(i.cvss))]),a("br"),a("span",{staticClass:"text-caption"},[t._v("CVSSv3: "+t._s(i.cvss3))])]}},{key:"item.summary",fn:function(e){var i=e.item;return[a("div",{staticClass:"py-2"},[a("div",{staticClass:"pb-2"},[a("span",{staticClass:"deep-orange--text font-weight-medium"},[t._v(t._s(i.cveid))]),t._v(" / PH-"+t._s(i.id)+" "),a("v-btn",{attrs:{color:"deep-orange",icon:"",small:""}},[a("v-icon",{attrs:{title:"View details"},on:{click:function(e){return t.viewVuln(i.id)}}},[t._v("mdi-arrow-right-bold-circle-outline")])],1)],1),a("div",[t._v(" "+t._s(i.summary)+" ")]),t._l(i.products.slice(0,5),(function(e){return a("v-chip",{key:e.id,staticClass:"vendor-chip",attrs:{label:"",small:"",link:""},on:{click:function(a){return t.$router.push({path:"/product/"+e.id})}}},[t._v(" "+t._s(e.vendor)+": "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(e.name))])])})),i.products.length>5?a("span",{on:{click:function(e){return t.viewVuln(i.id)}}},[t._v(" + ")]):t._e()],2)]}},{key:"item.metadata",fn:function(e){var i=e.item;return[a("v-chip",{staticClass:"font-weight-bold",attrs:{label:"",link:"",small:"",color:i.exploit_count>0?"deep-orange":"grey",title:"Is exploitable?"}},[t._v(t._s(i.exploit_count))]),a("v-btn",{attrs:{color:"NETWORK"==i.access.vector?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Is exploitable remotely?"}},[t._v("mdi-cloud")])],1),a("v-btn",{attrs:{color:"NONE"==i.access.authentication?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Require authentication?"}},[t._v("mdi-shield-account")])],1),a("v-btn",{attrs:{color:i.is_in_the_news||i.is_in_the_wild?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Is in the news or exploited in the wild?"}},[t._v("mdi-star")])],1)]}},{key:"item.monitored",fn:function(e){var i=e.item;return[i.monitored?a("v-chip",{staticClass:"text-center font-weight-bold",attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:function(e){return t.toggleMonitoredVuln(i)}}},[t._v("Yes")]):t._e(),i.monitored?t._e():a("v-chip",{staticClass:"text-center font-weight-bold",attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:function(e){return t.toggleMonitoredVuln(i)}}},[t._v("No")])]}},{key:"item.updated_at",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.updated_at).format("YYYY-MM-DD, hh:mm")))])]}}])}),this.showManageMetadataButtons()?a("v-dialog",{attrs:{"max-width":"600px"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[a("v-btn",t._g({attrs:{absolute:"",dark:"",fab:"",bottom:"",left:"",color:"deep-orange"}},i),[a("v-icon",[t._v("mdi-plus")])],1)]}}],null,!1,1303381134),model:{value:t.dialog_vuln,callback:function(e){t.dialog_vuln=e},expression:"dialog_vuln"}},[a("vuln-add-edit")],1):t._e(),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor,dense:""},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1)},We=[],qe=(a("841c"),a("498a"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v(t._s(t.formVulnTitle))])]),a("v-card-text",[a("v-form",{ref:"form-vuln"},[a("v-container",[a("v-row",[a("v-col",{attrs:{md:"6"}},[a("v-text-field",{attrs:{label:"CVE ID"},model:{value:t.editedItem.cve_id,callback:function(e){t.$set(t.editedItem,"cve_id",e)},expression:"editedItem.cve_id"}})],1),a("v-col",{attrs:{md:"3"}},[a("v-select",{attrs:{label:"Is monitored?",items:t.editedItem.monitored_items},model:{value:t.editedItem.monitored,callback:function(e){t.$set(t.editedItem,"monitored",e)},expression:"editedItem.monitored"}})],1)],1),a("v-row",[a("v-col",[a("v-textarea",{attrs:{label:"Summary",hint:"Insert notes about this vulnerability",rows:"4"},model:{value:t.editedItem.summary,callback:function(e){t.$set(t.editedItem,"summary",e)},expression:"editedItem.summary"}})],1)],1),a("v-row",[a("v-col",{attrs:{md:"3"}},[a("v-text-field",{attrs:{label:"CVSSv2 Score"},model:{value:t.editedItem.cvss2,callback:function(e){t.$set(t.editedItem,"cvss2",e)},expression:"editedItem.cvss2"}})],1),a("v-col",{attrs:{md:"9"}},[a("v-text-field",{attrs:{label:"CVSSv2 Vector"},model:{value:t.editedItem.cvss2_vector,callback:function(e){t.$set(t.editedItem,"cvss2_vector",e)},expression:"editedItem.cvss2_vector"}})],1)],1),a("v-row",[a("v-col",{attrs:{md:"3"}},[a("v-text-field",{attrs:{label:"CVSSv3 Score"},model:{value:t.editedItem.cvss3,callback:function(e){t.$set(t.editedItem,"cvss3",e)},expression:"editedItem.cvss3"}})],1),a("v-col",{attrs:{md:"9"}},[a("v-text-field",{attrs:{label:"CVSSv3 Vector"},model:{value:t.editedItem.cvss3_vector,callback:function(e){t.$set(t.editedItem,"cvss3_vector",e)},expression:"editedItem.cvss3_vector"}})],1)],1),t._v(" Impact "),a("v-row",[a("v-col",{attrs:{cols:"12",md:"4"}},[a("v-select",{attrs:{label:"Confidentiality",items:t.editedItem.impact_confidentiality_items},model:{value:t.editedItem.impact_confidentiality,callback:function(e){t.$set(t.editedItem,"impact_confidentiality",e)},expression:"editedItem.impact_confidentiality"}})],1),a("v-col",{attrs:{cols:"12",md:"4"}},[a("v-select",{attrs:{label:"Integrity",items:t.editedItem.impact_integrity_items},model:{value:t.editedItem.impact_integrity,callback:function(e){t.$set(t.editedItem,"impact_integrity",e)},expression:"editedItem.impact_integrity"}})],1),a("v-col",{attrs:{cols:"12",md:"4"}},[a("v-select",{attrs:{label:"Availability",items:t.editedItem.impact_availability_items},model:{value:t.editedItem.impact_availability,callback:function(e){t.$set(t.editedItem,"impact_availability",e)},expression:"editedItem.impact_availability"}})],1)],1),t._v(" Access "),a("v-row",[a("v-col",{attrs:{cols:"12",md:"4"}},[a("v-select",{attrs:{label:"Authentication",items:t.editedItem.access_authentication_items},model:{value:t.editedItem.access_authentication,callback:function(e){t.$set(t.editedItem,"access_authentication",e)},expression:"editedItem.access_authentication"}})],1),a("v-col",{attrs:{cols:"12",md:"4"}},[a("v-select",{attrs:{label:"Complexity",items:t.editedItem.access_complexity_items},model:{value:t.editedItem.access_complexity,callback:function(e){t.$set(t.editedItem,"access_complexity",e)},expression:"editedItem.access_complexity"}})],1),a("v-col",{attrs:{cols:"12",md:"4"}},[a("v-select",{attrs:{label:"Vector",items:t.editedItem.access_vector_items},model:{value:t.editedItem.access_vector,callback:function(e){t.$set(t.editedItem,"access_vector",e)},expression:"editedItem.access_vector"}})],1)],1),a("v-row",[a("v-col",{attrs:{cols:"12",md:"3"}},[a("v-select",{attrs:{label:"Is exploitable?",items:t.editedItem.is_exploitable_items},model:{value:t.editedItem.is_exploitable,callback:function(e){t.$set(t.editedItem,"is_exploitable",e)},expression:"editedItem.is_exploitable"}})],1),a("v-col",{attrs:{cols:"12",md:"3"}},[a("v-select",{attrs:{label:"Is confirmed?",items:t.editedItem.is_confirmed_items},model:{value:t.editedItem.is_confirmed,callback:function(e){t.$set(t.editedItem,"is_confirmed",e)},expression:"editedItem.is_confirmed"}})],1),a("v-col",{attrs:{cols:"12",md:"3"}},[a("v-select",{attrs:{label:"In the News?",items:t.editedItem.is_in_the_news_items},model:{value:t.editedItem.is_in_the_news,callback:function(e){t.$set(t.editedItem,"is_in_the_news",e)},expression:"editedItem.is_in_the_news"}})],1),a("v-col",{attrs:{cols:"12",md:"3"}},[a("v-select",{attrs:{label:"In The Wild",items:t.editedItem.is_in_the_wild_items},model:{value:t.editedItem.is_in_the_wild,callback:function(e){t.$set(t.editedItem,"is_in_the_wild",e)},expression:"editedItem.is_in_the_wild"}})],1)],1),a("v-row",[a("v-col",[a("v-autocomplete",{attrs:{items:t.products_items,loading:t.products_isLoading,"search-input":t.products_search,chips:"","cache-items":"","hide-details":"","hide-selected":"","hide-no-data":"","item-text":"name","item-value":"id",label:"Search for a product...",multiple:""},on:{"update:searchInput":function(e){t.products_search=e},"update:search-input":function(e){t.products_search=e}},scopedSlots:t._u([{key:"selection",fn:function(e){return[a("v-chip",t._b({attrs:{"input-value":e.selected,close:""},on:{click:e.select,"click:close":function(a){return t.removeSelectedProduct(e.item)}}},"v-chip",e.attrs,!1),[t._v(" "+t._s(e.item.vendor)+"/"+t._s(e.item.name)+" ")])]}},{key:"item",fn:function(e){return[t._v(" "+t._s(e.item.vendor)+"/"+t._s(e.item.name)+" ")]}}]),model:{value:t.editedItem.products,callback:function(e){t.$set(t.editedItem,"products",e)},expression:"editedItem.products"}})],1)],1),a("v-row",[a("v-col",[a("v-textarea",{attrs:{label:"CPE list",hint:"Insert CPEs (line by line or comma-separated)",rows:"3"},model:{value:t.editedItem.cpes,callback:function(e){t.$set(t.editedItem,"cpes",e)},expression:"editedItem.cpes"}})],1)],1),a("v-row",[a("v-col",[a("v-textarea",{attrs:{label:"References links",hint:"Insert links (line by line or comma-separated)",rows:"3"},model:{value:t.editedItem.references,callback:function(e){t.$set(t.editedItem,"references",e)},expression:"editedItem.references"}})],1)],1),a("v-btn",{attrs:{color:"success"},on:{click:t.saveVuln}},[t._v("Save")]),a("v-btn",{attrs:{color:"warning",type:"reset"}},[t._v("Reset")])],1)],1)],1),a("v-card-actions",[a("v-spacer")],1),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor,dense:""},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)}),Je=[],Ke=(a("c740"),a("ade3")),Ge={name:"VulnAddEdit",props:["vuln","action"],data:function(){var t;return{editedIndex:-1,editedItem:{},defaultVulnMetadata:(t={id:"",cve_id:"",summary:"",published:"",cvss2:"",cvss2_vector:"",cvss3:"",cvss3_vector:"",cwe:"",access_authentication:"NONE",access_authentication_items:["NONE","SINGLE","MULTIPLE"],access_complexity:"LOW",access_complexity_items:["LOW","MEDIUM","HIGH"],access_vector:"LOCAL",access_vector_items:["LOCAL","ADJACENT_NETWORK","NETWORK"],impact_availability:"NONE",impact_availability_items:["NONE","PARTIAL","COMPLETE"],impact_confidentiality:"NONE",impact_confidentiality_items:["NONE","PARTIAL","COMPLETE"],impact_integrity:"NONE",impact_integrity_items:["NONE","PARTIAL","COMPLETE"],references:[],cpes:"",products:[]},Object(Ke["a"])(t,"references",[]),Object(Ke["a"])(t,"monitored",!1),Object(Ke["a"])(t,"monitored_items",[{text:"Yes",value:!0},{text:"No",value:!1}]),Object(Ke["a"])(t,"is_exploitable",!1),Object(Ke["a"])(t,"is_exploitable_items",[{text:"Yes",value:!0},{text:"No",value:!1}]),Object(Ke["a"])(t,"is_confirmed",!1),Object(Ke["a"])(t,"is_confirmed_items",[{text:"Yes",value:!0},{text:"No",value:!1}]),Object(Ke["a"])(t,"is_in_the_wild",!1),Object(Ke["a"])(t,"is_in_the_wild_items",[{text:"Yes",value:!0},{text:"No",value:!1}]),Object(Ke["a"])(t,"is_in_the_news",!1),Object(Ke["a"])(t,"is_in_the_news_items",[{text:"Yes",value:!0},{text:"No",value:!1}]),t),products_isLoading:!1,products_autocomplete:null,products_items:[],products_search:null,snack:!1,snackColor:"",snackText:""}},mounted:function(){"edit"==this.action?this.loadVuln():this.editedItem=this.defaultVulnMetadata},watch:{products_search:bt.a.debounce((function(t){var e=this;null!=t&&(t.length<3||this.products_isLoading||(this.products_isLoading=!0,this.$api.get("/api/kb/products/?limit=30&search="+this.products_search).then((function(t){e.products_items=t.data.results})).catch((function(t){console.log(t)})).finally((function(){return e.products_isLoading=!1}))))}),500)},computed:{formVulnTitle:function(){return-1===this.editedIndex?"New Vulnerability":"Edit Vulnerability PH-"+this.vuln.id}},methods:{loadVuln:function(){this.editedIndex=0,this.editedItem=this.defaultVulnMetadata,this.editedItem.cve_id=this.vuln.cveid,this.editedItem.summary=this.vuln.summary,this.editedItem.monitored=this.vuln.monitored,this.editedItem.cvss2=this.vuln.cvss,this.editedItem.cvss2_vector=this.vuln.cvss_vector,this.editedItem.access_authentication=this.vuln.access.authentication,this.editedItem.access_complexity=this.vuln.access.complexity,this.editedItem.access_vector=this.vuln.access.vector,this.editedItem.impact_availability=this.vuln.impact.availability,this.editedItem.impact_confidentiality=this.vuln.impact.confidentiality,this.editedItem.impact_integrity=this.vuln.impact.integrity,this.editedItem.is_exploitable=this.vuln.is_exploitable,this.editedItem.is_confirmed=this.vuln.is_confirmed,this.editedItem.is_in_the_wild=this.vuln.is_in_the_wild,this.editedItem.is_in_the_news=this.vuln.is_in_the_news,this.editedItem.cpes=String(this.vuln.vulnerable_products).split(",").join("\n"),this.editedItem.references=String(this.vuln.reflinks).split(",").join("\n"),this.products_items=this.vuln.products,this.editedItem.products=this.vuln.products},saveVuln:function(){var t=this;this.editedItem.modified=new Date,-1===this.editedIndex?this.$api.post("/api/vulns/add",this.editedItem).then((function(e){e&&200===e.status&&"success"==e.data.status?(t.snack=!0,t.snackColor="success",t.snackText="Vulnerability successfuly saved."):("status"in e.data&&"reason"in e.data?t.snackText="Unable to save the vulnerability: "+e.data.reason:t.snackText="Unable to save the vulnerability.",t.snack=!0,t.snackColor="error")})).catch((function(e){t.snack=!0,t.snackColor="error",t.snackText="Unable to save the vulnerability."})):this.$api.post("/api/vulns/edit",this.editedItem).then((function(e){e&&200===e.status?(t.snack=!0,t.snackColor="success",t.snackText="Not implemented."):("status"in e.data&&"reason"in e.data?t.snackText="Unable to update the vulnerability: "+e.data.reason:t.snackText="Unable to update the vulnerability.",t.snack=!0,t.snackColor="error",t.snackText="Unable to update the vulnerability.")})).catch((function(e){t.dialog_vuln=!1,t.editedItem=t.defaultVulnMetadata})),this.dialog_vuln=!1,this.editedItem=this.defaultVulnMetadata,setTimeout((function(){t.$router.go()}),2e3)},removeSelectedProduct:function(t){var e=-1;e=-1===this.editedIndex?this.editedItem.products.indexOf(t.id):this.editedItem.products.findIndex((function(e){return e.id==t.id})),e>=0&&this.editedItem.products.splice(e,1)}}},Ze=Ge,Qe=(a("c921"),Object(l["a"])(Ze,qe,Je,!1,null,null,null)),ta=Qe.exports;d()(Qe,{VAutocomplete:yt["a"],VBtn:V["a"],VCard:I["a"],VCardActions:T["b"],VCardText:T["d"],VCardTitle:T["e"],VChip:wt["a"],VCol:Zt["a"],VContainer:S["a"],VForm:$["a"],VRow:te["a"],VSelect:Be["a"],VSnackbar:Vt["a"],VSpacer:D["a"],VTextField:O["a"],VTextarea:xe["a"]});var ea={name:"vulns",mixins:[pt,oe],components:{VulnAddEdit:ta,AdvancedSearch:Le},data:function(){return{vulns:[],loading:!0,limit:10,search:"",search_slider_min:0,search_slider_max:100,showAdvancedFilters:!1,show_all:!0,show_last_day:!1,show_last_week:!1,options:{},headers:[{text:"Score",value:"score",align:"center",width:"10%"},{text:"Summary",value:"summary"},{text:"Metadata",value:"metadata",align:"center",width:"8%",sortable:!1},{text:"Monitored",value:"monitored",align:"center"},{text:"Last update",value:"updated_at",align:"center",width:"12%"}],rowsPerPageItems:[5,10,20,50,100],dialog_vuln:!1,snack:!1,snackColor:"",snackText:""}},watch:{search:bt.a.debounce((function(t){this.search=t,this.options.page=1,this.getDataFromApi()}),500),options:{handler:function(){this.getDataFromApi()},deep:!0},search_slider_min:bt.a.debounce((function(){this.getDataFromApi()}),500),search_slider_max:bt.a.debounce((function(){this.getDataFromApi()}),500),show_all:{handler:function(){this.getDataFromApi()},deep:!0},show_last_day:{handler:function(){this.getDataFromApi()},deep:!0},show_last_week:{handler:function(){this.getDataFromApi()},deep:!0}},methods:{getDataFromApi:function(t,e){var a=this;return this.loading=!0,new Promise((function(i,s){var n=a.options,o=n.sortBy,r=n.sortDesc,l=n.page,c=n.itemsPerPage;null!=e&&""!=e&&(l=e);a.search.trim().toLowerCase();a.limit=c;var d=a.getVulns(l,a.limit,o,r,t);setTimeout((function(){i({items:d})}),300)}))},updateAdvancedSearchFilters:function(t){this.getDataFromApi(t,1)},getVulns:function(t,e,a,i,s){var n=this,o="";a.length>0&&(o=!0===i[0]?"sorted_by=-"+a:"sorted_by="+a);var r="";1==this.show_last_day?r="&updated_at__gte="+qt()(new Date).format("YYYY-MM-DD"):1==this.show_last_week&&(r="&updated_at__gte="+qt()(new Date).subtract(7,"day").format("YYYY-MM-DD")),null!=s&&""!=s||(s="&score__gte="+this.search_slider_min+"&score__lte="+this.search_slider_max),this.$api.get("/api/vulns/?limit="+e+"&page="+t+"&search="+this.search+"&"+o+r+s).then((function(t){return n.vulns=t.data,n.loading=!1,n.vulns})).catch((function(t){n.vulns=[],n.loading=!1,n.snack=!0,n.snackColor="error",n.snackText="Unable to get vulns."}))},viewVuln:function(t){this.$router.push({name:"VulnDetails",params:{vuln_id:t}})},editVuln:function(t){},deleteVuln:function(t){},clickRow:function(t){this.$router.push({name:"VulnDetails",params:{vuln_id:t.id}})},getBool:function(t){return 1==t?"red":"grey"},toggleShowAll:function(){this.options.page=1,0==this.show_all&&(this.show_all=!this.show_all),1==this.show_all&&(this.show_last_day=!1,this.show_last_week=!1)},toggleShowLastDay:function(){this.options.page=1,1==this.show_last_day&&(this.show_all=!0,this.show_last_day=!1,this.show_last_week=!1),0==this.show_last_day&&(this.show_last_day=!0,this.show_all=!1,this.show_last_week=!1)},toggleShowLastWeek:function(){this.options.page=1,1==this.show_last_week&&(this.show_all=!0,this.show_last_day=!1,this.show_last_week=!1),0==this.show_last_week&&(this.show_last_week=!0,this.show_all=!1,this.show_last_day=!1)},showManageMetadataButtons:function(){var t=JSON.parse(this.getUserProfile());return null==t||!("manage_metadata"in t)||t.manage_metadata},toggleMonitoredVuln:function(t){var e=this,a={monitored:!t.monitored,vuln_id:t.id,organization_id:localStorage.getItem("org_id")};this.$api.put("/api/vulns/"+t.id+"/toggle",a).then((function(a){a?(t.monitored=!t.monitored,e.snack=!0,e.snackColor="success",e.snackText="Vulnerability monitoring successfuly updated."):(e.snack=!0,e.snackColor="error",e.snackText="Unable to change the vulnerability monitoring status")})).catch((function(t){e.loading=!1,swal.fire({title:"Error",text:"Unable to change the vulnerability monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))}}},aa=ea,ia=(a("8083"),Object(l["a"])(aa,He,We,!1,null,null,null)),sa=ia.exports;d()(ia,{VBtn:V["a"],VCard:I["a"],VCardTitle:T["e"],VChip:wt["a"],VCol:Zt["a"],VContainer:S["a"],VDataTable:Dt["a"],VDialog:Ot["a"],VDivider:G["a"],VIcon:Q["a"],VRow:te["a"],VSlider:Ye["a"],VSnackbar:Vt["a"],VTextField:O["a"]});var na=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-tabs",{attrs:{left:"","background-color":"white",color:"deep-orange accent-4"}},[a("v-tab",[t._v("Summary")]),a("v-tab",[this.exploits.length>0?a("v-badge",{attrs:{color:"deep-orange",content:this.exploits.length}},[t._v("Exploits")]):t._e(),0==this.exploits.length?a("v-badge",{attrs:{color:"grey",content:"0"}},[t._v("Exploits")]):t._e()],1),a("v-tab",[this.threats.length>0?a("v-badge",{attrs:{color:"deep-orange",content:this.threats.length}},[t._v("Threat activities")]):t._e(),0==this.threats.length?a("v-badge",{attrs:{color:"grey",content:"0"}},[t._v("Threat activities")]):t._e()],1),a("v-tab",[t._v("Timeline")]),a("v-tab-item",[a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md9:""}},[a("v-flex",[a("v-card",{attrs:{color:"grey lighten-5"}},[a("v-card-title",{staticClass:"title",attrs:{primary:""}},[a("v-container",{staticClass:"grey lighten-5"},[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"pa-2",attrs:{md:"auto"}},[t._v(" Vuln ID: PH-"+t._s(t.$route.params.vuln_id)+" ")]),a("v-col",{staticClass:"pa-2",attrs:{md:"auto"}},[this.showManageMetadataButtons()?a("v-icon",{attrs:{color:"deep-orange",title:"Edit vulnerability"},on:{click:function(e){t.dialog_editvuln=!0}}},[t._v("mdi-pencil")]):t._e(),a("v-icon",{attrs:{color:"deep-orange",title:"Download as JSON file"},on:{click:function(e){return t.downloadVuln(t.$route.params.vuln_id,"json")}}},[t._v("mdi-download")]),a("v-icon",{attrs:{color:"deep-orange",title:"Send vulnerability as email"},on:{click:function(e){t.dialog_sendmail=!0}}},[t._v("mdi-email-send-outline")])],1),a("v-col",{staticClass:"pa-2"},[this.vuln.monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:t.toggleMonitored}},[t._v("Monitored")]):t._e(),this.vuln.monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:t.toggleMonitored}},[t._v("Not monitored")])],1)],1)],1)],1),a("v-card-text",[a("v-list",{attrs:{subheader:"",color:"grey lighten-5"}},[a("v-list-item",[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("CVE")]),t._v(" "+t._s(this.vuln.cveid)+" ")],1)],1),a("v-list-item",[a("v-list-item-content",{staticClass:"d-inline"},[a("v-list-item-subtitle",[t._v("CVSSv2")]),a("v-chip",{attrs:{small:"",label:"",color:t.getCVSSColor(this.vuln.cvss)}},[t._v(" "+t._s(this.vuln.cvss)+" ")]),t._v(" - "+t._s(this.vuln.cvss_vector)+" ")],1)],1),a("v-list-item",[a("v-list-item-content",{staticClass:"d-inline"},[a("v-list-item-subtitle",[t._v("CVSSv3")]),a("v-chip",{attrs:{small:"",label:"",color:t.getCVSSColor(this.vuln.cvss3)}},[t._v(" "+t._s(this.vuln.cvss3)+" ")]),t._v(" - "+t._s(this.vuln.cvss3_vector)+" ")],1)],1),a("v-list-item",[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("Summary")]),t._v(" "+t._s(this.vuln.summary)+" ")],1)],1),""!=this.vuln.cwe_id?a("v-list-item",{attrs:{href:"https://cwe.mitre.org/data/definitions/"+this.vuln.cwe_id.replace("CWE-","")+".html",target:"_blank"}},[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("CWE")]),t._v(" "+t._s(this.vuln.cwe_id)+" - "+t._s(this.vuln.cwe_name)+" ")],1)],1):t._e(),""!=this.vuln.cwe_refs&&"MITRE-ATTACK"in this.vuln.cwe_refs?a("v-list-item",[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("Mitre ATT&CK techniques")]),a("ul",{attrs:{id:"v-for-cwe_refs"}},t._l(this.vuln.cwe_refs["MITRE-ATTACK"],(function(e){return a("li",{attrs:{link:""}},[a("a",{attrs:{href:e["url"],target:"_blank"}},[t._v(" "+t._s(e["external_id"])+" - "+t._s(e["description"]))])])})),0)],1)],1):t._e(),"undefined"===typeof this.vuln.reflinks||this.vuln.reflinks.length>0?a("v-list-item",[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("Links")]),a("ul",{attrs:{id:"v-for-reflinks"}},t._l(this.vuln.reflinks,(function(e){return a("li",{key:e,attrs:{link:""}},[a("a",{attrs:{href:e,target:"_blank"}},[t._v(" "+t._s(e)+" ")])])})),0)],1)],1):t._e(),a("v-list-item",[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("Vulnerable product(s) - "+t._s(this.vuln.vulnerable_products.length)+" CPE")]),a("ul",{attrs:{id:"v-for-cpe"}},t._l(this.vuln.vulnerable_products,(function(e){return a("li",[t._v(" "+t._s(e)+" ")])})),0)],1)],1),a("v-list-item",[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("Vulnerable package(s)")]),a("ul",{attrs:{id:"v-for-package"}},[t._l(this.vuln.vulnerable_packages_versions,(function(e,i){return[t._l(e,(function(e,s){return t._l(e,(function(e,n){return a("li",[a("v-chip",{staticClass:"package-chip",attrs:{label:"",small:""}},[t._v(t._s(i)+":"+t._s(s)+" ")]),t._v(" affected: "+t._s(e.affected_versions)+", patched: "+t._s(e.patched_versions)+" ")],1)}))}))]}))],2)],1)],1)],1)],1)],1)],1)],1),a("v-flex",{attrs:{md3:""}},[a("v-flex",[this.ratings.score>=0?a("v-card",{attrs:{color:t.getRatingColor(t.vprating)},on:{click:function(e){return t.viewRating()}}},[a("v-card-title",{staticClass:"title"},[t._v("Rating Scores")]),a("v-card-text",[a("v-row",{attrs:{align:"bottom",justify:"center"}},[a("span",{staticClass:"display-3 font-weight-bold"},[t._v(t._s(t.vprating))]),t._v("/100 ")])],1)],1):t._e()],1),a("v-flex",[a("v-card",{attrs:{color:"grey lighten-5"}},[a("v-card-title",{staticClass:"title",attrs:{primary:""}},[t._v("Metrics")]),a("v-card-text",[a("v-switch",{staticStyle:{"margin-top":"0px"},attrs:{color:"deep-orange",readonly:"","hide-details":"",label:"Exploitable"},on:{click:function(e){return t.toggleMetric()}},model:{value:t.is_exploitable,callback:function(e){t.is_exploitable=e},expression:"is_exploitable"}}),a("v-switch",{staticStyle:{"margin-top":"0px"},attrs:{color:"deep-orange",readonly:"","hide-details":"",label:"Confirmed"},model:{value:t.is_confirmed,callback:function(e){t.is_confirmed=e},expression:"is_confirmed"}}),a("v-switch",{staticStyle:{"margin-top":"0px"},attrs:{color:"deep-orange",readonly:"","hide-details":"",label:"Relayed in the News"},model:{value:t.is_in_the_news,callback:function(e){t.is_in_the_news=e},expression:"is_in_the_news"}}),a("v-switch",{staticStyle:{"margin-top":"0px"},attrs:{color:"deep-orange",readonly:"","hide-details":"",label:"Exploited in the Wild"},model:{value:t.is_in_the_wild,callback:function(e){t.is_in_the_wild=e},expression:"is_in_the_wild"}})],1)],1)],1),a("v-flex",[a("v-card",{attrs:{color:"grey lighten-5",height:"100%"}},[a("v-card-title",{staticClass:"title",attrs:{primary:""}},[t._v("Access")]),a("v-card-text",[t._v(" Authentication: "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(this.vuln.access.authentication))]),a("br"),t._v(" Complexity: "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(this.vuln.access.complexity))]),a("br"),t._v(" Vector: "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(this.vuln.access.vector))])])],1)],1),a("v-flex",[a("v-card",{attrs:{color:"grey lighten-5",height:"100%"}},[a("v-card-title",{staticClass:"title",attrs:{primary:""}},[t._v("Impact")]),a("v-card-text",[t._v(" Confidentiality: "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(this.vuln.impact.confidentiality))]),a("br"),t._v(" Integrity: "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(this.vuln.impact.integrity))]),a("br"),t._v(" Availability: "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(this.vuln.impact.availability))])])],1)],1)],1)],1),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor,dense:""},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1),this.showManageMetadataButtons()?a("v-dialog",{attrs:{"max-width":"600px"},model:{value:t.dialog_editvuln,callback:function(e){t.dialog_editvuln=e},expression:"dialog_editvuln"}},[a("vuln-add-edit",{attrs:{vuln:this.vuln,action:"edit"}})],1):t._e(),a("v-dialog",{attrs:{"max-width":"600px"},model:{value:t.dialog_sendmail,callback:function(e){t.dialog_sendmail=e},expression:"dialog_sendmail"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Send vulnerability by email")])]),a("v-card-text",[a("v-form",{ref:"form-vuln-sendmail"},[a("v-row",[a("v-textarea",{attrs:{rows:"3",label:"Emails",hint:"Email addresses separated with comma or 1 per line. 10 emails max","prepend-icon":"mdi-email"},model:{value:t.notification_data.emails,callback:function(e){t.$set(t.notification_data,"emails",e)},expression:"notification_data.emails"}})],1),a("v-btn",{attrs:{color:"success"},on:{click:function(e){return t.sendEmailVuln(t.$route.params.vuln_id)}}},[t._v("Send")]),a("v-btn",{attrs:{color:"warning",type:"reset"}},[t._v("Reset")])],1)],1)],1)],1)],1),a("v-tab-item",[a("v-card",{attrs:{color:"grey lighten-5"}},[a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.exploit_headers,items:t.exploits,"item-key":"link","multi-sort":"","show-expand":"",expanded:t.expanded},on:{"update:expanded":function(e){t.expanded=e}},scopedSlots:t._u([{key:"item.scope",fn:function(e){var i=e.item;return["public"==i.scope?a("v-icon",{attrs:{color:"green"}},[t._v("mdi-lock-open-variant")]):a("v-icon",{attrs:{color:"orange darken-2"}},[t._v("mdi-lock")])]}},{key:"item.link",fn:function(e){var i=e.item;return[a("a",{attrs:{href:i.link,target:"_blank"}},[t._v(t._s(i.link))])]}},{key:"item.relevancy_level",fn:function(e){var i=e.item;return[t._l(1,(function(e){return 1==i.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"yellow"}}):t._e()})),t._l(4,(function(e){return 1==i.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six-outline",attrs:{"x-small":"",color:"grey"}}):t._e()})),t._l(2,(function(e){return 2==i.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"orange"}}):t._e()})),t._l(3,(function(e){return 2==i.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six-outline",attrs:{"x-small":"",color:"grey"}}):t._e()})),t._l(3,(function(e){return 3==i.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"orange darken-4"}}):t._e()})),t._l(2,(function(e){return 3==i.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six-outline",attrs:{"x-small":"",color:"grey"}}):t._e()})),t._l(4,(function(e){return 4==i.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"red"}}):t._e()})),t._l(1,(function(e){return 4==i.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six-outline",attrs:{"x-small":"",color:"grey"}}):t._e()})),t._l(5,(function(e){return 5==i.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"red darken-4"}}):t._e()}))]}},{key:"item.trust_level",fn:function(e){var a=e.item;return[t._v(" "+t._s(t._f("capitalize")(a.trust_level))+" ")]}},{key:"item.tlp_level",fn:function(e){var i=e.item;return[a("v-chip",{staticClass:"ma-2",attrs:{label:"",outlined:"",small:"",color:t.getTLPColor(i.tlp_level)}},[t._v(" "+t._s(t._f("capitalize")(i.tlp_level))+" ")])]}},{key:"item.modified",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.modified).format("YYYY-MM-DD")))])]}},{key:"item.action",fn:function(e){var i=e.item;return["public"!=i.scope?a("v-icon",{staticClass:"mdi mdi-pencil",attrs:{small:"",color:"orange"},on:{click:function(e){return t.loadExploit(i)}}}):t._e(),"public"!=i.scope?a("v-icon",{staticClass:"mdi mdi-delete",attrs:{small:"",color:"red"},on:{click:function(e){return t.deleteExploit(i)}}}):t._e()]}},{key:"expanded-item",fn:function(e){var i=e.headers,s=e.item;return[a("td",{attrs:{colspan:i.length}},[t._v(t._s(s.notes))])]}}])}),this.showManageMetadataButtons()?a("v-dialog",{attrs:{"max-width":"500px"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[a("v-btn",t._g({attrs:{absolute:"",dark:"",fab:"",bottom:"",left:"",color:"deep-orange"}},i),[a("v-icon",[t._v("mdi-plus")])],1)]}}],null,!1,1303381134),model:{value:t.dialog_exploit,callback:function(e){t.dialog_exploit=e},expression:"dialog_exploit"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v(t._s(t.formExploitTitle))])]),a("v-card-text",[a("v-form",{ref:"form"},[a("v-container",[a("v-row",[a("v-col",[a("v-text-field",{attrs:{label:"link"},model:{value:t.editedItem.link,callback:function(e){t.$set(t.editedItem,"link",e)},expression:"editedItem.link"}})],1)],1),a("v-row",[a("v-col",{attrs:{cols:"12",md:"6"}},[a("v-select",{attrs:{label:"Trust Level",items:t.editedItem.trust_level_items},model:{value:t.editedItem.trust_level,callback:function(e){t.$set(t.editedItem,"trust_level",e)},expression:"editedItem.trust_level"}})],1),a("v-col",{attrs:{cols:"12",md:"6"}},[a("v-select",{attrs:{label:"TLP Level",items:t.editedItem.tlp_level_items},model:{value:t.editedItem.tlp_level,callback:function(e){t.$set(t.editedItem,"tlp_level",e)},expression:"editedItem.tlp_level"}})],1)],1),a("v-row",[a("v-col",{attrs:{cols:"12",md:"6"}},[a("v-select",{attrs:{label:"Availability",items:t.editedItem.availability_items},model:{value:t.editedItem.availability,callback:function(e){t.$set(t.editedItem,"availability",e)},expression:"editedItem.availability"}})],1),a("v-col",{attrs:{cols:"12",md:"6"}},[a("v-select",{attrs:{label:"Maturity",items:t.editedItem.maturity_items},model:{value:t.editedItem.maturity,callback:function(e){t.$set(t.editedItem,"maturity",e)},expression:"editedItem.maturity"}})],1)],1),a("v-row",[a("v-col",[a("v-text-field",{attrs:{label:"Source"},model:{value:t.editedItem.source,callback:function(e){t.$set(t.editedItem,"source",e)},expression:"editedItem.source"}}),a("v-textarea",{attrs:{label:"Notes",hint:"Insert notes about this entry",rows:"3"},model:{value:t.editedItem.notes,callback:function(e){t.$set(t.editedItem,"notes",e)},expression:"editedItem.notes"}})],1)],1),a("v-text-field",{attrs:{hidden:""},model:{value:t.editedItem.type,callback:function(e){t.$set(t.editedItem,"type",e)},expression:"editedItem.type"}}),a("v-btn",{attrs:{color:"success"},on:{click:t.saveExploit}},[t._v("Save")]),a("v-btn",{attrs:{color:"warning"},on:{click:t.resetForm}},[t._v("Reset")])],1)],1)],1),a("v-card-actions",[a("v-spacer")],1)],1)],1):t._e()],1),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1),a("v-tab-item",[a("v-card",[a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.threat_headers,items:t.threats,"item-key":"id","multi-sort":"","show-expand":"",expanded:t.expanded},on:{"update:expanded":function(e){t.expanded=e}},scopedSlots:t._u([{key:"item.scope",fn:function(e){var i=e.item;return["public"==i.scope?a("v-icon",{attrs:{color:"green"}},[t._v("mdi-lock-open-variant")]):a("v-icon",{attrs:{color:"orange darken-2"}},[t._v("mdi-lock")])]}},{key:"item.link",fn:function(e){var i=e.item;return[a("a",{attrs:{href:i.link,target:"_blank"}},[t._v(t._s(i.link))])]}},{key:"item.trust_level",fn:function(e){var a=e.item;return[t._v(" "+t._s(t._f("capitalize")(a.trust_level))+" ")]}},{key:"item.tlp_level",fn:function(e){var i=e.item;return[a("v-chip",{staticClass:"ma-2",attrs:{label:"",outlined:"",small:"",color:t.getTLPColor(i.tlp_level)}},[t._v(" "+t._s(t._f("capitalize")(i.tlp_level))+" ")])]}},{key:"item.modified",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.modified).format("YYYY-MM-DD")))])]}},{key:"item.action",fn:function(e){var i=e.item;return["public"!=i.scope?a("v-icon",{staticClass:"mdi mdi-pencil",attrs:{small:"",color:"orange"},on:{click:function(e){return t.loadThreat(i)}}}):t._e(),"public"!=i.scope?a("v-icon",{staticClass:"mdi mdi-delete",attrs:{small:"",color:"red"},on:{click:function(e){return t.deleteThreat(i)}}}):t._e()]}},{key:"expanded-item",fn:function(e){var i=e.headers,s=e.item;return[a("td",{attrs:{colspan:i.length}},[t._v(t._s(s.notes))])]}}])}),this.showManageMetadataButtons()?a("v-dialog",{attrs:{"max-width":"500px"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[a("v-btn",t._g({attrs:{absolute:"",dark:"",fab:"",bottom:"",left:"",color:"deep-orange"}},i),[a("v-icon",[t._v("mdi-plus")])],1)]}}],null,!1,1303381134),model:{value:t.dialog_threat,callback:function(e){t.dialog_threat=e},expression:"dialog_threat"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v(t._s(t.formThreatTitle))])]),a("v-card-text",[a("v-form",{ref:"form-new-threat"},[a("v-container",[a("v-row",[a("v-col",[a("v-text-field",{attrs:{label:"link"},model:{value:t.editedItem.link,callback:function(e){t.$set(t.editedItem,"link",e)},expression:"editedItem.link"}})],1)],1),a("v-row",[a("v-col",{attrs:{cols:"12",md:"6"}},[a("v-select",{attrs:{label:"Trust Level",items:t.editedItem.trust_level_items},model:{value:t.editedItem.trust_level,callback:function(e){t.$set(t.editedItem,"trust_level",e)},expression:"editedItem.trust_level"}})],1),a("v-col",{attrs:{cols:"12",md:"6"}},[a("v-select",{attrs:{label:"TLP Level",items:t.editedItem.tlp_level_items},model:{value:t.editedItem.tlp_level,callback:function(e){t.$set(t.editedItem,"tlp_level",e)},expression:"editedItem.tlp_level"}})],1)],1),a("v-row",[a("v-col",{attrs:{cols:"12",md:"6"}},[a("v-select",{attrs:{label:"In the News?",items:t.editedItem.is_in_the_news_items,"item-text":"text","item-value":"value"},model:{value:t.editedItem.is_in_the_news,callback:function(e){t.$set(t.editedItem,"is_in_the_news",e)},expression:"editedItem.is_in_the_news"}})],1),a("v-col",{attrs:{cols:"12",md:"6"}},[a("v-select",{attrs:{label:"In The Wild",items:t.editedItem.is_in_the_wild_items},model:{value:t.editedItem.is_in_the_wild,callback:function(e){t.$set(t.editedItem,"is_in_the_wild",e)},expression:"editedItem.is_in_the_wild"}})],1)],1),a("v-row",[a("v-col",[a("v-text-field",{attrs:{label:"Source"},model:{value:t.editedItem.source,callback:function(e){t.$set(t.editedItem,"source",e)},expression:"editedItem.source"}}),a("v-textarea",{attrs:{label:"Notes",hint:"Insert notes about this entry",rows:"3"},model:{value:t.editedItem.notes,callback:function(e){t.$set(t.editedItem,"notes",e)},expression:"editedItem.notes"}})],1)],1),a("v-btn",{attrs:{color:"success"},on:{click:t.saveThreat}},[t._v("Save")]),a("v-btn",{attrs:{color:"warning",type:"reset"}},[t._v("Reset")])],1)],1)],1),a("v-card-actions",[a("v-spacer")],1)],1)],1):t._e()],1),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1),a("v-tab-item",[this.history?a("v-card",{attrs:{color:"grey lighten-5"}},[this.history.length>0?a("v-timeline",{attrs:{clipped:"",dense:""}},t._l(this.history,(function(e){return a("v-timeline-item",{attrs:{color:"blue",small:"","fill-dot":""}},[a("v-card",{staticClass:"elevation-2"},[a("v-card-title",{staticClass:"headline"},[t._v(t._s(e.reason)+" at '"+t._s(e.date)+"'")]),a("v-card-text",t._l(e.changes,(function(e){return a("span",[t._v(t._s(e)),a("br")])})),0)],1)],1)})),1):t._e()],1):t._e()],1)],1)},oa=[],ra=(a("9911"),{name:"VulnDetails",mixins:[oe,pt,Ie],components:{VulnAddEdit:ta},data:function(){return{expanded:[],vuln_id:"",vuln:{cwe_id:"UNKWNOWN",cwe_refs:{},impact:{confidentiality:"",integrity:"",availability:""},access:{authentication:"",complexity:"",vector:""},reflinks:[],vulnerable_products:[]},ratings:{score:0,cvssv2adj:0},history:[],threats:[],threat_headers:[{text:"Scope",value:"scope"},{text:"Link",value:"link"},{text:"Trust level",value:"trust_level"},{text:"TLP",value:"tlp_level",align:"center"},{text:"Source",value:"source",align:"center"},{text:"In the Wild ?",value:"is_in_the_wild",align:"center"},{text:"In the News ?",value:"is_in_the_news",align:"center"},{text:"Last update",value:"modified",align:"center"},{text:"Actions",value:"action",sortable:!1}],exploits:[],exploit_headers:[{text:"Scope",value:"scope"},{text:"Link",value:"link"},{text:"TLP",value:"tlp_level",align:"center"},{text:"Relevancy",value:"relevancy_level"},{text:"Trust",value:"trust_level"},{text:"Source",value:"source",align:"center"},{text:"Last update",value:"modified",align:"center"},{text:"Actions",value:"action",sortable:!1},{text:"",value:"data-table-expand"}],editedIndex:-1,defaultMetadata:{id:"",link:"https://",notes:"",trust_level:"high",trust_level_items:["unknown","low","medium","high"],tlp_level:"white",tlp_level_items:["white","green","amber","red","black"],source:"manual",availability:"public",availability_items:["unknown","private","public"],maturity:"unknown",maturity_items:["unknown","unproven","poc","functional"],modified:"",is_in_the_wild:0,is_in_the_wild_items:[{text:"Yes",value:1},{text:"No",value:0}],is_in_the_news:0,is_in_the_news_items:[{text:"Yes",value:1},{text:"No",value:0}],published:""},editedItem:{},dialog_exploit:!1,dialog_threat:!1,dialog_editvuln:!1,dialog_sendmail:!1,notification_data:{emails:""},snack:!1,snackColor:"",snackText:""}},beforeRouteUpdate:function(t){this.vuln_id=t.params.vuln_id},mounted:function(){this.vuln_id=this.$router.currentRoute.params.vuln_id,this.editedItem=this.defaultMetadata,this.getDataFromApi(this.vuln_id)},computed:{formExploitTitle:function(){return-1===this.editedIndex?"New Exploit":"Edit Exploit"},formThreatTitle:function(){return-1===this.editedIndex?"New threat activity":"Edit threat activity"},is_exploitable:function(){return this.vuln.is_exploitable},is_confirmed:function(){return this.vuln.is_confirmed},is_in_the_news:function(){return this.vuln.is_in_the_news},is_in_the_wild:function(){return this.vuln.is_in_the_wild},vprating:function(){return this.ratings.score},cvssv2adj:function(){return this.ratings.cvssv2adj},vuln_vector:function(){var t="";t+=this.vuln.cvss_vector,this.vuln.is_confirmed&&(t+="/CL:Y"),qt()(this.vuln.published).isValid()&&(t+="/VX:"+qt()().diff(qt()(this.vuln.published),"days"));for(var e,a,i,s=["unknown","private","public"],n=["X","R","U"],o=["unknown","unproven","poc","functional"],r=["X","U","P","F"],l=["unknown","low","medium","high","trusted"],c=["X","L","M","H","H"],d=0,u=0,v=0,m=0,p=0;p<this.exploits.length;p++)e=s.indexOf(this.exploits[p].availability),e>d&&(d=e),a=o.indexOf(this.exploits[p].maturity),a>u&&(u=a),i=l.indexOf(this.exploits[p].trust_level),i>v&&(v=i),qt()(this.exploits[p].published).isValid()&&qt()().diff(qt()(this.exploits[p].published),"days")>m&&(m=qt()().diff(qt()(this.exploits[p].published),"days"));return t+="/EA:"+n[d],t+="/EM:"+r[u],t+="/ET:"+c[v],t+="/EX:"+m,this.is_in_the_news&&(t+="/N:Y"),this.is_in_the_wild&&(t+="/W:Y"),t}},methods:{getDataFromApi:function(t){var e=this;return new Promise((function(a,i){var s=e.getVulnDetails(t),n=e.getHistory(t),o=e.getRatings(t),r=e.getExploits(t),l=e.getThreats(t);setTimeout((function(){e.loading=!1,a({vuln:s,history:n,ratings:o,exploits:r,threats:l})}),300)}))},getVulnDetails:function(t){var e=this;this.loading=!0,this.$api.get("/api/vulns/"+t+"/").then((function(t){return e.vuln=t.data,e.vuln})).catch((function(t){e.vuln={},e.loading=!1,y.a.fire({title:"Error",text:"unable to get vuln details",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1},getRatings:function(t){var e=this;this.loading=!0,this.$api.get("/api/ratings/calc/"+t).then((function(t){return e.ratings=t.data,e.vuln})).catch((function(t){e.ratings={},e.loading=!1,y.a.fire({title:"Error",text:"unable to get vuln ratings",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1},getExploits:function(t){var e=this;this.loading=!0,this.$api.get("/api/vulns/"+t+"/exploits").then((function(t){return t&&200===t.status&&(e.exploits=t.data),e.exploits})).catch((function(t){e.exploits={},e.loading=!1,y.a.fire({title:"Error",text:"unable to get related exploits",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1},getThreats:function(t){var e=this;this.loading=!0,this.$api.get("/api/vulns/"+t+"/threats").then((function(t){return t&&200===t.status&&(e.threats=t.data),e.threats})).catch((function(t){e.threats={},e.loading=!1,y.a.fire({title:"Error",text:"unable to get related threats",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1},getHistory:function(t){var e=this;this.loading=!0,this.$api.get("/api/vulns/"+t+"/history").then((function(t){return e.history=t.data,e.history})).catch((function(t){e.history={},e.loading=!1,y.a.fire({title:"Error",text:"unable to get vuln history",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1},downloadVuln:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"json";this.$api.get("/api/vulns/"+t+"/export/"+a,{responseType:"arraybuffer"}).then((function(i){e.forceFileDownload(i,"vuln_export_"+t+"."+a),e.snack=!0,e.snackColor="success",e.snackText="Vulnerability details available."})).catch((function(t){e.snack=!0,e.snackColor="error",e.snackText="Unable to download vulnerability details."})),this.loading=!1},sendEmailVuln:function(t){var e=this;this.$api.post("/api/vulns/"+t+"/export/email",this.notification_data).then((function(t){e.snack=!0,e.snackColor="success",e.snackText="Vulnerability details successfuly sent by mail."})).catch((function(t){e.snack=!0,e.snackColor="error",e.snackText="Unable to send vulnerability details."})),this.dialog_sendmail=!1},saveExploit:function(){var t=this;if(this.editedItem.modified=new Date,-1===this.editedIndex?this.$api.post("/api/vulns/"+this.vuln_id+"/exploits/add",this.editedItem).then((function(e){e&&200===e.status?(t.snack=!0,t.snackColor="success",t.snackText="Exploit successfuly saved."):(t.snack=!0,t.snackColor="error",t.snackText="Unable to save the exploit metadata.")})).catch((function(e){t.loading=!1,y.a.fire({title:"Error",text:"Unable to save related exploits",showConfirmButton:!1,showCloseButton:!1,timer:3e3}),t.dialog_exploit=!1,t.editedItem=t.defaultMetadata})):this.$api.post("/api/vulns/"+this.vuln_id+"/exploits/edit",this.editedItem).then((function(e){e&&200===e.status?(t.snack=!0,t.snackColor="success",t.snackText="Exploit successfuly saved."):(t.snack=!0,t.snackColor="error",t.snackText="Unable to save the exploit metadata.")})).catch((function(e){t.loading=!1,y.a.fire({title:"Error",text:"unable to save related exploits",showConfirmButton:!1,showCloseButton:!1,timer:3e3}),t.dialog_exploit=!1,t.editedItem=t.defaultMetadata,t.snackColor="error"})),"success"===this.snackColor){var e=JSON.parse(JSON.stringify(this.editedItem));this.editedIndex>-1?Object.assign(this.exploits[this.editedIndex],e):this.exploits.push(e),this.editedItem=JSON.parse(JSON.stringify(this.defaultMetadata))}this.dialog_exploit=!1},loadExploit:function(t){this.editedIndex=this.exploits.indexOf(t),this.editedItem=Object.assign({},this.defaultMetadata),this.editedItem.id=t.id,this.editedItem.availability=t.availability,this.editedItem.link=t.link,this.editedItem.maturity=t.maturity,this.editedItem.notes=t.notes,this.editedItem.source=t.source,this.editedItem.tlp_level=t.tlp_level,this.editedItem.trust_level=t.trust_level,this.dialog_exploit=!0},deleteExploit:function(t){var e=this;this.$api.get("/api/vulns/"+this.vuln_id+"/exploits/"+t.id+"/del").then((function(t){t?(e.snack=!0,e.snackColor="success",e.snackText="Exploit successfuly deleted."):(e.snack=!0,e.snackColor="error",e.snackText="Unable to delete the exploit")})).catch((function(t){e.loading=!1,y.a.fire({title:"Error",text:"unable to delete related exploit",showConfirmButton:!1,showCloseButton:!1,timer:3e3}),e.dialog_exploit=!1})),this.editedIndex=this.exploits.indexOf(t),this.exploits.splice(this.editedIndex,1)},saveThreat:function(){var t=this;this.editedItem.modified=new Date,-1===this.editedIndex?this.$api.post("/api/vulns/"+this.vuln_id+"/threats/add",this.editedItem).then((function(e){if(!e||200!==e.status)return t.snack=!0,t.snackColor="error",void(t.snackText="Unable to save the threat activity.");t.snack=!0,t.snackColor="success",t.snackText="Threat activity successfuly saved."})).catch((function(e){t.loading=!1,y.a.fire({title:"Error",text:"unable to save related threat activity",showConfirmButton:!1,showCloseButton:!1,timer:3e3}),t.dialog_threat=!1})):this.$api.post("/api/vulns/"+this.vuln_id+"/threats/edit",this.editedItem).then((function(e){if(!e||200!==e.status)return t.snack=!0,t.snackColor="error",void(t.snackText="Unable to save the threat activity.");t.snack=!0,t.snackColor="success",t.snackText="Threat activity successfuly saved."})).catch((function(e){t.loading=!1,y.a.fire({title:"Error",text:"unable to save related threat activity",showConfirmButton:!1,showCloseButton:!1,timer:3e3}),t.dialog_threat=!1}));var e=JSON.parse(JSON.stringify(this.editedItem));this.editedIndex>-1?Object.assign(this.threats[this.editedIndex],e):this.threats.push(e),this.editedItem=JSON.parse(JSON.stringify(this.defaultMetadata)),this.dialog_threat=!1},loadThreat:function(t){this.editedIndex=this.threats.indexOf(t),this.editedItem=Object.assign({},this.defaultMetadata),this.editedItem.id=t.id,this.editedItem.link=t.link,this.editedItem.notes=t.notes,this.editedItem.source=t.source,this.editedItem.tlp_level=t.tlp_level,this.editedItem.trust_level=t.trust_level,this.editedItem.is_in_the_news=0==t.is_in_the_news?0:1,this.editedItem.is_in_the_wild=0==t.is_in_the_wild?0:1,this.dialog_threat=!0},deleteThreat:function(t){var e=this;this.$api.get("/api/vulns/"+this.vuln_id+"/threats/"+t.id+"/del").then((function(t){t?(e.snack=!0,e.snackColor="success",e.snackText="Threat activity successfuly deleted."):(e.snack=!0,e.snackColor="error",e.snackText="Unable to delete the threat activity")})).catch((function(t){e.loading=!1,y.a.fire({title:"Error",text:"unable to delete related threat activity",showConfirmButton:!1,showCloseButton:!1,timer:3e3}),e.dialog_threat=!1})),this.editedIndex=this.threats.indexOf(t),this.threats.splice(this.editedIndex,1)},resetForm:function(){this.$refs.form.reset(),this.editedItem=this.defaultMetadata},viewRating:function(){this.$router.push({name:"Ratings",query:{vector:this.vuln_vector}})},toggleMonitored:function(t){var e=this,a={monitored:!this.vuln.monitored,vuln_id:this.vuln.id,organization_id:localStorage.getItem("org_id")};this.$api.put("/api/vulns/"+this.vuln_id+"/toggle",a).then((function(t){t?(e.vuln.monitored=!e.vuln.monitored,e.snack=!0,e.snackColor="success",e.snackText="Vulnerability monitoring successfuly updated."):(e.snack=!0,e.snackColor="error",e.snackText="Unable to change the vulnerability monitoring status")})).catch((function(t){e.loading=!1,y.a.fire({title:"Error",text:"Unable to change the vulnerability monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))},toggleMetric:function(t){this.snack=!0,this.snackColor="error",this.snackText="Unable to change the metrics - Insufficient privileges"},showManageMetadataButtons:function(){var t=JSON.parse(this.getUserProfile());return null==t||!("manage_metadata"in t)||t.manage_metadata}}}),la=ra,ca=(a("55e7"),a("8414")),da=a("1e06"),ua=Object(l["a"])(la,na,oa,!1,null,null,null),va=ua.exports;d()(ua,{VBadge:Re["a"],VBtn:V["a"],VCard:I["a"],VCardActions:T["b"],VCardText:T["d"],VCardTitle:T["e"],VChip:wt["a"],VCol:Zt["a"],VContainer:S["a"],VDataTable:Dt["a"],VDialog:Ot["a"],VFlex:E["a"],VForm:$["a"],VIcon:Q["a"],VLayout:A["a"],VList:tt["a"],VListItem:at["a"],VListItemContent:st["g"],VListItemSubtitle:st["j"],VRow:te["a"],VSelect:Be["a"],VSnackbar:Vt["a"],VSpacer:D["a"],VSwitch:ee["a"],VTab:fe["a"],VTabItem:be["a"],VTabs:ke["a"],VTextField:O["a"],VTextarea:xe["a"],VTimeline:ca["a"],VTimelineItem:da["a"]});var ma=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-card",[a("v-card-title",[t._v(" Exploits metadata "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers,items:t.exploits.results,options:t.options,"server-items-length":t.exploits.count,search:t.search,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"id"},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.vp",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.getVendorProduct(i.vp)))])]}},{key:"item.updated_at",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.updated_at).format("YYYY-MM-DD")))])]}},{key:"item.action",fn:function(e){var i=e.item;return[a("v-icon",{staticClass:"mdi mdi-eye",attrs:{small:"",color:"blue"},on:{click:function(e){return t.viewVuln(i.vuln_id)}}})]}}])}),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1)},pa=[],_a=(a("6062"),a("5319"),a("b85c")),ha={name:"exploits",data:function(){return{exploits:[],loading:!0,limit:20,only_monitored:!1,search:"",options:{},selected:[],headers:[{text:"Link",value:"link"},{text:"Products",value:"vp",sortable:!1},{text:"Last update",value:"updated_at"},{text:"Actions",value:"action",sortable:!1}],rowsPerPageItems:[5,10,20,50,100],snack:!1,snackColor:"",snackText:""}},watch:{search:bt.a.debounce((function(t){this.search=t,this.options.page=1,this.getDataFromApi()}),500),only_monitored:{handler:function(){this.getDataFromApi()},deep:!0},options:{handler:function(){this.getDataFromApi()},deep:!0}},methods:{getDataFromApi:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var i=t.options,s=i.sortBy,n=i.sortDesc,o=i.page,r=i.itemsPerPage;t.limit=r;var l=t.getExploits(o,t.limit,s,n);setTimeout((function(){e({items:l})}),300)}))},getExploits:function(t,e,a,i){var s=this,n="";a.length>0&&(n=!0===i[0]?"&sorted_by=-"+a:"&sorted_by="+a),this.$api.get("/api/exploits?limit="+e+"&page="+t+"&search="+this.search+n).then((function(t){return s.loading=!1,s.exploits=t.data,s.exploits})).catch((function(t){s.exploits=[],y.a.fire({title:"Error",text:"Unable to get exploits",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))},viewVuln:function(t){this.$router.push({name:"VulnDetails",params:{vuln_id:t}})},getVendorProduct:function(t){if(null==t)return"";var e,a,i,s=Array(),n=Object(_a["a"])(t);try{for(n.s();!(i=n.n()).done;)e=i.value,a=e.split(":")[4].replace(/_/g," ")+" ("+e.split(":")[3].replace(/_/g," ")+")",s.push(a)}catch(o){n.e(o)}finally{n.f()}return s=Object(gt["a"])(new Set(s)),s.join(", ")}}},ga=ha,fa=Object(l["a"])(ga,ma,pa,!1,null,null,null),ba=fa.exports;d()(fa,{VBtn:V["a"],VCard:I["a"],VCardTitle:T["e"],VDataTable:Dt["a"],VIcon:Q["a"],VSnackbar:Vt["a"],VSpacer:D["a"],VTextField:O["a"]});var ka=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[!0===t.loading?a("div",{staticClass:"loading"},[t._v("Loadingâ¦")]):t._e(),a("v-card",[a("v-card-title",[t._v(" Vendors "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers,items:t.vendors.results,options:t.options,"server-items-length":t.vendors.count,search:t.search,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"vendor","show-select":""},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.actions",fn:function(e){var i=e.item;return[a("v-icon",{staticClass:"mdi mdi-eye",attrs:{small:"",color:"blue"},on:{click:function(e){return t.viewProducts(i.vendor)}}})]}},{key:"item.monitored",fn:function(e){var i=e.item;return[i.monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:function(e){return t.toggleMonitored(i)}}},[t._v("Yes")]):t._e(),i.monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:function(e){return t.toggleMonitored(i)}}},[t._v("No")])]}}])}),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1)},xa=[],ya={name:"vendors",data:function(){return{vendors:[],totalvendors:0,loading:!0,limit:20,search:"",options:{},selected:[],headers:[{text:"Vendor",value:"vendor"},{text:"Actions",value:"actions"}],rowsPerPageItems:[5,10,20,50,100]}},mounted:function(){},watch:{search:{handler:function(t){this.search=t,this.options.page=1,this.getDataFromApi().then((function(t){}))},deep:!0},options:{handler:function(){this.getDataFromApi().then((function(t){}))},deep:!0}},methods:{getDataFromApi:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var i=t.options,s=i.sortBy,n=i.sortDesc,o=i.page,r=i.itemsPerPage;t.search.trim().toLowerCase();t.limit=r;var l=t.getvendors(o,t.limit,s,n);setTimeout((function(){t.loading=!1,e({items:l})}),300)}))},getvendors:function(t,e,a,i){var s=this;this.loading=!0;var n="";a.length>0&&(n=!0===i[0]?"sorted_by=-"+a:"sorted_by="+a),this.$api.get("/api/kb/vendors?limit="+e+"&page="+t+"&vendor__icontains="+this.search+"&"+n).then((function(t){return s.vendors=t.data,s.vendors})).catch((function(t){s.vendors=[],s.loading=!1,y.a.fire({title:"Error",text:"unable to get vendors",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1},viewProducts:function(t){this.$router.push({name:"KBProductVersions",params:{vendor_name:t}})}}},wa=ya,Ca=Object(l["a"])(wa,ka,xa,!1,null,null,null);Ca.exports;d()(Ca,{VBtn:V["a"],VCard:I["a"],VCardTitle:T["e"],VChip:wt["a"],VDataTable:Dt["a"],VIcon:Q["a"],VSnackbar:Vt["a"],VSpacer:D["a"],VTextField:O["a"]});var Va=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-card",[a("v-card-title",[a("v-container",[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"pa-2",attrs:{md:"auto"}},[t._v(" Products ")]),a("v-col",{staticClass:"pa-2"},[this.only_monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:t.toggleProductMonitored}},[t._v("Show all")]):t._e(),this.only_monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:t.toggleProductMonitored}},[t._v("Show monitored only")])],1),a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)],1),a("v-spacer")],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers,items:t.products.results,options:t.options,"server-items-length":t.products.count,search:t.search,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"items-per-page":t.rowsPerPage,"item-key":"item","show-select":""},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.monitored",fn:function(e){var i=e.item;return[i.monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:function(e){return t.toggleMonitored(i)}}},[t._v("Yes")]):t._e(),i.monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:function(e){return t.toggleMonitored(i)}}},[t._v("No")])]}},{key:"item.updated_at",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.updated_at).format("YYYY-MM-DD")))])]}},{key:"item.action",fn:function(e){var i=e.item;return[a("v-icon",{staticClass:"mdi mdi-eye",attrs:{small:"",color:"blue"},on:{click:function(e){return t.viewProduct(i.id)}}})]}}])}),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1)},Ia=[],Ta={name:"products",data:function(){return{products:[],loading:!0,limit:20,totalproducts:0,only_monitored:!1,search:"",options:{},selected:[],headers:[{text:"Vendor",value:"vendor"},{text:"Product",value:"name"},{text:"Monitored",value:"monitored",align:"center",sortable:!1},{text:"Last update",value:"updated_at"},{text:"Actions",value:"action",sortable:!1}],rowsPerPageItems:[5,10,20,50,100],rowsPerPage:10,snack:!1,snackColor:"",snackText:""}},mounted:function(){},watch:{search:bt.a.debounce((function(t){this.search=t,this.options.page=1,this.getDataFromApi()}),500),only_monitored:{handler:function(){this.getDataFromApi()},deep:!0},options:{handler:function(){this.getDataFromApi()},deep:!0}},methods:{getDataFromApi:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var i=t.options,s=i.sortBy,n=i.sortDesc,o=i.page,r=i.itemsPerPage;t.limit=r;var l=t.getProducts(o,t.limit,s,n);setTimeout((function(){e({items:l})}),300)}))},getProducts:function(t,e,a,i){var s=this,n="";a.length>0&&(n=!0===i[0]?"&sorted_by=-"+a:"&sorted_by="+a);var o=this.only_monitored?"&monitored=true":"";this.$api.get("/api/kb/products/?limit="+e+"&page="+t+"&search="+this.search+n+o).then((function(t){return s.loading=!1,s.products=t.data,s.products})).catch((function(t){s.products=[],y.a.fire({title:"Error",text:"unable to get products",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))},toggleMonitored:function(t){var e=this,a={vendor_name:t.vendor,product_name:t.name,monitored:!t.monitored,organization_id:localStorage.getItem("org_id")};this.$api.post("/api/monitor/product/toggle",a).then((function(a){e.loading=!1,a?(t.monitored=!t.monitored,e.snack=!0,e.snackColor="success",e.snackText="Monitoring status successfuly updated."):(e.snack=!0,e.snackColor="error",e.snackText="Unable to change the monitoring status")})).catch((function(t){e.loading=!1,y.a.fire({title:"Error",text:"Unable to change the monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:2e3})}))},toggleProductMonitored:function(){this.only_monitored=!this.only_monitored},viewProduct:function(t){this.$router.push({path:"/product/"+t})}}},Pa=Ta,Sa=Object(l["a"])(Pa,Va,Ia,!1,null,null,null),Ea=Sa.exports;d()(Sa,{VBtn:V["a"],VCard:I["a"],VCardTitle:T["e"],VChip:wt["a"],VCol:Zt["a"],VContainer:S["a"],VDataTable:Dt["a"],VIcon:Q["a"],VRow:te["a"],VSnackbar:Vt["a"],VSpacer:D["a"],VTextField:O["a"]});var $a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-tabs",{attrs:{left:"","background-color":"white",color:"deep-orange accent-4"}},[a("v-tab",[t._v("Vendors")]),a("v-tab",[t._v("Products")]),a("v-tab",[t._v("Packages")]),a("v-tab",[t._v("Vulns")]),a("v-tab-item",[a("v-card",[a("v-card-title",[a("v-container",[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"pa-2 mr-4",attrs:{md:"auto"}},[t._v(" Monitored Vendors "),a("v-menu",{attrs:{bottom:"",right:"","offset-x":!0},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[a("v-btn",t._g(t._b({attrs:{icon:"",outlined:"","x-small":"",color:"deep-orange"}},"v-btn",s,!1),i),[a("v-icon",[t._v("mdi-dots-horizontal")])],1)]}}])},[a("v-list",[a("v-list-item",{on:{click:function(e){return t.goToPage("/vendors")}}},[a("v-list-item-title",[t._v("Add new vendors")])],1),a("v-list-item",[a("v-list-item-title",[a("input",{attrs:{type:"button",id:"import_monitored",value:"Import monitored",onclick:"document.getElementById('file').click();"}}),a("input",{ref:"upload",staticStyle:{display:"none"},attrs:{id:"file",type:"file",name:"file-upload",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"},on:{change:t.onImportFileChange}})])],1),a("v-list-item",{on:{click:function(e){return t.exportMonitored("vendors")}}},[a("v-list-item-title",[t._v("Export monitored Vendors")])],1),a("v-list-item",{on:{click:function(e){return t.exportMonitored("all")}}},[a("v-list-item-title",[t._v("Export all monitored")])],1)],1)],1)],1),a("v-text-field",{staticClass:"pt-0",attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":"",md:"6"},model:{value:t.search_vendors,callback:function(e){t.search_vendors=e},expression:"search_vendors"}})],1)],1),a("v-spacer")],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers_vendors,items:t.vendors.results,options:t.options_vendors,"server-items-length":t.vendors.count,search:t.search_vendors,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"items-per-page":t.rowsPerPage,"item-key":"name","show-select":""},on:{"update:options":function(e){t.options_vendors=e}},scopedSlots:t._u([{key:"item.products_count",fn:function(e){var i=e.item;return[a("v-chip",{attrs:{small:"",color:"lightgrey"}},[t._v(t._s(i.products_count))])]}},{key:"item.updated_at",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.updated_at).format("YYYY-MM-DD")))])]}},{key:"item.action",fn:function(e){var i=e.item;return[a("v-icon",{staticClass:"mdi mdi-eye",attrs:{small:"",color:"blue"},on:{click:function(e){return t.viewVendor(i.id)}}})]}}])}),a("v-btn",{attrs:{absolute:"",dark:"",fab:"",bottom:"",left:"",color:"deep-orange"},on:{click:function(e){return t.goToPage("/vendors")}}},[a("v-icon",[t._v("mdi-plus")])],1),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1),a("v-tab-item",[a("v-card",[a("v-card-title",[a("v-container",[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"pa-2 mr-4",attrs:{md:"auto"}},[t._v(" Monitored Products "),a("v-menu",{attrs:{bottom:"",right:"","offset-x":!0},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[a("v-btn",t._g(t._b({attrs:{icon:"",outlined:"","x-small":"",color:"deep-orange"}},"v-btn",s,!1),i),[a("v-icon",[t._v("mdi-dots-horizontal")])],1)]}}])},[a("v-list",[a("v-list-item",{on:{click:function(e){return t.goToPage("/vendors")}}},[a("v-list-item-title",[t._v("Add new product(s)")])],1),a("v-list-item",[a("v-list-item-title",[a("input",{attrs:{type:"button",id:"import_monitored",value:"Import monitored",onclick:"document.getElementById('file').click();"}}),a("input",{ref:"upload",staticStyle:{display:"none"},attrs:{id:"file",type:"file",name:"file-upload",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"},on:{change:t.onImportFileChange}})])],1),a("v-list-item",{on:{click:function(e){return t.exportMonitored("products")}}},[a("v-list-item-title",[t._v("Export monitored Products")])],1),a("v-list-item",{on:{click:function(e){return t.exportMonitored("all")}}},[a("v-list-item-title",[t._v("Export all monitored")])],1)],1)],1)],1),a("v-text-field",{staticClass:"pt-0",attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search_products,callback:function(e){t.search_products=e},expression:"search_products"}})],1)],1),a("v-spacer")],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers_products,items:t.products.results,options:t.options_products,"server-items-length":t.products.count,search:t.search_products,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"items-per-page":t.rowsPerPage,"item-key":"id","show-select":""},on:{"update:options":function(e){t.options_products=e}},scopedSlots:t._u([{key:"item.updated_at",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.updated_at).format("YYYY-MM-DD")))])]}},{key:"item.action",fn:function(e){var i=e.item;return[a("v-icon",{staticClass:"mdi mdi-eye",attrs:{small:"",color:"blue"},on:{click:function(e){return t.viewProduct(i.id)}}})]}}])}),a("v-btn",{attrs:{absolute:"",dark:"",fab:"",bottom:"",left:"",color:"deep-orange"},on:{click:function(e){return t.goToPage("/vendors")}}},[a("v-icon",[t._v("mdi-plus")])],1),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1),a("v-tab-item",[a("v-card",[a("v-card-title",[a("v-container",[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"pa-2 mr-4",attrs:{md:"auto"}},[t._v(" Monitored Packages "),a("v-menu",{attrs:{bottom:"",right:"","offset-x":!0},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[a("v-btn",t._g(t._b({attrs:{icon:"",outlined:"","x-small":"",color:"deep-orange"}},"v-btn",s,!1),i),[a("v-icon",[t._v("mdi-dots-horizontal")])],1)]}}])},[a("v-list",[a("v-list-item",{on:{click:function(e){return t.goToPage("/packages")}}},[a("v-list-item-title",[t._v("Add new package(s)")])],1),a("v-list-item",[a("v-list-item-title",[a("input",{attrs:{type:"button",id:"import_monitored",value:"Import monitored",onclick:"document.getElementById('file').click();"}}),a("input",{ref:"upload",staticStyle:{display:"none"},attrs:{id:"file",type:"file",name:"file-upload",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"},on:{change:t.onImportFileChange}})])],1),a("v-list-item",{on:{click:function(e){return t.exportMonitored("packages")}}},[a("v-list-item-title",[t._v("Export monitored Packages")])],1),a("v-list-item",{on:{click:function(e){return t.exportMonitored("all")}}},[a("v-list-item-title",[t._v("Export all monitored")])],1)],1)],1)],1),a("v-text-field",{staticClass:"pt-0",attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search_packages,callback:function(e){t.search_packages=e},expression:"search_packages"}})],1)],1),a("v-spacer")],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers_packages,items:t.packages.results,options:t.options_packages,"server-items-length":t.packages.count,search:t.search_packages,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"items-per-page":t.rowsPerPage,"item-key":"id","show-select":""},on:{"update:options":function(e){t.options_packages=e}},scopedSlots:t._u([{key:"item.updated_at",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.updated_at).format("YYYY-MM-DD")))])]}},{key:"item.action",fn:function(e){var i=e.item;return[a("v-icon",{staticClass:"mdi mdi-eye",attrs:{small:"",color:"blue"},on:{click:function(e){return t.viewPackage(i.id)}}})]}}])}),a("v-btn",{attrs:{absolute:"",dark:"",fab:"",bottom:"",left:"",color:"deep-orange"},on:{click:function(e){return t.goToPage("/packages")}}},[a("v-icon",[t._v("mdi-plus")])],1),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1),a("v-tab-item",[a("v-card",[a("v-card-title",[a("v-container",[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"pa-2 mr-4",attrs:{md:"auto"}},[t._v(" Monitored Vulns "),a("v-menu",{attrs:{bottom:"",right:"","offset-x":!0},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[a("v-btn",t._g(t._b({attrs:{icon:"",outlined:"","x-small":"",color:"deep-orange"}},"v-btn",s,!1),i),[a("v-icon",[t._v("mdi-dots-horizontal")])],1)]}}])},[a("v-list",[a("v-list-item",{on:{click:function(e){return t.goToPage("/vulns")}}},[a("v-list-item-title",[t._v("Add new vuln(s)")])],1),a("v-list-item",[a("v-list-item-title",[a("input",{attrs:{type:"button",id:"import_monitored",value:"Import monitored",onclick:"document.getElementById('file').click();"}}),a("input",{ref:"upload",staticStyle:{display:"none"},attrs:{id:"file",type:"file",name:"file-upload",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"},on:{change:t.onImportFileChange}})])],1),a("v-list-item",{on:{click:function(e){return t.exportMonitored("vulns")}}},[a("v-list-item-title",[t._v("Export monitored Vulns")])],1),a("v-list-item",{on:{click:function(e){return t.exportMonitored("all")}}},[a("v-list-item-title",[t._v("Export all monitored")])],1)],1)],1)],1),a("v-text-field",{staticClass:"pt-0",attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search_vulns,callback:function(e){t.search_vulns=e},expression:"search_vulns"}})],1)],1),a("v-spacer")],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers_vulns,items:t.vulns.results,options:t.options_vulns,"server-items-length":t.vulns.count,search:t.search_vulns,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"items-per-page":t.rowsPerPage,"item-key":"item","show-select":""},on:{"update:options":function(e){t.options_vulns=e}},scopedSlots:t._u([{key:"item.score",fn:function(e){var i=e.item;return[a("v-chip",{staticClass:"text-center font-weight-bold",attrs:{color:t.getRatingColor(i.score),label:""}},[t._v(t._s(i.score)+"/100")]),a("br"),a("span",{staticClass:"text-caption"},[t._v("CVSSv2: "+t._s(i.cvss))])]}},{key:"item.summary",fn:function(e){var i=e.item;return[a("div",{staticClass:"py-2"},[a("div",{staticClass:"pb-2"},[a("span",{staticClass:"deep-orange--text font-weight-medium"},[t._v(t._s(i.cveid))]),t._v(" / PH-"+t._s(i.id)+" "),a("v-btn",{attrs:{color:"deep-orange",icon:"",small:""}},[a("v-icon",{attrs:{title:"View details"},on:{click:function(e){return t.viewVuln(i.id)}}},[t._v("mdi-arrow-right-bold-circle-outline")])],1)],1),a("div",[t._v(" "+t._s(i.summary)+" ")]),t._l(i.products,(function(e){return a("v-chip",{key:e.id,staticClass:"vendor-chip",attrs:{label:"",small:"",link:""},on:{click:function(a){return t.$router.push({path:"/product/"+e.id})}}},[t._v(" "+t._s(e.vendor)+": "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(e.name))])])}))],2)]}},{key:"item.metadata",fn:function(e){var i=e.item;return[a("v-chip",{staticClass:"font-weight-bold",attrs:{label:"",link:"",small:"",color:i.exploit_count>0?"deep-orange":"grey",title:"Is exploitable?"}},[t._v(t._s(i.exploit_count))]),a("v-btn",{attrs:{color:"NETWORK"==i.access.vector?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Is exploitable remotely?"}},[t._v("mdi-cloud")])],1),a("v-btn",{attrs:{color:"NONE"==i.access.authentication?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Require authentication?"}},[t._v("mdi-shield-account")])],1),a("v-btn",{attrs:{color:i.is_in_the_news||i.is_in_the_wild?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Is in the news or exploited in the wild?"}},[t._v("mdi-star")])],1)]}},{key:"item.updated_at",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.updated_at).format("YYYY-MM-DD, hh:mm")))])]}}])}),a("v-btn",{attrs:{absolute:"",dark:"",fab:"",bottom:"",left:"",color:"deep-orange"},on:{click:function(e){return t.goToPage("/vulns")}}},[a("v-icon",[t._v("mdi-plus")])],1),a("v-snackbar",{attrs:{timeout:t.snackTimeout,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1)],1)],1)},Aa=[],Ma={name:"Monitoring",mixins:[pt,Ie],data:function(){return{vendors:[],products:[],packages:[],vulns:[],loading:!0,limit:20,search_vendors:"",search_products:"",search_packages:"",search_vulns:"",options_vendors:{},options_products:{},options_packages:{},options_vulns:{},headers_vendors:[{text:"Vendor",value:"name"},{text:"# Products",value:"products_count",align:"center",sortable:!1},{text:"Last update",value:"updated_at"},{text:"Actions",value:"action",sortable:!1}],headers_products:[{text:"Vendor",value:"vendor"},{text:"Product",value:"name"},{text:"Last update",value:"updated_at"},{text:"Actions",value:"action",sortable:!1}],headers_packages:[{text:"Type",value:"type"},{text:"Package",value:"name"},{text:"Last update",value:"updated_at"},{text:"Actions",value:"action",sortable:!1}],headers_vulns:[{text:"Score",value:"score",align:"center",width:"10%"},{text:"Summary",value:"summary"},{text:"Metadata",value:"metadata",align:"center",width:"8%",sortable:!1},{text:"Last update",value:"updated_at",align:"center",width:"12%"}],rowsPerPageItems:[5,10,20,50,100],rowsPerPage:10,snack:!1,snackColor:"",snackText:"",snackTimeout:3e3}},mounted:function(){},watch:{search_vendors:bt.a.debounce((function(t){this.search_vendors=t,this.options_vendors.page=1,this.getDataVendors()}),500),search_products:bt.a.debounce((function(t){this.search_products=t,this.options_products.page=1,this.getDataProducts()}),500),search_packages:bt.a.debounce((function(t){this.search_packages=t,this.options_packages.page=1,this.getDataPackages()}),500),search_vulns:bt.a.debounce((function(t){this.search_vulns=t,this.options_vulns.page=1,this.getDataVulns()}),500),options_vendors:{handler:function(){this.getDataVendors()},deep:!0},options_products:{handler:function(){this.getDataProducts()},deep:!0},options_packages:{handler:function(){this.getDataPackages()},deep:!0},options_vulns:{handler:function(){this.getDataVulns()},deep:!0}},methods:{getDataVendors:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var i=t.options_vendors,s=i.sortBy,n=i.sortDesc,o=i.page,r=i.itemsPerPage;t.limit=r;var l=t.getVendors(o,t.limit,s,n);setTimeout((function(){e({items:l})}),300)}))},getDataProducts:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var i=t.options_products,s=i.sortBy,n=i.sortDesc,o=i.page,r=i.itemsPerPage;t.limit=r;var l=t.getProducts(o,t.limit,s,n);setTimeout((function(){e({items:l})}),300)}))},getDataPackages:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var i=t.options_packages,s=i.sortBy,n=i.sortDesc,o=i.page,r=i.itemsPerPage;t.limit=r;var l=t.getPackages(o,t.limit,s,n);setTimeout((function(){e({items:l})}),300)}))},getDataVulns:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var i=t.options_vulns,s=i.sortBy,n=i.sortDesc,o=i.page,r=i.itemsPerPage;t.limit=r;var l=t.getVulns(o,t.limit,s,n);setTimeout((function(){e({items:l})}),300)}))},getVendors:function(t,e,a,i){var s=this,n="";a.length>0&&(n=!0===i[0]?"&sorted_by=-"+a:"&sorted_by="+a),this.$api.get("/api/kb/vendors/?monitored=true&limit="+e+"&page="+t+"&search="+this.search_vendors+n).then((function(t){return s.loading=!1,s.vendors=t.data,s.products})).catch((function(t){s.vendors=[],y.a.fire({title:"Error",text:"unable to get vendors",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))},getProducts:function(t,e,a,i){var s=this,n="";a.length>0&&(n=!0===i[0]?"&sorted_by=-"+a:"&sorted_by="+a),this.$api.get("/api/kb/products/?monitored=true&limit="+e+"&page="+t+"&search="+this.search_products+n).then((function(t){return s.loading=!1,s.products=t.data,s.products})).catch((function(t){s.products=[],y.a.fire({title:"Error",text:"unable to get products",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))},getPackages:function(t,e,a,i){var s=this,n="";a.length>0&&(n=!0===i[0]?"&sorted_by=-"+a:"&sorted_by="+a),this.$api.get("/api/kb/packages/?monitored=true&limit="+e+"&page="+t+"&name="+this.search_packages+n).then((function(t){return s.loading=!1,s.packages=t.data,s.packages})).catch((function(t){s.packages=[],y.a.fire({title:"Error",text:"Unable to get packages",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))},getVulns:function(t,e,a,i){var s=this,n="";a.length>0&&(n=!0===i[0]?"&sorted_by=-"+a:"&sorted_by="+a),this.$api.get("/api/vulns/?monitored=true&limit="+e+"&page="+t+"&search="+this.search_products+n).then((function(t){return s.loading=!1,s.vulns=t.data,s.vulns})).catch((function(t){s.vulns=[],y.a.fire({title:"Error",text:"unable to get vulns",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))},viewVendor:function(t){this.$router.push({path:"/vendor/"+t})},viewProduct:function(t){this.$router.push({path:"/product/"+t})},viewPackage:function(t){this.$router.push({path:"/packages/"+t})},viewVuln:function(t){this.$router.push({path:"/vulns/"+t})},goToPage:function(t){this.$router.push({path:t})},exportMonitored:function(t){var e=this;this.snack=!0,this.snackColor="warning",this.snackText="Preparing export...",this.$api.get("/api/monitor/export/"+t).then((function(a){e.forceFileDownload(a,"ph_export_monitored_"+t+".csv"),e.snack=!0,e.snackColor="success",e.snackText="Monitored assets successfuly exported"})).catch((function(t){e.snack=!0,e.snackColor="error",e.snackText="Unable to export monitored assets"}))},onImportFileChange:function(t){var e=this,a=t.target.files||t.dataTransfer.files;if(a.length){var i=new FormData;i.append("file",a[0]),this.snack=!0,this.snackColor="warning",this.snackText="Importing...",this.$api.post("/api/monitor/import",i).then((function(t){e.snack=!0,e.snackColor="success",e.snackText="Monitored assets successfuly uploaded",e.options_vendors.page=1})).catch((function(t){e.snack=!0,e.snackColor="error",e.snackText="Unable to import monitored assets"}))}}}},Da=Ma,Oa=Object(l["a"])(Da,$a,Aa,!1,null,null,null),ja=Oa.exports;d()(Oa,{VBtn:V["a"],VCard:I["a"],VCardTitle:T["e"],VChip:wt["a"],VCol:Zt["a"],VContainer:S["a"],VDataTable:Dt["a"],VIcon:Q["a"],VList:tt["a"],VListItem:at["a"],VListItemTitle:st["k"],VMenu:ot["a"],VRow:te["a"],VSnackbar:Vt["a"],VSpacer:D["a"],VTab:fe["a"],VTabItem:be["a"],VTabs:ke["a"],VTextField:O["a"]});var Ba=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-tabs",{attrs:{left:"","background-color":"white",color:"deep-orange accent-4"}},[a("v-tab",[t._v("By Vendors")]),a("v-tab",[t._v("By Products")]),a("v-tab-item",[a("v-card",[a("v-card-title",[a("v-container",[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"pa-2",attrs:{md:"auto"}},[t._v(" Vendors ")]),a("v-col",{staticClass:"pa-2"},[this.only_monitored_vendors?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:t.toggleVendorMonitored}},[t._v("Show all")]):t._e(),this.only_monitored_vendors?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:t.toggleVendorMonitored}},[t._v("Show monitored only")])],1),a("v-text-field",{staticClass:"pt-0",attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search_vendors,callback:function(e){t.search_vendors=e},expression:"search_vendors"}})],1)],1),a("v-spacer")],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers_vendors,items:t.vendors.results,options:t.options_vendors,"server-items-length":t.vendors.count,search:t.search_vendors,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"items-per-page":t.rowsPerPage},on:{"update:options":function(e){t.options_vendors=e}},scopedSlots:t._u([{key:"item.products_count",fn:function(e){var i=e.item;return[a("v-chip",{attrs:{small:"",color:"lightgrey"}},[t._v(t._s(i.products_count))])]}},{key:"item.monitored",fn:function(e){var i=e.item;return[i.monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:function(e){return t.toggleMonitoredVendor(i)}}},[t._v("Yes")]):t._e(),i.monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:function(e){return t.toggleMonitoredVendor(i)}}},[t._v("No")])]}},{key:"item.updated_at",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.updated_at).format("YYYY-MM-DD")))])]}},{key:"item.action",fn:function(e){var i=e.item;return[a("v-icon",{staticClass:"mdi mdi-eye",attrs:{small:"",color:"blue"},on:{click:function(e){return t.viewVendor(i.id)}}})]}}])}),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1),a("v-tab-item",[a("v-card",[a("v-card-title",[a("v-container",[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"pa-2",attrs:{md:"auto"}},[t._v(" Products ")]),a("v-col",{staticClass:"pa-2"},[this.only_monitored_products?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:t.toggleProductMonitored}},[t._v("Show all")]):t._e(),this.only_monitored_products?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:t.toggleProductMonitored}},[t._v("Show monitored only")])],1),a("v-text-field",{staticClass:"pt-0",attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search_products,callback:function(e){t.search_products=e},expression:"search_products"}})],1)],1),a("v-spacer")],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers_products,items:t.products.results,options:t.options_products,"server-items-length":t.products.count,search:t.search_products,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"items-per-page":t.rowsPerPage},on:{"update:options":function(e){t.options_products=e}},scopedSlots:t._u([{key:"item.monitored",fn:function(e){var i=e.item;return[i.monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:function(e){return t.toggleMonitoredProduct(i)}}},[t._v("Yes")]):t._e(),i.monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:function(e){return t.toggleMonitoredProduct(i)}}},[t._v("No")])]}},{key:"item.updated_at",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.updated_at).format("YYYY-MM-DD")))])]}},{key:"item.action",fn:function(e){var i=e.item;return[a("v-icon",{staticClass:"mdi mdi-eye",attrs:{small:"",color:"blue"},on:{click:function(e){return t.viewProduct(i.id)}}})]}}])}),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1)],1)],1)},Ua=[],La={name:"VendorsProducts",data:function(){return{vendors:[],products:[],loading:!0,limit:20,only_monitored_vendors:!1,only_monitored_products:!1,search_vendors:"",search_products:"",options_vendors:{},options_products:{},headers_vendors:[{text:"Vendor",value:"name"},{text:"# Products",value:"products_count",align:"center",sortable:!1},{text:"Monitored",value:"monitored",align:"center",sortable:!1},{text:"Last update",value:"updated_at"},{text:"Actions",value:"action",sortable:!1}],headers_products:[{text:"Vendor",value:"vendor"},{text:"Product",value:"name"},{text:"Monitored",value:"monitored",align:"center",sortable:!1},{text:"Last update",value:"updated_at"},{text:"Actions",value:"action",sortable:!1}],rowsPerPageItems:[5,10,20,50,100],rowsPerPage:10,snack:!1,snackColor:"",snackText:""}},mounted:function(){},watch:{search_vendors:bt.a.debounce((function(t){this.search_vendors=t,this.options_vendors.page=1,this.getDataVendors()}),500),search_products:bt.a.debounce((function(t){this.search_products=t,this.options_products.page=1,this.getDataProducts()}),500),only_monitored_vendors:{handler:function(){this.getDataVendors()},deep:!0},only_monitored_products:{handler:function(){this.getDataProducts()},deep:!0},options_vendors:{handler:function(){this.getDataVendors()},deep:!0},options_products:{handler:function(){this.getDataProducts()},deep:!0}},methods:{getDataVendors:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var i=t.options_vendors,s=i.sortBy,n=i.sortDesc,o=i.page,r=i.itemsPerPage;t.limit=r;var l=t.getVendors(o,t.limit,s,n);setTimeout((function(){e({items:l})}),300)}))},getDataProducts:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var i=t.options_products,s=i.sortBy,n=i.sortDesc,o=i.page,r=i.itemsPerPage;t.limit=r;var l=t.getProducts(o,t.limit,s,n);setTimeout((function(){e({items:l})}),300)}))},getVendors:function(t,e,a,i){var s=this,n="";a.length>0&&(n=!0===i[0]?"&sorted_by=-"+a:"&sorted_by="+a);var o=this.only_monitored_vendors?"&monitored=true":"";this.$api.get("/api/kb/vendors/?limit="+e+"&page="+t+"&search="+this.search_vendors+n+o).then((function(t){return s.loading=!1,s.vendors=t.data,s.products})).catch((function(t){s.vendors=[],y.a.fire({title:"Error",text:"unable to get vendors",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))},getProducts:function(t,e,a,i){var s=this,n="";a.length>0&&(n=!0===i[0]?"&sorted_by=-"+a:"&sorted_by="+a);var o=this.only_monitored_products?"&monitored=true":"";this.$api.get("/api/kb/products/?limit="+e+"&page="+t+"&search="+this.search_products+n+o).then((function(t){return s.loading=!1,s.products=t.data,s.products})).catch((function(t){s.products=[],y.a.fire({title:"Error",text:"unable to get products",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))},toggleMonitoredVendor:function(t){var e=this,a={vendor_name:t.name,monitored:!t.monitored,organization_id:localStorage.getItem("org_id")};this.$api.post("/api/monitor/vendor/toggle",a).then((function(a){e.loading=!1,a?(t.monitored=!t.monitored,e.snack=!0,e.snackColor="success",e.snackText="Monitoring status successfuly updated."):(e.snack=!0,e.snackColor="error",e.snackText="Unable to change the monitoring status")})).catch((function(t){e.loading=!1,y.a.fire({title:"Error",text:"Unable to change the monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:2e3})}))},toggleMonitoredProduct:function(t){var e=this,a={vendor_name:t.vendor,product_name:t.name,monitored:!t.monitored,organization_id:localStorage.getItem("org_id")};this.$api.post("/api/monitor/product/toggle",a).then((function(a){e.loading=!1,a?(t.monitored=!t.monitored,e.snack=!0,e.snackColor="success",e.snackText="Monitoring status successfuly updated."):(e.snack=!0,e.snackColor="error",e.snackText="Unable to change the monitoring status")})).catch((function(t){e.loading=!1,y.a.fire({title:"Error",text:"Unable to change the monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:2e3})}))},toggleVendorMonitored:function(){this.only_monitored_vendors=!this.only_monitored_vendors,this.options_vendors.page=1},toggleProductMonitored:function(){this.only_monitored_products=!this.only_monitored_products,this.options_products.page=1},viewVendor:function(t){this.$router.push({path:"/vendor/"+t})},viewProduct:function(t){this.$router.push({path:"/product/"+t})}}},Fa=La,Na=Object(l["a"])(Fa,Ba,Ua,!1,null,null,null),Ra=Na.exports;d()(Na,{VBtn:V["a"],VCard:I["a"],VCardTitle:T["e"],VChip:wt["a"],VCol:Zt["a"],VContainer:S["a"],VDataTable:Dt["a"],VIcon:Q["a"],VRow:te["a"],VSnackbar:Vt["a"],VSpacer:D["a"],VTab:fe["a"],VTabItem:be["a"],VTabs:ke["a"],VTextField:O["a"]});var Ya=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-tabs",{attrs:{left:"","background-color":"white",color:"deep-orange accent-4"}},[a("v-tab",[t._v("Details")]),a("v-tab",[t._v("Products")]),a("v-tab-item",[a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md3:"","d-flex":"","align-stretch":""}},[a("v-card",{staticClass:"flex-grow-1",attrs:{color:"grey lighten-5"}},[a("v-card-title",[a("v-col",{staticClass:"pa-2",attrs:{md:"auto"}},[t._v(" Overview ")]),a("v-col",{staticClass:"pa-2"},[t.vendor.monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:t.toggleMonitored}},[t._v("Monitored")]):t._e(),t.vendor.monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:t.toggleMonitored}},[t._v("Not monitored")])],1)],1),a("v-card-text",[a("span",{staticClass:"font-weight-bold"},[t._v("Name:")]),t._v(" "+t._s(t.vendor.name)),a("br")])],1)],1),a("v-flex",{attrs:{md3:"","d-flex":"","align-stretch":""}},[a("v-card",{staticClass:"flex-grow-1",attrs:{color:"grey lighten-5"}},[a("v-col",{staticClass:"pa-2",attrs:{md:"auto"}},[a("v-card-title",[t._v("Statistics")])],1),a("v-card-text",[a("span",{staticClass:"font-weight-bold"},[t._v("Vulnerabilities: ")]),a("v-chip",{attrs:{color:"deep-orange white--text",content:this.vulns.count,small:""}},[t._v(t._s(t.vulns.count))]),a("br"),a("span",{staticClass:"font-weight-bold"},[t._v("Products: ")]),a("v-chip",{attrs:{color:"deep-orange white--text",small:""}},[t._v(t._s(t.vendor.products_count))])],1)],1)],1)],1),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md12:""}},[a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.vulns_headers,items:t.vulns.results,options:t.options_vulns,"server-items-length":t.vulns.count,"items-per-page":t.limit_vulns,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading_vulns:t.loading_vulns,"item-key":"id","multi-sort":""},on:{"update:options":function(e){t.options_vulns=e}},scopedSlots:t._u([{key:"item.score",fn:function(e){var i=e.item;return[a("v-chip",{staticClass:"text-center font-weight-bold",attrs:{color:t.getRatingColor(i.score),label:""}},[t._v(t._s(i.score)+"/100")]),a("br"),a("span",{staticClass:"text-caption"},[t._v("CVSSv2: "+t._s(i.cvss))])]}},{key:"item.summary",fn:function(e){var i=e.item;return[a("div",{staticClass:"py-2"},[a("div",{staticClass:"pb-2"},[a("span",{staticClass:"deep-orange--text font-weight-medium"},[t._v(t._s(i.cveid))]),t._v(" / PH-"+t._s(i.id)+" "),a("v-btn",{attrs:{color:"deep-orange",icon:"",small:""}},[a("v-icon",{attrs:{title:"View details"},on:{click:function(e){return t.viewVuln(i.id)}}},[t._v("mdi-arrow-right-bold-circle-outline")])],1)],1),a("div",[t._v(" "+t._s(i.summary)+" ")]),t._l(i.products,(function(e){return a("v-chip",{key:e.id,staticClass:"vendor-chip",attrs:{label:"",small:"",link:""},on:{click:function(a){return t.$router.push({path:"/product/"+e.id})}}},[t._v(" "+t._s(e.vendor)+": "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(e.name))])])}))],2)]}},{key:"item.metadata",fn:function(e){var i=e.item;return[a("v-chip",{staticClass:"font-weight-bold",attrs:{label:"",link:"",small:"",color:i.exploit_count>0?"deep-orange":"grey",title:"Is exploitable?"}},[t._v(t._s(i.exploit_count))]),a("v-btn",{attrs:{color:"NETWORK"==i.access.vector?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Is exploitable remotely?"}},[t._v("mdi-cloud")])],1),a("v-btn",{attrs:{color:"NONE"==i.access.authentication?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Require authentication?"}},[t._v("mdi-shield-account")])],1),a("v-btn",{attrs:{color:i.is_in_the_news||i.is_in_the_wild?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Is in the news or exploited in the wild?"}},[t._v("mdi-star")])],1)]}},{key:"item.updated_at",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.updated_at).format("YYYY-MM-DD, hh:mm:ss")))])]}}])})],1)],1)],1),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1),a("v-tab-item",[a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md12:""}},[a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.products_headers,items:t.products.results,options:t.options_products,"server-items-length":t.products.count,"items-per-page":t.limit_products,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading_vulns:t.loading_vulns,"item-key":"id","multi-sort":""},on:{"update:options":function(e){t.options_products=e}},scopedSlots:t._u([{key:"item.monitored",fn:function(e){var i=e.item;return[i.monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:function(e){return t.toggleMonitoredProduct(i)}}},[t._v("Yes")]):t._e(),i.monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:function(e){return t.toggleMonitoredProduct(i)}}},[t._v("No")])]}},{key:"item.updated_at",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.updated_at).format("YYYY-MM-DD, hh:mm:ss")))])]}},{key:"item.action",fn:function(e){var i=e.item;return[a("v-icon",{staticClass:"mdi mdi-eye",attrs:{small:"",color:"blue"},on:{click:function(e){return t.viewProduct(i.id)}}})]}}])})],1)],1)],1),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1)},za=[],Xa={name:"vendordetails",mixins:[pt],data:function(){return{loading_vulns:!0,loading_products:!0,vendor_id:"",vendor:{},products:[],vulns:{results:[]},limit_vulns:20,limit_products:20,options_vulns:{},options_products:{},vulns_headers:[{text:"Score",value:"score",align:"center",width:"10%"},{text:"Summary",value:"summary"},{text:"Metadata",value:"metadata",align:"center",width:"9%",sortable:!1},{text:"Last update",value:"updated_at",align:"center",width:"10%"}],products_headers:[{text:"Product Name",value:"name"},{text:"Monitored",value:"monitored"},{text:"Last update",value:"updated_at",align:"center"},{text:"Actions",value:"action",sortable:!1,align:"center"}],rowsPerPageItems:[5,10,20,50,100],snack:!1,snackColor:"",snackText:""}},watch:{options_vulns:{handler:function(){this.getDataVendor(this.vendor_id)},deep:!0},options_products:{handler:function(){this.getDataProducts(this.vendor_id)},deep:!0}},beforeRouteUpdate:function(t){this.vendor_id=t.params.vendor_id},mounted:function(){this.vendor_id=this.$router.currentRoute.params.vendor_id,this.options_products.page=1,this.options_vulns.page=1},methods:{getDataVendor:function(t){var e=this;return this.loading_vulns=!0,new Promise((function(a,i){var s=e.options_vulns,n=s.sortBy,o=s.sortDesc,r=s.page,l=s.itemsPerPage;e.limit_vulns=l;var c=e.getVendor(t),d=e.getVulns(t,r,e.limit_vulns,n,o);setTimeout((function(){a({vendor:c,vulns:d})}),300)}))},getDataProducts:function(t){var e=this;return this.loading_vulns=!0,new Promise((function(a,i){var s=e.options_products,n=s.sortBy,o=s.sortDesc,r=s.page,l=s.itemsPerPage;e.limit_products=l;var c=e.getProducts(t,r,e.limit_vulns,n,o);setTimeout((function(){a({products:c})}),300)}))},getVendor:function(t){var e=this;this.loading_vulns=!0,this.$api.get("/api/kb/vendors/"+t).then((function(t){return e.vendor=t.data,e.vendor})).catch((function(t){e.vendor={},e.loading_vulns=!1,y.a.fire({title:"Error",text:"Unable to get vendor details",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading_vulns=!1},getProducts:function(t,e,a){var i=this,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",n=arguments.length>4?arguments[4]:void 0;this.loading_products=!0;var o="";s.length>0&&(o=!0===n[0]?"sorted_by=-"+s:"sorted_by="+s),this.$api.get("/api/kb/products/?vendor_id="+t+"&limit="+a+"&page="+e+"&"+o).then((function(t){return i.products=t.data,i.products})).catch((function(t){i.products=[],i.loading_vulns=!1,y.a.fire({title:"Error",text:"Unable to get products",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading_products=!1},viewVuln:function(t){this.$router.push({path:"/vulns/"+t})},viewProduct:function(t){this.$router.push({path:"/product/"+t})},getVulns:function(t,e,a){var i=this,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",n=arguments.length>4?arguments[4]:void 0;this.loading_vulns=!0;var o="";s.length>0&&(o=!0===n[0]?"sorted_by=-"+s:"sorted_by="+s),this.$api.get("/api/vulns/?vendor="+t+"&limit="+a+"&page="+e+"&"+o).then((function(t){return i.vulns=t.data,i.vulns})).catch((function(t){vulns={results:[]},i.loading_vulns=!1,y.a.fire({title:"Error",text:"Unable to get vulns",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading_vulns=!1},toggleMonitored:function(){var t=this,e={vendor_name:this.vendor.name,monitored:!this.vendor.monitored,organization_id:localStorage.getItem("org_id")};this.$api.post("/api/monitor/vendor/toggle",e).then((function(e){t.loading_vulns=!1,e?(t.vendor.monitored=!t.vendor.monitored,t.snack=!0,t.snackColor="success",t.snackText="Monitoring status successfuly updated."):(t.snack=!0,t.snackColor="error",t.snackText="Unable to change the monitoring status")})).catch((function(e){t.loading_vulns=!1,y.a.fire({title:"Error",text:"Unable to change the monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:2e3})}))},toggleMonitoredProduct:function(t){var e=this,a={vendor_name:this.vendor.name,product_name:t.name,monitored:!t.monitored,organization_id:localStorage.getItem("org_id")};this.$api.post("/api/monitor/product/toggle",a).then((function(a){e.loading=!1,a?(t.monitored=!t.monitored,e.snack=!0,e.snackColor="success",e.snackText="Monitoring status successfuly updated."):(e.snack=!0,e.snackColor="error",e.snackText="Unable to change the monitoring status")})).catch((function(t){e.loading=!1,y.a.fire({title:"Error",text:"Unable to change the monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:2e3})}))}}},Ha=Xa,Wa=Object(l["a"])(Ha,Ya,za,!1,null,null,null),qa=Wa.exports;d()(Wa,{VBtn:V["a"],VCard:I["a"],VCardText:T["d"],VCardTitle:T["e"],VChip:wt["a"],VCol:Zt["a"],VContainer:S["a"],VDataTable:Dt["a"],VFlex:E["a"],VIcon:Q["a"],VLayout:A["a"],VSnackbar:Vt["a"],VTab:fe["a"],VTabItem:be["a"],VTabs:ke["a"]});var Ja=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-tabs",{attrs:{left:"","background-color":"white",color:"deep-orange accent-4"}},[a("v-tab",[t._v("Details")]),a("v-tab",[t._v("Timeline")]),a("v-tab-item",[a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md3:"","d-flex":"","align-stretch":""}},[a("v-card",{staticClass:"flex-grow-1",attrs:{color:"grey lighten-5"}},[a("v-card-title",[a("v-col",{staticClass:"pa-2",attrs:{md:"auto"}},[t._v(" Information ")]),a("v-col",{staticClass:"pa-2"},[t.product.monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:t.toggleMonitored}},[t._v("Monitored")]):t._e(),t.product.monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:t.toggleMonitored}},[t._v("Not monitored")])],1)],1),a("v-card-text",[a("span",{staticClass:"font-weight-bold"},[t._v("Name:")]),t._v(" "+t._s(t.product.name)),a("br"),a("span",{staticClass:"font-weight-bold"},[t._v("Vendor:")]),t._v(" "),a("a",{on:{click:function(e){return t.viewVendor(t.product.vendor_id)}}},[t._v(t._s(t.product.vendor))])])],1)],1),a("v-flex",{attrs:{md3:"","d-flex":"","align-stretch":""}},[a("v-card",{staticClass:"flex-grow-1",attrs:{color:"grey lighten-5"}},[a("v-card-title",[t._v("Statistics")]),a("v-card-text",[a("span",{staticClass:"font-weight-bold"},[t._v("Vulnerabilities: ")]),a("v-chip",{attrs:{color:"deep-orange white--text",content:this.vulns.count,small:""}},[t._v(t._s(t.vulns.count))]),a("br"),a("span",{staticClass:"font-weight-bold"},[t._v("Versions: ")]),a("v-chip",{attrs:{color:"deep-orange white--text",small:""}},[t._v(t._s(t.cpes.length))])],1)],1)],1),a("v-flex",{attrs:{md6:"","d-flex":"","align-stretch":""}},[a("v-card",{staticClass:"flex-grow-1",attrs:{color:"grey lighten-5"}},[a("v-card-title",[t._v(" Known versions "),a("v-icon",{staticClass:"ml-2",attrs:{small:"",link:"",title:"Reset selection"},on:{click:function(e){t.filter_version=null,t.select_pv=[]}}},[t._v(" mdi-reload ")])],1),a("v-card-text",[a("v-chip-group",{attrs:{"active-class":"deep-orange--text text--accent-4"},model:{value:t.select_pv,callback:function(e){t.select_pv=e},expression:"select_pv"}},t._l(t.cpes,(function(e){return a("v-chip",{key:e.id,attrs:{small:"",label:"",outlined:""},on:{click:function(a){t.filter_version=e.version}}},[t._v(t._s(e.version)+" ")])})),1)],1)],1)],1)],1),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md12:""}},[a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.vulns_headers,items:t.vulns.results,options:t.options,"server-items-length":t.vulns.count,search:t.search,"items-per-page":20,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"id","multi-sort":""},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.score",fn:function(e){var i=e.item;return[a("v-chip",{staticClass:"text-center font-weight-bold",attrs:{color:t.getRatingColor(i.score),label:""}},[t._v(t._s(i.score)+"/100")]),a("br"),a("span",{staticClass:"text-caption"},[t._v("CVSSv2: "+t._s(i.cvss))])]}},{key:"item.summary",fn:function(e){var i=e.item;return[a("div",{staticClass:"py-2"},[a("div",{staticClass:"pb-2"},[a("span",{staticClass:"deep-orange--text font-weight-medium"},[t._v(t._s(i.cveid))]),t._v(" / PH-"+t._s(i.id)+" "),a("v-btn",{attrs:{color:"deep-orange",icon:"",small:""}},[a("v-icon",{attrs:{title:"View details"},on:{click:function(e){return t.viewVuln(i.id)}}},[t._v("mdi-arrow-right-bold-circle-outline")])],1)],1),a("div",[t._v(" "+t._s(i.summary)+" ")]),t._l(i.products,(function(e){return a("v-chip",{key:e.id,staticClass:"vendor-chip",attrs:{label:"",small:"",link:""},on:{click:function(a){return t.viewProduct(e.id)}}},[t._v(" "+t._s(e.vendor)+": "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(e.name))])])}))],2)]}},{key:"item.metadata",fn:function(e){var i=e.item;return[a("v-chip",{staticClass:"font-weight-bold",attrs:{label:"",link:"",small:"",color:i.exploit_count>0?"deep-orange":"grey",title:"Is exploitable?"}},[t._v(t._s(i.exploit_count))]),a("v-btn",{attrs:{color:"NETWORK"==i.access.vector?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Is exploitable remotely?"}},[t._v("mdi-cloud")])],1),a("v-btn",{attrs:{color:"NONE"==i.access.authentication?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Require authentication?"}},[t._v("mdi-shield-account")])],1),a("v-btn",{attrs:{color:i.is_in_the_news||i.is_in_the_wild?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Is in the news or exploited in the wild?"}},[t._v("mdi-star")])],1)]}},{key:"item.updated_at",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.updated_at).format("YYYY-MM-DD, hh:mm:ss")))])]}}])})],1)],1)],1)],1),a("v-tab-item",[a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[t._v(" Soon available. ")])],1)],1)],1)},Ka=[],Ga={name:"productdetails",mixins:[pt],components:{VClamp:mt["a"]},data:function(){return{loading:!0,product_id:"",product:{},select_pv:[],vulns:{results:[]},cpes:[],limit:20,search:"",filter_version:null,options:{},selected:[],vulns_headers:[{text:"Score",value:"score",align:"center",width:"10%"},{text:"Summary",value:"summary"},{text:"Metadata",value:"metadata",align:"center",width:"9%",sortable:!1},{text:"Last update",value:"updated_at",align:"center",width:"10%"}],rowsPerPageItems:[5,10,20,50,100],snack:!1,snackColor:"",snackText:""}},watch:{options:{handler:function(){this.getDataFromApi(this.product_id)},deep:!0},filter_version:{handler:function(){this.getDataFromApi(this.product_id)},deep:!0}},beforeRouteUpdate:function(t,e){this.product_id=t.params.product_id},mounted:function(){this.product_id=this.$router.currentRoute.params.product_id,this.options.page=1},methods:{getDataFromApi:function(t){var e=this;return this.loading=!0,new Promise((function(a,i){var s=e.options,n=s.sortBy,o=s.sortDesc,r=s.page,l=s.itemsPerPage;e.limit=l;var c=e.getProduct(t),d=e.getVulns(t,r,e.limit,n,o);setTimeout((function(){a({product:c,vulns:d})}),300)}))},getProduct:function(t){var e=this;this.$api.get("/api/kb/detailed-products/"+t).then((function(t){return e.product=t.data,e.cpes=e.product.versions,e.product})).catch((function(t){e.product={},e.loading=!1,y.a.fire({title:"Error",text:"unable to get product details",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))},viewVuln:function(t){this.$router.push({name:"VulnDetails",params:{vuln_id:t}})},viewProduct:function(t){var e="/product/"+t;this.$route.path!=e&&(this.product_id=t,this.$router.push({path:e}))},getVulns:function(t,e,a){var i=this,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",n=arguments.length>4?arguments[4]:void 0,o="";s.length>0&&(o=!0===n[0]?"sorted_by=-"+s:"sorted_by="+s);var r="/api/vulns/?product="+t+"&limit="+a+"&page="+e+"&"+o;null!=this.filter_version&&""!=this.filter_version&&(r+="&product_version="+this.filter_version+"&vendor_name="+this.product.vendor+"&product_name="+this.product.name),this.$api.get(r).then((function(t){return i.vulns=t.data,i.loading=!1,i.vulns})).catch((function(t){vulns={results:[]},y.a.fire({title:"Error",text:"unable to get vulns",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1},toggleMonitored:function(){var t=this,e={vendor_name:this.product.vendor,product_name:this.product.name,monitored:!this.product.monitored,organization_id:localStorage.getItem("org_id")};this.$api.post("/api/monitor/product/toggle",e).then((function(e){e?(t.product.monitored=!t.product.monitored,t.snack=!0,t.snackColor="success",t.snackText="Monitoring status successfuly updated."):(t.snack=!0,t.snackColor="error",t.snackText="Unable to change the monitoring status")})).catch((function(t){y.a.fire({title:"Error",text:"Unable to change the monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:2e3})}))},viewVendor:function(t){this.$router.push({path:"/vendor/"+t})}}},Za=Ga,Qa=a("ef9a"),ti=Object(l["a"])(Za,Ja,Ka,!1,null,null,null),ei=ti.exports;d()(ti,{VBtn:V["a"],VCard:I["a"],VCardText:T["d"],VCardTitle:T["e"],VChip:wt["a"],VChipGroup:Qa["a"],VCol:Zt["a"],VContainer:S["a"],VDataTable:Dt["a"],VFlex:E["a"],VIcon:Q["a"],VLayout:A["a"],VTab:fe["a"],VTabItem:be["a"],VTabs:ke["a"]});var ai=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-card",[a("v-card-title",[a("v-container",[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"pa-2",attrs:{md:"auto"}},[t._v(" Packages ")]),a("v-col",{staticClass:"pa-2"},[this.only_monitored_packages?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:t.togglePackageMonitored}},[t._v("Show all")]):t._e(),this.only_monitored_packages?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:t.togglePackageMonitored}},[t._v("Show monitored only")])],1),a("v-text-field",{staticClass:"pt-0",attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search_packages,callback:function(e){t.search_packages=e},expression:"search_packages"}})],1)],1),a("v-spacer")],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers_packages,items:t.packages.results,options:t.options_packages,"server-items-length":t.packages.count,search:t.search_packages,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"items-per-page":t.rowsPerPage},on:{"update:options":function(e){t.options_packages=e}},scopedSlots:t._u([{key:"item.monitored",fn:function(e){var i=e.item;return[i.monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:function(e){return t.toggleMonitoredPackage(i)}}},[t._v("Yes")]):t._e(),i.monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:function(e){return t.toggleMonitoredPackage(i)}}},[t._v("No")])]}},{key:"item.updated_at",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.updated_at).format("YYYY-MM-DD")))])]}},{key:"item.action",fn:function(e){var i=e.item;return[a("v-icon",{staticClass:"mdi mdi-eye",attrs:{small:"",color:"blue"},on:{click:function(e){return t.viewPackage(i.id)}}})]}}])}),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1)},ii=[],si={name:"Packages",data:function(){return{packages:[],loading:!0,limit:20,only_monitored_packages:!1,search_packages:"",options_packages:{},headers_packages:[{text:"Type",value:"type"},{text:"Package",value:"name"},{text:"Monitored",value:"monitored",align:"center",sortable:!1},{text:"Last update",value:"updated_at"},{text:"Actions",value:"action",sortable:!1}],rowsPerPageItems:[5,10,20,50,100],rowsPerPage:10,snack:!1,snackColor:"",snackText:""}},mounted:function(){},watch:{search_packages:bt.a.debounce((function(t){this.search_packages=t,this.options_packages.page=1,this.getDataPackages()}),500),only_monitored_packages:{handler:function(){this.getDataPackages()},deep:!0},options_packages:{handler:function(){this.getDataPackages()},deep:!0}},methods:{getDataPackages:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var i=t.options_packages,s=i.sortBy,n=i.sortDesc,o=i.page,r=i.itemsPerPage;t.limit=r;var l=t.getPackages(o,t.limit,s,n);setTimeout((function(){e({items:l})}),300)}))},getPackages:function(t,e,a,i){var s=this,n="";a.length>0&&(n=!0===i[0]?"&sorted_by=-"+a:"&sorted_by="+a);var o=this.only_monitored_packages?"&monitored=true":"";this.$api.get("/api/kb/packages/?limit="+e+"&page="+t+"&name__icontains="+this.search_packages+n+o).then((function(t){return s.loading=!1,s.packages=t.data,s.packages})).catch((function(t){s.packages=[],y.a.fire({title:"Error",text:"Unable to get packages",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))},toggleMonitoredPackage:function(t){var e=this,a={package_id:t.id,monitored:!t.monitored,organization_id:localStorage.getItem("org_id")};this.$api.post("/api/monitor/package/toggle",a).then((function(a){e.loading=!1,a?(t.monitored=!t.monitored,e.snack=!0,e.snackColor="success",e.snackText="Monitoring status successfuly updated."):(e.snack=!0,e.snackColor="error",e.snackText="Unable to change the monitoring status")})).catch((function(t){e.loading=!1,y.a.fire({title:"Error",text:"Unable to change the monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:2e3})}))},togglePackageMonitored:function(){this.only_monitored_packages=!this.only_monitored_packages,this.options_packages.page=1},viewPackage:function(t){this.$router.push({path:"/packages/"+t})}}},ni=si,oi=Object(l["a"])(ni,ai,ii,!1,null,null,null),ri=oi.exports;d()(oi,{VBtn:V["a"],VCard:I["a"],VCardTitle:T["e"],VChip:wt["a"],VCol:Zt["a"],VContainer:S["a"],VDataTable:Dt["a"],VIcon:Q["a"],VRow:te["a"],VSnackbar:Vt["a"],VSpacer:D["a"],VTextField:O["a"]});var li=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-tabs",{attrs:{left:"","background-color":"white",color:"deep-orange accent-4"}},[a("v-tab",[t._v("Details")]),a("v-tab",[t._v("Timeline")]),a("v-tab-item",[a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md3:"","d-flex":"","align-stretch":""}},[a("v-card",{staticClass:"flex-grow-1",attrs:{color:"grey lighten-5"}},[a("v-card-title",[a("v-col",{staticClass:"pa-2",attrs:{md:"auto"}},[t._v(" Information ")]),a("v-col",{staticClass:"pa-2"},[t.package.monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:t.toggleMonitored}},[t._v("Monitored")]):t._e(),t.package.monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:t.toggleMonitored}},[t._v("Not monitored")])],1)],1),a("v-card-text",[a("span",{staticClass:"font-weight-bold"},[t._v("Type:")]),t._v(" "+t._s(t.package.type)),a("br"),a("span",{staticClass:"font-weight-bold"},[t._v("Name:")]),t._v(" "+t._s(t.package.name)),a("br")])],1)],1),a("v-flex",{attrs:{md3:"","d-flex":"","align-stretch":""}},[a("v-card",{staticClass:"flex-grow-1",attrs:{color:"grey lighten-5"}},[a("v-card-title",[t._v("Statistics")]),a("v-card-text",[a("span",{staticClass:"font-weight-bold"},[t._v("Vulnerabilities: ")]),a("v-chip",{attrs:{color:"deep-orange white--text",content:this.vulns.count,small:""}},[t._v(t._s(t.vulns.count))]),a("br")],1)],1)],1),a("v-flex",{attrs:{md6:"","d-flex":"","align-stretch":""}},[a("v-card",{staticClass:"flex-grow-1",attrs:{color:"grey lighten-5"}},[a("v-card-title",[t._v(" Known versions "),a("v-icon",{staticClass:"ml-2",attrs:{small:"",link:"",title:"Reset selection"},on:{click:function(e){t.filter_version=null,t.select_pv=[]}}},[t._v(" mdi-reload ")])],1),a("v-card-text")],1)],1)],1),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md12:""}},[a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.vulns_headers,items:t.vulns.results,options:t.options,"server-items-length":t.vulns.count,search:t.search,"items-per-page":20,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"id","multi-sort":""},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.score",fn:function(e){var i=e.item;return[a("v-chip",{staticClass:"text-center font-weight-bold",attrs:{color:t.getRatingColor(i.score),label:""}},[t._v(t._s(i.score)+"/100")]),a("br"),a("span",{staticClass:"text-caption"},[t._v("CVSSv2: "+t._s(i.cvss))]),a("br"),a("span",{staticClass:"text-caption"},[t._v("CVSSv3: "+t._s(i.cvss3))])]}},{key:"item.summary",fn:function(e){var i=e.item;return[a("div",{staticClass:"py-2"},[a("div",{staticClass:"pb-2"},[a("span",{staticClass:"deep-orange--text font-weight-medium"},[t._v(t._s(i.cveid))]),t._v(" / PH-"+t._s(i.id)+" "),a("v-btn",{attrs:{color:"deep-orange",icon:"",small:""}},[a("v-icon",{attrs:{title:"View details"},on:{click:function(e){return t.viewVuln(i.id)}}},[t._v("mdi-arrow-right-bold-circle-outline")])],1)],1),a("div",[t._v(" "+t._s(i.summary)+" ")])])]}},{key:"item.metadata",fn:function(e){var i=e.item;return[a("v-chip",{staticClass:"font-weight-bold",attrs:{label:"",link:"",small:"",color:i.exploit_count>0?"deep-orange":"grey",title:"Is exploitable?"}},[t._v(t._s(i.exploit_count))]),a("v-btn",{attrs:{color:"NETWORK"==i.access.vector?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Is exploitable remotely?"}},[t._v("mdi-cloud")])],1),a("v-btn",{attrs:{color:"NONE"==i.access.authentication?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Require authentication?"}},[t._v("mdi-shield-account")])],1),a("v-btn",{attrs:{color:i.is_in_the_news||i.is_in_the_wild?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Is in the news or exploited in the wild?"}},[t._v("mdi-star")])],1)]}},{key:"item.updated_at",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.updated_at).format("YYYY-MM-DD, hh:mm:ss")))])]}}])})],1)],1)],1)],1),a("v-tab-item",[a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[t._v(" Soon available. ")])],1)],1)],1)},ci=[],di={name:"PackageDetails",mixins:[pt],data:function(){return{loading:!0,package_id:"",package:{},select_p:[],vulns:{results:[]},limit:20,search:"",filter_version:null,options:{},selected:[],vulns_headers:[{text:"Score",value:"score",align:"center",width:"10%"},{text:"Summary",value:"summary"},{text:"Metadata",value:"metadata",align:"center",width:"9%",sortable:!1},{text:"Last update",value:"updated_at",align:"center",width:"10%"}],rowsPerPageItems:[5,10,20,50,100],snack:!1,snackColor:"",snackText:""}},watch:{options:{handler:function(){this.getDataFromApi(this.package_id)},deep:!0},filter_version:{handler:function(){this.getDataFromApi(this.package_id)},deep:!0}},beforeRouteUpdate:function(t,e){this.package_id=t.params.package_id},mounted:function(){this.package_id=this.$router.currentRoute.params.package_id,this.options.page=1},methods:{getDataFromApi:function(t){var e=this;return this.loading=!0,new Promise((function(a,i){var s=e.options,n=s.sortBy,o=s.sortDesc,r=s.page,l=s.itemsPerPage;e.limit=l;var c=e.getPackage(t),d=e.getVulns(t,r,e.limit,n,o);setTimeout((function(){a({pkg:c,vulns:d})}),300)}))},getPackage:function(t){var e=this;this.$api.get("/api/kb/packages/"+t).then((function(t){return e.package=t.data,e.package})).catch((function(t){e.package={},e.loading=!1,y.a.fire({title:"Error",text:"Unable to get package details",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))},viewVuln:function(t){this.$router.push({name:"VulnDetails",params:{vuln_id:t}})},getVulns:function(t,e,a){var i=this,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",n=arguments.length>4?arguments[4]:void 0,o="";s.length>0&&(o=!0===n[0]?"sorted_by=-"+s:"sorted_by="+s);var r="/api/vulns/?package="+t+"&limit="+a+"&page="+e+"&"+o;this.$api.get(r).then((function(t){return i.vulns=t.data,i.loading=!1,i.vulns})).catch((function(t){vulns={results:[]},y.a.fire({title:"Error",text:"Unable to get vulns",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1},toggleMonitored:function(){var t=this,e={package_id:this.package.id,monitored:!this.package.monitored,organization_id:localStorage.getItem("org_id")};this.$api.post("/api/monitor/package/toggle",e).then((function(e){e?(t.package.monitored=!t.package.monitored,t.snack=!0,t.snackColor="success",t.snackText="Monitoring status successfuly updated."):(t.snack=!0,t.snackColor="error",t.snackText="Unable to change the monitoring status")})).catch((function(t){y.a.fire({title:"Error",text:"Unable to change the monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:2e3})}))}}},ui=di,vi=Object(l["a"])(ui,li,ci,!1,null,null,null),mi=vi.exports;d()(vi,{VBtn:V["a"],VCard:I["a"],VCardText:T["d"],VCardTitle:T["e"],VChip:wt["a"],VCol:Zt["a"],VContainer:S["a"],VDataTable:Dt["a"],VFlex:E["a"],VIcon:Q["a"],VLayout:A["a"],VTab:fe["a"],VTabItem:be["a"],VTabs:ke["a"]});var pi=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-card",[a("v-card-title",[t._v(" CVE "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers,items:t.cves.results,"items-per-page":20,options:t.options,"server-items-length":t.cves.count,search:t.search,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"cve_id","show-select":"","multi-sort":""},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.summary",fn:function(e){var i=e.item;return[a("v-clamp",{attrs:{autoresize:"","max-lines":1},scopedSlots:t._u([{key:"after",fn:function(e){var i=e.toggle,s=e.expanded,n=e.clamped;return s||n?a("button",{staticClass:"toggle btn btn-sm",on:{click:i}},[t._v(" "+t._s(" more")+" ")]):t._e()}}],null,!0)},[t._v(" "+t._s(i.summary)+" ")])]}},{key:"item.monitored",fn:function(e){var i=e.item;return[i.monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:function(e){return t.toggleMonitored(i)}}},[t._v("Yes")]):t._e(),i.monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:function(e){return t.toggleMonitored(i)}}},[t._v("No")])]}},{key:"item.modified",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.modified).format("YYYY-MM-DD")))])]}}])}),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1)},_i=[],hi={name:"cves",components:{VClamp:mt["a"]},data:function(){return{cves:[],totalcves:0,loading:!0,limit:20,search:"",options:{},selected:[],headers:[{text:"CVE-ID",value:"cve_id",width:"150px"},{text:"Summary",value:"summary",sortable:!1},{text:"CVSS",value:"cvss",align:"center"},{text:"CVSS Vector",value:"cvss_vector",align:"center",sortable:!1},{text:"Modified",value:"modified",align:"center"}],rowsPerPageItems:[5,10,20,50,100],snack:!1,snackColor:"",snackText:""}},mounted:function(){},watch:{search:{handler:function(t){this.search=t,this.options.page=1,this.getDataFromApi().then((function(t){}))},deep:!0},options:{handler:function(){this.getDataFromApi().then((function(t){}))},deep:!0}},methods:{getDataFromApi:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var i=t.options,s=i.sortBy,n=i.sortDesc,o=i.page,r=i.itemsPerPage;t.search.trim().toLowerCase();t.limit=r;var l=t.getcves(o,t.limit,s,n);setTimeout((function(){e({items:l})}),300)}))},getcves:function(t,e,a,i){var s=this,n="";a.length>0&&(n=!0===i[0]?"&sorted_by=-"+a:"&sorted_by="+a),this.$api.get("/api/kb/cve?limit="+e+"&page="+t+n+"&search="+this.search).then((function(t){return s.cves=t.data,s.loading=!1,s.cves})).catch((function(t){s.cves=[],s.loading=!1,y.a.fire({title:"Error",text:"unable to get cves",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))},toggleMonitored:function(t){var e=this,a={monitored:!t.monitored};this.$api.put("/api/kb/vendor/"+t.id+"/",a).then((function(a){a?(t.monitored=!t.monitored,e.snack=!0,e.snackColor="success",e.snackText="Monitoring status successfuly updated."):(e.snack=!0,e.snackColor="error",e.snackText="Unable to change the monitoring status"),e.loading=!1})).catch((function(t){e.loading=!1,y.a.fire({title:"Error",text:"Unable to change the monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))}}},gi=hi,fi=Object(l["a"])(gi,pi,_i,!1,null,null,null),bi=fi.exports;d()(fi,{VBtn:V["a"],VCard:I["a"],VCardTitle:T["e"],VChip:wt["a"],VDataTable:Dt["a"],VSnackbar:Vt["a"],VSpacer:D["a"],VTextField:O["a"]});var ki=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[!0===t.loading?a("div",{staticClass:"loading"},[t._v("Loadingâ¦")]):t._e(),a("v-card",[a("v-card-title",[t._v(" Bulletins "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers,items:t.bulletins.results,options:t.options,"server-items-length":t.bulletins.count,search:t.search,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"publicid","show-select":"","multi-sort":""},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.title",fn:function(e){var i=e.item;return[a("v-clamp",{attrs:{autoresize:"","max-lines":1},scopedSlots:t._u([{key:"after",fn:function(e){var i=e.toggle,s=e.expanded,n=e.clamped;return s||n?a("button",{staticClass:"toggle btn btn-sm",on:{click:i}},[t._v(" "+t._s(" more")+" ")]):t._e()}}],null,!0)},[t._v(" "+t._s(i.title)+" ")])]}},{key:"item.published",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(t.moment(i.published).format("YYYY-MM-DD")))])]}}])}),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1)},xi=[],yi={name:"bulletins",components:{VClamp:mt["a"]},data:function(){return{bulletins:[],totalbulletins:0,loading:!0,limit:20,search:"",options:{},selected:[],headers:[{text:"ID",value:"publicid",width:"150px"},{text:"Vendor",value:"vendor"},{text:"Title",value:"title"},{text:"Severity",value:"severity"},{text:"Published",value:"published"}],rowsPerPageItems:[5,10,20,50,100],snack:!1,snackColor:"",snackText:""}},mounted:function(){},watch:{search:{handler:function(t){this.search=t,this.options.page=1,this.getDataFromApi()},deep:!0},options:{handler:function(){this.getDataFromApi()},deep:!0}},methods:{getDataFromApi:function(){var t=this;return this.loading=!0,new Promise((function(e,a){var i=t.options,s=i.sortBy,n=i.sortDesc,o=i.page,r=i.itemsPerPage;t.search.trim().toLowerCase();t.limit=r;var l=t.getbulletins(o,t.limit,s,n);setTimeout((function(){t.loading=!1,e({items:l})}),300)}))},getbulletins:function(t,e,a,i){var s=this;this.loading=!0;var n="";a.length>0&&(n=!0===i[0]?"sorted_by=-"+a:"sorted_by="+a),this.$api.get("/api/kb/bulletins?limit="+e+"&page="+t+"&"+n+"&search="+this.search).then((function(t){return s.bulletins=t.data,s.bulletins})).catch((function(t){s.bulletins=[],s.loading=!1,y.a.fire({title:"Error",text:"unable to get bulletins",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})),this.loading=!1},toggleMonitored:function(t){var e=this,a={monitored:!t.monitored};this.$api.put("/api/kb/bulletin/"+t.id+"/",a).then((function(a){a?(t.monitored=!t.monitored,e.snack=!0,e.snackColor="success",e.snackText="Monitoring status successfuly updated."):(e.snack=!0,e.snackColor="error",e.snackText="Unable to change the monitoring status")})).catch((function(t){e.loading=!1,y.a.fire({title:"Error",text:"Unable to change the monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))}}},wi=yi,Ci=Object(l["a"])(wi,ki,xi,!1,null,null,null),Vi=Ci.exports;d()(Ci,{VBtn:V["a"],VCard:I["a"],VCardTitle:T["e"],VDataTable:Dt["a"],VSnackbar:Vt["a"],VSpacer:D["a"],VTextField:O["a"]});var Ii=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{fluid:""}},[a("p",{staticClass:"title"},[t._v("Usage")]),a("p",{staticClass:"subtitle-1"},[t._v("General information")]),a("p",{staticClass:"body-2"},[t._v(" PatrowlHears is an open-source platform supporting a vulnerability watch process for IT assets (OS, middleware, application, Web CMS, Java/.Net/Node library, network devices, IoT, ...). Vulnerabilities, exploits and threats information are collected from various OSINT feeds. ")]),a("p",{staticClass:"subtitle-1"},[t._v("Monitoring")]),a("p",{staticClass:"body-2"},[t._v(" Vendors, products, packages and vulnerabilities could be monitored. New data or changes are then identified and reported to users. Be careful when enabling/disabling monitoring on a vendor. Monitoring will be enabled/disabled on all related products, regardless of previous monitoring status. ")]),a("p",{staticClass:"subtitle-1"},[t._v("Organizations")]),a("p",{staticClass:"body-2"},[t._v(' An organization (or "Team") is a group of users sharing lists of monitored vendors, products, packages or vulnerabilities. An user could be member of several organizations. An user is able to add and edit exploits or threats references. These submissions remain private within the context of the organization. ')]),a("p",{staticClass:"subtitle-1"},[t._v("Alerting")]),a("p",{staticClass:"body-2"},[t._v(" Alerts could be sent on key events like changes in monitored assets or periodic reporting. Several notification systems could be enabled depending of your configuration, including email, Slack and Feedly. Contacts and endpoints are configured "),a("a",{attrs:{href:"#/settings"}},[t._v("here")]),t._v(". ")]),a("p",{staticClass:"subtitle-1"},[t._v("REST-API")]),a("p",{staticClass:"body-2"},[t._v(" All features and data are available through REST-API using JWT or Token header authentication. See "),a("a",{attrs:{href:"/api/docs/swagger"}},[t._v("Swagger")]),t._v(", "),a("a",{attrs:{href:"/api/docs/redoc"}},[t._v("ReDoc")]),t._v(" and "),a("a",{attrs:{href:"/api/docs/swagger/?format=openapi"}},[t._v("JSON OpenAPI")]),t._v(" for details. A throttling policy is set on API for preventing abuses. API tokens could be created, renewed or deleted in the Settings menu. ")]),a("p",{staticClass:"body-2"},[t._v(" Example:"),a("br"),a("code",[t._v("curl 'https://hears.patrowl.io/api/vulns/' -H 'Authorization: Token e36700fd50c1eab4cfef08936ff7421b093c13bb'")])]),a("p",{staticClass:"title"},[t._v("Updates")]),a("p",{staticClass:"body-2"},[t._v(" Information, news and updates are regularly posted on Patrowl.io "),a("a",{attrs:{href:"https://twitter.com/patrowl_io",target:"_blank"}},[t._v("Twitter")]),t._v(" account. ")]),a("p",{staticClass:"title"},[t._v("Contributing")]),a("p",{staticClass:"body-2"},[t._v(" PatrowlHears is an open-source project. All users and contributors are part of the Patrowl's community. We welcome your contributions. Please feel free to fork the code, play with it, make some patches and send us pull requests via issues. ")]),a("p",{staticClass:"title"},[t._v("More questions ?")]),a("p",{staticClass:"body-2"},[t._v(" Feel free to reach us in your prefered manner:"),a("br"),t._v(" - Send an email at "),a("a",{attrs:{href:"mailto:getsupport@patrowl.io"}},[t._v("getsupport@patrowl.io")]),a("br"),t._v(" - Fill an issue on "),a("a",{attrs:{href:"https://github.com/Patrowl/PatrowlHears/issues",target:"_blank"}},[t._v("GitHub")]),a("br"),t._v(" - Chat on "),a("a",{attrs:{href:"https://gitter.im/PatrowlHears/Support",target:"_blank"}},[t._v("Gitter PatrowlHears/Support")])]),a("p",{staticClass:"title"},[t._v("Copyright")]),a("p",{staticClass:"body-2"},[t._v(" Copyright (C) 2021 Nicolas MATTIOCCO (@MaKyOtOx - nicolas@patrowl.io) ")]),a("p",{staticClass:"title"},[t._v("Version")]),a("p",{staticClass:"body-2"},[t._v(" "+t._s(t.app_version)+" ")])])},Ti=[],Pi={name:"Help",data:function(){return{app_version:"1.0.0-RC1"}},mounted:function(){this.app_version=H.version},methods:{}},Si=Pi,Ei=Object(l["a"])(Si,Ii,Ti,!1,null,null,null),$i=Ei.exports;d()(Ei,{VContainer:S["a"]});var Ai=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("v-container",{attrs:{fluid:"","fill-height":""}},[a("v-layout",{attrs:{"align-center":"","justify-center":""}},[a("div",{staticClass:"text-md-center"},[a("h1",[t._v("404")]),a("h2",{staticClass:"my-3 headline"},[t._v("Sorry, page not found")]),a("div",[a("v-btn",{attrs:{color:"primary"},on:{click:t.goBack}},[t._v("Take me back!")]),a("v-btn",{attrs:{color:"primary"},on:{click:t.goHome}},[t._v("Go Home")])],1)])])],1)],1)},Mi=[],Di={methods:{goBack:function(){this.$router.go(-1)},goHome:function(){this.$router.push({path:"/"})}}},Oi=Di,ji=(a("3d91"),Object(l["a"])(Oi,Ai,Mi,!1,null,"7cd99d3d",null)),Bi=ji.exports;d()(ji,{VApp:u["a"],VBtn:V["a"],VContainer:S["a"],VLayout:A["a"]}),i["a"].use(f["a"]);var Ui=[{path:"/auth",name:"AuthLayout",component:B},{path:"/registration",name:"UserRegistrationLayout",component:Y},{path:"/",component:ct,redirect:"/homepage",children:[{path:"homepage",name:"Homepage",component:Bt},{path:"help",name:"Help",component:$i},{path:"alerts",name:"Alerts",component:Yt},{path:"ratings",name:"Ratings",component:ie},{path:"monitoring",name:"Monitoring",component:ja},{path:"settings",name:"Settings",component:we},{path:"search",name:"Search",component:Xe},{path:"search/:appsearch",name:"SearchData",component:Xe,props:!0},{path:"/products",name:"KBProducts",component:Ea},{path:"product",name:"ProductDetails",component:ei},{path:"product/:product_id",name:"ProductDetailsData",component:ei},{path:"/vendors",name:"VendorsProducts",component:Ra},{path:"/vendor/:vendor_id",name:"VendorDetails",component:qa},{path:"/packages",name:"Packages",component:ri},{path:"/packages/:package_id",name:"PackageDetails",component:mi},{path:"/kb/cves",name:"KBCVE",component:bi},{path:"/kb/bulletins",name:"KBBulletins",component:Vi},{path:"/vulns",name:"Vulns",component:sa},{path:"/vulns/:vuln_id",name:"VulnDetails",component:va},{path:"/exploits",name:"Exploits",component:ba},{path:"/test-as",name:"AdvancedSearch",component:Le}]},{path:"*",component:Bi}],Li=new f["a"]({base:"/",routes:Ui});Li.beforeEach((function(t,e,a){null==localStorage.getItem("org_id")&&(localStorage.removeItem("authToken"),localStorage.removeItem("username"),localStorage.removeItem("is_admin"),localStorage.removeItem("is_org_admin"),localStorage.removeItem("orgs"),localStorage.removeItem("org_id"),localStorage.removeItem("org_name")),null!==localStorage.getItem("authToken")||"/auth"===t.path||"/registration"===t.path?a():a("/auth")}));var Fi=Li,Ni=a("2f62"),Ri=a("bc3a"),Yi=a.n(Ri),zi=a("a7fe"),Xi=a.n(zi),Hi=a("04e1"),Wi=a.n(Hi);i["a"].use(Ni["a"]),i["a"].use(Xi.a,Yi.a);var qi=new Ni["a"].Store({state:{authUser:{},isAuthenticated:!1,jwt_auth_token:localStorage.getItem("authToken"),jwt_refresh_token:localStorage.getItem("refreshToken"),endpoints:{obtainJWT:"/auth-jwt/obtain_jwt_token/",refreshJWT:"/auth-jwt/refresh_jwt_token/"}},mutations:{setAuthUser:function(t,e){var a=e.authUser,s=e.isAuthenticated;i["a"].set(t,"authUser",a),i["a"].set(t,"isAuthenticated",s)},updateToken:function(t,e){localStorage.setItem("authToken",e),t.jwt_auth_token=e},removeToken:function(t){localStorage.removeItem("authToken"),t.jwt_auth_token=null}},actions:{obtainToken:function(t,e){var a=this,i={username:t,password:e};this.$api.post(this.state.endpoints.obtainJWT,i).then((function(t){a.commit("updateToken",t.data.access)})).catch((function(t){console.log(t)}))},refreshToken:function(){var t=this,e={token:this.state.jwt_refresh_token};this.$api.post(this.state.endpoints.refreshJWT,e).then((function(e){t.commit("updateToken",e.data.access)})).catch((function(t){console.log(t)}))},inspectToken:function(){var t=this.state.jwt_auth_token;if(t){var e=Wi()(t),a=e.exp,i=decode.orig_iat;a-Date.now()/1e3<1800&&Date.now()/1e3-i<628200?this.dispatch("refreshToken"):Date.now()}}},modules:{}});i["a"].filter("capitalize",(function(t){return t?(t=t.toString(),t.charAt(0).toUpperCase()+t.slice(1)):""})),i["a"].filter("truncate",(function(t,e,a){a=a||"...";var i=document.createElement("div");i.innerHTML=t;var s=i.textContent;return s.length>e?s.slice(0,e)+a:s}));var Ji=a("9eed"),Ki=a.n(Ji);i["a"].use(Ki.a,{vuetify:g}),i["a"].use(_.a),Yi.a.interceptors.response.use((function(t){return t}),(function(t){t.response})),Yi.a.interceptors.request.use((function(t){return qi.state.jwt_auth_token&&(t.headers.Authorization="JWT "+qi.state.jwt_auth_token),t}),(function(t){return Promise.reject(t)})),Yi.a.defaults.xsrfCookieName="csrftoken",Yi.a.defaults.xsrfHeaderName="X-CSRFTOKEN",i["a"].prototype.$api=Yi.a,i["a"].prototype.moment=qt.a,i["a"].config.productionTip=!1,new i["a"]({vuetify:g,router:Fi,VueSession:_.a,store:qi,render:function(t){return t(m)}}).$mount("#app"),i["a"].filter("capitalize",(function(t){return t?(t=t.toString(),t.charAt(0).toUpperCase()+t.slice(1)):""}))},8083:function(t,e,a){"use strict";var i=a("19ec"),s=a.n(i);s.a},8248:function(t){t.exports=JSON.parse('{"version":"1.0.1","edition":"Community","build":"(20210201)"}')},c2fc:function(t,e,a){"use strict";var i=a("1256"),s=a.n(i);s.a},c921:function(t,e,a){"use strict";var i=a("f88d"),s=a.n(i);s.a},cf25:function(t,e,a){"use strict";var i=a("fea6"),s=a.n(i);s.a},f748:function(t,e,a){},f88d:function(t,e,a){},fea6:function(t,e,a){}});
//# sourceMappingURL=app.9be54d36.js.map