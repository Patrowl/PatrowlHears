(function(t){function e(e){for(var s,n,r=e[0],l=e[1],c=e[2],u=0,v=[];u<r.length;u++)n=r[u],Object.prototype.hasOwnProperty.call(i,n)&&i[n]&&v.push(i[n][0]),i[n]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(t[s]=l[s]);d&&d(e);while(v.length)v.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var t,e=0;e<o.length;e++){for(var a=o[e],s=!0,r=1;r<a.length;r++){var l=a[r];0!==i[l]&&(s=!1)}s&&(o.splice(e--,1),t=n(n.s=a[0]))}return t}var s={},i={app:0},o=[];function n(e){if(s[e])return s[e].exports;var a=s[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=s,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(a,s,function(e){return t[e]}.bind(null,s));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var d=l;o.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},1:function(t,e){},1234:function(t,e,a){},1256:function(t,e,a){},1604:function(t,e,a){"use strict";a("d5c3")},"19ec":function(t,e,a){},2:function(t,e){},"22c2":function(t,e,a){},"26a5":function(t,e,a){},"2a36":function(t,e,a){},"2f63":function(t,e,a){"use strict";a("64ae")},3369:function(t,e,a){},3437:function(t,e,a){"use strict";a("1234")},"3c0c":function(t,e,a){"use strict";a("2a36")},"3d91":function(t,e,a){"use strict";a("f748")},"3f07":function(t,e,a){"use strict";a("4b96")},4678:function(t,e,a){var s={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function i(t){var e=o(t);return a(e)}function o(t){if(!a.o(s,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return s[t]}i.keys=function(){return Object.keys(s)},i.resolve=o,t.exports=i,i.id="4678"},"4b96":function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);var s=a("2b0e"),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("router-view")],1)},o=[],n={name:"App",data(){return{section:"AppLayout"}},created(){document.title="CanPatch"},methods:{logout(){this.$store.commit("removeToken"),this.$router.push("/auth")}}},r=n,l=(a("cf25"),a("2877")),c=a("6544"),d=a.n(c),u=a("7496"),v=Object(l["a"])(r,i,o,!1,null,null,null),m=v.exports;d()(v,{VApp:u["a"]});var h=a("0628"),p=a.n(h),_=(a("15f5"),a("5363"),a("f309"));s["a"].use(_["a"]);var g=new _["a"]({icons:{iconfont:"mdi"}}),f=a("8c4f"),b=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{"grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:"","align-center":"","justify-center":"","fill-height":""}},[a("v-flex",{attrs:{xs12:"",sm8:"",lg4:"",md5:""}},[a("v-card",{staticClass:"login-card"},[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Login to CanPatch")])]),a("v-spacer"),a("v-card-text",[t.loading?a("v-layout",{attrs:{row:"","fill-height":"","justify-center":"","align-center":""}},[a("v-progress-circular",{attrs:{size:50,color:"primary",indeterminate:""}})],1):a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-container",[a("v-text-field",{attrs:{counter:70,label:"username",maxlength:"70",autocomplete:"username",required:""},model:{value:t.credentials.username,callback:function(e){t.$set(t.credentials,"username",e)},expression:"credentials.username"}}),a("v-text-field",{attrs:{type:"password",counter:256,label:"password",rules:t.rules.password,maxlength:"256",autocomplete:"current-password",required:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.login.apply(null,arguments)}},model:{value:t.credentials.password,callback:function(e){t.$set(t.credentials,"password",e)},expression:"credentials.password"}}),a("v-checkbox",{attrs:{label:"First visit"},model:{value:t.credentials.enable_firststeps,callback:function(e){t.$set(t.credentials,"enable_firststeps",e)},expression:"credentials.enable_firststeps"}})],1),a("v-btn",{staticClass:"deep-orange white--text",attrs:{disabled:!t.valid,block:""},on:{click:t.login}},[t._v("Login")])],1)],1)],1),a("br")],1)],1),a("v-snackbar",{attrs:{timeout:t.snackTimeout,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)},k=[],x=a("3d20"),y=a.n(x),w={name:"AuthLayout",data:()=>({credentials:{username:"",password:"",use_default_organization:!0,enable_firststeps:!0},valid:!0,loading:!1,rules:{username:[t=>!!t||"Username is required",t=>t&&t.length>3||"A username must be more than 3 characters long",t=>/^[a-z0-9_]+$/.test(t)||"A username can only contain letters and digits"],password:[t=>!!t||"Password is required",t=>t&&t.length<256||"The password must be lesser than 256 characters"]},snack:!1,snackColor:"",snackText:"",snackTimeout:3e3}),methods:{login(){this.$refs.form.validate()&&(this.loading=!0,this.$store.commit("removeToken"),this.$api.post(this.$store.state.endpoints.obtainJWT,this.credentials).then(t=>{this.$store.commit("updateToken",t.data.access);this.$api.get("/users/set-org").then(t=>{t&&200===t.status&&"set"===t.data.status?(localStorage.setItem("org_id",t.data.org_id),localStorage.setItem("org_name",t.data.org_name),this.$api.get("/users/api/current").then(t=>{localStorage.setItem("username",t.data.username),localStorage.setItem("is_admin",t.data.is_superuser),localStorage.setItem("is_org_admin",t.data.is_org_admin),localStorage.setItem("orgs",JSON.stringify(t.data.orgs)),localStorage.setItem("org_name",t.data.current_org.org_name),localStorage.setItem("profile",JSON.stringify(t.data.profile)),1==t.data.is_superuser&&localStorage.setItem("is_org_admin",!0),this.$store.commit("setAuthUser",{authUser:t.data,isAuthenticated:!0}),1==this.credentials.enable_firststeps?this.$router.push({name:"Homepage",query:{firststeps:"1"}}):this.$router.push({name:"Homepage"})})):(this.logout(),this.loading=!1,this.snack=!0,this.snackColor="error",this.snackText="Unable to set organization")})}).catch(t=>{this.$store.commit("removeToken"),this.loading=!1,y.a.fire({title:"Error",text:"Wrong username or password",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}))},loginsso(){this.$router.push({name:"AuthSSOLayout"})},logout(){this.$store.commit("removeToken"),localStorage.removeItem("authToken"),localStorage.removeItem("username"),localStorage.removeItem("is_admin"),localStorage.removeItem("is_org_admin"),localStorage.removeItem("orgs"),localStorage.removeItem("org_id"),localStorage.removeItem("org_name"),this.$session.destroy()}}},C=w,V=a("8336"),S=a("b0af"),T=a("99d9"),I=a("ac7c"),P=a("a523"),E=a("0e8f"),$=a("4bd4"),A=a("a722"),D=a("490a"),M=a("2db4"),B=a("2fa4"),O=a("8654"),j=Object(l["a"])(C,b,k,!1,null,null,null),U=j.exports;d()(j,{VBtn:V["a"],VCard:S["a"],VCardText:T["d"],VCardTitle:T["e"],VCheckbox:I["a"],VContainer:P["a"],VFlex:E["a"],VForm:$["a"],VLayout:A["a"],VProgressCircular:D["a"],VSnackbar:M["a"],VSpacer:B["a"],VTextField:O["a"]});var F=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{"grid-list-md":""}},[a("v-snackbar",{attrs:{timeout:t.snackTimeout,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)},L=[],N={name:"AuthSSOLayout",data:()=>({snack:!1,snackColor:"",snackText:"",snackTimeout:3e3}),mounted(){"code"in this.$route.query?this.$api.get("/oauth2/callback").then(t=>{this.$store.commit("updateToken",t.data.access);this.$api.get("/users/set-org").then(t=>{t&&200===t.status&&"set"===t.data.status?(localStorage.setItem("org_id",t.data.org_id),localStorage.setItem("org_name",t.data.org_name),this.$api.get("/users/api/current").then(t=>{localStorage.setItem("username",t.data.username),localStorage.setItem("is_admin",t.data.is_superuser),localStorage.setItem("is_org_admin",t.data.is_org_admin),localStorage.setItem("orgs",JSON.stringify(t.data.orgs)),localStorage.setItem("org_name",t.data.current_org.org_name),localStorage.setItem("profile",JSON.stringify(t.data.profile)),1==t.data.is_superuser&&localStorage.setItem("is_org_admin",!0),this.$store.commit("setAuthUser",{authUser:t.data,isAuthenticated:!0}),1==this.credentials.enable_firststeps?this.$router.push({name:"Homepage",query:{firststeps:"1"}}):this.$router.push({name:"Homepage"})})):(this.logout(),this.loading=!1,this.snack=!0,this.snackColor="error",this.snackText="Unable to set organization")})}):this.$api.get("/adfs/login-page").then(t=>{window.location.href=decodeURI(t.data.url)})}},R=N,Y=Object(l["a"])(R,F,L,!1,null,null,null),z=Y.exports;d()(Y,{VBtn:V["a"],VContainer:P["a"],VSnackbar:M["a"]});var X=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-app",[s("v-navigation-drawer",{attrs:{clipped:"",app:"",color:"grey lighten-4"},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[s("v-list",{staticClass:"grey lighten-4",attrs:{dense:""}},[t._l(t.menu_items,(function(e,a){return[e.submenu?s("v-list-group",{attrs:{"no-action":"","prepend-icon":e.icon},scopedSlots:t._u([{key:"activator",fn:function(){return[s("v-list-item-content",[s("v-list-item-title",{domProps:{textContent:t._s(e.text)}})],1)]},proxy:!0}],null,!0)},t._l(e.submenu,(function(e,a){return s("v-list-item",{key:a,attrs:{to:e.to}},[s("v-list-item-content",[s("v-list-item-title",{attrs:{link:"",to:e.to},domProps:{textContent:t._s(e.text)}})],1)],1)})),1):e.divider?s("v-divider",{key:a}):s("v-list-item",{key:a,attrs:{link:"",to:e.to}},[s("v-list-item-action",[s("v-icon",[t._v(t._s(e.icon))])],1),s("v-list-item-content",[s("v-list-item-title",{staticClass:"grey-darken-3--text"},[t._v(" "+t._s(e.text)+" ")])],1)],1)]}))],2)],1),s("v-app-bar",{attrs:{app:"","clipped-left":"",color:"grey lighten-2",dense:""}},[s("v-app-bar-nav-icon",{on:{click:function(e){t.drawer=!t.drawer}}}),s("img",{attrs:{width:"180px",src:a("cf05")}}),s("v-text-field",{attrs:{"solo-inverted":"",flat:"","hide-details":"",label:"Search","prepend-inner-icon":"mdi-magnify",dense:""},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search()}},model:{value:t.appsearch,callback:function(e){t.appsearch=e},expression:"appsearch"}}),s("v-spacer"),s("v-btn",{attrs:{href:"/login"}},[t._v("Login")]),s("v-btn",{attrs:{icon:"",href:"/login"}},[s("v-icon",[t._v("mdi-login")])],1)],1),s("v-main",[s("v-container",{attrs:{fluid:""}},[s("router-view")],1)],1),s("v-footer",[s("v-spacer"),s("div",{staticClass:"caption"},[s("v-chip",{attrs:{color:"deep-orange",href:"https://canaris.in",small:"",label:""}},[t._v("Visit Canaris")]),t._v(" - version "+t._s(t.app_version.version)+" - "+t._s(t._f("capitalize")(t.app_version.edition))+" Edition "+t._s(t.app_version.build))],1)],1)],1)},H=[],W=a("8248"),q={name:"AppPublicLayout",data:()=>({drawer:null,app_version:"",appsearch:"",menu_items:[{icon:"mdi-home",text:"Home",to:"/homepage"},{icon:"mdi-magnify",text:"Search",to:"/public/search"},{divider:!0},{icon:"mdi-file-multiple",text:"Monitoring",to:"/monitoring"},{icon:"mdi-file-find",text:"Vulnerabilities",to:"/public/vulns"},{icon:"mdi-knife-military",text:"Exploits",to:"/exploits"},{icon:"mdi-security",text:"Ratings",to:"/ratings"},{icon:"mdi-bookmark",text:"CVE",to:"/kb/cves"},{icon:"mdi-clipboard-check-outline",text:"Bulletins",to:"/kb/bulletins"},{icon:"mdi-apps",text:"Vendors & Products",to:"/vendors"},{icon:"mdi-package-variant",text:"Packages",to:"/packages"},{divider:!0},{icon:"mdi-help-circle",text:"Help",to:"/help"}],username:"",user_organization:"",orgs:[]}),mounted(){this.getUsername(),this.getOrganization(),this.getOrganizations(),this.app_version=W},methods:{logout(){this.$store.commit("removeToken"),localStorage.removeItem("authToken"),localStorage.removeItem("username"),localStorage.removeItem("is_admin"),localStorage.removeItem("is_org_admin"),localStorage.removeItem("orgs"),localStorage.removeItem("org_id"),localStorage.removeItem("org_name"),this.$session.destroy(),this.$router.push("/auth")},getUsername(){this.username=localStorage.getItem("username")},getOrganization(){this.user_organization=localStorage.getItem("org_name")},getOrganizations(){this.orgs=JSON.parse(localStorage.getItem("orgs"))},search(){this.$route.path==="/public/search/"+this.appsearch?this.$router.go():this.$router.push({path:"/public/search/"+this.appsearch})},setOrganization(t){this.$api.get("/users/set-org/"+t.id).then(e=>{e&&200===e.status&&"set"===e.data.status&&(localStorage.setItem("org_id",t.id),localStorage.setItem("org_name",t.name),this.user_organization=t.name,this.$router.go())})}}},J=q,K=a("40dc"),G=a("5bc1"),Z=a("cc20"),Q=a("ce7e"),tt=a("553a"),et=a("132d"),at=a("8860"),st=a("56b0"),it=a("da13"),ot=a("1800"),nt=a("5d23"),rt=a("f6c4"),lt=a("f774"),ct=Object(l["a"])(J,X,H,!1,null,null,null),dt=ct.exports;d()(ct,{VApp:u["a"],VAppBar:K["a"],VAppBarNavIcon:G["a"],VBtn:V["a"],VChip:Z["a"],VContainer:P["a"],VDivider:Q["a"],VFooter:tt["a"],VIcon:et["a"],VList:at["a"],VListGroup:st["a"],VListItem:it["a"],VListItemAction:ot["a"],VListItemContent:nt["g"],VListItemTitle:nt["k"],VMain:rt["a"],VNavigationDrawer:lt["a"],VSpacer:B["a"],VTextField:O["a"]});var ut=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{"grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:"","align-center":"","justify-center":"","fill-height":""}},[a("v-flex",{attrs:{xs12:"",sm8:"",lg4:"",md5:""}},[a("v-card",{staticClass:"registration-card"},[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Register to CanPatch")])]),a("v-spacer"),a("v-card-text",[t.loading?a("v-layout",{attrs:{row:"","fill-height":"","justify-center":"","align-center":""}},[a("v-progress-circular",{attrs:{size:50,color:"primary",indeterminate:""}})],1):a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-container",[a("v-text-field",{attrs:{label:"Email",rules:t.rules.email,required:"",disabled:""},model:{value:t.registration.email,callback:function(e){t.$set(t.registration,"email",e)},expression:"registration.email"}}),a("v-text-field",{attrs:{counter:128,label:"Username",maxlength:"128",required:"",autocomplete:"username"},model:{value:t.registration.username,callback:function(e){t.$set(t.registration,"username",e)},expression:"registration.username"}}),a("v-text-field",{attrs:{type:"password",rules:t.rules.password,counter:30,label:"Password",maxlength:"30",required:"",autocomplete:"new-password"},model:{value:t.registration.password,callback:function(e){t.$set(t.registration,"password",e)},expression:"registration.password"}}),a("v-text-field",{attrs:{type:"password",rules:t.rules.password,counter:30,label:"Password (again)",maxlength:"30",required:"",autocomplete:"new-password"},model:{value:t.registration.password_confirm,callback:function(e){t.$set(t.registration,"password_confirm",e)},expression:"registration.password_confirm"}}),a("v-text-field",{attrs:{counter:128,label:"Firstname",maxlength:"128",autocomplete:"firstname"},model:{value:t.registration.first_name,callback:function(e){t.$set(t.registration,"first_name",e)},expression:"registration.first_name"}}),a("v-text-field",{attrs:{counter:128,label:"Lastname",maxlength:"128",autocomplete:"lastname"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.register.apply(null,arguments)}},model:{value:t.registration.last_name,callback:function(e){t.$set(t.registration,"last_name",e)},expression:"registration.last_name"}})],1),a("v-btn",{staticClass:"deep-orange white--text",attrs:{disabled:!t.valid},on:{click:t.register}},[t._v("Register")])],1)],1)],1)],1)],1)],1)},vt=[],mt={name:"UserRegistrationLayout",data:()=>({loading:!1,valid:!0,registration:{email:"",username:"",password:"",password_confirm:"",first_name:"",last_name:""},rules:{username:[t=>!!t||"Username is required",t=>t&&t.length>3||"A username must be more than 3 characters long",t=>/^[a-z0-9_]+$/.test(t)||"A username can only contain letters and digits"],password:[t=>!!t||"Password is required",t=>t&&t.length>8||"The password must be longer than 8 characters",t=>/(?=.*[A-Z])/.test(t)||"Must have one uppercase character",t=>/(?=.*\d)/.test(t)||"Must have one number",t=>/([!@#$%-_])/.test(t)||"Must have one special character [!@#$%-_]"],email:[t=>!!t||"E-mail is required",t=>/.+@.+\..+/.test(t)||"E-mail must be valid"]}}),beforeRouteUpdate(t){this.invitation_token=t.query.token,this.checkToken()},mounted(){this.invitation_token=this.$router.currentRoute.query.token,this.checkToken()},methods:{checkToken(){this.$api.get("/users/activate/"+this.invitation_token).then(t=>{t&&200===t.status&&"valid"===t.data.status?this.registration.email=t.data.email:this.$router.push("/auth")}).catch(t=>{this.$router.push("/auth")})},register(){this.$api.post("/users/activate/"+this.invitation_token,this.registration).then(t=>{t&&200===t.status&&"success"===t.data.status&&this.$router.push("/auth")}).catch(t=>{})}}},ht=mt,pt=Object(l["a"])(ht,ut,vt,!1,null,null,null),_t=pt.exports;d()(pt,{VBtn:V["a"],VCard:S["a"],VCardText:T["d"],VCardTitle:T["e"],VContainer:P["a"],VFlex:E["a"],VForm:$["a"],VLayout:A["a"],VProgressCircular:D["a"],VSpacer:B["a"],VTextField:O["a"]});var gt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-app",[s("v-navigation-drawer",{attrs:{clipped:"",app:"",color:"grey lighten-4"},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[s("v-list",{staticClass:"grey lighten-4",attrs:{dense:""}},[t._l(t.menu_items,(function(e,a){return[e.submenu?s("v-list-group",{attrs:{"no-action":"","prepend-icon":e.icon},scopedSlots:t._u([{key:"activator",fn:function(){return[s("v-list-item-content",[s("v-list-item-title",{domProps:{textContent:t._s(e.text)}})],1)]},proxy:!0}],null,!0)},t._l(e.submenu,(function(e,a){return s("v-list-item",{key:a,attrs:{to:e.to}},[s("v-list-item-content",[s("v-list-item-title",{attrs:{link:"",to:e.to},domProps:{textContent:t._s(e.text)}})],1)],1)})),1):e.divider?s("v-divider",{key:a}):s("v-list-item",{key:a,attrs:{link:"",to:e.to}},[s("v-list-item-action",[s("v-icon",[t._v(t._s(e.icon))])],1),s("v-list-item-content",[s("v-list-item-title",{staticClass:"grey-darken-3--text"},[t._v(" "+t._s(e.text)+" ")])],1)],1)]}))],2)],1),s("v-app-bar",{attrs:{app:"","clipped-left":"",color:"grey lighten-2",dense:""}},[s("v-app-bar-nav-icon",{on:{click:function(e){t.drawer=!t.drawer}}}),s("span",{staticClass:"title ml-3 mr-5 deep-orange--text"},[s("img",{attrs:{width:"180px",src:a("cf05")}})]),s("v-text-field",{attrs:{"solo-inverted":"",flat:"","hide-details":"",label:"Search","prepend-inner-icon":"mdi-magnify",dense:""},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search()}},model:{value:t.appsearch,callback:function(e){t.appsearch=e},expression:"appsearch"}}),s("v-spacer"),s("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on;return[s("v-btn",t._g({attrs:{tile:""}},a),[t._v(" "+t._s(t.username)+"@"+t._s(t.user_organization)+" ")])]}}])},[s("v-list",t._l(t.orgs,(function(e,a){return s("v-list-item",{key:a,on:{click:function(a){return t.setOrganization(e)}}},[s("v-list-item-title",[t._v(t._s(e.slug))])],1)})),1)],1),s("v-btn",{attrs:{icon:""},on:{click:t.logout}},[s("v-icon",[t._v("mdi-logout")])],1)],1),s("v-main",[s("v-container",{attrs:{fluid:""}},[s("router-view")],1)],1),s("v-footer",[s("v-spacer"),s("div",{staticClass:"caption"},[s("v-chip",{attrs:{color:"deep-orange",href:"https://canaris.in",small:"",label:""}},[t._v("Visit Canaris")]),t._v(" © 2020-"+t._s((new Date).getFullYear())+" // version "+t._s(t.app_version.version)+" // "+t._s(t._f("capitalize")(t.app_version.edition))+" Edition "+t._s(t.app_version.build))],1)],1)],1)},ft=[],bt={name:"AppLayout",data:()=>({drawer:null,app_version:"",appsearch:"",menu_items:[{icon:"mdi-home",text:"Home",to:"/homepage"},{icon:"mdi-magnify",text:"Search",to:"/search"},{divider:!0},{icon:"mdi-file-multiple",text:"Monitoring",to:"/monitoring"},{icon:"mdi-file-find",text:"Vulnerabilities",to:"/vulns"},{icon:"mdi-knife-military",text:"Exploits",to:"/exploits"},{icon:"mdi-security",text:"Ratings",to:"/ratings"},{icon:"mdi-bookmark",text:"Public feeds",to:"",submenu:[{icon:"mdi-bookmark",text:"CVE",to:"/kb/cves"},{icon:"mdi-bookmark",text:"Bulletins",to:"/kb/bulletins"},{icon:"mdi-apps",text:"Vendors & Products",to:"/vendors"},{icon:"mdi-package-variant",text:"Packages",to:"/packages"}]},{divider:!0},{icon:"mdi-toggle-switch",text:"Settings",to:"/settings"},{icon:"mdi-help-circle",text:"Help",to:"/help"}],username:"",user_organization:"",orgs:[],snack:!1,snackColor:"",snackText:"",snackTimeout:3e3}),mounted(){this.getUsername(),this.getOrganization(),this.getOrganizations(),this.app_version=W},methods:{logout(){this.$store.commit("removeToken"),localStorage.removeItem("authToken"),localStorage.removeItem("username"),localStorage.removeItem("is_admin"),localStorage.removeItem("is_org_admin"),localStorage.removeItem("orgs"),localStorage.removeItem("org_id"),localStorage.removeItem("org_name"),this.$session.destroy(),this.$router.push("/auth")},getUsername(){this.username=localStorage.getItem("username")},getOrganization(){this.user_organization=localStorage.getItem("org_name")},getOrganizations(){this.orgs=JSON.parse(localStorage.getItem("orgs"))},search(){this.$route.path==="/search/"+this.appsearch?this.$router.go():this.$router.push({path:"/search/"+this.appsearch})},setOrganization(t){this.$api.get("/users/set-org/"+t.id).then(e=>{e&&200===e.status&&"set"===e.data.status&&(localStorage.setItem("org_id",t.id),localStorage.setItem("org_name",t.name),this.user_organization=t.name,this.$router.go())})}}},kt=bt,xt=a("e449"),yt=Object(l["a"])(kt,gt,ft,!1,null,null,null),wt=yt.exports;d()(yt,{VApp:u["a"],VAppBar:K["a"],VAppBarNavIcon:G["a"],VBtn:V["a"],VChip:Z["a"],VContainer:P["a"],VDivider:Q["a"],VFooter:tt["a"],VIcon:et["a"],VList:at["a"],VListGroup:st["a"],VListItem:it["a"],VListItemAction:ot["a"],VListItemContent:nt["g"],VListItemTitle:nt["k"],VMain:rt["a"],VMenu:xt["a"],VNavigationDrawer:lt["a"],VSpacer:B["a"],VTextField:O["a"]});var Ct=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md4:""}},[a("v-card",{attrs:{color:"deep-orange"}},[a("v-card-title",[t._v("Vulnerabilities")]),a("v-card-subtitle",{attrs:{primary:""}},[t._v("CVE, 0days, ...")]),a("v-card-text",{staticClass:"display-3 text-center"},[t._v(" "+t._s(t.stats.vulns)+" ")])],1)],1),a("v-flex",{attrs:{md4:""}},[a("v-card",{attrs:{color:"lime"}},[a("v-card-title",{attrs:{primary:""}},[t._v("Metadata")]),a("v-card-subtitle",{attrs:{primary:""}},[t._v("Exploits, Threats activities, News, Blog posts")]),a("v-card-text",{staticClass:"display-3 text-center"},[t._v(" "+t._s(t.stats.exploits+t.stats.threats)+" ")])],1)],1),a("v-flex",{attrs:{md4:""}},[a("v-card",{attrs:{color:"teal"}},[a("v-card-title",{attrs:{primary:""}},[t._v("Monitored items")]),a("v-card-subtitle",{attrs:{primary:""}},[t._v("Vendors, Products, Vulnerabilites, Bulletins")]),a("v-card-text",{staticClass:"display-3 text-center"},[t._v(" "+t._s(t.stats.monitored)+" ")])],1)],1)],1),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md12:""}},[a("v-card",{attrs:{outlined:""}},[a("v-card-title",[t._v("Latest monitored vulnerabilities and products (< 30 days)")]),a("v-card-text",{staticClass:"text-center"},[a("v-data-table",{attrs:{headers:t.monitored_vulns_headers,items:t.monitored_vulns,"items-per-page":5,loading:t.loading_last_vulns},on:{"click:row":t.viewVuln},scopedSlots:t._u([{key:"item.score",fn:function(e){var s=e.item;return[a("v-chip",{staticClass:"text-center font-weight-bold",attrs:{color:t.getRatingColor(s.score),label:""}},[t._v(t._s(s.score)+"/100")]),a("br"),a("span",{staticClass:"text-caption"},[t._v("CVSSv2: "+t._s(s.cvss))]),a("br"),a("span",{staticClass:"text-caption"},[t._v("CVSSv3: "+t._s(s.cvss3))])]}},{key:"item.summary",fn:function(e){var s=e.item;return[a("div",{staticClass:"py-2"},[a("div",{staticClass:"pb-2"},[a("span",{staticClass:"deep-orange--text font-weight-medium"},[t._v(t._s(s.cveid))]),t._v(" / PH-"+t._s(s.id)+" "),a("v-btn",{attrs:{color:"deep-orange",icon:"",small:""}},[a("v-icon",{attrs:{title:"View details"},on:{click:function(e){return t.viewVuln(s)}}},[t._v("mdi-arrow-right-bold-circle-outline")])],1)],1),a("div",[t._v(" "+t._s(s.summary)+" ")]),t._l(s.products,(function(e){return a("v-chip",{key:e.id,staticClass:"vendor-chip",attrs:{label:"",small:"",link:""},on:{click:function(a){return t.$router.push({path:"/product/"+e.id})}}},[t._v(" "+t._s(e.vendor)+": "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(e.name))])])}))],2)]}},{key:"item.metadata",fn:function(e){var s=e.item;return[a("v-chip",{staticClass:"font-weight-bold",attrs:{label:"",link:"",small:"",color:s.exploit_count>0?"deep-orange":"grey",title:"Is exploitable?"}},[t._v(t._s(s.exploit_count))]),a("v-btn",{attrs:{color:"NETWORK"==s.access.vector?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Is exploitable remotely?"}},[t._v("mdi-cloud")])],1),a("v-btn",{attrs:{color:"NONE"==s.access.authentication?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Require authentication?"}},[t._v("mdi-shield-account")])],1),a("v-btn",{attrs:{color:s.is_in_the_news||s.is_in_the_wild?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Is in the news or exploited in the wild?"}},[t._v("mdi-star")])],1)]}},{key:"item.updated_at",fn:function(e){var s=e.item;return[a("span",[t._v(t._s(t.moment(s.updated_at).format("YYYY-MM-DD, hh:mm:ss")))])]}}])})],1)],1)],1)],1),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md6:""}},[a("v-card",{attrs:{outlined:""}},[a("v-card-title",[t._v(" Latest vulnerabilities (Top 20) "),a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:function(e){return t.viewVulns()}}},[t._v("See all")])],1),a("v-card-text",{staticClass:"text-center"},[a("v-data-table",{attrs:{headers:t.vulns_headers,items:t.vulns,"items-per-page":5,"item-class":t.rowColor,loading:t.loading_last_vulns},on:{"click:row":t.viewVuln},scopedSlots:t._u([{key:"item.summary",fn:function(e){var s=e.item;return[a("v-clamp",{attrs:{autoresize:"","max-lines":1}},[t._v(" "+t._s(s.summary)+" ")])]}}])})],1)],1)],1),a("v-flex",{attrs:{md6:""}},[a("v-card",{attrs:{outlined:""}},[a("v-card-title",{attrs:{primary:""}},[t._v("Latest exploits metadata (Top 20)")]),a("v-card-text",{staticClass:"text-center"},[a("v-data-table",{attrs:{headers:t.exploits_headers,items:t.exploits,"items-per-page":5,loading:t.loading_last_vulns},scopedSlots:t._u([{key:"item.relevancy_level",fn:function(e){var s=e.item;return[t._l(1,(function(e){return 1==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"yellow"}}):t._e()})),t._l(4,(function(e){return 1==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six-outline",attrs:{"x-small":"",color:"grey"}}):t._e()})),t._l(2,(function(e){return 2==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"orange"}}):t._e()})),t._l(3,(function(e){return 2==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six-outline",attrs:{"x-small":"",color:"grey"}}):t._e()})),t._l(3,(function(e){return 3==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"orange darken-4"}}):t._e()})),t._l(2,(function(e){return 3==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six-outline",attrs:{"x-small":"",color:"grey"}}):t._e()})),t._l(4,(function(e){return 4==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"red"}}):t._e()})),t._l(1,(function(e){return 4==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six-outline",attrs:{"x-small":"",color:"grey"}}):t._e()})),t._l(5,(function(e){return 5==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"red darken-4"}}):t._e()}))]}},{key:"item.link",fn:function(e){var s=e.item;return[a("v-clamp",{attrs:{autoresize:"","max-lines":1}},[t._v(" "+t._s(s.link)+" ")])]}}])})],1)],1)],1),a("v-dialog",{attrs:{width:"600"},model:{value:t.firststeps_overlay,callback:function(e){t.firststeps_overlay=e},expression:"firststeps_overlay"}},[a("first-steps")],1)],1)],1)},Vt=[],St=a("1ce8"),Tt={methods:{getCVSSColor(t){return t>=9?"red darken-4":t>=7?"red":t>=4?"orange":t>=.1?"yellow":"grey"},getTLPColor(t){return"white"===t?"":"green"===t?"green":"amber"===t?"orange":"red"===t?"red":"black"===t?"black":"grey"},getRatingColor(t){return t>=80?"red":t>=60?"orange":t>=40?"yellow":t>=0?"blue":"grey"},getBoolColor(t){return t?"deep-orange":"grey"},getNumberColor(t){return t>0?"deep-orange":"grey"}},mounted(){},destroyed(){}},It=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-stepper",{attrs:{"non-linear":"",light:""},model:{value:t.stepper_fs,callback:function(e){t.stepper_fs=e},expression:"stepper_fs"}},[a("v-stepper-header",[a("v-stepper-step",{attrs:{editable:"",step:"1",color:"deep-orange"}},[t._v("Welcome")]),a("v-divider"),a("v-stepper-step",{attrs:{editable:"",step:"2",color:"deep-orange"}},[t._v("Monitoring")]),a("v-divider"),a("v-stepper-step",{attrs:{editable:"",step:"3",color:"deep-orange"}},[t._v("Alerting")]),a("v-divider"),a("v-stepper-step",{attrs:{editable:"",step:"4",color:"deep-orange"}},[t._v("Finish")])],1),a("v-stepper-content",{attrs:{step:"1"}},[a("v-card",{staticClass:"mb-6",attrs:{height:"200px",tile:""}},[a("v-card-title",[t._v(" Welcome in CanPatch ! ")]),a("v-card-text",[a("strong",[t._v("CanPatch")]),t._v(" is an advanced platform offering a continuous watch on vulnerabilities found on your IT assets, enriched by cyber-threat Intelligence data."),a("br"),a("br"),t._v(" Let's get started. Click 'Next' button to continue. ")])],1),a("v-btn",{attrs:{color:"grey"},on:{click:function(e){return t.nextStep(1)}}},[t._v("Next"),a("v-icon",[t._v("mdi-chevron-right")])],1)],1),a("v-stepper-content",{attrs:{step:"2"}},[a("v-card",{staticClass:"mb-6",attrs:{height:"auto",tile:""}},[a("v-card-title",[t._v(" Monitor your assets ")]),a("v-card-text",[t._v(" First, you have to select products to monitor. You will be advised when new vulnerabilities are found or a change has been detected by our platform."),a("br"),t._v(" Select 3 products (max.). Don't panic, it's just a start ;)"),a("br")]),a("v-card-text",[a("v-autocomplete",{attrs:{items:t.products_items,loading:t.products_isLoading,"search-input":t.products_search,chips:"","cache-items":"","hide-details":"","hide-selected":"","hide-no-data":"","item-text":"name","item-value":"id",label:"Search for a product...",multiple:""},on:{"update:searchInput":function(e){t.products_search=e},"update:search-input":function(e){t.products_search=e}},scopedSlots:t._u([{key:"selection",fn:function(e){return[a("v-chip",t._b({attrs:{"input-value":e.selected,close:""},on:{click:e.select,"click:close":function(a){return t.removeSelectedProduct(e.item)}}},"v-chip",e.attrs,!1),[t._v(" "+t._s(e.item.vendor)+"/"+t._s(e.item.name)+" ")])]}},{key:"item",fn:function(e){return[t._v(" "+t._s(e.item.vendor)+"/"+t._s(e.item.name)+" ")]}}]),model:{value:t.products_autocomplete,callback:function(e){t.products_autocomplete=e},expression:"products_autocomplete"}})],1),a("v-divider")],1),a("v-btn",{attrs:{color:"grey"},on:{click:function(e){return t.nextStep(2,"saveMonitoredProducts")}}},[t._v("Next"),a("v-icon",[t._v("mdi-chevron-right")])],1),a("v-btn",{attrs:{text:""},on:{click:function(e){return t.nextStep(0)}}},[t._v("Cancel")])],1),a("v-stepper-content",{attrs:{step:"3"}},[a("v-card",{staticClass:"mb-6",attrs:{height:"200px",tile:""}},[a("v-card-title",[t._v(" Alert me ")]),a("v-card-text",[t._v(" You have successfuly added your products to your monitoring list. Now, let us set a contact email for receiving alerts. Other alert channels are also available (Slack, TheHive, ...) in the 'Settings' page. "),a("v-combobox",{attrs:{clearable:"",label:"Contact Emails",multiple:"",rules:t.emailRules},scopedSlots:t._u([{key:"selection",fn:function(e){var s=e.attrs,i=e.item,o=e.select,n=e.selected;return[a("v-chip",t._b({attrs:{"input-value":n,close:""},on:{click:o,"click:close":function(e){return t.removeContactEmail(i)}}},"v-chip",s,!1),[a("strong",[t._v(t._s(i))]),t._v("  ")])]}}]),model:{value:t.org_settings.alerts_emails,callback:function(e){t.$set(t.org_settings,"alerts_emails",e)},expression:"org_settings.alerts_emails"}})],1)],1),a("v-btn",{attrs:{color:"grey"},on:{click:function(e){return t.nextStep(3,"saveAlertEmails")}}},[t._v("Next"),a("v-icon",[t._v("mdi-chevron-right")])],1),a("v-btn",{attrs:{text:""},on:{click:function(e){return t.nextStep(1)}}},[t._v("Cancel")])],1),a("v-stepper-content",{attrs:{step:"4"}},[a("v-card",{staticClass:"mb-6",attrs:{height:"200px",tile:""}},[a("v-card-title",[t._v(" It's done ! ")]),a("v-card-text",[t._v(" That's all! You just finished the inital configuration."),a("br"),t._v(" Want help ? go "),a("a",{attrs:{href:"/#/help"}},[t._v("there")])])],1),a("v-btn",{attrs:{color:"deep-orange"},on:{click:function(e){return t.closeMe()}}},[t._v("Close"),a("v-icon",[t._v("mdi-chevron-right")])],1),a("v-btn",{attrs:{text:""},on:{click:function(e){return t.nextStep(2)}}},[t._v("Cancel")])],1)],1),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)},Pt=[],Et=a("2ef0"),$t=a.n(Et),At={name:"FirstSteps",data:()=>({stepper_fs:1,steps:4,descriptionLimit:60,products_isLoading:!1,products_autocomplete:null,products_items:[],products_search:null,emailRules:[t=>!!t||"E-mail is required",t=>/.+@.+\..+/.test(t)||"E-mail must be valid"],org_settings:{alerts_emails:[]},snack:!1,snackColor:"",snackText:""}),watch:{steps(t){this.stepper_fs>t&&(this.stepper_fs=t)},products_search:$t.a.debounce((function(t){null!=t&&(t.length<3||this.products_isLoading||(this.products_isLoading=!0,this.$api.get("/api/kb/products/?limit=30&search="+this.products_search).then(t=>{this.products_items=t.data.results}).catch(t=>{console.log(t)}).finally(()=>this.products_isLoading=!1)))}),500)},mounted(){},methods:{nextStep(t,e=""){t===this.steps?this.stepper_fs=1:this.stepper_fs=t+1,"saveMonitoredProducts"==e&&this.toggleMonitoredProducts(),"saveAlertEmails"==e&&this.updateContactEmails()},closeMe(){this.$vnode.context.firststeps_overlay=!1,this.$router.push("/homepage")},removeSelectedProduct(t){const e=this.products_autocomplete.indexOf(t.name);e>=0&&this.products_autocomplete.splice(e,1)},removeContactEmail(t){this.org_settings.alerts_emails.splice(this.org_settings.alerts_emails.indexOf(t),1),this.org_settings.alerts_emails=[...this.org_settings.alerts_emails]},toggleMonitoredProducts(){var t,e;for(t=0;t<this.products_autocomplete.length;t++){var a=this.products_autocomplete[t];for(e=0;e<this.products_items.length;e++)if(this.products_items[e]["id"]==a){let t={vendor_name:this.products_items[e].vendor,product_name:this.products_items[e].name,monitored:!0,organization_id:localStorage.getItem("org_id")};this.$api.post("/api/monitor/product/toggle",t).then(t=>{this.loading=!1,t?(this.snack=!0,this.snackColor="success",this.snackText="Monitoring status successfuly updated."):(this.snack=!0,this.snackColor="error",this.snackText="Unable to change the monitoring status")}).catch(t=>{this.loading=!1,console.log(t)})}}},updateContactEmails(){var t=new FormData;t.set("org_id",localStorage.getItem("org_id")),t.set("alerts_emails",this.org_settings.alerts_emails),this.$api.post("/users/org/update",t).then(t=>{t&&200!=t.status&&(this.snack=!0,this.snackColor="error",this.snackText="Unable to update organization settings :/")}).catch(t=>{this.snack=!0,this.snackColor="error",this.snackText="Unable to update organization settings :/"})}}},Dt=At,Mt=a("c6a6"),Bt=a("2b5d"),Ot=a("7e85"),jt=a("e516"),Ut=a("9c54"),Ft=a("56a4"),Lt=Object(l["a"])(Dt,It,Pt,!1,null,null,null),Nt=Lt.exports;d()(Lt,{VAutocomplete:Mt["a"],VBtn:V["a"],VCard:S["a"],VCardText:T["d"],VCardTitle:T["e"],VChip:Z["a"],VCombobox:Bt["a"],VDivider:Q["a"],VIcon:et["a"],VSnackbar:M["a"],VStepper:Ot["a"],VStepperContent:jt["a"],VStepperHeader:Ut["c"],VStepperStep:Ft["a"]});var Rt={name:"Home",mixins:[Tt],components:{VClamp:St["a"],FirstSteps:Nt},data:()=>({stats:{vulns:"...",exploits:"...",threats:"...",monitored:"...",vulns_exploitable:"n/a"},vulns:[],vulns_headers:[{text:"CVE",value:"cveid",fixed:!0},{text:"Summary",value:"summary"}],monitored_vulns:[],monitored_vulns_headers:[{text:"Score",value:"score",align:"center",width:"10%"},{text:"Summary",value:"summary"},{text:"Metadata",value:"metadata",align:"center",width:"9%",sortable:!1},{text:"Last update",value:"updated_at",align:"center",width:"10%"}],loading_monitored_vulns:!0,loading_last_vulns:!0,exploits:[],exploits_headers:[{text:"Relevancy",value:"relevancy_level",fixed:!0},{text:"Link",value:"link",fixed:!0}],firststeps:!1,firststeps_overlay:!1}),watch:{firststeps(){1==this.firststeps?this.firststeps_overlay=!0:this.firststeps_overlay=!1}},mounted(){this.firststeps=this.$route.query.firststeps,this.getStats(),this.getLastVulns()},methods:{async getStats(){await this.$api.get("/api/vulns/stats").then(t=>{t&&200===t.status&&(this.stats=t.data,this.loading_last_vulns=!1)}).catch(t=>{y.a.fire({title:"Error",text:"Unable to get stats",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})},async getLastVulns(){await this.$api.get("/api/vulns/latest?timedelta=30").then(t=>{t&&200===t.status&&(this.vulns=t.data.vulns,this.exploits=t.data.exploits,this.monitored_vulns=t.data.monitored_vulns,this.loading_last_vulns=!1)}).catch(t=>{y.a.fire({title:"Error",text:"Unable to get vulnerabilities and exploits",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})},viewVuln(t){this.$router.push({name:"Vuln",params:{vuln_id:t.id}})},viewVulns(){this.$router.push({name:"Vulns"})},rowColor(t){return this.getRatingColor(t.score)}}},Yt=Rt,zt=(a("3437"),a("8fea")),Xt=a("169a"),Ht=Object(l["a"])(Yt,Ct,Vt,!1,null,null,null),Wt=Ht.exports;d()(Ht,{VBtn:V["a"],VCard:S["a"],VCardSubtitle:T["c"],VCardText:T["d"],VCardTitle:T["e"],VChip:Z["a"],VContainer:P["a"],VDataTable:zt["a"],VDialog:Xt["a"],VFlex:E["a"],VIcon:et["a"],VLayout:A["a"]});var qt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._v(" Alert Page - TODO ")])},Jt=[],Kt={name:"Alerts",mounted(){},methods:{}},Gt=Kt,Zt=Object(l["a"])(Gt,qt,Jt,!1,null,null,null),Qt=Zt.exports,te=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md8:"","d-flex":"","align-stretch":""}},[a("v-card",{staticClass:"flex-grow-1",attrs:{color:"grey lighten-1",raised:""}},[a("v-card-title",[t._v("Vector")]),a("v-card-text",[t._v(t._s(t.rating_vector))])],1)],1),a("v-flex",{attrs:{md3:"","align-stretch":""}},[a("v-card",{attrs:{color:t.getRatingColor(parseInt(t.score)),raised:""}},[a("v-card-title",[t._v("Global Score")]),a("v-card-text",{staticClass:"display-2 text-center"},[t._v(t._s(parseInt(t.score)))])],1)],1)],1),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md8:""}},[a("v-card",{attrs:{color:"grey lighten-5"}},[a("v-card-title",[t._v("Vulnerability metrics")]),a("v-card-text",[a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Access - Attack Vector  ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.vulnerability.access.vector,callback:function(e){t.$set(t.vulnerability.access,"vector",e)},expression:"vulnerability.access.vector"}},[a("v-btn",{attrs:{small:"",value:"L"}},[t._v("Local (AV:L)")]),a("v-btn",{attrs:{small:"",value:"A"}},[t._v("Adjacent Network (AV:A)")]),a("v-btn",{attrs:{small:"",value:"N"}},[t._v("Network (AV:N)")])],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Access - Attack Complexity  ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.vulnerability.access.complexity,callback:function(e){t.$set(t.vulnerability.access,"complexity",e)},expression:"vulnerability.access.complexity"}},[a("v-btn",{attrs:{small:"",value:"H"}},[t._v("High (AC:H)")]),a("v-btn",{attrs:{small:"",value:"M"}},[t._v("Medium (AC:M)")]),a("v-btn",{attrs:{small:"",value:"L"}},[t._v("Low (AC:L)")])],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Access - Authentication  ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.vulnerability.access.authentication,callback:function(e){t.$set(t.vulnerability.access,"authentication",e)},expression:"vulnerability.access.authentication"}},[a("v-btn",{attrs:{small:"",value:"M"}},[t._v("Multiple (Au:M)")]),a("v-btn",{attrs:{small:"",value:"S"}},[t._v("Single (Au:S)")]),a("v-btn",{attrs:{small:"",value:"N"}},[t._v("None (Au:N)")])],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Impact - Confidentiality  ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.vulnerability.impact.confidentiality,callback:function(e){t.$set(t.vulnerability.impact,"confidentiality",e)},expression:"vulnerability.impact.confidentiality"}},[a("v-btn",{attrs:{small:"",value:"N"}},[t._v("None (C:N)")]),a("v-btn",{attrs:{small:"",value:"L"}},[t._v("Low (C:L)")]),a("v-btn",{attrs:{small:"",value:"C"}},[t._v("Complete (C:C)")])],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Impact - Integrity  ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.vulnerability.impact.integrity,callback:function(e){t.$set(t.vulnerability.impact,"integrity",e)},expression:"vulnerability.impact.integrity"}},[a("v-btn",{attrs:{small:"",value:"N"}},[t._v("None (I:N)")]),a("v-btn",{attrs:{small:"",value:"L"}},[t._v("Low (I:L)")]),a("v-btn",{attrs:{small:"",value:"C"}},[t._v("Complete (I:C)")])],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Impact - Availability  ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.vulnerability.impact.availability,callback:function(e){t.$set(t.vulnerability.impact,"availability",e)},expression:"vulnerability.impact.availability"}},[a("v-btn",{attrs:{small:"",value:"N"}},[t._v("None (A:N)")]),a("v-btn",{attrs:{small:"",value:"L"}},[t._v("Low (A:L)")]),a("v-btn",{attrs:{small:"",value:"C"}},[t._v("Complete (A:C)")])],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Remediation  ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.vulnerability.remediation,callback:function(e){t.$set(t.vulnerability,"remediation",e)},expression:"vulnerability.remediation"}},[a("v-btn",{attrs:{small:"",value:"X"}},[t._v("Unknown (R:X)")]),a("v-btn",{attrs:{small:"",value:"U"}},[t._v("Unavailable (R:H)")]),a("v-btn",{attrs:{small:"",value:"W"}},[t._v("Workaround (R:W)")]),a("v-btn",{attrs:{small:"",value:"T"}},[t._v("Temporary (R:T)")]),a("v-btn",{attrs:{small:"",value:"O"}},[t._v("Official (R:O)")])],1)],1),a("v-row",[a("v-col",{staticClass:"py-2 pa-6",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Vulnerability Age  ")]),a("v-menu",{ref:"menu_vage",attrs:{"close-on-content-click":!1,"return-value":t.vulnerability.age,transition:"scale-transition","offset-y":"","min-width":"290px"},on:{"update:returnValue":function(e){return t.$set(t.vulnerability,"age",e)},"update:return-value":function(e){return t.$set(t.vulnerability,"age",e)}},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on;return[a("v-text-field",t._g({model:{value:t.vulnerability.age,callback:function(e){t.$set(t.vulnerability,"age",e)},expression:"vulnerability.age"}},s))]}}]),model:{value:t.menu_vage,callback:function(e){t.menu_vage=e},expression:"menu_vage"}},[a("v-date-picker",{attrs:{scrollable:"",landscape:""},model:{value:t.vulnerability.age,callback:function(e){t.$set(t.vulnerability,"age",e)},expression:"vulnerability.age"}},[a("v-spacer"),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){t.menu_vage=!1}}},[t._v("Cancel")]),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){return t.$refs.menu_vage.save("")}}},[t._v("Reset")]),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){return t.$refs.menu_vage.save(t.vulnerability.age)}}},[t._v("OK")])],1)],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"8"}},[a("span",{staticClass:"subtitle-1"},[t._v("Confirmation  ")]),a("v-row",[a("v-col",{staticClass:"py-2",attrs:{cols:"12"}},[a("v-switch",{attrs:{label:"Confirmed by trusted parties: "+t.vulnerability.confirmation.toString(),color:"deep-orange"},model:{value:t.vulnerability.confirmation,callback:function(e){t.$set(t.vulnerability,"confirmation",e)},expression:"vulnerability.confirmation"}})],1)],1)],1)],1)],1)],1)],1),a("v-flex",{attrs:{md3:"","d-flex":"","align-stretch":""}},[a("v-card",{staticClass:"flex-grow-1 flex-shrink-0",attrs:{color:"grey lighten-5"}},[a("v-card-title",[t._v("Vulnerability Score")]),a("v-card-text",{staticClass:"text-center"},[a("v-progress-circular",{attrs:{value:20*t.vuln_score,size:100,width:5,color:"deep-orange"}},[t._v(t._s(parseInt(20*t.vuln_score))+" ")])],1)],1)],1)],1),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md8:""}},[a("v-card",{attrs:{color:"grey lighten-5"}},[a("v-card-title",[t._v("Threat metrics")]),a("v-card-text",[a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Exploit Availability  ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.threat.exploit_availability,callback:function(e){t.$set(t.threat,"exploit_availability",e)},expression:"threat.exploit_availability"}},[a("v-btn",{attrs:{small:"",value:"X"}},[t._v("Unknown (EA:X)")]),a("v-btn",{attrs:{small:"",value:"R"}},[t._v("Private (EA:R)")]),a("v-btn",{attrs:{small:"",value:"U"}},[t._v("Public (EA:U)")])],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Exploit Maturity  ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.threat.exploit_maturity,callback:function(e){t.$set(t.threat,"exploit_maturity",e)},expression:"threat.exploit_maturity"}},[a("v-btn",{attrs:{small:"",value:"X"}},[t._v("Unknown (EM:X)")]),a("v-btn",{attrs:{small:"",value:"U"}},[t._v("Unproven (EM:U)")]),a("v-btn",{attrs:{small:"",value:"P"}},[t._v("PoC (EM:P)")]),a("v-btn",{attrs:{small:"",value:"F"}},[t._v("Functional (EM:F)")])],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Exploit Confidence  ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.threat.exploit_trust,callback:function(e){t.$set(t.threat,"exploit_trust",e)},expression:"threat.exploit_trust"}},[a("v-btn",{attrs:{small:"",value:"X"}},[t._v("Unknown (ET:X)")]),a("v-btn",{attrs:{small:"",value:"L"}},[t._v("Low (ET:L)")]),a("v-btn",{attrs:{small:"",value:"M"}},[t._v("Medium (ET:M)")]),a("v-btn",{attrs:{small:"",value:"H"}},[t._v("High (ET:H)")])],1)],1),a("v-row",[a("v-col",{staticClass:"py-2 pa-6",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Exploit Age  ")]),a("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,"return-value":t.threat.exploit_age,transition:"scale-transition","offset-y":"","min-width":"290px"},on:{"update:returnValue":function(e){return t.$set(t.threat,"exploit_age",e)},"update:return-value":function(e){return t.$set(t.threat,"exploit_age",e)}},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on;return[a("v-text-field",t._g({model:{value:t.threat.exploit_age,callback:function(e){t.$set(t.threat,"exploit_age",e)},expression:"threat.exploit_age"}},s))]}}]),model:{value:t.menu,callback:function(e){t.menu=e},expression:"menu"}},[a("v-date-picker",{attrs:{scrollable:"",landscape:""},model:{value:t.threat.exploit_age,callback:function(e){t.$set(t.threat,"exploit_age",e)},expression:"threat.exploit_age"}},[a("v-spacer"),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){t.menu}}},[t._v("Cancel")]),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){return t.$refs.menu.save("")}}},[t._v("Reset")]),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){return t.$refs.menu.save(t.threat.exploit_age)}}},[t._v("OK")])],1)],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"8"}},[a("span",{staticClass:"subtitle-1"},[t._v("Mediatisation  ")]),a("v-row",[a("v-col",{staticClass:"py-2",attrs:{cols:"6"}},[a("v-switch",{attrs:{label:"In the News ? : "+t.threat.in_the_news.toString(),color:"deep-orange"},model:{value:t.threat.in_the_news,callback:function(e){t.$set(t.threat,"in_the_news",e)},expression:"threat.in_the_news"}})],1),a("v-col",{staticClass:"py-2",attrs:{cols:"6"}},[a("v-switch",{attrs:{label:"In the Wild ? : "+t.threat.in_the_wild.toString(),color:"deep-orange"},model:{value:t.threat.in_the_wild,callback:function(e){t.$set(t.threat,"in_the_wild",e)},expression:"threat.in_the_wild"}})],1)],1)],1)],1)],1)],1)],1),a("v-flex",{attrs:{md3:"","d-flex":"","align-stretch":""}},[a("v-card",{staticClass:"flex-grow-1 flex-shrink-0",attrs:{color:"grey lighten-5"}},[a("v-card-title",[t._v("Threat Score")]),a("v-card-text",{staticClass:"text-center"},[a("v-progress-circular",{attrs:{value:20*t.threat_score,size:100,width:5,color:"deep-orange"}},[t._v(t._s(parseInt(20*t.threat_score))+" ")])],1)],1)],1)],1),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md8:""}},[a("v-card",{attrs:{color:"grey lighten-5"}},[a("v-card-title",[t._v("Asset metrics")]),a("v-card-text",[a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Criticality  ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.asset.criticality,callback:function(e){t.$set(t.asset,"criticality",e)},expression:"asset.criticality"}},[a("v-btn",{attrs:{small:"",value:"X"}},[t._v("Unknown (Cr:X)")]),a("v-btn",{attrs:{small:"",value:"L"}},[t._v("Low (Cr:L)")]),a("v-btn",{attrs:{small:"",value:"M"}},[t._v("Medium (Cr:M)")]),a("v-btn",{attrs:{small:"",value:"H"}},[t._v("High (Cr:H)")])],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Exposure  ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.asset.exposure,callback:function(e){t.$set(t.asset,"exposure",e)},expression:"asset.exposure"}},[a("v-btn",{attrs:{small:"",value:"X"}},[t._v("Unknown (E:X)")]),a("v-btn",{attrs:{small:"",value:"R"}},[t._v("Restricted/DMZ (E:R)")]),a("v-btn",{attrs:{small:"",value:"I"}},[t._v("Internal (E:I)")]),a("v-btn",{attrs:{small:"",value:"E"}},[t._v("External (E:E)")])],1)],1),a("v-col",{staticClass:"py-2",attrs:{cols:"4"}},[a("span",{staticClass:"subtitle-1"},[t._v("Distribution  ")]),a("v-btn-toggle",{attrs:{color:"deep-orange accent-3",mandatory:""},model:{value:t.asset.distribution,callback:function(e){t.$set(t.asset,"distribution",e)},expression:"asset.distribution"}},[a("v-btn",{attrs:{small:"",value:"X"}},[t._v("Unknown (D:X)")]),a("v-btn",{attrs:{small:"",value:"L"}},[t._v("Low <15 (D:L)")]),a("v-btn",{attrs:{small:"",value:"M"}},[t._v("Medium <45 (D:M)")]),a("v-btn",{attrs:{small:"",value:"H"}},[t._v("High ≥45 (D:H)")])],1)],1)],1)],1)],1),a("v-flex",{attrs:{md3:"","d-flex":"","align-stretch":""}},[a("v-card",{staticClass:"flex-grow-1 flex-shrink-0",attrs:{color:"grey lighten-5"}},[a("v-card-title",[t._v("Asset Score")]),a("v-card-text",{staticClass:"text-center"},[a("v-progress-circular",{attrs:{value:25*t.asset_score,size:100,width:5,color:"deep-orange"}},[t._v(t._s(parseInt(25*t.asset_score))+" ")])],1)],1)],1)],1)],1)},ee=[],ae={methods:{calcVulnScore(t,e){if(void 0==e||0===Object.keys(e).length)return 0;let a=0,s={vector:0,complexity:0,authentication:0,confidentiality:0,integrity:0,availability:0},i="",o=[];for(let d=0;d<t.length;d++)i=t[d].split(":"),"AV"===i[0]&&!["N","A","L"].includes(i[1])&&(s.vector+=e.cvss2.access.vector.default),"AV"===i[0]&&"N"===i[1]&&(s.vector+=e.cvss2.access.vector.network),"AV"===i[0]&&"A"===i[1]&&(s.vector+=e.cvss2.access.vector.adjacent),"AV"===i[0]&&"L"===i[1]&&(s.vector+=e.cvss2.access.vector.local),"AV"===i[0]&&o.push("AV"),"AC"===i[0]&&!["L","M","H"].includes(i[1])&&(s.complexity+=e.cvss2.access.complexity.default),"AC"===i[0]&&"L"===i[1]&&(s.complexity+=e.cvss2.access.complexity.low),"AC"===i[0]&&"M"===i[1]&&(s.complexity+=e.cvss2.access.complexity.medium),"AC"===i[0]&&"H"===i[1]&&(s.complexity+=e.cvss2.access.complexity.high),"AC"===i[0]&&o.push("AC"),"Au"===i[0]&&!["N","S","M"].includes(i[1])&&(s.authentication+=e.cvss2.access.authentication.default),"Au"===i[0]&&"N"===i[1]&&(s.authentication+=e.cvss2.access.authentication.none),"Au"===i[0]&&"S"===i[1]&&(s.authentication+=e.cvss2.access.authentication.single),"Au"===i[0]&&"M"===i[1]&&(s.authentication+=e.cvss2.access.authentication.multiple),"Au"===i[0]&&o.push("Au"),"C"===i[0]&&!["N","L","P","C","H"].includes(i[1])&&(s.confidentiality+=e.cvss2.impact.confidentiality.default),"C"===i[0]&&"N"===i[1]&&(s.confidentiality+=e.cvss2.impact.confidentiality.none),"C"===i[0]&&"L"===i[1]&&(s.confidentiality+=e.cvss2.impact.confidentiality.partial),"C"===i[0]&&"P"===i[1]&&(s.confidentiality+=e.cvss2.impact.confidentiality.partial),"C"===i[0]&&"C"===i[1]&&(s.confidentiality+=e.cvss2.impact.confidentiality.complete),"C"===i[0]&&"H"===i[1]&&(s.confidentiality+=e.cvss2.impact.confidentiality.complete),"C"===i[0]&&o.push("C"),"I"===i[0]&&!["N","L","P","C","H"].includes(i[1])&&(s.integrity+=e.cvss2.impact.integrity.default),"I"===i[0]&&"N"===i[1]&&(s.integrity+=e.cvss2.impact.integrity.none),"I"===i[0]&&"L"===i[1]&&(s.integrity+=e.cvss2.impact.integrity.partial),"I"===i[0]&&"P"===i[1]&&(s.integrity+=e.cvss2.impact.integrity.partial),"I"===i[0]&&"C"===i[1]&&(s.integrity+=e.cvss2.impact.integrity.complete),"I"===i[0]&&"H"===i[1]&&(s.integrity+=e.cvss2.impact.integrity.complete),"I"===i[0]&&o.push("I"),"A"===i[0]&&!["N","L","P","C","H"].includes(i[1])&&(s.availability+=e.cvss2.impact.availability.default),"A"===i[0]&&"N"===i[1]&&(s.availability+=e.cvss2.impact.availability.none),"A"===i[0]&&"L"===i[1]&&(s.availability+=e.cvss2.impact.availability.partial),"A"===i[0]&&"P"===i[1]&&(s.availability+=e.cvss2.impact.availability.partial),"A"===i[0]&&"C"===i[1]&&(s.availability+=e.cvss2.impact.availability.complete),"A"===i[0]&&"H"===i[1]&&(s.availability+=e.cvss2.impact.availability.complete),"A"===i[0]&&o.push("A"),"R"===i[0]&&!["U","W","T","O"].includes(i[1])&&(a+=e.remediation.default),"R"===i[0]&&"U"===i[1]&&(a+=e.remediation.unavailable),"R"===i[0]&&"W"===i[1]&&(a+=e.remediation.workaround),"R"===i[0]&&"T"===i[1]&&(a+=e.remediation.temporary),"R"===i[0]&&"O"===i[1]&&(a+=e.remediation.official),"R"===i[0]&&o.push("R"),"VX"===i[0]&&i[1]<=15&&(a+=e.age.caps["15"]),"VX"===i[0]&&i[1]>15&&i[1]<=45&&(a+=e.age.caps["45"]),"VX"===i[0]&&i[1]>45&&(a+=e.age.caps["10000000"]),"VX"===i[0]&&o.push("VX"),"CL"===i[0]&&"Y"===i[1]&&(a+=e.confirmation.is_confirmed),o.push("CL");!o.includes("AV")&&(s.vector=e.cvss2.access.vector.default),!o.includes("AC")&&(s.complexity=e.cvss2.access.complexity.default),!o.includes("Au")&&(s.authentication=e.cvss2.access.authentication.default),!o.includes("C")&&(s.confidentiality=e.cvss2.impact.confidentiality.default),!o.includes("I")&&(s.integrity=e.cvss2.impact.integrity.default),!o.includes("A")&&(s.availability=e.cvss2.impact.availability.default),!o.includes("VX")&&(a+=e.age.default),!o.includes("R")&&(a+=e.remediation.default);let n=10.41*(1-(1-s.confidentiality)*(1-s.integrity)*(1-s.availability)),r=20*s.complexity*s.vector*s.authentication,l=0;l=0==n?0:1.176;let c=(.6*n+.4*r-1.5)*l;return a+=80*parseFloat(c).toFixed(1)/100/2,a>e.max_score&&(a=e.max_score),parseFloat(a).toFixed(1)},calcThreatScore(t,e){if(void 0==e||0===Object.keys(e).length)return 0;let a=0,s="",i=[];for(let o=0;o<t.length;o++)s=t[o].split(":"),"EA"===s[0]&&!["X","R","U"].includes(s[1])&&(a+=e.exploit_availability.default),"EA"===s[0]&&"X"===s[1]&&(a+=e.exploit_availability.unknown),"EA"===s[0]&&"R"===s[1]&&(a+=e.exploit_availability.private),"EA"===s[0]&&"U"===s[1]&&(a+=e.exploit_availability.public),"EA"===s[0]&&i.push("EA"),"EM"===s[0]&&!["X","U","P","F"].includes(s[1])&&(a+=e.exploit_maturity.default),"EM"===s[0]&&"X"===s[1]&&(a+=e.exploit_maturity.unknown),"EM"===s[0]&&"U"===s[1]&&(a+=e.exploit_maturity.unproven),"EM"===s[0]&&"P"===s[1]&&(a+=e.exploit_maturity.poc),"EM"===s[0]&&"F"===s[1]&&(a+=e.exploit_maturity.functional),"EM"===s[0]&&i.push("EM"),"ET"===s[0]&&!["X","L","M","H"].includes(s[1])&&(a+=e.exploit_trust.default),"ET"===s[0]&&"X"===s[1]&&(a+=e.exploit_trust.unknown),"ET"===s[0]&&"L"===s[1]&&(a+=e.exploit_trust.low),"ET"===s[0]&&"M"===s[1]&&(a+=e.exploit_trust.medium),"ET"===s[0]&&"H"===s[1]&&(a+=e.exploit_trust.high),"ET"===s[0]&&i.push("ET"),"EX"===s[0]&&s[1]<=15&&(a+=e.exploit_age.caps["15"]),"EX"===s[0]&&s[1]>15&&s[1]<=45&&(a+=e.exploit_age.caps["45"]),"EX"===s[0]&&s[1]>45&&(a+=e.exploit_age.caps["10000000"]),"EX"===s[0]&&i.push("EX"),"N"===s[0]&&"Y"===s[1]&&(a+=e.threat_intensity.is_in_the_news),"W"===s[0]&&"Y"===s[1]&&(a+=e.threat_intensity.is_in_the_wild);return!i.includes("EA")&&(a+=e.exploit_availability.default),!i.includes("EM")&&(a+=e.exploit_maturity.default),!i.includes("ET")&&(a+=e.exploit_trust.default),!i.includes("EX")&&(a+=e.exploit_age.default),a>e.max_score&&(a=e.max_score),parseFloat(a).toFixed(1)},calcAssetScore(t,e){if(void 0==e||0===Object.keys(e).length)return 0;let a=0,s="",i=[];for(let o=0;o<t.length;o++)s=t[o].split(":"),"Cr"===s[0]&&!["L","M","H"].includes(s[1])&&(a+=e.criticality.default),"Cr"===s[0]&&"L"===s[1]&&(a+=e.criticality.low),"Cr"===s[0]&&"M"===s[1]&&(a+=e.criticality.medium),"Cr"===s[0]&&"H"===s[1]&&(a+=e.criticality.high),"Cr"===s[0]&&i.push("Cr"),"E"===s[0]&&!["R","I","E"].includes(s[1])&&(a+=e.exposure.default),"E"===s[0]&&"R"===s[1]&&(a+=e.exposure.restricted),"E"===s[0]&&"I"===s[1]&&(a+=e.exposure.internal),"E"===s[0]&&"E"===s[1]&&(a+=e.exposure.external),"E"===s[0]&&i.push("E"),"D"===s[0]&&!["L","M","H"].includes(s[1])&&(a+=e.distribution.default),"D"===s[0]&&"L"===s[1]&&(a+=e.distribution.low),"D"===s[0]&&"M"===s[1]&&(a+=e.distribution.medium),"D"===s[0]&&"H"===s[1]&&(a+=e.distribution.high),"D"===s[0]&&i.push("D");return!i.includes("Cr")&&(a+=e.criticality.default),!i.includes("E")&&(a+=e.exposure.default),!i.includes("D")&&(a+=e.distribution.default),a>e.max_score&&(a=e.max_score),parseFloat(a).toFixed(1)}},mounted(){},destroyed(){}},se=a("c1df"),ie=a.n(se),oe={name:"Ratings",mixins:[Tt,ae],data:()=>({loading:!1,vulnerability:{access:{vector:"N",complexity:"L",authentication:"N"},impact:{confidentiality:"N",integrity:"N",availability:"N"},confirmation:!1,remediation:"X",age:(new Date).toISOString().substr(0,10)},threat:{exploit_availability:"X",exploit_maturity:"X",exploit_trust:"X",exploit_age:(new Date).toISOString().substr(0,10),in_the_news:!1,in_the_wild:!1},asset:{criticality:"M",exposure:"I",distribution:"M"},metrics_values:{},base_vector:"",base_vector_format:"VPRv1",score:"n/a",vuln_score:80,threat_score:0,asset_score:0,menu:!1,menu_vage:!1}),mounted(){this.base_vector=this.$route.query.vector,this.getDataFromApi(),null==this.base_vector&&""==this.base_vector||this.init_vector(this.base_vector)},computed:{rating_vector(){let t=[],e=[];e.push("AV:"+this.vulnerability.access.vector),e.push("AC:"+this.vulnerability.access.complexity),e.push("Au:"+this.vulnerability.access.authentication),e.push("C:"+this.vulnerability.impact.confidentiality),e.push("I:"+this.vulnerability.impact.integrity),e.push("A:"+this.vulnerability.impact.availability),1==this.vulnerability.confirmation&&e.push("CL:Y"),"X"!=this.vulnerability.remediation&&e.push("R:"+this.vulnerability.remediation),""!=this.vulnerability.age&&e.push("VX:"+ie()().diff(this.vulnerability.age,"days")),this.vuln_score=this.calcVulnScore(e,this.metrics_values.vulnerability),t=t.concat(e);let a=[];"X"!=this.threat.exploit_availability&&a.push("EA:"+this.threat.exploit_availability),"X"!=this.threat.exploit_maturity&&a.push("EM:"+this.threat.exploit_maturity),"X"!=this.threat.exploit_trust&&a.push("ET:"+this.threat.exploit_trust),!0===this.threat.in_the_news&&a.push("N:Y"),!0===this.threat.in_the_wild&&a.push("W:Y"),""!=this.threat.exploit_age&&a.push("EX:"+ie()().diff(this.threat.exploit_age,"days")),this.threat_score=this.calcThreatScore(a,this.metrics_values.threat),t=t.concat(a);let s=[];return"X"!=this.asset.criticality&&s.push("Cr:"+this.asset.criticality),"X"!=this.asset.exposure&&s.push("E:"+this.asset.exposure),"X"!=this.asset.distribution&&s.push("D:"+this.asset.distribution),this.asset_score=this.calcAssetScore(s,this.metrics_values.asset),t=t.concat(s),this.score=12*this.vuln_score+4*this.threat_score+5*this.asset_score,t.join("/")}},methods:{init_vector(t){if(void 0==t||0===Object.keys(t).length)return 0;let e="",a=t.split("/");for(let s=0;s<a.length;s++)e=a[s].split(":"),"AV"==e[0]&&(this.vulnerability.access.vector=e[1]),"AC"==e[0]&&(this.vulnerability.access.complexity=e[1]),"Au"==e[0]&&(this.vulnerability.access.authentication=e[1]),"C"==e[0]&&(this.vulnerability.impact.confidentiality=e[1]),"P"==this.vulnerability.impact.confidentiality&&(this.vulnerability.impact.confidentiality="L"),"I"==e[0]&&(this.vulnerability.impact.integrity=e[1]),"P"==this.vulnerability.impact.integrity&&(this.vulnerability.impact.integrity="L"),"A"==e[0]&&(this.vulnerability.impact.availability=e[1]),"P"==this.vulnerability.impact.availability&&(this.vulnerability.impact.availability="L"),"CL:Y"==a[s]&&(this.vulnerability.confirmation=!0),"R"==e[0]&&(this.vulnerability.remediation=e[1]),"VX"==e[0]&&(this.vulnerability.age=ie()().subtract(e[1],"days").toISOString(!0).substr(0,10)),"EA"==e[0]&&(this.threat.exploit_availability=e[1]),"EM"==e[0]&&(this.threat.exploit_maturity=e[1]),"ET"==e[0]&&(this.threat.exploit_trust=e[1]),"N:Y"==a[s]&&(this.threat.in_the_news=!0),"W:Y"==a[s]&&(this.threat.in_the_wild=!0),"EX"==e[0]&&(this.threat.exploit_age=ie()().subtract(e[1],"days").toISOString(!0).substr(0,10)),"Cr"==e[0]&&(this.asset.criticality=e[1]),"E"==e[0]&&(this.asset.exposure=e[1]),"D"==e[0]&&(this.asset.distribution=e[1])},getDataFromApi(){return this.loading=!0,new Promise((t,e)=>{let a=this.getMetricValues();setTimeout(()=>{t({metrics_values:a})},300)})},getMetricValues(){this.$api.get("/api/ratings/metrics").then(t=>(this.metrics_values=t.data,this.loading=!1,this.metrics_values)).catch(t=>{this.metrics_values={},this.loading=!1,swal.fire({title:"Error",text:"unable to get metrics values",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})}}},ne=oe,re=a("a609"),le=a("62ad"),ce=a("2e4b"),de=a("0fd9"),ue=a("b73d"),ve=Object(l["a"])(ne,te,ee,!1,null,null,null),me=ve.exports;d()(ve,{VBtn:V["a"],VBtnToggle:re["a"],VCard:S["a"],VCardText:T["d"],VCardTitle:T["e"],VCol:le["a"],VContainer:P["a"],VDatePicker:ce["a"],VFlex:E["a"],VLayout:A["a"],VMenu:xt["a"],VProgressCircular:D["a"],VRow:de["a"],VSpacer:B["a"],VSwitch:ue["a"],VTextField:O["a"]});var he=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-tabs",{attrs:{left:"","background-color":"white",color:"deep-orange accent-4"}},[a("v-tab",[t._v("Profile")]),t.isAlertAdmin()?a("v-tab",[t._v("Alerting")]):t._e(),"notsupported"==t.isAdmin()?a("v-tab",[t._v("Sync")]):t._e(),t.isTeamOrgAdmin()?a("v-tab",[t._v("Orgs + Users")]):t._e(),a("v-tab-item",[a("v-row",[a("v-col",{attrs:{cols:"8"}},[a("v-list-item",[a("v-list-item-content",[a("v-list-item-title",[t._v("Username")]),a("v-list-item-subtitle",[t._v(t._s(t.user_profile.username))])],1),a("v-list-item-content",[a("v-list-item-title",[t._v("Email")]),a("v-list-item-subtitle",[t._v(t._s(t.user_profile.email))])],1)],1),a("v-list-item",[a("v-list-item-content",[a("v-list-item-title",[t._v("Permissions")]),t._l(t.user_profile.profile,(function(e,s){return a("v-list-item-subtitle",{key:s},[t._v(" "+t._s(s)+": "),a("strong",[t._v(t._s(e))])])}))],2)],1)],1),a("v-col",{attrs:{cols:"4"}},[a("v-card",{staticClass:"ma-2"},[a("v-card-title",{on:{click:function(e){t.showEditProfileCard=!t.showEditProfileCard}}},[t._v(" Edit user profile "),a("v-icon",{attrs:{left:""}},[t._v("mdi-chevron-double-right")])],1),t.showEditProfileCard?a("v-card-text",[a("v-text-field",{attrs:{disabled:"",label:"Username"},model:{value:t.user_profile.username,callback:function(e){t.$set(t.user_profile,"username",e)},expression:"user_profile.username"}}),a("v-text-field",{attrs:{disabled:"",label:"Email Address"},model:{value:t.user_profile.email,callback:function(e){t.$set(t.user_profile,"email",e)},expression:"user_profile.email"}}),a("v-text-field",{attrs:{label:"First Name"},model:{value:t.user_profile.first_name,callback:function(e){t.$set(t.user_profile,"first_name",e)},expression:"user_profile.first_name"}}),a("v-text-field",{attrs:{label:"Last Name"},model:{value:t.user_profile.last_name,callback:function(e){t.$set(t.user_profile,"last_name",e)},expression:"user_profile.last_name"}})],1):t._e(),t.showEditProfileCard?a("v-card-actions",{staticClass:"justify-center"},[a("v-btn",{attrs:{color:"grey",loading:t.loading,block:""},nativeOn:{click:function(e){return t.updateUserProfile.apply(null,arguments)}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Update Profile ")],1)],1):t._e()],1),a("v-card",{staticClass:"ma-2"},[a("v-card-title",{on:{click:function(e){t.showEditTokenCard=!t.showEditTokenCard}}},[t._v(" Edit API token "),a("v-icon",{attrs:{left:""}},[t._v("mdi-chevron-double-right")])],1),t.showEditTokenCard?a("v-card-text",[a("v-text-field",{attrs:{"append-icon":t.show_authtoken?"mdi-eye":"mdi-eye-off",type:t.show_authtoken?"text":"password",label:"API Token"},on:{"click:append":function(e){t.show_authtoken=!t.show_authtoken}},model:{value:t.user_profile.auth_token,callback:function(e){t.$set(t.user_profile,"auth_token",e)},expression:"user_profile.auth_token"}})],1):t._e(),t.showEditTokenCard?a("v-card-actions",{staticClass:"justify-center"},[a("v-btn",{attrs:{color:"red",loading:t.loading},nativeOn:{click:function(e){return t.deleteUserToken.apply(null,arguments)}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-delete-outline")]),t._v(" Delete Token ")],1),a("v-btn",{attrs:{color:"grey",loading:t.loading},nativeOn:{click:function(e){return t.updateUserToken.apply(null,arguments)}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-autorenew")]),t._v(" Renew Token ")],1)],1):t._e()],1),a("v-card",{staticClass:"ma-2"},[a("v-card-title",{on:{click:function(e){t.showEditPasswordCard=!t.showEditPasswordCard}}},[t._v(" Edit password "),a("v-icon",{attrs:{left:""}},[t._v("mdi-chevron-double-right")])],1),t.showEditPasswordCard?a("v-card-text",[a("v-text-field",{attrs:{"append-icon":t.showPassword_old?"mdi-eye":"mdi-eye-off",type:t.showPassword_old?"text":"password",counter:"",label:"Old Password"},on:{"click:append":function(e){t.showPassword_old=!t.showPassword_old}},model:{value:t.user_profile_chpwd.oldpassword,callback:function(e){t.$set(t.user_profile_chpwd,"oldpassword",e)},expression:"user_profile_chpwd.oldpassword"}}),a("v-text-field",{attrs:{"append-icon":t.showPassword_new1?"mdi-eye":"mdi-eye-off",type:t.showPassword_new1?"text":"password",counter:"",label:"New Password"},on:{"click:append":function(e){t.showPassword_new1=!t.showPassword_new1}},model:{value:t.user_profile_chpwd.new_password1,callback:function(e){t.$set(t.user_profile_chpwd,"new_password1",e)},expression:"user_profile_chpwd.new_password1"}}),a("v-text-field",{attrs:{"append-icon":t.showPassword_new2?"mdi-eye":"mdi-eye-off",type:t.showPassword_new2?"text":"password",counter:"",label:"New Password (again)"},on:{"click:append":function(e){t.showPassword_new2=!t.showPassword_new2}},model:{value:t.user_profile_chpwd.new_password2,callback:function(e){t.$set(t.user_profile_chpwd,"new_password2",e)},expression:"user_profile_chpwd.new_password2"}})],1):t._e(),t.showEditPasswordCard?a("v-card-actions",{staticClass:"justify-center"},[a("v-btn",{attrs:{color:"grey",loading:t.loading,disabled:t.user_profile_chpwd.new_password1!=t.user_profile_chpwd.new_password2,block:""},nativeOn:{click:function(e){return t.updateUserPassword.apply(null,arguments)}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Update Password ")],1)],1):t._e()],1)],1)],1)],1),t.isAlertAdmin()?a("v-tab-item",[a("v-row",[a("v-col",{attrs:{cols:"10"}},[a("v-card",[a("v-card-title",[t._v(" Email alerting ")]),a("v-card-text",[a("v-layout",{staticClass:"mx-1",attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",sm12:"",md12:""}},[a("v-combobox",{attrs:{clearable:"",label:"Contact emails (press Enter to confirm)",multiple:"",rules:t.emailRules},scopedSlots:t._u([{key:"selection",fn:function(e){var s=e.attrs,i=e.item,o=e.select,n=e.selected;return[a("v-chip",t._b({attrs:{"input-value":n,close:""},on:{click:o,"click:close":function(e){return t.removeContactEmail(i)}}},"v-chip",s,!1),[a("strong",[t._v(t._s(i))]),t._v("  ")])]}}],null,!1,3738212504),model:{value:t.org_settings.alerts_emails,callback:function(e){t.$set(t.org_settings,"alerts_emails",e)},expression:"org_settings.alerts_emails"}})],1),a("v-flex",{attrs:{xs12:"",sm12:"",md12:""}},[a("v-checkbox",{attrs:{label:"Enable daily report by email on monitored assets",dense:"","hide-details":""},model:{value:t.org_settings.enable_daily_email_report,callback:function(e){t.$set(t.org_settings,"enable_daily_email_report",e)},expression:"org_settings.enable_daily_email_report"}})],1),a("v-flex",{attrs:{xs12:"",sm12:"",md12:""}},[a("v-checkbox",{attrs:{label:"Enable weekly report by email on monitored assets",dense:"","hide-details":""},model:{value:t.org_settings.enable_weekly_email_report,callback:function(e){t.$set(t.org_settings,"enable_weekly_email_report",e)},expression:"org_settings.enable_weekly_email_report"}})],1),a("v-flex",{attrs:{xs12:"",sm12:"",md12:""}},[a("v-checkbox",{attrs:{label:"Enable monthly report by email on monitored assets",dense:"","hide-details":""},model:{value:t.org_settings.enable_monthly_email_report,callback:function(e){t.$set(t.org_settings,"enable_monthly_email_report",e)},expression:"org_settings.enable_monthly_email_report"}})],1),a("v-flex",{attrs:{xs12:"",sm12:"",md12:""}},[a("v-checkbox",{attrs:{label:"Enable instant report by email on monitored assets when become exploitable",dense:"","hide-details":""},model:{value:t.org_settings.enable_instant_email_report_exploitable,callback:function(e){t.$set(t.org_settings,"enable_instant_email_report_exploitable",e)},expression:"org_settings.enable_instant_email_report_exploitable"}})],1),a("v-flex",{attrs:{xs10:"",sm10:"",md10:""}},[a("v-checkbox",{attrs:{label:"Enable instant report by email on monitored assets with Score >=",dense:"","hide-details":""},model:{value:t.org_settings.enable_instant_email_report_score,callback:function(e){t.$set(t.org_settings,"enable_instant_email_report_score",e)},expression:"org_settings.enable_instant_email_report_score"}})],1),a("v-flex",{attrs:{xs2:"",sm2:"",md2:""}},[a("v-text-field",{attrs:{type:"number",label:"Score max value",rules:t.rules.score},model:{value:t.org_settings.enable_instant_email_report_score_value,callback:function(e){t.$set(t.org_settings,"enable_instant_email_report_score_value",e)},expression:"org_settings.enable_instant_email_report_score_value"}})],1),a("v-flex",{attrs:{xs10:"",sm10:"",md10:""}},[a("v-checkbox",{attrs:{label:"Enable instant report by email on monitored assets with CVSSv2 score >=",dense:"","hide-details":""},model:{value:t.org_settings.enable_instant_email_report_cvss,callback:function(e){t.$set(t.org_settings,"enable_instant_email_report_cvss",e)},expression:"org_settings.enable_instant_email_report_cvss"}})],1),a("v-flex",{attrs:{xs2:"",sm2:"",md2:""}},[a("v-text-field",{attrs:{type:"number",label:"CVSSv2 max value",rules:t.rules.cvss},model:{value:t.org_settings.enable_instant_email_report_cvss_value,callback:function(e){t.$set(t.org_settings,"enable_instant_email_report_cvss_value",e)},expression:"org_settings.enable_instant_email_report_cvss_value"}})],1),a("v-flex",{attrs:{xs10:"",sm10:"",md10:""}},[a("v-checkbox",{attrs:{label:"Enable instant report by email on monitored assets with CVSSv3 score >=",dense:"","hide-details":""},model:{value:t.org_settings.enable_instant_email_report_cvss3,callback:function(e){t.$set(t.org_settings,"enable_instant_email_report_cvss3",e)},expression:"org_settings.enable_instant_email_report_cvss3"}})],1),a("v-flex",{attrs:{xs2:"",sm2:"",md2:""}},[a("v-text-field",{attrs:{type:"number",label:"CVSSv3 max value",rules:t.rules.cvss},model:{value:t.org_settings.enable_instant_email_report_cvss3_value,callback:function(e){t.$set(t.org_settings,"enable_instant_email_report_cvss3_value",e)},expression:"org_settings.enable_instant_email_report_cvss3_value"}})],1)],1)],1),a("v-card-actions",[a("v-btn",{attrs:{color:"deep-orange",loading:t.loading},nativeOn:{click:function(e){return t.updateOrgSettings.apply(null,arguments)}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Save Changes ")],1),a("v-btn",{attrs:{color:"deep-orange",loading:t.loading},nativeOn:{click:function(e){return t.sendTestEmail.apply(null,arguments)}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-cog")]),t._v(" Send test email ")],1)],1)],1)],1)],1),this.org_settings.show_slack_settings?a("v-row",[a("v-col",{attrs:{cols:"10"}},[a("v-card",[a("v-card-title",[t._v(" Slack alerting ")]),a("v-card-text",[a("v-text-field",{attrs:{label:"Slack Webhook URL",placeholder:"Ex: https://hooks.slack.com/services/T00000000/B00000000/XXXXXXXXXXXXXXXXXXXXXXXX"},model:{value:t.org_settings.alerts_slack_url,callback:function(e){t.$set(t.org_settings,"alerts_slack_url",e)},expression:"org_settings.alerts_slack_url"}}),a("v-checkbox",{attrs:{label:"Enable notifications when detecting new vulnerabilities (monitored assets)",dense:"","hide-details":""},model:{value:t.org_settings.enable_slack_new_vuln,callback:function(e){t.$set(t.org_settings,"enable_slack_new_vuln",e)},expression:"org_settings.enable_slack_new_vuln"}}),a("v-checkbox",{attrs:{label:"Enable notifications when detecting changes in vulnerabilities (monitored assets)",dense:"","hide-details":""},model:{value:t.org_settings.enable_slack_update_vuln,callback:function(e){t.$set(t.org_settings,"enable_slack_update_vuln",e)},expression:"org_settings.enable_slack_update_vuln"}})],1),a("v-card-actions",[a("v-btn",{attrs:{color:"deep-orange",loading:t.loading},nativeOn:{click:function(e){return t.updateOrgSettings.apply(null,arguments)}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Save Changes ")],1)],1)],1)],1)],1):t._e(),this.org_settings.show_thehive_settings?a("v-row",[a("v-col",{attrs:{cols:"10"}},[a("v-card",[a("v-card-title",[t._v(" TheHive alerting ")]),a("v-card-text",[a("v-text-field",{attrs:{label:"TheHive URL",placeholder:"Ex: https://thehive.example.com"},model:{value:t.org_settings.alerts_thehive_url,callback:function(e){t.$set(t.org_settings,"alerts_thehive_url",e)},expression:"org_settings.alerts_thehive_url"}}),a("v-text-field",{attrs:{label:"TheHive API Key (token)",type:"password"},model:{value:t.org_settings.alerts_thehive_apikey,callback:function(e){t.$set(t.org_settings,"alerts_thehive_apikey",e)},expression:"org_settings.alerts_thehive_apikey"}}),a("v-checkbox",{attrs:{label:"Enable notifications when detecting new vulnerabilities (monitored assets)",dense:"","hide-details":""},model:{value:t.org_settings.enable_thehive_new_vuln,callback:function(e){t.$set(t.org_settings,"enable_thehive_new_vuln",e)},expression:"org_settings.enable_thehive_new_vuln"}}),a("v-checkbox",{attrs:{label:"Enable notifications when detecting changes in vulnerabilities (monitored assets)",dense:"","hide-details":""},model:{value:t.org_settings.enable_thehive_update_vuln,callback:function(e){t.$set(t.org_settings,"enable_thehive_update_vuln",e)},expression:"org_settings.enable_thehive_update_vuln"}})],1),a("v-card-actions",[a("v-btn",{attrs:{color:"deep-orange",loading:t.loading},nativeOn:{click:function(e){return t.updateOrgSettings.apply(null,arguments)}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Save Changes ")],1)],1)],1)],1)],1):t._e(),this.org_settings.show_misp_settings?a("v-row",[a("v-col",{attrs:{cols:"10"}},[a("v-card",[a("v-card-title",[t._v(" MISP alerting ")]),a("v-card-text",[a("v-text-field",{attrs:{label:"MISP URL",placeholder:"Ex: https://misp.example.com"},model:{value:t.org_settings.alerts_misp_url,callback:function(e){t.$set(t.org_settings,"alerts_misp_url",e)},expression:"org_settings.alerts_misp_url"}}),a("v-text-field",{attrs:{label:"MISP API Key",type:"password"},model:{value:t.org_settings.alerts_misp_apikey,callback:function(e){t.$set(t.org_settings,"alerts_misp_apikey",e)},expression:"org_settings.alerts_misp_apikey"}}),a("v-checkbox",{attrs:{label:"Enable notifications when detecting new vulnerabilities (monitored assets)",dense:"","hide-details":""},model:{value:t.org_settings.enable_misp_new_vuln,callback:function(e){t.$set(t.org_settings,"enable_misp_new_vuln",e)},expression:"org_settings.enable_misp_new_vuln"}}),a("v-checkbox",{attrs:{label:"Enable notifications when detecting changes in vulnerabilities (monitored assets)",dense:"","hide-details":""},model:{value:t.org_settings.enable_misp_update_vuln,callback:function(e){t.$set(t.org_settings,"enable_misp_update_vuln",e)},expression:"org_settings.enable_misp_update_vuln"}})],1),a("v-card-actions",[a("v-btn",{attrs:{color:"deep-orange",loading:t.loading},nativeOn:{click:function(e){return t.updateOrgSettings.apply(null,arguments)}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Save Changes ")],1)],1)],1)],1)],1):t._e()],1):t._e(),"notsupported"==t.isAdmin()?a("v-tab-item",[a("v-row",[a("v-col",{attrs:{cols:"3"}},[a("v-card",{staticClass:"mx-auto"},[a("v-subheader",[t._v("Synchronize data from feed")]),a("v-card-text",[a("v-btn",{attrs:{color:"deep-orange",loading:t.loading,"x-small":""},nativeOn:{click:function(e){return t.syncFromRemote("")}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Sync All from remote ")],1),a("br"),a("v-btn",{attrs:{color:"light-orange",loading:t.loading,"x-small":""},nativeOn:{click:function(e){return t.syncFromRemote("kb_vendor")}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Sync Vendor ")],1),a("br"),a("v-btn",{attrs:{color:"light-orange",loading:t.loading,"x-small":""},nativeOn:{click:function(e){return t.syncFromRemote("kb_product")}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Sync Product ")],1),a("br"),a("v-btn",{attrs:{color:"light-orange",loading:t.loading,"x-small":""},nativeOn:{click:function(e){return t.syncFromRemote("kb_product_version")}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Sync ProductVersion ")],1),a("br"),a("v-btn",{attrs:{color:"light-orange",loading:t.loading,"x-small":""},nativeOn:{click:function(e){return t.syncFromRemote("kb_bulletin")}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Sync Bulletin ")],1),a("br"),a("v-btn",{attrs:{color:"light-orange",loading:t.loading,"x-small":""},nativeOn:{click:function(e){return t.syncFromRemote("kb_cwe")}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Sync CWE ")],1),a("br"),a("v-btn",{attrs:{color:"light-orange",loading:t.loading,"x-small":""},nativeOn:{click:function(e){return t.syncFromRemote("kb_cpe")}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Sync CPE ")],1),a("br"),a("v-btn",{attrs:{color:"light-orange",loading:t.loading,"x-small":""},nativeOn:{click:function(e){return t.syncFromRemote("kb_cve")}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Sync CVE ")],1),a("br"),a("v-btn",{attrs:{color:"light-orange",loading:t.loading,"x-small":""},nativeOn:{click:function(e){return t.syncFromRemote("vulns")}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Sync Vuln ")],1),a("br"),a("v-btn",{attrs:{color:"light-orange",loading:t.loading,"x-small":""},nativeOn:{click:function(e){return t.syncFromRemote("exploits")}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Sync Exploits ")],1),a("br"),a("v-btn",{attrs:{color:"light-orange",loading:t.loading,"x-small":""},nativeOn:{click:function(e){return t.syncFromRemote("threats")}}},[a("v-icon",{attrs:{left:"",dark:""}},[t._v("mdi-check")]),t._v(" Sync Threats ")],1)],1)],1)],1),a("v-col",{attrs:{cols:"3"}},[a("v-card",{staticClass:"mx-auto"},[a("v-list",{attrs:{dense:""}},[a("v-subheader",[t._v("Synchronize data from local")]),a("v-list-item-group",{attrs:{color:"primary"},model:{value:t.async_item,callback:function(e){t.async_item=e},expression:"async_item"}},t._l(t.async_items,(function(e,s){return a("v-list-item",{key:s,on:{click:function(a){return t.callAction(e)}}},[a("v-list-item-icon",[a("v-icon",{attrs:{color:"deep-orange"},domProps:{textContent:t._s(e.icon)}})],1),a("v-list-item-content",[a("v-list-item-title",{attrs:{link:"",to:e.to},domProps:{textContent:t._s(e.text)}})],1)],1)})),1)],1)],1)],1),a("v-col",{attrs:{cols:"3"}},[a("v-card",{staticClass:"mx-auto"},[a("v-list",{attrs:{dense:""}},[a("v-subheader",[t._v("Synchronize CVEs from year")]),a("v-list-item-group",{attrs:{color:"primary"}},t._l(t.cves_years,(function(e,s){return a("v-list-item",{key:s,on:{click:function(a){return t.callAction({to:"/api/kb/cves/async/from/"+e})}}},[a("v-list-item-icon",[a("v-icon",{attrs:{color:"deep-orange"},domProps:{textContent:t._s("mdi-clock")}})],1),a("v-list-item-content",[a("v-list-item-title",{attrs:{link:""},domProps:{textContent:t._s(e)}})],1)],1)})),1)],1)],1)],1),a("v-col",{attrs:{cols:"3"}},[a("v-card",{staticClass:"mx-auto"},[a("v-list",{attrs:{dense:""}},[a("v-subheader",[t._v("Synchronize CVEs at year")]),a("v-list-item-group",{attrs:{color:"primary"}},t._l(t.cves_years,(function(e,s){return a("v-list-item",{key:s,on:{click:function(a){return t.callAction({to:"/api/kb/cves/async/"+e})}}},[a("v-list-item-icon",[a("v-icon",{attrs:{color:"deep-orange"},domProps:{textContent:t._s("mdi-clock")}})],1),a("v-list-item-content",[a("v-list-item-title",{attrs:{link:""},domProps:{textContent:t._s(e)}})],1)],1)})),1)],1)],1)],1)],1)],1):t._e(),t.isTeamOrgAdmin()?a("v-tab-item",[a("v-card",[a("v-card-title",[t._v(" Organizations ")]),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.orgs_headers,items:t.orgs.results,options:t.orgs_options,"server-items-length":t.orgs.count,"items-per-page":5,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"id"},on:{"update:options":function(e){t.orgs_options=e}},scopedSlots:t._u([{key:"item.is_active",fn:function(e){var s=e.item;return[1==s.is_active?a("v-icon",{staticClass:"mdi mdi-check-circle",attrs:{small:"",color:"green",title:"Enable Organization"},on:{click:function(e){"true"==t.isAdmin()&&t.disableOrg(s)}}}):t._e(),0==s.is_active?a("v-icon",{staticClass:"mdi mdi-checkbox-blank-circle",attrs:{small:"",color:"red",title:"Disable Organization"},on:{click:function(e){"true"==t.isAdmin()&&t.enableOrg(s)}}}):t._e()]}},{key:"item.action",fn:function(e){var s=e.item;return["true"==t.isAdmin()||"Private"!=s.name?a("v-icon",{staticClass:"mdi mdi-account-plus",attrs:{small:"",color:"green",title:"Add user in Organization"},on:{click:function(e){return t.openInvitationDialog(s.id,s.name)}}}):t._e(),t._v("   "),"true"==t.isAdmin()?a("v-icon",{staticClass:"mdi mdi-close-circle",attrs:{small:"",title:"Remove Organization",color:"red"},on:{click:function(e){return t.removeOrg(s)}}}):t._e()]}}],null,!1,2926665826)}),"true"==t.isAdmin()?a("v-dialog",{attrs:{"max-width":"500px"},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on;return[a("v-btn",t._g({attrs:{absolute:"",dark:"",fab:"",top:"",right:"",color:"deep-orange",small:""}},s),[a("v-icon",{attrs:{small:""}},[t._v("mdi-plus")])],1)]}}],null,!1,1321426347),model:{value:t.dialog_new_organization,callback:function(e){t.dialog_new_organization=e},expression:"dialog_new_organization"}},[a("v-card",[a("v-card-title",[t._v(" Create new organization ")]),a("v-card-text",[a("v-container",[a("v-form",{ref:"form-new-organization"},[a("v-text-field",{attrs:{label:"Name"},model:{value:t.org_form.name,callback:function(e){t.$set(t.org_form,"name",e)},expression:"org_form.name"}}),a("v-checkbox",{attrs:{label:"is active ?"},model:{value:t.org_form.is_active,callback:function(e){t.$set(t.org_form,"is_active",e)},expression:"org_form.is_active"}}),a("v-divider"),a("v-text-field",{attrs:{label:"Email owner",rules:t.emailRules,required:""},model:{value:t.org_form.email,callback:function(e){t.$set(t.org_form,"email",e)},expression:"org_form.email"}}),a("v-btn",{attrs:{color:"success"},on:{click:t.createOrg}},[t._v("Save")]),a("v-btn",{attrs:{color:"warning",type:"reset"}},[t._v("Reset")])],1)],1)],1),a("v-card-actions",[a("v-spacer")],1)],1)],1):t._e(),a("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.dialog_invitation,callback:function(e){t.dialog_invitation=e},expression:"dialog_invitation"}},[a("v-card",[a("v-card-title",[t._v(" Invite people to organization '"+t._s(t.invitation.org_name)+"' ")]),a("v-card-text",[a("v-container",[a("v-form",{ref:"form-user-invitation"},[a("v-textarea",{attrs:{label:"Emails",hint:"Users emails separated with comma or 1 per line. 50 emails max",required:""},model:{value:t.invitation.emails,callback:function(e){t.$set(t.invitation,"emails",e)},expression:"invitation.emails"}}),a("v-btn",{attrs:{color:"success",small:""},on:{click:t.addUserToOrg}},[t._v("Invite")]),a("v-btn",{attrs:{color:"warning",type:"reset",small:""}},[t._v("Reset")])],1)],1)],1),a("v-card-actions",[a("v-spacer")],1)],1)],1)],1),a("br"),a("v-card",[a("v-card-title",[t._v(" Organization Users ")]),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.users_headers,items:t.users.results,options:t.users_options,"server-items-length":t.users.count,"items-per-page":20,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"id"},on:{"update:options":function(e){t.users_options=e}},scopedSlots:t._u([{key:"item.is_admin",fn:function(e){var s=e.item;return[1==s.is_admin?a("v-icon",{staticClass:"mdi mdi-shield-check",attrs:{small:"",title:"Promote user as Org admin",color:"deep-orange"},on:{click:function(e){"true"==t.isAdmin()&&t.disableOrgAdmin(s.org_id,s.user,s)}}}):t._e(),0==s.is_admin?a("v-icon",{staticClass:"mdi mdi-shield-check",attrs:{small:"",title:"Demote user from Org admin",color:"grey"},on:{click:function(e){"true"==t.isAdmin()&&t.enableOrgAdmin(s.org_id,s.user,s)}}}):t._e()]}},{key:"item.is_active",fn:function(e){var s=e.item;return[1==s.is_active?a("v-icon",{staticClass:"mdi mdi-check-circle",attrs:{small:"",color:"green"}}):t._e(),0==s.is_active?a("v-icon",{staticClass:"mdi mdi-checkbox-blank-circle",attrs:{small:"",color:"grey"}}):t._e()]}},{key:"item.action",fn:function(e){var s=e.item;return[a("v-icon",{staticClass:"mdi mdi-account-box",attrs:{small:"",title:"View or Update user"},on:{click:function(e){return t.viewUser(s.user)}}}),s.username!=t.user_profile.username?a("v-icon",{staticClass:"mdi mdi-account-remove",attrs:{small:"",title:"Remove user",color:"red"},on:{click:function(e){return t.delUserFromOrg(s.org_id,s.user,s)}}}):t._e()]}}],null,!1,4010060456)})],1),a("v-dialog",{attrs:{"max-width":"600px"},model:{value:t.dialog_edituser,callback:function(e){t.dialog_edituser=e},expression:"dialog_edituser"}},[a("user-edit",{attrs:{user_id:t.dialog_edituser_user_id}})],1)],1):t._e()],1),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)},pe=[],_e={methods:{isAdmin(){return localStorage.getItem("is_admin")},isOrgAdmin(){return localStorage.getItem("is_org_admin")},getUserProfile(){return localStorage.getItem("profile")}},mounted(){},destroyed(){}},ge=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("User information")])]),a("v-card-text",[a("v-form",{ref:"form-user"},[a("v-container",[a("v-row",[a("v-col",{attrs:{md:"10"}},[a("v-text-field",{attrs:{label:"Username",disabled:""},model:{value:t.user_profile.username,callback:function(e){t.$set(t.user_profile,"username",e)},expression:"user_profile.username"}}),a("v-text-field",{attrs:{label:"Firstname",disabled:""},model:{value:t.user_profile.first_name,callback:function(e){t.$set(t.user_profile,"first_name",e)},expression:"user_profile.first_name"}}),a("v-text-field",{attrs:{label:"Lastname",disabled:""},model:{value:t.user_profile.last_name,callback:function(e){t.$set(t.user_profile,"last_name",e)},expression:"user_profile.last_name"}}),a("v-text-field",{attrs:{label:"email",disabled:""},model:{value:t.user_profile.email,callback:function(e){t.$set(t.user_profile,"email",e)},expression:"user_profile.email"}}),a("v-text-field",{attrs:{label:"last_login",disabled:""},model:{value:t.moment(t.user_profile.last_login).format("YYYY-MM-DD, hh:mm:ss"),callback:function(e){t.$set(t.moment(t.user_profile.last_login),"format('YYYY-MM-DD, hh:mm:ss')",e)},expression:"moment(user_profile.last_login).format('YYYY-MM-DD, hh:mm:ss')"}})],1)],1),a("v-btn",{attrs:{color:"deep-orange"},on:{click:t.renewUserPassword}},[t._v("Renew password")]),t._v(" "+t._s(t.new_password)+" ")],1)],1)],1),a("v-card-actions",[a("v-spacer")],1),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor,dense:""},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)},fe=[],be={name:"UserEdit",props:["user_id"],data:()=>({snack:!1,snackColor:"",snackText:"",user_profile:{},user_profile_default:{username:"",email:"",last_login:"",first_name:"",last_name:"",orgs:[]},new_password:""}),mounted(){this.user_profile=this.user_profile_default,this.loadUserProfile()},watch:{user_id:function(t,e){this.loadUserProfile()}},computed:{},methods:{loadUserProfile(){this.new_password="",this.$api.get("/api/users/"+this.user_id).then(t=>{t&&200===t.status&&(this.user_profile=t.data)}).catch(t=>{this.snack=!0,this.snackColor="error",this.snackText="Unable to retreive user's info"})},renewUserPassword(){this.$api.get("/api/users/profile/"+this.user_id+"/renewpassword").then(t=>{t&&200===t.status&&"success"==t.data.status&&(this.new_password='New password: "'+t.data.password+'"')}).catch(t=>{this.snack=!0,this.snackColor="error",this.snackText="Unable to retreive user's info"})}}},ke=be,xe=(a("c2fc"),Object(l["a"])(ke,ge,fe,!1,null,null,null)),ye=xe.exports;d()(xe,{VBtn:V["a"],VCard:S["a"],VCardActions:T["b"],VCardText:T["d"],VCardTitle:T["e"],VCol:le["a"],VContainer:P["a"],VForm:$["a"],VRow:de["a"],VSnackbar:M["a"],VSpacer:B["a"],VTextField:O["a"]});var we={name:"Settings",mixins:[_e],components:{UserEdit:ye},data:()=>({loading:!1,showEditProfileCard:!1,showEditPasswordCard:!1,showEditTokenCard:!1,user_profile:{username:"",email:"",first_name:"",last_name:"",last_login:"",profile:{manage_organization:!1,manage_alert_email:!1}},user_profile_chpwd:{},show_authtoken:!1,showPassword:!1,showPassword_old:!1,showPassword_new1:!1,showPassword_new2:!1,rules:{password:[t=>!!t||"Password is required",t=>t&&t.length>8||"The password must be longer than 8 characters",t=>/(?=.*[A-Z])/.test(t)||"Must have one uppercase character",t=>/(?=.*\d)/.test(t)||"Must have one number",t=>/([!@$%])/.test(t)||"Must have one special character [!@#$%]"],email:[t=>!!t||"E-mail is required",t=>/.+@.+\..+/.test(t)||"E-mail must be valid"],cvss:[t=>t&&t>=0&&t<=10||"CVSS score has to be between 0 and 10. Default is 8.0"],score:[t=>t&&t>=0&&t<=100||"Score has to be between 0 and 100. Default is 80"]},org_settings_default:{alerts_emails:[],alerts_emails_max:3,enable_email_alert_new_vuln:!1,enable_email_alert_update_vuln:!1,enable_daily_email_report:!1,enable_weekly_email_report:!1,enable_monthly_email_report:!1,enable_instant_email_report_exploitable:!1,enable_instant_email_report_score:!1,enable_instant_email_report_score_value:80,enable_instant_email_report_cvss:!1,enable_instant_email_report_cvss_value:8,enable_instant_email_report_cvss3:!1,enable_instant_email_report_cvss3_value:8,show_slack_settings:!0,alerts_slack_url:"",enable_slack_new_vuln:!1,enable_slack_update_vuln:!1,show_thehive_settings:!1,alerts_thehive_url:"",alerts_thehive_apikey:"",enable_thehive_new_vuln:!1,enable_thehive_update_vuln:!1,show_misp_settings:!1,alerts_misp_url:"",alerts_misp_apikey:"",enable_misp_new_vuln:!1,enable_misp_update_vuln:!1},org_settings:{alerts_emails:[],alerts_emails_max:3,enable_email_alert_new_vuln:!1,enable_email_alert_update_vuln:!1,enable_daily_email_report:!1,enable_weekly_email_report:!1,enable_monthly_email_report:!1,enable_instant_email_report_exploitable:!1,enable_instant_email_report_score:!1,enable_instant_email_report_score_value:80,enable_instant_email_report_cvss:!1,enable_instant_email_report_cvss_value:8,enable_instant_email_report_cvss3:!1,enable_instant_email_report_cvss3_value:8,show_slack_settings:!0,alerts_slack_url:"",enable_slack_new_vuln:!1,enable_slack_update_vuln:!1,show_thehive_settings:!1,alerts_thehive_url:"",alerts_thehive_apikey:"",enable_thehive_new_vuln:!1,enable_thehive_update_vuln:!1,show_misp_settings:!1,alerts_misp_url:"",alerts_misp_apikey:"",enable_misp_new_vuln:!1,enable_misp_update_vuln:!1},async_item:1,async_items:[{text:"CWE",icon:"mdi-clock",to:"/api/kb/cwes/async"},{text:"CPE",icon:"mdi-clock",to:"/api/kb/cpes/async"},{text:"Bulletins",icon:"mdi-clock",to:"/api/kb/bulletins/async"},{text:"CVE",icon:"mdi-clock",to:"/api/kb/cves/async"},{text:"VIA",icon:"mdi-clock",to:"/api/kb/vias/async"},{text:"Vuln / Scores",icon:"mdi-clock",to:"/api/vulns/refresh_scores"},{text:"Vuln / Product versions",icon:"mdi-clock",to:"/api/vulns/refresh_vulnerable_versions"}],cves_years:["1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017","2018","2019","2020","2021"],orgs:[],orgs_options:{},org_selected:"",orgs_headers:[{text:"Name",value:"name"},{text:"Slug",value:"slug"},{text:"Owner",value:"owner"},{text:"Users",value:"nb_users"},{text:"Active",value:"is_active",align:"center"},{text:"Actions",value:"action",align:"center",sortable:!1}],dialog_new_organization:!1,org_form:{name:"",is_active:!0},users:[],users_options:{},users_headers:[{text:"Organization name",value:"org_name"},{text:"Username",value:"username"},{text:"Email",value:"email"},{text:"Admin ?",value:"is_admin",align:"center"},{text:"Active ?",value:"is_active",align:"center"},{text:"Actions",value:"action",align:"center",sortable:!1}],invitation:{org_name:"",org_id:0,email:"",emails:"",is_admin:!1},emailRules:[t=>!!t||"E-mail is required",t=>/.+@.+\..+/.test(t)||"E-mail must be valid"],rowsPerPageItems:[5,10,20,50,100],dialog_invitation:!1,dialog_edituser:!1,dialog_edituser_user_id:0,snack:!1,snackColor:"",snackText:""}),mounted(){this.getUserProfile(),this.getOrgSettings()},watch:{orgs_options:{handler(){this.getDataFromApiOrgs().then(t=>{})},deep:!0},users_options:{handler(){this.getDataFromApiUsers().then(t=>{})},deep:!0}},methods:{getDataFromApiOrgs(){return this.loading=!0,new Promise((t,e)=>{const{sortBy:a,sortDesc:s,page:i,itemsPerPage:o}=this.orgs_options;this.limit=o;let n=this.getOrgs(i,this.limit,a,s);setTimeout(()=>{t({orgs:n})},300),this.loading=!1})},getDataFromApiUsers(){return this.loading=!0,new Promise((t,e)=>{const{sortBy:a,sortDesc:s,page:i,itemsPerPage:o}=this.users_options;this.limit=o;let n=this.getUsers(i,this.limit,a,s);setTimeout(()=>{t({users:n})},300),this.loading=!1})},getDataFromApiUserProfile(){return this.loading=!0,new Promise((t,e)=>{let a=this.getUserProfile();setTimeout(()=>{t({user_profile_api:a})},300),this.loading=!1})},callAction(t){this.$api.get(t.to).then(t=>{t&&200===t.status?(this.snack=!0,this.snackColor="success",this.snackText="Sync successfuly enqueued."):(this.snack=!0,this.snackColor="error",this.snackText="Unable to sync :/")}).catch(t=>{swal.fire({title:"Error",text:"Unable to call action",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})},getOrgs(t,e,a,s){let i="";a.length>0&&(i=!0===s[0]?"&sorted_by=-"+a:"&sorted_by="+a),this.$api.get("/api/orgs/?limit="+e+"&page="+t+i).then(t=>{t&&200===t.status&&(this.orgs=t.data)}).catch(t=>{this.orgs=[],swal.fire({title:"Error",text:"Unable to get org users",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})},getUsers(t,e,a,s){let i="";a.length>0&&(i=!0===s[0]?"sorted_by=-"+a:"sorted_by="+a),this.$api.get("/api/org-users/?limit="+e+"&page="+t+"&"+i).then(t=>{t&&200===t.status&&(this.users=t.data)}).catch(t=>{this.users=[],swal.fire({title:"Error",text:"Unable to get org users",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})},getUserProfile(){this.$api.get("/users/profile").then(t=>{t&&200===t.status&&(this.user_profile=t.data)}).catch(t=>{this.user_profile={},swal.fire({title:"Error",text:"Unable to get user profile",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})},isAlertAdmin(){return this.user_profile.profile.manage_alert_email},isTeamOrgAdmin(){return"true"==this.isAdmin()||this.user_profile.profile.manage_organization},updateUserProfile(){var t=new FormData;t.set("first_name",this.user_profile.first_name),t.set("last_name",this.user_profile.last_name),this.$api.post("/users/profile/update",t).then(t=>{t&&200===t.status?(this.snack=!0,this.snackColor="success",this.snackText="User profile updated !"):(this.snack=!0,this.snackColor="error",this.snackText="Unable to update user profile :/")}).catch(t=>{this.snack=!0,this.snackColor="error",this.snackText="Unable to update user profile :/"})},sendTestEmail(){this.$api.get("/api/alerts/email/test").then(t=>{t&&200===t.status&&"success"==t.data.status?(this.snack=!0,this.snackColor="success",this.snackText="Test sent. Check your mailbox !"):(this.snack=!0,this.snackColor="error",this.snackText="Unable to send test email: "+t.data.reason)}).catch(t=>{this.snack=!0,this.snackColor="error",this.snackText="Unable to send test email"})},updateUserToken(){new FormData;this.$api.get("/users/token/renew").then(t=>{t&&200===t.status?(this.user_profile.auth_token=t.data.token,this.snack=!0,this.snackColor="success",this.snackText="User's API Token updated !"):(this.snack=!0,this.snackColor="error",this.snackText="Unable to update user's API Token :/")}).catch(t=>{this.snack=!0,this.snackColor="error",this.snackText="Unable to update user profile :/"})},deleteUserToken(){new FormData;this.$api.get("/users/token/delete").then(t=>{t&&200===t.status?(this.user_profile.auth_token="",this.snack=!0,this.snackColor="success",this.snackText="User's API Token updated !"):(this.snack=!0,this.snackColor="error",this.snackText="Unable to update user's API Token :/")}).catch(t=>{this.snack=!0,this.snackColor="error",this.snackText="Unable to update user profile :/"})},updateUserPassword(){var t=new FormData;t.set("old_password",this.user_profile_chpwd.oldpassword),t.set("new_password1",this.user_profile_chpwd.new_password1),t.set("new_password2",this.user_profile_chpwd.new_password2),this.$api.post("/users/profile/chpwd",t).then(t=>{t&&200===t.status?(this.snack=!0,this.snackColor="success",this.snackText="User profile updated !"):(this.snack=!0,this.snackColor="error",this.snackText="Unable to update user profile :/")}).catch(t=>{this.snack=!0,this.snackColor="error",this.snackText="Unable to update user profile :/"})},getOrgSettings(){var t=localStorage.getItem("org_id");this.$api.get("/users/org/"+t+"/settings").then(t=>{if(t&&200===t.status){for(let e in t.data)this.org_settings[e]=t.data[e];this.org_settings.alerts_slack_url=t.data["alerts_slack"]["url"],this.org_settings.enable_slack_new_vuln=t.data["alerts_slack"]["new_vuln"],this.org_settings.enable_slack_update_vuln=t.data["alerts_slack"]["update_vuln"]}}).catch(t=>{Object.assign(this.org_settings,this.org_settings_default),swal.fire({title:"Error",text:"Unable to get org settings profile",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})},updateOrgSettings(){var t=new FormData;t.set("org_id",localStorage.getItem("org_id")),t.set("alerts_emails",this.org_settings.alerts_emails),t.set("enable_email_alert_new_vuln",this.org_settings.enable_email_alert_new_vuln),t.set("enable_email_alert_update_vuln",this.org_settings.enable_email_alert_update_vuln),t.set("enable_daily_email_report",this.org_settings.enable_daily_email_report),t.set("enable_weekly_email_report",this.org_settings.enable_weekly_email_report),t.set("enable_monthly_email_report",this.org_settings.enable_monthly_email_report),t.set("enable_instant_email_report_exploitable",this.org_settings.enable_instant_email_report_exploitable),t.set("enable_instant_email_report_cvss",this.org_settings.enable_instant_email_report_cvss),t.set("enable_instant_email_report_cvss_value",this.org_settings.enable_instant_email_report_cvss_value),t.set("enable_instant_email_report_cvss3",this.org_settings.enable_instant_email_report_cvss3),t.set("enable_instant_email_report_cvss3_value",this.org_settings.enable_instant_email_report_cvss3_value),t.set("enable_instant_email_report_score",this.org_settings.enable_instant_email_report_score),t.set("enable_instant_email_report_score_value",this.org_settings.enable_instant_email_report_score_value),t.set("alerts_slack_url",this.org_settings.alerts_slack_url),t.set("enable_slack_new_vuln",this.org_settings.enable_slack_new_vuln),t.set("enable_slack_update_vuln",this.org_settings.enable_slack_update_vuln),t.set("alerts_thehive_url",this.org_settings.alerts_thehive_url),t.set("alerts_thehive_apikey",this.org_settings.alerts_thehive_apikey),t.set("enable_thehive_new_vuln",this.org_settings.enable_thehive_new_vuln),t.set("enable_thehive_update_vuln",this.org_settings.enable_thehive_update_vuln),t.set("alerts_misp_url",this.org_settings.alerts_misp_url),t.set("alerts_misp_apikey",this.org_settings.alerts_misp_apikey),t.set("enable_misp_new_vuln",this.org_settings.enable_misp_new_vuln),t.set("enable_misp_update_vuln",this.org_settings.enable_misp_update_vuln),this.$api.post("/users/org/update",t).then(t=>{t&&200===t.status?(this.org_settings.alerts_emails=t.data.alerts_emails,this.org_settings.enable_email_alert_new_vuln=t.data.enable_email_alert_new_vuln,this.org_settings.enable_email_alert_update_vuln=t.data.enable_email_alert_update_vuln,this.org_settings.enable_daily_email_report=t.data.enable_daily_email_report,this.org_settings.enable_weekly_email_report=t.data.enable_weekly_email_report,this.org_settings.enable_monthly_email_report=t.data.enable_monthly_email_report,this.org_settings.alerts_slack_url=t.data.alerts_slack_url,this.snack=!0,this.snackColor="success",this.snackText="Organization settings updated !"):(this.snack=!0,this.snackColor="error",this.snackText="Unable to update organization settings :/")}).catch(t=>{this.snack=!0,this.snackColor="error",this.snackText="Unable to update organization settings :/"})},openInvitationDialog(t,e){this.invitation.org_id=t,this.invitation.org_name=e,this.dialog_invitation=!0},addUserToOrg(t){this.dialog_invitation=!1,this.snack=!0,this.snackColor="grey",this.snackText="Processing user invitation into organization";var e=new FormData;e.set("emails",this.invitation.emails),this.$api.post("/users/"+this.invitation.org_id+"/adduser",e).then(t=>{t&&200===t.status&&"success"==t.data.status?(this.snack=!0,this.snackColor="success",this.snackText="Invitation(s) successfuly sent to valid email addresses.",this.$router.go()):t&&200===t.status&&"error"==t.data.status?(this.snack=!0,this.snackColor="error",this.snackText="An error occured during the invitation: "+t.data.reason):(this.snack=!0,this.snackColor="error",this.snackText="An error occured during the invitation.")}).catch(t=>{swal.fire({title:"Error",text:"Unable to add users",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})},async delUserFromOrg(t,e,a){let s=await this.$confirm("Do you really want to delete user ?",{title:"Warning"});s&&this.$api.get("/users/"+t+"/delete/"+e).then(t=>{if(t&&200===t.status){let t=this.users.results.indexOf(a);this.users.results.splice(t,1)}})},disableOrg(t){this.$api.get("/users/"+t.id+"/disable").then(e=>{e&&200===e.status?(t.is_active=!1,this.snack=!0,this.snackColor="success",this.snackText="Organization successfuly disabled."):(this.snack=!0,this.snackColor="error",this.snackText="Unable to disable the Organization.")})},enableOrg(t){this.$api.get("/users/"+t.id+"/enable").then(e=>{e&&200===e.status?(t.is_active=!0,this.snack=!0,this.snackColor="success",this.snackText="Organization successfuly enabled."):(this.snack=!0,this.snackColor="error",this.snackText="Unable to enable the Organization.")})},enableOrgAdmin(t,e,a){this.$api.get("/users/"+t+"/"+e+"/admin/enable").then(t=>{t&&200===t.status?(a.is_admin=!0,this.snack=!0,this.snackColor="success",this.snackText="Organization admin successfuly enabled."):(this.snack=!0,this.snackColor="error",this.snackText="Unable to enable the Organization admin.")})},disableOrgAdmin(t,e,a){this.$api.get("/users/"+t+"/"+e+"/admin/disable").then(t=>{t&&200===t.status?(a.is_admin=!1,this.snack=!0,this.snackColor="success",this.snackText="Organization admin successfuly disabled."):(this.snack=!0,this.snackColor="error",this.snackText="Unable to disable the Organization admin.")})},createOrg(t){this.dialog_new_organization=!1;var e=new FormData;e.set("name",this.org_form.name),e.set("is_active",this.org_form.is_active),e.set("email",this.org_form.email),this.$api.post("/users/addorg",e).then(t=>{t&&200===t.status?(this.snack=!0,this.snackColor="success",this.snackText="Organization successfuly created.",this.$router.go()):(this.snack=!0,this.snackColor="error",this.snackText="Unable to create the Organization.")})},syncFromRemote(t){let e="/api/data/sync/run";""!=t&&(e=e+"?model="+t),this.$api.get(e).then(t=>{t&&200===t.status?(this.snack=!0,this.snackColor="success",this.snackText="Sync successfuly enqueued.",this.$router.go()):(this.snack=!0,this.snackColor="error",this.snackText="Unable to start data sync from remote.")})},async removeOrg(t){let e=await this.$confirm("Do you really want to delete organization ?",{title:"Warning"});e&&this.$api.get("/users/"+t.id+"/remove").then(e=>{if(e&&200===e.status){let e=this.orgs.results.indexOf(t);this.orgs.results.splice(e,1),this.snack=!0,this.snackColor="success",this.snackText="Organization successfuly removed."}else this.snack=!0,this.snackColor="error",this.snackText="Unable to remove the Organization."})},removeContactEmail(t){this.org_settings.alerts_emails.splice(this.org_settings.alerts_emails.indexOf(t),1),this.org_settings.alerts_emails=[...this.org_settings.alerts_emails]},viewUser(t){this.dialog_edituser=!0,this.dialog_edituser_user_id=t},showManageAlertsEmail(){return JSON.parse(this.getUserProfile()).manage_alert_email},showManageAlertsSlack(){return JSON.parse(this.getUserProfile()).manage_alert_slack}}},Ce=we,Ve=(a("f880"),a("1baa")),Se=a("34c3"),Te=a("e0c7"),Ie=a("71a3"),Pe=a("c671"),Ee=a("fe57"),$e=a("a844"),Ae=Object(l["a"])(Ce,he,pe,!1,null,null,null),De=Ae.exports;d()(Ae,{VBtn:V["a"],VCard:S["a"],VCardActions:T["b"],VCardText:T["d"],VCardTitle:T["e"],VCheckbox:I["a"],VChip:Z["a"],VCol:le["a"],VCombobox:Bt["a"],VContainer:P["a"],VDataTable:zt["a"],VDialog:Xt["a"],VDivider:Q["a"],VFlex:E["a"],VForm:$["a"],VIcon:et["a"],VLayout:A["a"],VList:at["a"],VListItem:it["a"],VListItemContent:nt["g"],VListItemGroup:Ve["a"],VListItemIcon:Se["a"],VListItemSubtitle:nt["j"],VListItemTitle:nt["k"],VRow:de["a"],VSnackbar:M["a"],VSpacer:B["a"],VSubheader:Te["a"],VTab:Ie["a"],VTabItem:Pe["a"],VTabs:Ee["a"],VTextField:O["a"],VTextarea:$e["a"]});var Me=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{staticClass:"pa-2",attrs:{cols:"10"}},[a("v-text-field",{staticClass:"pt-0",attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.appsearch,callback:function(e){t.appsearch=e},expression:"appsearch"}})],1),a("v-col",{staticClass:"pa-2",attrs:{md:"2"}},[a("v-slider",{attrs:{label:"Min Score",min:"0",max:"100",color:"deep-orange","track-color":"grey","thumb-label":"","hide-details":""},model:{value:t.search_slider_min,callback:function(e){t.search_slider_min=e},expression:"search_slider_min"}}),a("v-slider",{attrs:{label:"Max Score",min:"0",max:"100",color:"grey","thumb-color":"deep-orange","track-color":"deep-orange","thumb-label":"","hide-details":""},model:{value:t.search_slider_max,callback:function(e){t.search_slider_max=e},expression:"search_slider_max"}})],1)],1),t.showAdvancedFilters?a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-divider"),a("advanced-search",{attrs:{scope:"vulns"},on:{advanced_search_filters:t.updateAdvancedSearchFilters}})],1)],1):t._e(),t.showAdvancedFilters?a("v-btn",{attrs:{depressed:"",tile:"",block:"",label:"coic"},on:{click:function(e){t.showAdvancedFilters=!t.showAdvancedFilters}}},[a("v-icon",[t._v("mdi-chevron-up")]),t._v("Hide advanced filters"),a("v-icon",[t._v("mdi-chevron-up")])],1):a("v-btn",{attrs:{depressed:"",tile:"",block:"",label:"coic"},on:{click:function(e){t.showAdvancedFilters=!0}}},[a("v-icon",[t._v("mdi-chevron-down")]),t._v("Show advanced filters"),a("v-icon",[t._v("mdi-chevron-down")])],1),a("v-tabs",{staticClass:"mt-1",attrs:{left:"","background-color":"white",color:"deep-orange accent-4"}},[a("v-tab",[this.vulns.count>0?a("v-badge",{attrs:{color:"deep-orange",content:this.vulns.count}},[t._v("Vulnerabilities")]):t._e(),null==this.vulns.count||0==this.vulns.count?a("v-badge",{attrs:{color:"grey",content:"0"}},[t._v("Vulnerabilities")]):t._e()],1),a("v-tab",[this.exploits.count>0?a("v-badge",{attrs:{color:"deep-orange",content:this.exploits.count}},[t._v("Exploits")]):t._e(),null==this.exploits.count||0==this.exploits.count?a("v-badge",{attrs:{color:"grey",content:"0"}},[t._v("Exploits")]):t._e()],1),a("v-tab",[this.threats.count>0?a("v-badge",{attrs:{color:"deep-orange",content:this.threats.count}},[t._v("Threat activities")]):t._e(),null==this.threats.count||0==this.threats.count?a("v-badge",{attrs:{color:"grey",content:"0"}},[t._v("Threat activities")]):t._e()],1),a("v-tab",[this.advisories.count>0?a("v-badge",{attrs:{color:"deep-orange",content:this.advisories.count}},[t._v("Advisories")]):t._e(),null==this.advisories.count||0==this.advisories.count?a("v-badge",{attrs:{color:"grey",content:"0"}},[t._v("Advisories")]):t._e()],1),a("v-tab",[this.tools.count>0?a("v-badge",{attrs:{color:"deep-orange",content:this.tools.count}},[t._v("Tools")]):t._e(),null==this.tools.count||0==this.tools.count?a("v-badge",{attrs:{color:"grey",content:"0"}},[t._v("Tools")]):t._e()],1),a("v-tab-item",[a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers_vulns,items:t.vulns.results,options:t.options_vulns,"server-items-length":t.vulns.count,"items-per-page":t.limit_vulns,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading_vulns,"item-key":"id","multi-sort":""},on:{"update:options":function(e){t.options_vulns=e}},scopedSlots:t._u([{key:"item.score",fn:function(e){var s=e.item;return[a("v-chip",{staticClass:"text-center font-weight-bold",attrs:{color:t.getRatingColor(s.score),label:""}},[t._v(t._s(s.score)+"/100")]),a("br"),a("span",{staticClass:"text-caption"},[t._v("CVSSv2: "+t._s(s.cvss))]),a("br"),a("span",{staticClass:"text-caption"},[t._v("CVSSv3: "+t._s(s.cvss3))])]}},{key:"item.summary",fn:function(e){var s=e.item;return[a("div",{staticClass:"py-2"},[a("div",{staticClass:"pb-2"},[a("span",{staticClass:"deep-orange--text font-weight-medium"},[t._v(t._s(s.cveid))]),t._v(" / PH-"+t._s(s.id)+" "),a("v-btn",{attrs:{color:"deep-orange",icon:"",small:""}},[a("v-icon",{attrs:{title:"View details"},on:{click:function(e){return t.viewVuln(s.id)}}},[t._v("mdi-arrow-right-bold-circle-outline")])],1),a("v-icon",{attrs:{color:"deep-orange",title:"Download as JSON file"},on:{click:function(e){return t.downloadVuln(s.id,"json")}}},[t._v("mdi-download")]),a("v-icon",{attrs:{color:"deep-orange",title:"Send vulnerabilty as email"},on:{click:function(e){t.selected_vuln_id=s.id,t.dialog_sendmail=!0}}},[t._v("mdi-email-send-outline")])],1),a("div",[t._v(" "+t._s(s.summary)+" ")]),t._l(s.products,(function(e){return a("v-chip",{key:e.id,staticClass:"vendor-chip",attrs:{label:"",small:"",link:""},on:{click:function(a){return t.$router.push({path:"/product/"+e.id})}}},[t._v(" "+t._s(e.vendor)+": "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(e.name))])])}))],2)]}},{key:"item.metadata",fn:function(e){var s=e.item;return[a("v-chip",{staticClass:"font-weight-bold",attrs:{label:"",link:"",small:"",color:s.exploit_count>0?"deep-orange":"grey",title:"Is exploitable?"}},[t._v(t._s(s.exploit_count))]),a("v-btn",{attrs:{color:"NETWORK"==s.access.vector?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Is exploitable remotely?"}},[t._v("mdi-cloud")])],1),a("v-btn",{attrs:{color:"NONE"==s.access.authentication?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Require authentication?"}},[t._v("mdi-shield-account")])],1),a("v-btn",{attrs:{color:s.is_in_the_news||s.is_in_the_wild?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Is in the news or exploited in the wild?"}},[t._v("mdi-star")])],1)]}},{key:"item.monitored",fn:function(e){var s=e.item;return[s.monitored?a("v-chip",{staticClass:"text-center font-weight-bold",attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:function(e){return t.toggleMonitoredVuln(s)}}},[t._v("Yes")]):t._e(),s.monitored?t._e():a("v-chip",{staticClass:"text-center font-weight-bold",attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:function(e){return t.toggleMonitoredVuln(s)}}},[t._v("No")])]}},{key:"item.updated_at",fn:function(e){var s=e.item;return[a("span",[t._v(t._s(t.moment(s.updated_at).format("YYYY-MM-DD, hh:mm")))])]}}])})],1),a("v-tab-item",[a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers_exploits,items:t.exploits.results,options:t.options_exploits,"server-items-length":t.exploits.count,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading_exploits,"item-key":"id"},on:{"update:options":function(e){t.options_exploits=e}},scopedSlots:t._u([{key:"item.relevancy_level",fn:function(e){var s=e.item;return[t._l(1,(function(e){return 1==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"yellow"}}):t._e()})),t._l(4,(function(e){return 1==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six-outline",attrs:{"x-small":"",color:"grey"}}):t._e()})),t._l(2,(function(e){return 2==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"orange"}}):t._e()})),t._l(3,(function(e){return 2==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six-outline",attrs:{"x-small":"",color:"grey"}}):t._e()})),t._l(3,(function(e){return 3==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"orange darken-4"}}):t._e()})),t._l(2,(function(e){return 3==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six-outline",attrs:{"x-small":"",color:"grey"}}):t._e()})),t._l(4,(function(e){return 4==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"red"}}):t._e()})),t._l(1,(function(e){return 4==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six-outline",attrs:{"x-small":"",color:"grey"}}):t._e()})),t._l(5,(function(e){return 5==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"red darken-4"}}):t._e()}))]}},{key:"item.vp",fn:function(e){var s=e.item;return t._l(s.products,(function(e){return a("v-chip",{key:e.id,staticClass:"vendor-chip",attrs:{label:"",small:"",link:""},on:{click:function(a){return t.$router.push({path:"/product/"+e.id})}}},[t._v(" "+t._s(e.vendor)+": "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(e.name))])])}))}},{key:"item.updated_at",fn:function(e){var s=e.item;return[a("span",[t._v(t._s(t.moment(s.updated_at).format("YYYY-MM-DD")))])]}},{key:"item.action",fn:function(e){var s=e.item;return[a("v-icon",{staticClass:"mdi mdi-eye",attrs:{small:"",color:"blue"},on:{click:function(e){return t.viewVuln(s.vuln_id)}}})]}}])})],1),a("v-tab-item"),a("v-tab-item"),a("v-tab-item")],1),a("DialogSendVulnByEmail",{attrs:{vuln_id:t.selected_vuln_id,visible:t.dialog_sendmail},on:{close:function(e){t.dialog_sendmail=!1}}})],1)},Be=[],Oe={methods:{forceFileDownload(t,e){const a=window.URL.createObjectURL(new Blob([t.data],{type:"application/*"})),s=document.createElement("a");s.href=a,s.setAttribute("download",e),document.body.appendChild(s),s.click()}},mounted(){},destroyed(){}},je=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{attrs:{"max-width":"600px"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Send vulnerability by emaile")])]),a("v-card-text",[a("v-form",{ref:"form-vuln-sendmail"},[a("v-row",[a("v-textarea",{attrs:{rows:"3",label:"Emails",hint:"Email addresses separated with comma or 1 per line. 10 emails max","prepend-icon":"mdi-email"},model:{value:t.notification_data.emails,callback:function(e){t.$set(t.notification_data,"emails",e)},expression:"notification_data.emails"}})],1),a("v-btn",{attrs:{color:"success"},on:{click:t.sendEmailVuln}},[t._v("Send")]),a("v-btn",{attrs:{color:"warning",type:"reset"}},[t._v("Reset")])],1)],1)],1),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor,dense:""},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)},Ue=[],Fe={name:"DialogSendVulnByEmail",props:["vuln_id","visible"],data:()=>({notification_data:{emails:""},snack:!1,snackColor:"",snackText:""}),mounted(){},computed:{show:{get(){return this.visible},set(t){t||this.$emit("close")}}},watch:{},methods:{sendEmailVuln(){this.$api.post("/api/vulns/"+this.vuln_id+"/export/email",this.notification_data).then(t=>{this.snack=!0,this.snackColor="success",this.snackText="Vulnerability details successfuly sent by mail."}).catch(t=>{this.snack=!0,this.snackColor="error",this.snackText="Unable to send vulnerability details."}),this.show=!1}}},Le=Fe,Ne=Object(l["a"])(Le,je,Ue,!1,null,null,null),Re=Ne.exports;d()(Ne,{VBtn:V["a"],VCard:S["a"],VCardText:T["d"],VCardTitle:T["e"],VDialog:Xt["a"],VForm:$["a"],VRow:de["a"],VSnackbar:M["a"],VTextarea:$e["a"]});var Ye=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-row",{staticClass:"py-0 mt-1"},[a("v-col",{staticClass:"py-0",attrs:{cols:"12"}},[a("span",{staticClass:"subtitle-1"},[t._v("Add a new filter")])])],1),a("v-row",[a("v-col",{attrs:{cols:"4"}},[a("v-select",{attrs:{hint:"Filter",items:t.filters_options["vulns"],"item-text":"name","item-value":"attribute",label:"Select","persistent-hint":"","return-object":"","single-line":"",outlined:"",dense:"",clearable:""},model:{value:t.new_filter.filter,callback:function(e){t.$set(t.new_filter,"filter",e)},expression:"new_filter.filter"}})],1),a("v-col",{attrs:{cols:"3"}},[a("v-select",{attrs:{disabled:""==t.new_filter.filter,hint:"Criteria",items:t.new_filter_criterias,"item-text":"text","item-value":"value",label:"Criteria","persistent-hint":"","single-line":"",outlined:"",dense:""},model:{value:t.new_filter.criteria,callback:function(e){t.$set(t.new_filter,"criteria",e)},expression:"new_filter.criteria"}})],1),"text"==this.new_filter.filter.criteria||"numeric"==this.new_filter.filter.criteria?a("v-col",{attrs:{cols:"4"}},["bool"!=this.new_filter.filter.criteria?a("v-text-field",{attrs:{disabled:""==t.new_filter.filter||null==t.new_filter.criteria,type:"numeric"==this.new_filter.filter.criteria?"number":"",hint:"Value",label:"...",outlined:"",dense:""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addFilter.apply(null,arguments)}},model:{value:t.new_filter.value,callback:function(e){t.$set(t.new_filter,"value",e)},expression:"new_filter.value"}}):t._e()],1):t._e(),"date"==this.new_filter.filter.criteria?a("v-col",{attrs:{cols:"4"}},[a("v-menu",{attrs:{"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,i=e.attrs;return[a("v-text-field",t._g(t._b({attrs:{"append-icon":"mdi-calendar",outlined:"",dense:""},model:{value:t.new_filter_date,callback:function(e){t.new_filter_date=e},expression:"new_filter_date"}},"v-text-field",i,!1),s))]}}],null,!1,1825579829),model:{value:t.new_filter_date_menu,callback:function(e){t.new_filter_date_menu=e},expression:"new_filter_date_menu"}},[a("v-date-picker",{on:{input:function(e){t.new_filter_date_menu=!1}},model:{value:t.new_filter.value,callback:function(e){t.$set(t.new_filter,"value",e)},expression:"new_filter.value"}})],1)],1):t._e(),a("v-col",{attrs:{cols:"1"}},[a("v-btn",{staticClass:"mt-0",attrs:{disabled:""==t.new_filter.value&&"bool"!=t.new_filter.filter.criteria||null==t.new_filter.criteria,fab:"",small:"",outlined:"",color:"deep-orange",title:"Add new filter"},on:{click:t.addFilter}},[a("v-icon",[t._v("mdi-plus")])],1)],1)],1),a("v-row",{staticClass:"pt-2"},[t.filters.length>0?a("v-col",{staticClass:"py-0",attrs:{cols:"12"}},[a("span",{staticClass:"subtitle-1"},[t._v("Applied filters:")])]):a("v-col",{staticClass:"py-0",attrs:{cols:"12"}},[a("span",{staticClass:"subtitle-2 font-italic"},[t._v("No filter applied yet")])])],1),t._l(t.filters,(function(e,s){return a("v-row",{key:s,attrs:{align:"center"}},[a("v-col",{attrs:{cols:"auto"}},[a("v-icon",{on:{click:function(e){return t.removeFilter(s)}}},[t._v("mdi-delete-outline")])],1),a("v-col",{attrs:{cols:"4"}},[a("v-select",{attrs:{items:t.filters_options[t.scope],"item-text":"name","item-value":"attribute","return-object":"","single-line":"",outlined:"",dense:"","hide-details":""},model:{value:e.filter,callback:function(a){t.$set(e,"filter",a)},expression:"f.filter"}})],1),a("v-col",{attrs:{cols:"3"}},[a("v-select",{attrs:{items:t.criterias[e.filter.criteria],"item-text":"text","item-value":"value","single-line":"",outlined:"",dense:"","hide-details":""},model:{value:e.criteria,callback:function(a){t.$set(e,"criteria",a)},expression:"f.criteria"}})],1),a("v-col",{attrs:{cols:"4"}},["bool"!=e.filter.criteria?a("v-text-field",{attrs:{outlined:"",dense:"","hide-details":""},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"f.value"}}):t._e()],1)],1)})),a("v-row",{attrs:{align:"start",justify:"start"}},[a("v-col",[a("v-btn",{staticClass:"mr-2",attrs:{color:"deep-orange",disabled:0==t.filters.length,small:""},on:{click:t.applySearchFilters}},[t._v("Search")])],1)],1)],2)},ze=[],Xe={name:"AdvancedSearch",props:{scope:{type:String,default:"vulns"}},data:()=>({new_filter_date:(new Date).toISOString().substr(0,10),new_filter_date_menu:!1,new_filter:{filter:"",criteria:null,value:""},new_filter_criterias:[],filters:[],filters_options:{vulns:[{name:"CVE",attribute:"cveid",criteria:"text"},{name:"Summary",attribute:"summary",criteria:"text"},{name:"Score",attribute:"score",criteria:"numeric"},{name:"CVSSv2",attribute:"cvss",criteria:"numeric"},{name:"CVSSv2 Vector",attribute:"cvss_vector",criteria:"text"},{name:"CVSSv3",attribute:"cvss3",criteria:"numeric"},{name:"CVSSv3 Vector",attribute:"cvss3_vector",criteria:"text"},{name:"Is exploitable ?",attribute:"is_exploitable",criteria:"bool"},{name:"Is confirmed ?",attribute:"is_confirmed",criteria:"bool"},{name:"Is in the News ?",attribute:"is_in_the_news",criteria:"bool"},{name:"Is in the Wild ?",attribute:"is_in_the_wild",criteria:"bool"},{name:"Published at",attribute:"published",criteria:"date"}]},criterias:{text:[{text:"Equals",value:""},{text:"Contains",value:"contains"},{text:"Contains (ignore case)",value:"icontains"}],numeric:[{text:"Equals",value:""},{text:"Greater than",value:"gt"},{text:"Greater than or equals",value:"gte"},{text:"Less than",value:"lt"},{text:"Less than or equals",value:"lte"}],date:[{text:"At",value:"date"},{text:"After",value:"date__gt"},{text:"After or at",value:"date__gte"},{text:"Before",value:"date__lt"},{text:"Before or at",value:"date__lte"}],bool:[{text:"Yes",value:"true"},{text:"No",value:"false"}]}}),mounted(){},watch:{new_filter:{handler(){this.new_filter_criterias=this.criterias[this.new_filter.filter.criteria]},deep:!0}},computed:{},methods:{addFilter(){this.filters.push(this.new_filter),this.new_filter={filter:"",criteria:null,value:""},this.applySearchFilters()},removeFilter(t){this.filters.splice(t,1),this.applySearchFilters()},applySearchFilters(){let t="";this.filters.forEach((function(e){var a="";a="bool"==e.filter.criteria?"&"+e.filter.attribute+"="+e.criteria:""==e.criteria?"&"+e.filter.attribute+"="+e.value:"&"+e.filter.attribute+"__"+e.criteria+"="+e.value,t+=a})),this.$emit("advanced_search_filters",t)}}},He=Xe,We=a("b974"),qe=Object(l["a"])(He,Ye,ze,!1,null,null,null),Je=qe.exports;d()(qe,{VBtn:V["a"],VCol:le["a"],VDatePicker:ce["a"],VIcon:et["a"],VMenu:xt["a"],VRow:de["a"],VSelect:We["a"],VTextField:O["a"]});var Ke={name:"Search",mixins:[Tt,Oe],components:{AdvancedSearch:Je,DialogSendVulnByEmail:Re},data:()=>({results:[],vulns:[],exploits:[],threats:[],advisories:[],tools:[],loading_vulns:!0,limit_vulns:10,options_vulns:{sortBy:[]},headers_vulns:[{text:"Score",value:"score",align:"center",width:"10%"},{text:"Summary",value:"summary"},{text:"Metadata",value:"metadata",align:"center",width:"8%",sortable:!1},{text:"Monitored",value:"monitored",align:"center"},{text:"Last update",value:"updated_at",align:"center",width:"12%"}],loading_exploits:!0,limit_exploits:10,options_exploits:{sortBy:[]},headers_exploits:[{text:"Relevancy",value:"relevancy_level"},{text:"Link",value:"link",width:"50%"},{text:"Products",value:"vp",sortable:!1},{text:"Last update",value:"updated_at"},{text:"Actions",value:"action",sortable:!1}],loading_threats:!0,limit_threats:10,options_threats:{sortBy:[]},headers_threats:[{text:"Link",value:"link",width:"50%"},{text:"Products",value:"vp",sortable:!1},{text:"Last update",value:"updated_at"},{text:"Actions",value:"action",sortable:!1}],rowsPerPageItems:[10,25,50,100],appsearch:"",showAdvancedFilters:!1,extra_filters:"",search_slider_min:0,search_slider_max:100,dialog_sendmail:!1,selected_vuln_id:null,notification_data:{emails:""},snack:!1,snackColor:"",snackText:""}),beforeRouteUpdate(t){this.appsearch=t.params.appsearch},mounted(){this.appsearch=this.$router.currentRoute.params.appsearch},watch:{appsearch:{handler(t){this.appsearch=t,null!=this.appsearch?(this.options_vulns.page=1,this.options_exploits.page=1,this.options_threats.page=1):(this.loading_vulns=!1,this.loading_exploits=!1,this.loading_threats=!1)}},options_vulns:{handler(){null!=this.appsearch&&this.getDataFromApi(this.extra_filters)},deep:!0}},methods:{getDataFromApi(t){this.getDataFromApiVuln(t),this.getDataFromApiExploits(t),this.getDataFromApiThreats(t)},getDataFromApiVuln(t){return this.loading_vulns=!0,new Promise((e,a)=>{const{sortBy:s,sortDesc:i,page:o,itemsPerPage:n}=this.options_vulns;let r=this.getVulns(o,this.limit_vulns,s,i,t);setTimeout(()=>{e({vulns:r})},300)})},getDataFromApiExploits(t){return this.loading_exploits=!0,new Promise((e,a)=>{const{sortBy:s,sortDesc:i,page:o,itemsPerPage:n}=this.options_exploits;let r=this.getExploits(o,this.limit_exploits,s,i,t);setTimeout(()=>{e({exploits:r})},300)})},getDataFromApiThreats(t){return this.loading_threats=!0,new Promise((e,a)=>{const{sortBy:s,sortDesc:i,page:o,itemsPerPage:n}=this.options_threats;let r=this.getThreats(o,this.limit_threats,s,i,t);setTimeout(()=>{e({threats:r})},300)})},updateAdvancedSearchFilters(t){this.extra_filters=t,this.getDataFromApi(t)},getVulns(t,e,a,s,i){let o="";a.length>0&&(o=!0===s[0]?"&sorted_by=-"+a:"&sorted_by="+a),null!=i&&""!=i||(i="&score__gte="+this.search_slider_min+"&score__lte="+this.search_slider_max),this.$api.get("/api/vulns/?limit="+e+"&page="+t+"&search="+this.appsearch+o+i).then(t=>(this.vulns=t.data,this.loading_vulns=!1,this.vulns)).catch(t=>{this.vulns=[],this.loading_vulns=!1,this.snack=!0,this.snackColor="error",this.snackText="Unable to get vulns."})},viewVuln(t){this.$router.push({name:"Vuln",params:{vuln_id:t}})},downloadVuln(t,e="json"){this.$api.get("/api/vulns/"+t+"/export/"+e,{responseType:"arraybuffer"}).then(a=>{this.forceFileDownload(a,"vuln_export_"+t+"."+e),this.snack=!0,this.snackColor="success",this.snackText="Vulnerability details available."}).catch(t=>{this.snack=!0,this.snackColor="error",this.snackText="Unable to download vulnerability details."}),this.loading=!1},sendEmailVuln(t){this.$api.post("/api/vulns/"+t+"/export/email",this.notification_data).then(t=>{this.snack=!0,this.snackColor="success",this.snackText="Vulnerability details successfuly sent by mail."}).catch(t=>{this.snack=!0,this.snackColor="error",this.snackText="Unable to send vulnerability details."}),this.dialog_sendmail=!1},getExploits(t,e,a,s,i){let o="";a.length>0&&(o=!0===s[0]?"&sorted_by=-"+a:"&sorted_by="+a),this.$api.get("/api/exploits/?limit="+e+"&page="+t+"&search="+this.appsearch+o+i).then(t=>(this.exploits=t.data,this.loading_exploits=!1,this.exploits)).catch(t=>{this.exploits=[],this.loading_exploits=!1,this.snack=!0,this.snackColor="error",this.snackText="Unable to get exploits."})},getThreats(t,e,a,s,i){let o="";a.length>0&&(o=!0===s[0]?"&sorted_by=-"+a:"&sorted_by="+a),this.$api.get("/api/threats/?limit="+e+"&page="+t+"&search="+this.appsearch+o+i).then(t=>(this.threats=t.data,this.loading_threats=!1,this.threats)).catch(t=>{this.threats=[],this.loading_threats=!1,this.snack=!0,this.snackColor="error",this.snackText="Unable to get threat news."})},toggleMonitoredVuln(t){let e={monitored:!t.monitored,vuln_id:t.id,organization_id:localStorage.getItem("org_id")};this.$api.put("/api/vulns/"+t.id+"/toggle",e).then(e=>{e?(t.monitored=!t.monitored,this.snack=!0,this.snackColor="success",this.snackText="Vulnerability monitoring successfuly updated."):(this.snack=!0,this.snackColor="error",this.snackText="Unable to change the vulnerability monitoring status")}).catch(t=>{this.loading=!1,y.a.fire({title:"Error",text:"Unable to change the vulnerability monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})},getBoolValue(t){return t?"Yes":"No"}}},Ge=Ke,Ze=(a("3f07"),a("4ca6")),Qe=a("ba0d"),ta=Object(l["a"])(Ge,Me,Be,!1,null,null,null),ea=ta.exports;d()(ta,{VBadge:Ze["a"],VBtn:V["a"],VChip:Z["a"],VCol:le["a"],VContainer:P["a"],VDataTable:zt["a"],VDivider:Q["a"],VIcon:et["a"],VRow:de["a"],VSlider:Qe["a"],VTab:Ie["a"],VTabItem:Pe["a"],VTabs:Ee["a"],VTextField:O["a"]});var aa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{staticClass:"pa-2",attrs:{cols:"10"}},[a("v-text-field",{staticClass:"pt-0",attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.appsearch,callback:function(e){t.appsearch=e},expression:"appsearch"}})],1),a("v-col",{staticClass:"pa-2",attrs:{md:"2"}},[a("v-slider",{attrs:{label:"Min Score",min:"0",max:"100",color:"deep-orange","track-color":"grey","thumb-label":"","hide-details":""},model:{value:t.search_slider_min,callback:function(e){t.search_slider_min=e},expression:"search_slider_min"}}),a("v-slider",{attrs:{label:"Max Score",min:"0",max:"100",color:"grey","thumb-color":"deep-orange","track-color":"deep-orange","thumb-label":"","hide-details":""},model:{value:t.search_slider_max,callback:function(e){t.search_slider_max=e},expression:"search_slider_max"}})],1)],1),t.showAdvancedFilters?a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-divider"),a("advanced-search",{attrs:{scope:"vulns"},on:{advanced_search_filters:t.updateAdvancedSearchFilters}})],1)],1):t._e(),t.showAdvancedFilters?a("v-btn",{attrs:{depressed:"",tile:"",block:"",label:"coic"},on:{click:function(e){t.showAdvancedFilters=!t.showAdvancedFilters}}},[a("v-icon",[t._v("mdi-chevron-up")]),t._v("Hide advanced filters"),a("v-icon",[t._v("mdi-chevron-up")])],1):a("v-btn",{attrs:{depressed:"",tile:"",block:"",label:"coic"},on:{click:function(e){t.showAdvancedFilters=!0}}},[a("v-icon",[t._v("mdi-chevron-down")]),t._v("Show advanced filters"),a("v-icon",[t._v("mdi-chevron-down")])],1),a("v-tabs",{staticClass:"mt-1",attrs:{left:"","background-color":"white",color:"deep-orange accent-4"}},[a("v-tab",[this.vulns.count>0?a("v-badge",{attrs:{color:"deep-orange",content:this.vulns.count}},[t._v("Vulnerabilities")]):t._e(),null==this.vulns.count||0==this.vulns.count?a("v-badge",{attrs:{color:"grey",content:"0"}},[t._v("Vulnerabilities")]):t._e()],1),a("v-tab",[this.exploits.count>0?a("v-badge",{attrs:{color:"deep-orange",content:this.exploits.count}},[t._v("Exploits")]):t._e(),null==this.exploits.count||0==this.exploits.count?a("v-badge",{attrs:{color:"grey",content:"0"}},[t._v("Exploits")]):t._e()],1),a("v-tab",[this.threats.count>0?a("v-badge",{attrs:{color:"deep-orange",content:this.threats.count}},[t._v("Threat activities")]):t._e(),null==this.threats.count||0==this.threats.count?a("v-badge",{attrs:{color:"grey",content:"0"}},[t._v("Threat activities")]):t._e()],1),a("v-tab",[this.advisories.count>0?a("v-badge",{attrs:{color:"deep-orange",content:this.advisories.count}},[t._v("Advisories")]):t._e(),null==this.advisories.count||0==this.advisories.count?a("v-badge",{attrs:{color:"grey",content:"0"}},[t._v("Advisories")]):t._e()],1),a("v-tab",[this.tools.count>0?a("v-badge",{attrs:{color:"deep-orange",content:this.tools.count}},[t._v("Tools")]):t._e(),null==this.tools.count||0==this.tools.count?a("v-badge",{attrs:{color:"grey",content:"0"}},[t._v("Tools")]):t._e()],1),a("v-tab-item",[a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers_vulns,items:t.vulns.results,options:t.options_vulns,"server-items-length":t.vulns.count,"items-per-page":t.limit_vulns,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading_vulns,"item-key":"id","multi-sort":""},on:{"update:options":function(e){t.options_vulns=e}},scopedSlots:t._u([{key:"item.score",fn:function(e){var s=e.item;return[a("v-chip",{staticClass:"text-center font-weight-bold",attrs:{color:t.getRatingColor(s.score),label:""}},[t._v(t._s(s.score)+"/100")]),a("br"),a("span",{staticClass:"text-caption"},[t._v("CVSSv2: "+t._s(s.cvss))])]}},{key:"item.summary",fn:function(e){var s=e.item;return[a("div",{staticClass:"py-2"},[a("div",{staticClass:"pb-2"},[a("span",{staticClass:"deep-orange--text font-weight-medium"},[t._v(t._s(s.cveid))]),t._v(" / PH-"+t._s(s.id)+" "),a("v-btn",{attrs:{color:"deep-orange",icon:"",small:""}},[a("v-icon",{attrs:{title:"View details"},on:{click:function(e){return t.viewVuln(s.id)}}},[t._v("mdi-arrow-right-bold-circle-outline")])],1),a("v-icon",{attrs:{color:"deep-orange",title:"Download as JSON file"},on:{click:function(e){return t.downloadVuln(s.id,"json")}}},[t._v("mdi-download")]),a("v-icon",{attrs:{color:"deep-orange",title:"Send vulnerabilty as email"},on:{click:function(e){t.selected_vuln_id=s.id,t.dialog_sendmail=!0}}},[t._v("mdi-email-send-outline")])],1),a("div",[t._v(" "+t._s(s.summary)+" ")]),t._l(s.products,(function(e){return a("v-chip",{key:e.id,staticClass:"vendor-chip",attrs:{label:"",small:"",link:""},on:{click:function(a){return t.$router.push({path:"/product/"+e.id})}}},[t._v(" "+t._s(e.vendor)+": "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(e.name))])])}))],2)]}},{key:"item.metadata",fn:function(e){var s=e.item;return[a("v-chip",{staticClass:"font-weight-bold",attrs:{label:"",link:"",small:"",color:s.exploit_count>0?"deep-orange":"grey",title:"Is exploitable?"}},[t._v(t._s(s.exploit_count))]),a("v-btn",{attrs:{color:"NETWORK"==s.access.vector?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Is exploitable remotely?"}},[t._v("mdi-cloud")])],1),a("v-btn",{attrs:{color:"NONE"==s.access.authentication?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Require authentication?"}},[t._v("mdi-shield-account")])],1),a("v-btn",{attrs:{color:s.is_in_the_news||s.is_in_the_wild?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Is in the news or exploited in the wild?"}},[t._v("mdi-star")])],1)]}},{key:"item.updated_at",fn:function(e){var s=e.item;return[a("span",[t._v(t._s(t.moment(s.updated_at).format("YYYY-MM-DD, hh:mm")))])]}}])})],1),a("v-tab-item",[a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers_exploits,items:t.exploits.results,options:t.options_exploits,"server-items-length":t.exploits.count,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading_exploits,"item-key":"id"},on:{"update:options":function(e){t.options_exploits=e}},scopedSlots:t._u([{key:"item.relevancy_level",fn:function(e){var s=e.item;return[t._l(1,(function(e){return 1==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"yellow"}}):t._e()})),t._l(4,(function(e){return 1==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six-outline",attrs:{"x-small":"",color:"grey"}}):t._e()})),t._l(2,(function(e){return 2==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"orange"}}):t._e()})),t._l(3,(function(e){return 2==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six-outline",attrs:{"x-small":"",color:"grey"}}):t._e()})),t._l(3,(function(e){return 3==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"orange darken-4"}}):t._e()})),t._l(2,(function(e){return 3==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six-outline",attrs:{"x-small":"",color:"grey"}}):t._e()})),t._l(4,(function(e){return 4==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"red"}}):t._e()})),t._l(1,(function(e){return 4==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six-outline",attrs:{"x-small":"",color:"grey"}}):t._e()})),t._l(5,(function(e){return 5==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"red darken-4"}}):t._e()}))]}},{key:"item.vp",fn:function(e){var s=e.item;return t._l(s.products,(function(e){return a("v-chip",{key:e.id,staticClass:"vendor-chip",attrs:{label:"",small:"",link:""},on:{click:function(a){return t.$router.push({path:"/product/"+e.id})}}},[t._v(" "+t._s(e.vendor)+": "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(e.name))])])}))}},{key:"item.updated_at",fn:function(e){var s=e.item;return[a("span",[t._v(t._s(t.moment(s.updated_at).format("YYYY-MM-DD")))])]}}])})],1),a("v-tab-item"),a("v-tab-item"),a("v-tab-item")],1),a("DialogSendVulnByEmail",{attrs:{vuln_id:t.selected_vuln_id,visible:t.dialog_sendmail},on:{close:function(e){t.dialog_sendmail=!1}}})],1)},sa=[],ia={name:"Search",mixins:[Tt,Oe],components:{AdvancedSearch:Je,DialogSendVulnByEmail:Re},data:()=>({results:[],vulns:[],exploits:[],threats:[],advisories:[],tools:[],loading_vulns:!0,limit_vulns:10,options_vulns:{sortBy:[]},headers_vulns:[{text:"Score",value:"score",align:"center",width:"10%"},{text:"Summary",value:"summary"},{text:"Metadata",value:"metadata",align:"center",width:"8%",sortable:!1},{text:"Last update",value:"updated_at",align:"center",width:"12%"}],loading_exploits:!0,limit_exploits:10,options_exploits:{sortBy:[]},headers_exploits:[{text:"Relevancy",value:"relevancy_level"},{text:"Link",value:"link",width:"50%"},{text:"Products",value:"vp",sortable:!1},{text:"Last update",value:"updated_at"}],loading_threats:!0,limit_threats:10,options_threats:{sortBy:[]},headers_threats:[{text:"Link",value:"link",width:"50%"},{text:"Products",value:"vp",sortable:!1},{text:"Last update",value:"updated_at"}],rowsPerPageItems:[10,25,50,100],appsearch:"",showAdvancedFilters:!1,extra_filters:"",search_slider_min:0,search_slider_max:100,dialog_sendmail:!1,selected_vuln_id:null,notification_data:{emails:""},snack:!1,snackColor:"",snackText:""}),beforeRouteUpdate(t){this.appsearch=t.params.appsearch},mounted(){this.appsearch=this.$router.currentRoute.params.appsearch},watch:{appsearch:$t.a.debounce((function(t){console.log("coucou"),this.appsearch=t,this.options_vulns.page=1,this.getDataFromApi()}),500),options_vulns:{handler(){null!=this.appsearch&&this.getDataFromApi(this.extra_filters)},deep:!0}},methods:{getDataFromApi(t){this.getDataFromApiVuln(t)},getDataFromApiVuln(t){return this.loading_vulns=!0,new Promise((e,a)=>{const{sortBy:s,sortDesc:i,page:o,itemsPerPage:n}=this.options_vulns;let r=this.getVulns(o,this.limit_vulns,s,i,t);setTimeout(()=>{e({vulns:r})},300)})},getDataFromApiExploits(t){return this.loading_exploits=!0,new Promise((e,a)=>{const{sortBy:s,sortDesc:i,page:o,itemsPerPage:n}=this.options_exploits;let r=this.getExploits(o,this.limit_exploits,s,i,t);setTimeout(()=>{e({exploits:r})},300)})},getDataFromApiThreats(t){return this.loading_threats=!0,new Promise((e,a)=>{const{sortBy:s,sortDesc:i,page:o,itemsPerPage:n}=this.options_threats;let r=this.getThreats(o,this.limit_threats,s,i,t);setTimeout(()=>{e({threats:r})},300)})},updateAdvancedSearchFilters(t){this.extra_filters=t,this.getDataFromApi(t)},getVulns(t,e,a,s,i){let o="";a.length>0&&(o=!0===s[0]?"&sorted_by=-"+a:"&sorted_by="+a),null!=i&&""!=i||(i="&score__gte="+this.search_slider_min+"&score__lte="+this.search_slider_max),this.$api.get("/api/public/vulns/?limit="+e+"&page="+t+"&search="+this.appsearch+o+i).then(t=>(this.vulns=t.data,this.loading_vulns=!1,this.vulns)).catch(t=>{this.vulns=[],this.loading_vulns=!1,this.snack=!0,this.snackColor="error",this.snackText="Unable to get vulns."})},viewVuln(t){this.$router.push({name:"VulnDetailsPublic",params:{vuln_id:t}})},downloadVuln(t,e="json"){this.$api.get("/api/public/vulns/"+t+"/export/"+e,{responseType:"arraybuffer"}).then(a=>{this.forceFileDownload(a,"vuln_export_"+t+"."+e),this.snack=!0,this.snackColor="success",this.snackText="Vulnerability details available."}).catch(t=>{this.snack=!0,this.snackColor="error",this.snackText="Unable to download vulnerability details."}),this.loading=!1},sendEmailVuln(t){this.$api.post("/api/public/vulns/"+t+"/export/email",this.notification_data).then(t=>{this.snack=!0,this.snackColor="success",this.snackText="Vulnerability details successfuly sent by mail."}).catch(t=>{this.snack=!0,this.snackColor="error",this.snackText="Unable to send vulnerability details."}),this.dialog_sendmail=!1},getExploits(t,e,a,s,i){let o="";a.length>0&&(o=!0===s[0]?"&sorted_by=-"+a:"&sorted_by="+a),this.$api.get("/api/public/exploits/?limit="+e+"&page="+t+"&search="+this.appsearch+o+i).then(t=>(this.exploits=t.data,this.loading_exploits=!1,this.exploits)).catch(t=>{this.exploits=[],this.loading_exploits=!1,this.snack=!0,this.snackColor="error",this.snackText="Unable to get exploits."})},getThreats(t,e,a,s,i){let o="";a.length>0&&(o=!0===s[0]?"&sorted_by=-"+a:"&sorted_by="+a),this.$api.get("/api/public/threats/?limit="+e+"&page="+t+"&search="+this.appsearch+o+i).then(t=>(this.threats=t.data,this.loading_threats=!1,this.threats)).catch(t=>{this.threats=[],this.loading_threats=!1,this.snack=!0,this.snackColor="error",this.snackText="Unable to get threat news."})},getBoolValue(t){return t?"Yes":"No"}}},oa=ia,na=(a("a6f5"),Object(l["a"])(oa,aa,sa,!1,null,null,null)),ra=na.exports;d()(na,{VBadge:Ze["a"],VBtn:V["a"],VChip:Z["a"],VCol:le["a"],VContainer:P["a"],VDataTable:zt["a"],VDivider:Q["a"],VIcon:et["a"],VRow:de["a"],VSlider:Qe["a"],VTab:Ie["a"],VTabItem:Pe["a"],VTabs:Ee["a"],VTextField:O["a"]});var la=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-card",[a("v-card-title",{staticClass:"py-0"},[a("v-container",[a("v-row",[a("v-col",{staticClass:"pa-2",attrs:{md:"auto"}},[t._v(" Vulnerabilities"),a("br"),a("v-chip",{attrs:{small:"",label:"",outlined:"",color:t.getBoolColor(this.show_all)},on:{click:function(e){return t.toggleShowAll()}}},[t._v("All")]),t._v("  "),a("v-chip",{attrs:{small:"",label:"",outlined:"",color:t.getBoolColor(this.show_last_day)},on:{click:function(e){return t.toggleShowLastDay()}}},[t._v("Last 24h")]),t._v("  "),a("v-chip",{attrs:{small:"",label:"",outlined:"",color:t.getBoolColor(this.show_last_week)},on:{click:function(e){return t.toggleShowLastWeek()}}},[t._v("Last Week")]),t._v("  "),a("v-chip",{attrs:{small:"",label:"",outlined:"",color:t.getBoolColor(this.show_monitored)},on:{click:function(e){return t.toggleMonitored()}}},[t._v("Monitored")])],1),a("v-col",{staticClass:"pa-2",attrs:{md:"4"}},[a("v-text-field",{staticClass:"pt-0",attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-col",{staticClass:"pa-2 mt-4",attrs:{md:"3"}},[a("v-range-slider",{attrs:{label:"Score",max:"100",min:"0","thumb-label":"","thumb-color":"deep-orange","track-color":"grey",color:"deep-orange"},model:{value:t.search_slider,callback:function(e){t.search_slider=e},expression:"search_slider"}})],1)],1),t.showAdvancedFilters?a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-divider"),a("advanced-search",{attrs:{scope:"vulns"},on:{advanced_search_filters:t.updateAdvancedSearchFilters}})],1)],1):t._e()],1)],1),t.showAdvancedFilters?a("v-btn",{attrs:{depressed:"",tile:"",block:"",label:"coic"},on:{click:function(e){t.showAdvancedFilters=!t.showAdvancedFilters}}},[a("v-icon",[t._v("mdi-chevron-up")]),t._v("Hide advanced filters"),a("v-icon",[t._v("mdi-chevron-up")])],1):a("v-btn",{attrs:{depressed:"",tile:"",block:"",label:"coic"},on:{click:function(e){t.showAdvancedFilters=!0}}},[a("v-icon",[t._v("mdi-chevron-down")]),t._v("Show advanced filters"),a("v-icon",[t._v("mdi-chevron-down")])],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers,search:t.search,items:t.vulns.results,"server-items-length":t.vulns.count,options:t.options,"items-per-page":t.limit,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"id","multi-sort":""},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.score",fn:function(e){var s=e.item;return[a("v-chip",{staticClass:"text-center font-weight-bold",attrs:{color:t.getRatingColor(s.score),label:""}},[t._v(t._s(s.score)+"/100")]),a("br"),a("span",{staticClass:"text-caption"},[t._v("CVSSv2: "+t._s(s.cvss))]),a("br"),a("span",{staticClass:"text-caption"},[t._v("CVSSv3: "+t._s(s.cvss3))])]}},{key:"item.summary",fn:function(e){var s=e.item;return[a("div",{staticClass:"py-2"},[a("div",{staticClass:"pb-2"},[a("span",{staticClass:"deep-orange--text font-weight-medium"},[t._v(t._s(s.cveid))]),t._v(" / PH-"+t._s(s.id)+" "),a("v-btn",{attrs:{color:"deep-orange",icon:"",small:""}},[a("v-icon",{attrs:{title:"View details"},on:{click:function(e){return t.viewVuln(s.id)}}},[t._v("mdi-arrow-right-bold-circle-outline")])],1)],1),a("div",[t._v(" "+t._s(s.summary)+" ")]),t._l(s.products.slice(0,5),(function(e){return a("v-chip",{key:e.id,staticClass:"vendor-chip",attrs:{label:"",small:"",link:""},on:{click:function(a){return t.$router.push({path:"/product/"+e.id})}}},[t._v(" "+t._s(e.vendor)+": "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(e.name))])])})),s.products.length>5?a("span",{on:{click:function(e){return t.viewVuln(s.id)}}},[t._v("+")]):t._e()],2)]}},{key:"item.metadata",fn:function(e){var s=e.item;return[a("v-chip",{staticClass:"font-weight-bold",attrs:{label:"",link:"",small:"",color:s.exploit_count>0?"deep-orange":"grey",title:"Is exploitable?"}},[t._v(" "+t._s(s.exploit_count)+" ")]),a("v-btn",{attrs:{color:"NETWORK"==s.access.vector?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Is exploitable remotely?"}},[t._v("mdi-cloud")])],1),a("v-btn",{attrs:{color:"NONE"==s.access.authentication?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Require authentication?"}},[t._v("mdi-shield-account")])],1),a("v-btn",{attrs:{color:s.is_in_the_news||s.is_in_the_wild?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Is in the news or exploited in the wild?"}},[t._v("mdi-star")])],1)]}},{key:"item.monitored",fn:function(e){var s=e.item;return[s.monitored?a("v-chip",{staticClass:"text-center font-weight-bold",attrs:{small:"",label:"",outlined:"",color:t.getBoolColor(!0)},on:{click:function(e){return t.toggleMonitoredVuln(s)}}},[t._v("Yes")]):t._e(),s.monitored?t._e():a("v-chip",{staticClass:"text-center font-weight-bold",attrs:{small:"",label:"",outlined:"",color:t.getBoolColor(!1)},on:{click:function(e){return t.toggleMonitoredVuln(s)}}},[t._v("No")])]}},{key:"item.updated_at",fn:function(e){var s=e.item;return[a("span",[t._v(t._s(t.moment(s.updated_at).format("YYYY-MM-DD, hh:mm")))])]}}],null,!0)}),this.showManageMetadataButtons()?a("v-dialog",{attrs:{"max-width":"600px"},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on;return[a("v-btn",t._g({attrs:{absolute:"",dark:"",fab:"",bottom:"",left:"",color:"deep-orange"}},s),[a("v-icon",[t._v("mdi-plus")])],1)]}}],null,!1,1303381134),model:{value:t.dialog_vuln,callback:function(e){t.dialog_vuln=e},expression:"dialog_vuln"}},[a("DialogVulnAddEdit")],1):t._e(),a("v-snackbar",{attrs:{timeout:3e3,color:t.snack.color,dense:""},model:{value:t.snack.open,callback:function(e){t.$set(t.snack,"open",e)},expression:"snack.open"}},[t._v(" "+t._s(t.snack.text)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack.open=!1}}},[t._v("Close")])],1)],1)],1)},ca=[],da=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v(t._s(t.formVulnTitle))])]),a("v-card-text",[a("v-form",{ref:"form-vuln"},[a("v-container",[a("v-row",[a("v-col",{attrs:{md:"6"}},[a("v-text-field",{attrs:{label:"CVE ID"},model:{value:t.editedItem.cve_id,callback:function(e){t.$set(t.editedItem,"cve_id",e)},expression:"editedItem.cve_id"}})],1),a("v-col",{attrs:{md:"3"}},[a("v-select",{attrs:{label:"Is monitored?",items:t.editedItem.monitored_items},model:{value:t.editedItem.monitored,callback:function(e){t.$set(t.editedItem,"monitored",e)},expression:"editedItem.monitored"}})],1)],1),a("v-row",[a("v-col",[a("v-textarea",{attrs:{label:"Summary",hint:"Insert notes about this vulnerability",rows:"4"},model:{value:t.editedItem.summary,callback:function(e){t.$set(t.editedItem,"summary",e)},expression:"editedItem.summary"}})],1)],1),a("v-row",[a("v-col",{attrs:{md:"3"}},[a("v-text-field",{attrs:{label:"CVSSv2 Score"},model:{value:t.editedItem.cvss2,callback:function(e){t.$set(t.editedItem,"cvss2",e)},expression:"editedItem.cvss2"}})],1),a("v-col",{attrs:{md:"9"}},[a("v-text-field",{attrs:{label:"CVSSv2 Vector"},model:{value:t.editedItem.cvss2_vector,callback:function(e){t.$set(t.editedItem,"cvss2_vector",e)},expression:"editedItem.cvss2_vector"}})],1)],1),a("v-row",[a("v-col",{attrs:{md:"3"}},[a("v-text-field",{attrs:{label:"CVSSv3 Score"},model:{value:t.editedItem.cvss3,callback:function(e){t.$set(t.editedItem,"cvss3",e)},expression:"editedItem.cvss3"}})],1),a("v-col",{attrs:{md:"9"}},[a("v-text-field",{attrs:{label:"CVSSv3 Vector"},model:{value:t.editedItem.cvss3_vector,callback:function(e){t.$set(t.editedItem,"cvss3_vector",e)},expression:"editedItem.cvss3_vector"}})],1)],1),t._v(" Impact "),a("v-row",[a("v-col",{attrs:{cols:"12",md:"4"}},[a("v-select",{attrs:{label:"Confidentiality",items:t.editedItem.impact_confidentiality_items},model:{value:t.editedItem.impact_confidentiality,callback:function(e){t.$set(t.editedItem,"impact_confidentiality",e)},expression:"editedItem.impact_confidentiality"}})],1),a("v-col",{attrs:{cols:"12",md:"4"}},[a("v-select",{attrs:{label:"Integrity",items:t.editedItem.impact_integrity_items},model:{value:t.editedItem.impact_integrity,callback:function(e){t.$set(t.editedItem,"impact_integrity",e)},expression:"editedItem.impact_integrity"}})],1),a("v-col",{attrs:{cols:"12",md:"4"}},[a("v-select",{attrs:{label:"Availability",items:t.editedItem.impact_availability_items},model:{value:t.editedItem.impact_availability,callback:function(e){t.$set(t.editedItem,"impact_availability",e)},expression:"editedItem.impact_availability"}})],1)],1),t._v(" Access "),a("v-row",[a("v-col",{attrs:{cols:"12",md:"4"}},[a("v-select",{attrs:{label:"Authentication",items:t.editedItem.access_authentication_items},model:{value:t.editedItem.access_authentication,callback:function(e){t.$set(t.editedItem,"access_authentication",e)},expression:"editedItem.access_authentication"}})],1),a("v-col",{attrs:{cols:"12",md:"4"}},[a("v-select",{attrs:{label:"Complexity",items:t.editedItem.access_complexity_items},model:{value:t.editedItem.access_complexity,callback:function(e){t.$set(t.editedItem,"access_complexity",e)},expression:"editedItem.access_complexity"}})],1),a("v-col",{attrs:{cols:"12",md:"4"}},[a("v-select",{attrs:{label:"Vector",items:t.editedItem.access_vector_items},model:{value:t.editedItem.access_vector,callback:function(e){t.$set(t.editedItem,"access_vector",e)},expression:"editedItem.access_vector"}})],1)],1),a("v-row",[a("v-col",{attrs:{cols:"12",md:"3"}},[a("v-select",{attrs:{label:"Is exploitable?",items:t.editedItem.is_exploitable_items},model:{value:t.editedItem.is_exploitable,callback:function(e){t.$set(t.editedItem,"is_exploitable",e)},expression:"editedItem.is_exploitable"}})],1),a("v-col",{attrs:{cols:"12",md:"3"}},[a("v-select",{attrs:{label:"Is confirmed?",items:t.editedItem.is_confirmed_items},model:{value:t.editedItem.is_confirmed,callback:function(e){t.$set(t.editedItem,"is_confirmed",e)},expression:"editedItem.is_confirmed"}})],1),a("v-col",{attrs:{cols:"12",md:"3"}},[a("v-select",{attrs:{label:"In the News?",items:t.editedItem.is_in_the_news_items},model:{value:t.editedItem.is_in_the_news,callback:function(e){t.$set(t.editedItem,"is_in_the_news",e)},expression:"editedItem.is_in_the_news"}})],1),a("v-col",{attrs:{cols:"12",md:"3"}},[a("v-select",{attrs:{label:"In The Wild",items:t.editedItem.is_in_the_wild_items},model:{value:t.editedItem.is_in_the_wild,callback:function(e){t.$set(t.editedItem,"is_in_the_wild",e)},expression:"editedItem.is_in_the_wild"}})],1)],1),a("v-row",[a("v-col",[a("v-autocomplete",{attrs:{items:t.products_items,loading:t.products_isLoading,"search-input":t.products_search,chips:"","cache-items":"","hide-details":"","hide-selected":"","hide-no-data":"","item-text":"name","item-value":"id",label:"Search for a product...",multiple:""},on:{"update:searchInput":function(e){t.products_search=e},"update:search-input":function(e){t.products_search=e}},scopedSlots:t._u([{key:"selection",fn:function(e){return[a("v-chip",t._b({attrs:{"input-value":e.selected,close:""},on:{click:e.select,"click:close":function(a){return t.removeSelectedProduct(e.item)}}},"v-chip",e.attrs,!1),[t._v(" "+t._s(e.item.vendor)+"/"+t._s(e.item.name)+" ")])]}},{key:"item",fn:function(e){return[t._v(" "+t._s(e.item.vendor)+"/"+t._s(e.item.name)+" ")]}}]),model:{value:t.editedItem.products,callback:function(e){t.$set(t.editedItem,"products",e)},expression:"editedItem.products"}})],1)],1),a("v-row",[a("v-col",[a("v-textarea",{attrs:{label:"CPE list",hint:"Insert CPEs (line by line or comma-separated)",rows:"3"},model:{value:t.editedItem.cpes,callback:function(e){t.$set(t.editedItem,"cpes",e)},expression:"editedItem.cpes"}})],1)],1),a("v-row",[a("v-col",[a("v-textarea",{attrs:{label:"References links",hint:"Insert links (line by line or comma-separated)",rows:"3"},model:{value:t.editedItem.references,callback:function(e){t.$set(t.editedItem,"references",e)},expression:"editedItem.references"}})],1)],1),a("v-btn",{attrs:{color:"success"},on:{click:t.saveVuln}},[t._v("Save")]),a("v-btn",{attrs:{color:"warning",type:"reset"}},[t._v("Reset")])],1)],1)],1),a("v-card-actions",[a("v-spacer")],1),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor,dense:""},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)},ua=[],va={name:"VulnAddEdit",props:["vuln","action"],data:()=>({editedIndex:-1,editedItem:{},defaultVulnMetadata:{id:"",cve_id:"",summary:"",published:"",cvss2:"",cvss2_vector:"",cvss3:"",cvss3_vector:"",cwe:"",access_authentication:"NONE",access_authentication_items:["NONE","SINGLE","MULTIPLE"],access_complexity:"LOW",access_complexity_items:["LOW","MEDIUM","HIGH"],access_vector:"LOCAL",access_vector_items:["LOCAL","ADJACENT_NETWORK","NETWORK"],impact_availability:"NONE",impact_availability_items:["NONE","PARTIAL","COMPLETE"],impact_confidentiality:"NONE",impact_confidentiality_items:["NONE","PARTIAL","COMPLETE"],impact_integrity:"NONE",impact_integrity_items:["NONE","PARTIAL","COMPLETE"],references:[],cpes:"",products:[],references:[],monitored:!1,monitored_items:[{text:"Yes",value:!0},{text:"No",value:!1}],is_exploitable:!1,is_exploitable_items:[{text:"Yes",value:!0},{text:"No",value:!1}],is_confirmed:!1,is_confirmed_items:[{text:"Yes",value:!0},{text:"No",value:!1}],is_in_the_wild:!1,is_in_the_wild_items:[{text:"Yes",value:!0},{text:"No",value:!1}],is_in_the_news:!1,is_in_the_news_items:[{text:"Yes",value:!0},{text:"No",value:!1}]},products_isLoading:!1,products_autocomplete:null,products_items:[],products_search:null,snack:!1,snackColor:"",snackText:""}),mounted(){"edit"==this.action?this.loadVuln():this.editedItem=this.defaultVulnMetadata},watch:{products_search:$t.a.debounce((function(t){null!=t&&(t.length<3||this.products_isLoading||(this.products_isLoading=!0,this.$api.get("/api/kb/products/?limit=30&search="+this.products_search).then(t=>{this.products_items=t.data.results}).catch(t=>{console.log(t)}).finally(()=>this.products_isLoading=!1)))}),500)},computed:{formVulnTitle(){return-1===this.editedIndex?"New Vulnerability":"Edit Vulnerability PH-"+this.vuln.id}},methods:{loadVuln(){this.editedIndex=0,this.editedItem=this.defaultVulnMetadata,this.editedItem.cve_id=this.vuln.cveid,this.editedItem.summary=this.vuln.summary,this.editedItem.monitored=this.vuln.monitored,this.editedItem.cvss2=this.vuln.cvss,this.editedItem.cvss2_vector=this.vuln.cvss_vector,this.editedItem.access_authentication=this.vuln.access.authentication,this.editedItem.access_complexity=this.vuln.access.complexity,this.editedItem.access_vector=this.vuln.access.vector,this.editedItem.impact_availability=this.vuln.impact.availability,this.editedItem.impact_confidentiality=this.vuln.impact.confidentiality,this.editedItem.impact_integrity=this.vuln.impact.integrity,this.editedItem.is_exploitable=this.vuln.is_exploitable,this.editedItem.is_confirmed=this.vuln.is_confirmed,this.editedItem.is_in_the_wild=this.vuln.is_in_the_wild,this.editedItem.is_in_the_news=this.vuln.is_in_the_news,this.editedItem.cpes=String(this.vuln.vulnerable_products).split(",").join("\n"),this.editedItem.references=String(this.vuln.reflinks).split(",").join("\n"),this.products_items=this.vuln.products,this.editedItem.products=this.vuln.products},saveVuln(){this.editedItem.modified=new Date,-1===this.editedIndex?this.$api.post("/api/vulns/add",this.editedItem).then(t=>{t&&200===t.status&&"success"==t.data.status?(this.snack=!0,this.snackColor="success",this.snackText="Vulnerability successfuly saved."):("status"in t.data&&"reason"in t.data?this.snackText="Unable to save the vulnerability: "+t.data.reason:this.snackText="Unable to save the vulnerability.",this.snack=!0,this.snackColor="error")}).catch(t=>{this.snack=!0,this.snackColor="error",this.snackText="Unable to save the vulnerability."}):this.$api.post("/api/vulns/edit",this.editedItem).then(t=>{t&&200===t.status?(this.snack=!0,this.snackColor="success",this.snackText="Not implemented."):("status"in t.data&&"reason"in t.data?this.snackText="Unable to update the vulnerability: "+t.data.reason:this.snackText="Unable to update the vulnerability.",this.snack=!0,this.snackColor="error",this.snackText="Unable to update the vulnerability.")}).catch(t=>{this.dialog_vuln=!1,this.editedItem=this.defaultVulnMetadata}),this.dialog_vuln=!1,this.editedItem=this.defaultVulnMetadata,setTimeout(()=>{this.$router.go()},2e3)},removeSelectedProduct(t){let e=-1;e=-1===this.editedIndex?this.editedItem.products.indexOf(t.id):this.editedItem.products.findIndex(e=>e.id==t.id),e>=0&&this.editedItem.products.splice(e,1)}}},ma=va,ha=(a("6ab0"),Object(l["a"])(ma,da,ua,!1,null,null,null)),pa=ha.exports;d()(ha,{VAutocomplete:Mt["a"],VBtn:V["a"],VCard:S["a"],VCardActions:T["b"],VCardText:T["d"],VCardTitle:T["e"],VChip:Z["a"],VCol:le["a"],VContainer:P["a"],VForm:$["a"],VRow:de["a"],VSelect:We["a"],VSnackbar:M["a"],VSpacer:B["a"],VTextField:O["a"],VTextarea:$e["a"]});var _a={name:"vulns",mixins:[Tt,_e],components:{DialogVulnAddEdit:pa,AdvancedSearch:Je},data:()=>({vulns:[],loading:!0,limit:10,search:"",showAdvancedFilters:!1,advancedSearchFilter:null,show_all:!0,show_last_day:!1,show_last_week:!1,show_monitored:!1,search_slider:[0,100],options:{},headers:[{text:"Score",value:"score",align:"center",width:"10%"},{text:"Summary",value:"summary"},{text:"Metadata",value:"metadata",align:"center",width:"8%",sortable:!1},{text:"Monitored",value:"monitored",align:"center"},{text:"Last update",value:"updated_at",align:"center",width:"12%"}],rowsPerPageItems:[5,10,20,50,100],dialog_vuln:!1,snack:{open:!1,color:"",text:""}}),watch:{search:$t.a.debounce((function(t){this.search=t,this.options.page=1,this.getDataFromApi()}),500),options:{handler(){this.getDataFromApi()},deep:!0},search_slider:$t.a.debounce((function(){this.getDataFromApi()}),500),show_all:{handler(){this.getDataFromApi()},deep:!0},show_last_day:{handler(){this.getDataFromApi()},deep:!0},show_last_week:{handler(){this.getDataFromApi()},deep:!0},show_monitored:{handler(){this.getDataFromApi()},deep:!0}},methods:{getDataFromApi(t){return this.loading=!0,new Promise((e,a)=>{let{sortBy:s,sortDesc:i,page:o,itemsPerPage:n}=this.options;null!=t&&""!=t&&(o=t);this.search.trim().toLowerCase();this.limit=n;let r=this.getVulns(o,this.limit,s,i);setTimeout(()=>{e({items:r})},300)})},updateAdvancedSearchFilters(t){this.advancedSearchFilter=t,this.getDataFromApi()},getVulns(t,e,a,s){let i="";a.length>0&&(i=!0===s[0]?"sorted_by=-"+a:"sorted_by="+a);let o="";1==this.show_last_day?o="&updated_at__gte="+ie()(new Date).format("YYYY-MM-DD"):1==this.show_last_week&&(o="&updated_at__gte="+ie()(new Date).subtract(7,"day").format("YYYY-MM-DD"));let n="&score__gte="+this.search_slider[0]+"&score__lte="+this.search_slider[1];null!=this.advancedSearchFilter&&(n+=this.advancedSearchFilter);let r="/api/vulns/?limit="+e+"&page="+t+"&search="+this.search+"&"+i+o+n;!0===this.show_monitored&&(r+="&monitored=true"),this.$api.get(r).then(t=>(this.vulns=t.data,this.loading=!1,this.vulns)).catch(t=>{this.vulns=[],this.loading=!1,this.snack={open:!0,color:"error",text:"Unable to get vulns."}})},viewVuln(t){this.$router.push({name:"Vuln",params:{vuln_id:t}})},showManageMetadataButtons(){let t=JSON.parse(this.getUserProfile());return null==t||!("manage_metadata"in t)||t.manage_metadata},toggleMonitoredVuln(t){let e={monitored:!t.monitored,vuln_id:t.id,organization_id:localStorage.getItem("org_id")};this.$api.put("/api/vulns/"+t.id+"/toggle",e).then(e=>{e?(t.monitored=!t.monitored,this.snack={open:!0,color:"success",text:"Vulnerability monitoring successfuly updated."}):this.snack={snack:!0,color:"error",text:"Unable to change the vulnerability monitoring status"}}).catch(t=>{this.loading=!1,swal.fire({title:"Error",text:"Unable to change the vulnerability monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})},toggleMonitored(){!0===this.show_monitored?this.show_monitored=!1:this.show_monitored=!0},toggleShowAll(){this.options.page=1,0==this.show_all&&(this.show_all=!this.show_all),1==this.show_all&&(this.show_last_day=!1,this.show_last_week=!1)},toggleShowLastDay(){this.options.page=1,1==this.show_last_day&&(this.show_all=!0,this.show_last_day=!1,this.show_last_week=!1),0==this.show_last_day&&(this.show_last_day=!0,this.show_all=!1,this.show_last_week=!1)},toggleShowLastWeek(){this.options.page=1,1==this.show_last_week&&(this.show_all=!0,this.show_last_day=!1,this.show_last_week=!1),0==this.show_last_week&&(this.show_last_week=!0,this.show_all=!1,this.show_last_day=!1)},editVuln(t){},deleteVuln(t){}}},ga=_a,fa=(a("8083"),a("5963")),ba=Object(l["a"])(ga,la,ca,!1,null,null,null),ka=ba.exports;d()(ba,{VBtn:V["a"],VCard:S["a"],VCardTitle:T["e"],VChip:Z["a"],VCol:le["a"],VContainer:P["a"],VDataTable:zt["a"],VDialog:Xt["a"],VDivider:Q["a"],VIcon:et["a"],VRangeSlider:fa["a"],VRow:de["a"],VSnackbar:M["a"],VTextField:O["a"]});var xa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-card",[a("v-card-title",{staticClass:"py-0"},[a("v-container",[a("v-row",[a("v-col",{staticClass:"pa-2",attrs:{md:"auto"}},[t._v(" Vulnerabilities"),a("br"),a("v-chip",{attrs:{small:"",label:"",outlined:"",color:t.getBoolColor(this.show_all)},on:{click:function(e){return t.toggleShowAll()}}},[t._v("All")]),t._v("  "),a("v-chip",{attrs:{small:"",label:"",outlined:"",color:t.getBoolColor(this.show_last_day)},on:{click:function(e){return t.toggleShowLastDay()}}},[t._v("Last 24h")]),t._v("  "),a("v-chip",{attrs:{small:"",label:"",outlined:"",color:t.getBoolColor(this.show_last_week)},on:{click:function(e){return t.toggleShowLastWeek()}}},[t._v("Last Week")])],1),a("v-col",{staticClass:"pa-2",attrs:{md:"6"}},[a("v-text-field",{staticClass:"pt-0",attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-col",{staticClass:"pa-2",attrs:{md:"2"}},[a("v-slider",{attrs:{label:"Min Score",min:"0",max:"100",color:"deep-orange","track-color":"grey","thumb-label":"","hide-details":""},model:{value:t.search_slider_min,callback:function(e){t.search_slider_min=e},expression:"search_slider_min"}}),a("v-slider",{attrs:{label:"Max Score",min:"0",max:"100",color:"grey","thumb-color":"deep-orange","track-color":"deep-orange","thumb-label":"","hide-details":""},model:{value:t.search_slider_max,callback:function(e){t.search_slider_max=e},expression:"search_slider_max"}})],1)],1),t.showAdvancedFilters?a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-divider"),a("advanced-search",{attrs:{scope:"vulns"},on:{advanced_search_filters:t.updateAdvancedSearchFilters}})],1)],1):t._e()],1)],1),t.showAdvancedFilters?a("v-btn",{attrs:{depressed:"",tile:"",block:"",label:"coic"},on:{click:function(e){t.showAdvancedFilters=!t.showAdvancedFilters}}},[a("v-icon",[t._v("mdi-chevron-up")]),t._v("Hide advanced filters"),a("v-icon",[t._v("mdi-chevron-up")])],1):a("v-btn",{attrs:{depressed:"",tile:"",block:"",label:"coic"},on:{click:function(e){t.showAdvancedFilters=!0}}},[a("v-icon",[t._v("mdi-chevron-down")]),t._v("Show advanced filters"),a("v-icon",[t._v("mdi-chevron-down")])],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers,items:t.vulns.results,options:t.options,"server-items-length":t.vulns.count,search:t.search,"items-per-page":t.limit,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"id","multi-sort":""},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.score",fn:function(e){var s=e.item;return[a("v-chip",{staticClass:"text-center font-weight-bold",attrs:{color:t.getRatingColor(s.score),label:""}},[t._v(t._s(s.score)+"/100")]),a("br"),a("span",{staticClass:"text-caption"},[t._v("CVSSv2: "+t._s(s.cvss))]),a("br"),a("span",{staticClass:"text-caption"},[t._v("CVSSv3: "+t._s(s.cvss3))])]}},{key:"item.summary",fn:function(e){var s=e.item;return[a("div",{staticClass:"py-2"},[a("div",{staticClass:"pb-2"},[a("span",{staticClass:"deep-orange--text font-weight-medium"},[t._v(t._s(s.cveid))]),t._v(" / PH-"+t._s(s.id)+" "),a("v-btn",{attrs:{color:"deep-orange",icon:"",small:""}},[a("v-icon",{attrs:{title:"View details"},on:{click:function(e){return t.viewVuln(s.id)}}},[t._v("mdi-arrow-right-bold-circle-outline")])],1)],1),a("div",[t._v(" "+t._s(s.summary)+" ")]),t._l(s.products.slice(0,5),(function(e){return a("v-chip",{key:e.id,staticClass:"vendor-chip",attrs:{label:"",small:"",link:""},on:{click:function(a){return t.$router.push({path:"/product/"+e.id})}}},[t._v(" "+t._s(e.vendor)+": "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(e.name))])])})),s.products.length>5?a("span",{on:{click:function(e){return t.viewVuln(s.id)}}},[t._v(" + ")]):t._e()],2)]}},{key:"item.metadata",fn:function(e){var s=e.item;return[a("v-chip",{staticClass:"font-weight-bold",attrs:{label:"",link:"",small:"",color:s.exploit_count>0?"deep-orange":"grey",title:"Is exploitable?"}},[t._v(t._s(s.exploit_count))]),a("v-btn",{attrs:{color:"NETWORK"==s.access.vector?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Is exploitable remotely?"}},[t._v("mdi-cloud")])],1),a("v-btn",{attrs:{color:"NONE"==s.access.authentication?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Require authentication?"}},[t._v("mdi-shield-account")])],1),a("v-btn",{attrs:{color:s.is_in_the_news||s.is_in_the_wild?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Is in the news or exploited in the wild?"}},[t._v("mdi-star")])],1)]}},{key:"item.updated_at",fn:function(e){var s=e.item;return[a("span",[t._v(t._s(t.moment(s.updated_at).format("YYYY-MM-DD, hh:mm")))])]}}])}),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor,dense:""},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1)},ya=[],wa={name:"VulnsPublic",mixins:[Tt,_e],components:{AdvancedSearch:Je},data:()=>({vulns:[],loading:!0,limit:10,search:"",search_slider_min:0,search_slider_max:100,showAdvancedFilters:!1,show_all:!0,show_last_day:!1,show_last_week:!1,options:{},headers:[{text:"Score",value:"score",align:"center",width:"10%"},{text:"Summary",value:"summary"},{text:"Metadata",value:"metadata",align:"center",width:"8%",sortable:!1},{text:"Last update",value:"updated_at",align:"center",width:"12%"}],rowsPerPageItems:[5,10,20,50,100],dialog_vuln:!1,snack:!1,snackColor:"",snackText:""}),watch:{search:$t.a.debounce((function(t){this.search=t,this.options.page=1,this.getDataFromApi()}),500),options:{handler(){this.getDataFromApi()},deep:!0},search_slider_min:$t.a.debounce((function(){this.getDataFromApi()}),500),search_slider_max:$t.a.debounce((function(){this.getDataFromApi()}),500),show_all:{handler(){this.getDataFromApi()},deep:!0},show_last_day:{handler(){this.getDataFromApi()},deep:!0},show_last_week:{handler(){this.getDataFromApi()},deep:!0}},methods:{getDataFromApi(t,e){return this.loading=!0,new Promise((a,s)=>{let{sortBy:i,sortDesc:o,page:n,itemsPerPage:r}=this.options;null!=e&&""!=e&&(n=e);this.search.trim().toLowerCase();this.limit=r;let l=this.getVulns(n,this.limit,i,o,t);setTimeout(()=>{a({items:l})},300)})},updateAdvancedSearchFilters(t){this.getDataFromApi(t,1)},getVulns(t,e,a,s,i){let o="";a.length>0&&(o=!0===s[0]?"sorted_by=-"+a:"sorted_by="+a);let n="";1==this.show_last_day?n="&updated_at__gte="+ie()(new Date).format("YYYY-MM-DD"):1==this.show_last_week&&(n="&updated_at__gte="+ie()(new Date).subtract(7,"day").format("YYYY-MM-DD")),null!=i&&""!=i||(i="&score__gte="+this.search_slider_min+"&score__lte="+this.search_slider_max),this.$api.get("/api/public/vulns/?limit="+e+"&page="+t+"&search="+this.search+"&"+o+n+i).then(t=>(this.vulns=t.data,this.loading=!1,this.vulns)).catch(t=>{this.vulns=[],this.loading=!1,this.snack=!0,this.snackColor="error",this.snackText="Unable to get vulns."})},viewVuln(t){this.$router.push({name:"VulnDetailsPublic",params:{vuln_id:t}})},clickRow(t){this.$router.push({name:"VulnDetailsPublic",params:{vuln_id:t.id}})},getBool(t){return 1==t?"red":"grey"},toggleShowAll(){this.options.page=1,0==this.show_all&&(this.show_all=!this.show_all),1==this.show_all&&(this.show_last_day=!1,this.show_last_week=!1)},toggleShowLastDay(){this.options.page=1,1==this.show_last_day&&(this.show_all=!0,this.show_last_day=!1,this.show_last_week=!1),0==this.show_last_day&&(this.show_last_day=!0,this.show_all=!1,this.show_last_week=!1)},toggleShowLastWeek(){this.options.page=1,1==this.show_last_week&&(this.show_all=!0,this.show_last_day=!1,this.show_last_week=!1),0==this.show_last_week&&(this.show_last_week=!0,this.show_all=!1,this.show_last_day=!1)}}},Ca=wa,Va=(a("1604"),Object(l["a"])(Ca,xa,ya,!1,null,null,null)),Sa=Va.exports;d()(Va,{VBtn:V["a"],VCard:S["a"],VCardTitle:T["e"],VChip:Z["a"],VCol:le["a"],VContainer:P["a"],VDataTable:zt["a"],VDivider:Q["a"],VIcon:et["a"],VRow:de["a"],VSlider:Qe["a"],VSnackbar:M["a"],VTextField:O["a"]});var Ta=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-tabs",{attrs:{left:"","background-color":"white",color:"deep-orange accent-4"}},[a("v-tab",[t._v("Summary")]),a("v-tab",[a("v-badge",{attrs:{color:t.getNumberColor(this.counter.count_exploit),content:this.count_exploit}},[t._v(" Exploits ")])],1),a("v-tab",[a("v-badge",{attrs:{color:t.getNumberColor(this.counter.count_threat),content:this.count_threat}},[t._v(" Threat activities ")])],1),a("v-tab",[t._v("Comments")]),a("v-tab-item",[a("VulnDetails",{attrs:{vuln_id:this.vuln_id},on:{OpenSnackBar:this.modifySnackBar}})],1),a("v-tab-item",[a("VulnerabilityExploit",{attrs:{vuln_id:this.vuln_id},on:{OpenSnackBar:this.modifySnackBar,UpdateCounter:this.getCountThreatsExploits}})],1),a("v-tab-item",[a("VulnerabilityThreat",{attrs:{vuln_id:this.vuln_id},on:{OpenSnackBar:this.modifySnackBar,UpdateCounter:this.getCountThreatsExploits}})],1),a("v-tab-item",[a("VulnerabilityComment",{attrs:{vuln_id:this.vuln_id},on:{OpenSnackBar:this.modifySnackBar}})],1)],1),a("SnackBar",{attrs:{snack:t.snack}})],1)},Ia=[],Pa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md9:""}},[void 0!==this.vuln.id?a("CardVulnerability",t._g({attrs:{vuln:this.vuln}},t.$listeners)):t._e()],1),a("v-flex",{attrs:{md3:""}},[a("v-flex",[a("CardScore",{attrs:{vuln_id:this.vuln_id}})],1),a("v-flex",[a("CardMetrics",t._g({attrs:{is_exploitable:this.vuln.is_exploitable,is_confirmed:this.vuln.is_confirmed,is_in_the_news:this.vuln.is_in_the_news,is_in_the_wild:this.vuln.is_in_the_wild}},t.$listeners))],1),a("v-flex",[a("CardAccess",{attrs:{authentication:this.vuln.access.authentication,complexity:this.vuln.access.complexity,vector:this.vuln.access.vector}})],1),a("v-flex",[a("CardImpact",{attrs:{confidentiality:this.vuln.impact.confidentiality,integrity:this.vuln.impact.integrity,availability:this.vuln.impact.availability}})],1)],1)],1)],1)},Ea=[],$a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{attrs:{color:"grey lighten-5"}},[a("CardHeaderVulnerability",t._g({attrs:{vuln:this.vuln}},t.$listeners)),a("CardBodyVulnerability",{attrs:{vuln:this.vuln}})],1)},Aa=[],Da=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card-title",{staticClass:"title",attrs:{primary:""}},[a("v-container",{staticClass:"grey lighten-5"},[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"pa-2",attrs:{md:"auto"}},[t._v(" Vuln ID: PH-"+t._s(this.vuln.id)+" ")]),a("v-col",{staticClass:"pa-2",attrs:{md:"auto"}},[a("v-icon",{attrs:{color:"deep-orange",title:"Edit Vulnerability"},on:{click:function(e){t.dialog_edit_vuln=!0}}},[t._v("mdi-pencil")]),a("v-icon",{attrs:{color:"deep-orange",title:"Download as JSON file"},on:{click:function(e){return t.downloadVuln("json")}}},[t._v("mdi-download")]),a("v-icon",{attrs:{color:"deep-orange",title:"Send vulnerability as email"},on:{click:function(e){t.dialog_send_mail=!0}}},[t._v("mdi-email-send-outline")])],1),a("v-col",{staticClass:"pa-2"},[a("v-chip",{attrs:{small:"",label:"",outlined:"",color:this.getColorChipMonitored},on:{click:t.toggleMonitored}},[t._v(t._s(this.getTextChipMonitored))])],1),this.vuln.monitored?a("v-col",{staticClass:"pa-2",attrs:{md:"auto"}},[a("v-select",{attrs:{items:t.vuln_status,"item-text":"label","item-value":"value",label:"Status",dense:""},on:{change:function(e){return t.editStatusVunerability()}},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}})],1):t._e()],1)],1),this.showManageMetadataButtons()?a("v-dialog",{attrs:{"max-width":"600px"},model:{value:t.dialog_edit_vuln,callback:function(e){t.dialog_edit_vuln=e},expression:"dialog_edit_vuln"}},[a("DialogVulnAddEdit",{attrs:{vuln:this.vuln,action:"edit"}})],1):t._e(),a("v-dialog",{attrs:{"max-width":"600px"},model:{value:t.dialog_send_mail,callback:function(e){t.dialog_send_mail=e},expression:"dialog_send_mail"}},[a("DialogSendEmail",t._g({attrs:{vuln_id:this.vuln.id},on:{CloseDialog:t.toggleDialogEmail}},t.$listeners))],1)],1)},Ma=[],Ba=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v(" Send vulnerability by email ")])]),a("v-card-text",[a("v-form",{ref:"form-vuln-sendmail"},[a("v-row",[a("v-textarea",{attrs:{rows:"3",label:"Emails",hint:"Email addresses separated with comma or 1 per line. 10 emails max","prepend-icon":"mdi-email"},model:{value:t.notification_data.emails,callback:function(e){t.$set(t.notification_data,"emails",e)},expression:"notification_data.emails"}})],1),a("v-btn",{attrs:{color:"success"},on:{click:function(e){return t.sendEmailVuln(t.vuln_id)}}},[t._v(" Send ")]),a("v-btn",{attrs:{color:"warning",type:"reset"}},[t._v(" Reset ")])],1)],1)],1)},Oa=[],ja={props:{vuln_id:String|Number},data:()=>({notification_data:{emails:""}}),methods:{sendEmailVuln(t){this.$api.post("/api/vulns/"+t+"/export/email",this.notification_data).then(t=>{const e={open:!0,color:"success",text:"Vulnerability details successfuly sent by mail."};this.$emit("OpenSnackBar",e)}).catch(t=>{const e={open:!0,color:"error",text:"Unable to send vulnerability details."};this.$emit("OpenSnackBar",e)}),this.$emit("CloseDialog",!1)}}},Ua=ja,Fa=Object(l["a"])(Ua,Ba,Oa,!1,null,null,null),La=Fa.exports;d()(Fa,{VBtn:V["a"],VCard:S["a"],VCardText:T["d"],VCardTitle:T["e"],VForm:$["a"],VRow:de["a"],VTextarea:$e["a"]});var Na={mixins:[_e,Oe],data:()=>({dialog_edit_vuln:!1,dialog_send_mail:!1,vuln_status:[{label:"Undefined",value:"undefined"},{label:"Fixed",value:"fixed"},{label:"Not Interesting",value:"not_interesting"},{label:"In Progress",value:"in_progress"}],status:"undefined"}),components:{DialogVulnAddEdit:pa,DialogSendEmail:La},props:{vuln:Object},computed:{getColorChipMonitored(){return!0===this.vuln.monitored?"deep-orange":"grey"},getTextChipMonitored(){return!0===this.vuln.monitored?"Monitored":"Not Monitored"}},mounted(){this.getDataFromApi()},methods:{getDataFromApi(){if(!0===this.vuln.monitored)return new Promise((t,e)=>{var a=this.getStatusVulnerability();setTimeout(()=>{this.loading=!1,t({status:a})},300)})},showManageMetadataButtons(){let t=JSON.parse(this.getUserProfile());return null==t||!("manage_metadata"in t)||t.manage_metadata},downloadVuln(t="json"){this.$api.get("/api/vulns/"+this.vuln.id+"/export/"+t,{responseType:"arraybuffer"}).then(e=>{this.forceFileDownload(e,"vuln_export_"+this.vuln.id+"."+t);const a={open:!0,color:"success",text:"Vulnerability details available."};this.$emit("OpenSnackBar",a)}).catch(t=>{const e={open:!0,color:"error",text:"Unable to download vulnerability details."};this.$emit("OpenSnackBar",e)}),this.loading=!1},toggleMonitored(){let t={monitored:!this.vuln.monitored,vuln_id:this.vuln.id,organization_id:localStorage.getItem("org_id")};this.status="undefined",this.$api.put("/api/vulns/"+this.vuln.id+"/toggle",t).then(t=>{if(t){this.vuln.monitored=!this.vuln.monitored;const t={open:!0,color:"success",text:"Vulnerability monitoring successfuly updated."};this.$emit("OpenSnackBar",t),this.getDataFromApi()}else{const t={open:!0,color:"error",text:"Unable to change the vulnerability monitoring status"};this.$emit("OpenSnackBar",t)}}).catch(t=>{this.loading=!1,y.a.fire({title:"Error",text:"Unable to change the vulnerability monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})},toggleDialogEmail(t){this.dialog_send_mail=t},getStatusVulnerability(){this.loading=!0,this.$api.get("/api/vulns/"+this.vuln.id+"/status").then(t=>(t&&200===t.status&&(this.status=t.data),this.status)).catch(t=>{this.counter="undefined",this.loading=!1,y.a.fire({title:"Error",text:"Unable to get counter",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}),this.loading=!1},editStatusVunerability(){this.$api.post("/api/vulns/"+this.vuln.id+"/status/edit",{status:this.status}).then(t=>{if(t&&200===t.status){var e={open:!0,color:"success",text:"Status successfuly modified."};this.$emit("OpenSnackBar",e)}else{e={open:!0,color:"error",text:"Unable to modify the status."};this.$emit("OpenSnackBar",e)}}).catch(t=>{this.loading=!1,y.a.fire({title:"Error",text:"Unable to modify the status.",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})}}},Ra=Na,Ya=Object(l["a"])(Ra,Da,Ma,!1,null,null,null),za=Ya.exports;d()(Ya,{VCardTitle:T["e"],VChip:Z["a"],VCol:le["a"],VContainer:P["a"],VDialog:Xt["a"],VIcon:et["a"],VRow:de["a"],VSelect:We["a"]});var Xa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card-text",[a("v-list",{attrs:{subheader:"",color:"grey lighten-5"}},[a("v-list-item",[a("v-list-item-content",[a("v-list-item-subtitle",[a("span",[t._v("CVE")]),a("v-chip",{staticClass:"mx-2",attrs:{label:"",link:"","x-small":"",href:"https://nvd.nist.gov/vuln/detail/"+this.vuln.cveid,target:"_blank"}},[t._v("NVD")]),a("v-chip",{attrs:{label:"",link:"","x-small":"",href:"https://cve.mitre.org/cgi-bin/cvename.cgi?name="+this.vuln.cveid,target:"_blank"}},[t._v("MITRE")])],1),a("span",[t._v(t._s(this.vuln.cveid))])],1)],1),a("CvssListItem",{attrs:{title:this.title_cvss_v2,cvss:this.vuln.cvss,cvss_vector:this.vuln.cvss_vector}}),a("CvssListItem",{attrs:{title:this.title_cvss_v3,cvss:this.vuln.cvss3,cvss_vector:this.vuln.cvss3_vector}}),a("v-list-item",[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("Summary")]),t._v(" "+t._s(this.vuln.summary)+" ")],1)],1),""!=this.vuln.cwe_id?a("v-list-item",{attrs:{href:"https://cwe.mitre.org/data/definitions/"+this.vuln.cwe_id.replace("CWE-","")+".html",target:"_blank"}},[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("CWE")]),t._v(" "+t._s(this.vuln.cwe_id)+" - "+t._s(this.vuln.cwe_name)+" ")],1)],1):t._e(),""!=this.vuln.cwe_refs&&"MITRE-ATTACK"in this.vuln.cwe_refs?a("v-list-item",[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("Mitre ATT&CK techniques")]),a("ul",{attrs:{id:"v-for-cwe_refs"}},t._l(this.vuln.cwe_refs["MITRE-ATTACK"],(function(e){return a("li",{key:e["external_id"],attrs:{link:""}},[a("a",{attrs:{href:e["url"],target:"_blank"}},[t._v(" "+t._s(e["external_id"])+" - "+t._s(e["description"]))])])})),0)],1)],1):t._e(),"undefined"===typeof this.vuln.reflinks||this.vuln.reflinks.length>0?a("v-list-item",[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("Links")]),a("ul",{attrs:{id:"v-for-reflinks"}},t._l(this.vuln.reflinks,(function(e){return a("li",{key:e,attrs:{link:""}},[a("a",{attrs:{href:e,target:"_blank"}},[t._v(" "+t._s(e)+" ")])])})),0)],1)],1):t._e(),a("v-list-item",[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("Vulnerable product(s) - "+t._s(this.vuln.vulnerable_products.length)+" CPE")]),a("ul",{attrs:{id:"v-for-cpe"}},t._l(this.vuln.vulnerable_products,(function(e,s){return a("li",{key:s},[t._v(" "+t._s(e)+" ")])})),0)],1)],1),a("v-list-item",[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("Vulnerable package(s)")]),a("ul",{attrs:{id:"v-for-package"}},[t._l(this.vuln.vulnerable_packages_versions,(function(e,s){return[t._l(e,(function(e,i){return t._l(e,(function(e,o){return a("li",{key:o},[a("v-chip",{staticClass:"package-chip",attrs:{label:"",small:""}},[t._v(t._s(s)+":"+t._s(i)+" ")]),t._v(" affected: "+t._s(e.affected_versions)+", patched: "+t._s(e.patched_versions)+" ")],1)}))}))]}))],2)],1)],1)],1)],1)},Ha=[],Wa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-list-item",[a("v-list-item-content",{staticClass:"d-inline"},[a("v-list-item-subtitle",[t._v(t._s(this.title))]),a("v-chip",{attrs:{small:"",label:"",color:t.getCVSSColor(this.cvss)}},[t._v(" "+t._s(this.cvss)+" ")]),a("span",[t._v(" - "+t._s(this.cvss_vector)+" ")])],1)],1)},qa=[],Ja={props:{title:String,cvss:Number,cvss_vector:String},mixins:[Tt]},Ka=Ja,Ga=Object(l["a"])(Ka,Wa,qa,!1,null,null,null),Za=Ga.exports;d()(Ga,{VChip:Z["a"],VListItem:it["a"],VListItemContent:nt["g"],VListItemSubtitle:nt["j"]});var Qa={components:{CvssListItem:Za},props:{vuln:Object},data:()=>({title_cvss_v2:"CVSSv2",title_cvss_v3:"CVSSv3"})},ts=Qa,es=(a("2f63"),Object(l["a"])(ts,Xa,Ha,!1,null,null,null)),as=es.exports;d()(es,{VCardText:T["d"],VChip:Z["a"],VList:at["a"],VListItem:it["a"],VListItemContent:nt["g"],VListItemSubtitle:nt["j"]});var ss={components:{CardHeaderVulnerability:za,CardBodyVulnerability:as},props:{vuln:Object}},is=ss,os=Object(l["a"])(is,$a,Aa,!1,null,null,null),ns=os.exports;d()(os,{VCard:S["a"]});var rs=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.vprating>=0?a("v-card",{attrs:{color:t.getRatingColor(t.vprating)},on:{click:function(e){return t.viewRating()}}},[a("v-card-title",{staticClass:"title"},[t._v(t._s(this.title))]),a("v-card-text",[a("v-row",{attrs:{justify:"center"}},[a("span",{staticClass:"display-3 font-weight-bold"},[t._v(t._s(t.vprating))]),t._v("/100 ")])],1)],1):t._e()},ls=[],cs={computed:{vprating(){return this.ratings.score}},mixins:[Tt],props:{vuln_id:String|Number},data:()=>({title:"Rating Scores",ratings:{score:0,cvssV2adj:0},vector:""}),mounted(){this.getDataFromApi()},methods:{getDataFromApi(){return new Promise((t,e)=>{let a=this.getRatings(),s=this.getVulnVector();setTimeout(()=>{this.loading=!1,t({ratings:a,vector:s})},300)})},getRatings(){this.loading=!0,this.$api.get("/api/ratings/calc/"+this.vuln_id).then(t=>{this.ratings=t.data}).catch(t=>{this.ratings={},this.loading=!1,y.a.fire({title:"Error",text:"Unable to get vuln ratings",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}),this.loading=!1},getVulnVector(){this.$api.get("/api/ratings/vector/"+this.vuln_id).then(t=>{this.vector=t.data}).catch(t=>{this.loading=!1,y.a.fire({title:"Error",text:"Unable to get Vuln Vector",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}),this.loading=!1},viewRating(){this.$router.push({name:"Ratings",query:{vector:this.vector}})}}},ds=cs,us=Object(l["a"])(ds,rs,ls,!1,null,null,null),vs=us.exports;d()(us,{VCard:S["a"],VCardText:T["d"],VCardTitle:T["e"],VRow:de["a"]});var ms=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{attrs:{color:"grey lighten-5"}},[a("v-card-title",{staticClass:"title",attrs:{primary:""}},[t._v(" "+t._s(this.title)+" ")]),a("v-card-text",[a("v-switch",{staticStyle:{"margin-top":"0px"},attrs:{color:"deep-orange",readonly:"","hide-details":"",label:"Exploitable"},on:{click:function(e){return t.toggleMetric()}},model:{value:t.is_exploitable,callback:function(e){t.is_exploitable=e},expression:"is_exploitable"}}),a("v-switch",{staticStyle:{"margin-top":"0px"},attrs:{color:"deep-orange",readonly:"","hide-details":"",label:"Confirmed"},model:{value:t.is_confirmed,callback:function(e){t.is_confirmed=e},expression:"is_confirmed"}}),a("v-switch",{staticStyle:{"margin-top":"0px"},attrs:{color:"deep-orange",readonly:"","hide-details":"",label:"Relayed in the News"},model:{value:t.is_in_the_news,callback:function(e){t.is_in_the_news=e},expression:"is_in_the_news"}}),a("v-switch",{staticStyle:{"margin-top":"0px"},attrs:{color:"deep-orange",readonly:"","hide-details":"",label:"Exploited in the Wild"},model:{value:t.is_in_the_wild,callback:function(e){t.is_in_the_wild=e},expression:"is_in_the_wild"}})],1)],1)},hs=[],ps={data:()=>({title:"Metrics"}),props:{is_exploitable:Boolean,is_confirmed:Boolean,is_in_the_news:Boolean,is_in_the_wild:Boolean},methods:{toggleMetric(){const t={open:!0,color:"error",text:"Unable to change the metrics - Insufficient privileges"};this.$emit("OpenSnackBar",t)}}},_s=ps,gs=Object(l["a"])(_s,ms,hs,!1,null,null,null),fs=gs.exports;d()(gs,{VCard:S["a"],VCardText:T["d"],VCardTitle:T["e"],VSwitch:ue["a"]});var bs=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{attrs:{color:"grey lighten-5",height:"100%"}},[a("v-card-title",{staticClass:"title",attrs:{primary:""}},[t._v(" "+t._s(this.title)+" ")]),a("v-card-text",[a("span",[t._v("Authentication: "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(t.authentication))])]),a("br"),a("span",[t._v("Complexity: "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(t.complexity))])]),a("br"),a("span",[t._v("Vector: "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(t.vector))])])])],1)},ks=[],xs={props:{authentication:String,complexity:String,vector:String},data:()=>({title:"Access"})},ys=xs,ws=Object(l["a"])(ys,bs,ks,!1,null,null,null),Cs=ws.exports;d()(ws,{VCard:S["a"],VCardText:T["d"],VCardTitle:T["e"]});var Vs=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{attrs:{color:"grey lighten-5",height:"100%"}},[a("v-card-title",{staticClass:"title",attrs:{primary:""}},[t._v(" "+t._s(this.title)+" ")]),a("v-card-text",[a("span",[t._v(" Confidentiality: "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(t.confidentiality))]),a("br")]),a("span",[t._v(" Integrity: "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(t.integrity))]),a("br")]),a("span",[t._v(" Availability: "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(t.availability))])])])],1)},Ss=[],Ts={data:()=>({title:"Impact"}),props:{confidentiality:String,integrity:String,availability:String}},Is=Ts,Ps=Object(l["a"])(Is,Vs,Ss,!1,null,null,null),Es=Ps.exports;d()(Ps,{VCard:S["a"],VCardText:T["d"],VCardTitle:T["e"]});var $s={props:{vuln_id:String|Number},components:{CardVulnerability:ns,CardScore:vs,CardMetrics:fs,CardAccess:Cs,CardImpact:Es},data:()=>({vuln:{cwe_id:"UNKWNOWN",cwe_refs:{},impact:{confidentiality:"",integrity:"",availability:""},access:{authentication:"",complexity:"",vector:""},reflinks:[],vulnerable_products:[]}}),mounted(){this.getDataFromApi(this.vuln_id)},methods:{getDataFromApi(t){return new Promise((e,a)=>{let s=this.getVulnDetails(t);setTimeout(()=>{this.loading=!1,e({vuln:s})},300)})},getVulnDetails(t){this.loading=!0,this.$api.get("/api/vulns/"+t+"/").then(t=>(this.vuln=t.data,this.vuln)).catch(t=>{this.vuln={},this.loading=!1,y.a.fire({title:"Error",text:"unable to get vuln details",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}),this.loading=!1}}},As=$s,Ds=Object(l["a"])(As,Pa,Ea,!1,null,null,null),Ms=Ds.exports;d()(Ds,{VContainer:P["a"],VFlex:E["a"],VLayout:A["a"]});var Bs=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{attrs:{color:"grey lighten-5"}},[a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.exploit_headers,items:t.exploits,"item-key":"id","multi-sort":"","show-expand":"",expanded:t.expanded},on:{"update:expanded":function(e){t.expanded=e}},scopedSlots:t._u([{key:"item.scope",fn:function(e){var s=e.item;return["public"==s.scope?a("v-icon",{attrs:{color:"green"}},[t._v("mdi-lock-open-variant")]):a("v-icon",{attrs:{color:"orange darken-2"}},[t._v("mdi-lock")])]}},{key:"item.link",fn:function(e){var s=e.item;return[a("a",{attrs:{href:s.link,target:"_blank"}},[t._v(t._s(s.link))])]}},{key:"item.relevancy_level",fn:function(e){var s=e.item;return[t._l(s.relevancy_level,(function(e){return a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:t.getColorRelevancyLevel(s.relevancy_level)}})})),t._l(5-s.relevancy_level,(function(t){return a("v-icon",{key:t+1e3,staticClass:"mdi mdi-clock-time-six-outline",attrs:{"x-small":"",color:"grey"}})}))]}},{key:"item.trust_level",fn:function(e){var a=e.item;return[t._v(" "+t._s(t._f("capitalize")(a.trust_level))+" ")]}},{key:"item.tlp_level",fn:function(e){var s=e.item;return[a("v-chip",{staticClass:"ma-2",attrs:{label:"",outlined:"",small:"",color:t.getTLPColor(s.tlp_level)}},[t._v(" "+t._s(t._f("capitalize")(s.tlp_level))+" ")])]}},{key:"item.modified",fn:function(e){var s=e.item;return[a("span",[t._v(t._s(t.moment(s.modified).format("YYYY-MM-DD")))])]}},{key:"item.action",fn:function(e){var s=e.item;return["public"!=s.scope?a("v-icon",{staticClass:"mdi mdi-pencil",attrs:{small:"",color:"orange"},on:{click:function(e){return t.loadExploit(s)}}}):t._e(),"public"!=s.scope?a("v-icon",{staticClass:"mdi mdi-delete",attrs:{small:"",color:"red"},on:{click:function(e){return t.deleteExploit(s)}}}):t._e()]}},{key:"expanded-item",fn:function(e){var s=e.headers,i=e.item;return[a("td",{attrs:{colspan:s.length}},[t._v(t._s(i.notes))])]}}],null,!0)}),[a("v-btn",{attrs:{absolute:"",dark:"",fab:"",bottom:"",left:"",color:"deep-orange"},on:{click:function(e){t.dialog_exploit=!0}}},[a("v-icon",[t._v("mdi-plus")])],1)],this.showManageMetadataButtons()?a("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.dialog_exploit,callback:function(e){t.dialog_exploit=e},expression:"dialog_exploit"}},[a("DialogExploit",t._g({attrs:{vuln_id:t.vuln_id,editedItem:this.editedItem},on:{addExploit:t.addExploit,editExploit:t.editExploit}},t.$listeners))],1):t._e()],2)},Os=[],js=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v(" "+t._s(t.title_form)+" ")])]),a("v-card-text",[a("v-form",{ref:"form"},[a("v-container",[a("v-row",[a("v-col",[a("v-text-field",{attrs:{label:"link"},model:{value:t.item.link,callback:function(e){t.$set(t.item,"link",e)},expression:"item.link"}})],1)],1),a("v-row",[a("v-col",{attrs:{cols:"12",md:"6"}},[a("v-select",{attrs:{label:"Trust Level",items:t.defaultMetadata.trust_level_items},model:{value:t.item.trust_level,callback:function(e){t.$set(t.item,"trust_level",e)},expression:"item.trust_level"}})],1),a("v-col",{attrs:{cols:"12",md:"6"}},[a("v-select",{attrs:{label:"TLP Level",items:t.defaultMetadata.tlp_level_items},model:{value:t.item.tlp_level,callback:function(e){t.$set(t.item,"tlp_level",e)},expression:"item.tlp_level"}})],1)],1),a("v-row",[a("v-col",{attrs:{cols:"12",md:"6"}},[a("v-select",{attrs:{label:"Availability",items:t.defaultMetadata.availability_items},model:{value:t.item.availability,callback:function(e){t.$set(t.item,"availability",e)},expression:"item.availability"}})],1),a("v-col",{attrs:{cols:"12",md:"6"}},[a("v-select",{attrs:{label:"Maturity",items:t.defaultMetadata.maturity_items},model:{value:t.item.maturity,callback:function(e){t.$set(t.item,"maturity",e)},expression:"item.maturity"}})],1)],1),a("v-row",[a("v-col",[a("v-text-field",{attrs:{label:"Source"},model:{value:t.item.source,callback:function(e){t.$set(t.item,"source",e)},expression:"item.source"}}),a("v-textarea",{attrs:{label:"Notes",hint:"Insert notes about this entry",rows:"3"},model:{value:t.item.notes,callback:function(e){t.$set(t.item,"notes",e)},expression:"item.notes"}})],1)],1),a("v-btn",{attrs:{color:"success"},on:{click:t.saveExploit}},[t._v("Save")]),a("v-btn",{attrs:{color:"warning"},on:{click:t.resetItemValue}},[t._v("Reset")])],1)],1)],1),a("v-card-actions",[a("v-spacer")],1)],1)},Us=[],Fs={props:{vuln_id:String|Number,editedItem:Object},watch:{editedItem:{immediate:!0,handler(){this.resetItemValue()}}},data:()=>({defaultMetadata:{link:"https://",trust_level:"high",tlp_level:"white",availability:"public",maturity:"unknown",source:"manual",notes:"",trust_level_items:["unknown","low","medium","high"],tlp_level_items:["white","green","amber","red","black"],availability_items:["unknown","private","public"],maturity_items:["unknown","unproven","poc","functional"]},item:{link:"",trust_level:"",tlp_level:"",availability:"",maturity:"",source:"",modified:"",notes:""}}),computed:{title_form(){return 0===Object.keys(this.editedItem).length?"New Exploit":"Edit Exploit"}},methods:{saveExploit(){this.item.modified=new Date,0===Object.keys(this.editedItem).length?this.$emit("addExploit",this.item):this.$emit("editExploit",this.item)},setDefaultValue(){this.item={link:this.defaultMetadata.link,trust_level:this.defaultMetadata.trust_level,tlp_level:this.defaultMetadata.tlp_level,availability:this.defaultMetadata.availability,maturity:this.defaultMetadata.maturity,source:this.defaultMetadata.source,notes:"",modified:""}},resetItemValue(){0===Object.keys(this.editedItem).length?this.setDefaultValue():this.item={link:this.editedItem.link,trust_level:this.editedItem.trust_level,tlp_level:this.editedItem.tlp_level,availability:this.editedItem.availability,maturity:this.editedItem.maturity,source:this.editedItem.source,notes:this.editedItem.notes,modified:this.editedItem.modified}}}},Ls=Fs,Ns=Object(l["a"])(Ls,js,Us,!1,null,null,null),Rs=Ns.exports;d()(Ns,{VBtn:V["a"],VCard:S["a"],VCardActions:T["b"],VCardText:T["d"],VCardTitle:T["e"],VCol:le["a"],VContainer:P["a"],VForm:$["a"],VRow:de["a"],VSelect:We["a"],VSpacer:B["a"],VTextField:O["a"],VTextarea:$e["a"]});var Ys={props:{vuln_id:String|Number},components:{DialogExploit:Rs},mixins:[Tt,_e],data:()=>({expanded:[],exploits:[],exploit_headers:[{text:"Scope",value:"scope"},{text:"Link",value:"link"},{text:"TLP",value:"tlp_level",align:"center"},{text:"Relevancy",value:"relevancy_level"},{text:"Trust",value:"trust_level"},{text:"Source",value:"source",align:"center"},{text:"Last update",value:"modified",align:"center"},{text:"Actions",value:"action",sortable:!1},{text:"",value:"data-table-expand"}],editedItem:{},dialog_exploit:!1}),mounted(){this.getDataFromApi()},watch:{dialog_exploit:{immediate:!0,handler(){!1===this.dialog_exploit&&(this.editedItem={})}}},methods:{getDataFromApi(){return new Promise((t,e)=>{let a=this.getExploits();setTimeout(()=>{this.loading=!1,t({exploits:a})},300)})},getExploits(){this.loading=!0,this.$api.get("/api/vulns/"+this.vuln_id+"/exploits").then(t=>(t&&200===t.status&&(this.exploits=t.data),this.exploits)).catch(t=>{this.exploits=[],this.loading=!1,y.a.fire({title:"Error",text:"unable to get related exploits",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}),this.loading=!1},getColorRelevancyLevel(t){return 1===t?"yellow":2===t?"orange":3===t?"orange darken-4":4===t?"red":5===t?"red darken-4":"grey"},loadExploit(t){this.editedItem=t,this.dialog_exploit=!0},deleteExploit(t){this.$api.get("/api/vulns/"+this.vuln_id+"/exploits/"+t.id+"/del").then(t=>{if(t){const t={open:!0,color:"success",text:"Exploit successfuly deleted."};this.getExploits(),this.$emit("OpenSnackBar",t)}else{const t={open:!0,color:"error",text:"Unable to delete the exploit"};this.$emit("OpenSnackBar",t)}}).catch(t=>{this.loading=!1,y.a.fire({title:"Error",text:"unable to delete related exploit",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}),this.$emit("UpdateCounter",this.vuln_id)},addExploit(t){this.$api.post("/api/vulns/"+this.vuln_id+"/exploits/add",t).then(t=>{if(t&&200===t.status){const t={open:!0,color:"success",text:"Exploit successfuly saved."};this.$emit("OpenSnackBar",t),this.getExploits(),this.$emit("UpdateCounter",this.vuln_id)}else{const t={open:!0,color:"error",text:"Unable to save the exploit metadata."};this.$emit("OpenSnackBar",t)}}).catch(t=>{this.loading=!1,y.a.fire({title:"Error",text:"Unable to save related exploits",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}),this.dialog_exploit=!1},editExploit(t){var e=t;e["id"]=this.editedItem["id"],this.$api.post("/api/vulns/"+this.vuln_id+"/exploits/edit",e).then(t=>{if(t&&200===t.status){const t={open:!0,color:"success",text:"Exploit successfuly saved."};this.$emit("OpenSnackBar",t),this.getExploits()}else{const t={open:!0,color:"error",text:"Unable to save the exploit metadata."};this.$emit("OpenSnackBar",t)}}).catch(t=>{this.loading=!1,y.a.fire({title:"Error",text:"unable to save related exploits",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}),this.dialog_exploit=!1},showManageMetadataButtons(){let t=JSON.parse(this.getUserProfile());return null==t||!("manage_metadata"in t)||t.manage_metadata}}},zs=Ys,Xs=Object(l["a"])(zs,Bs,Os,!1,null,null,null),Hs=Xs.exports;d()(Xs,{VBtn:V["a"],VCard:S["a"],VChip:Z["a"],VDataTable:zt["a"],VDialog:Xt["a"],VIcon:et["a"]});var Ws=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{attrs:{color:"grey lighten-5"}},[a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.threat_headers,items:t.threats,"item-key":"id","multi-sort":"","show-expand":"",expanded:t.expanded},on:{"update:expanded":function(e){t.expanded=e}},scopedSlots:t._u([{key:"item.scope",fn:function(e){var s=e.item;return["public"==s.scope?a("v-icon",{attrs:{color:"green"}},[t._v("mdi-lock-open-variant")]):a("v-icon",{attrs:{color:"orange darken-2"}},[t._v("mdi-lock")])]}},{key:"item.link",fn:function(e){var s=e.item;return[a("a",{attrs:{href:s.link,target:"_blank"}},[t._v(t._s(s.link))])]}},{key:"item.trust_level",fn:function(e){var a=e.item;return[t._v(" "+t._s(t._f("capitalize")(a.trust_level))+" ")]}},{key:"item.tlp_level",fn:function(e){var s=e.item;return[a("v-chip",{staticClass:"ma-2",attrs:{label:"",outlined:"",small:"",color:t.getTLPColor(s.tlp_level)}},[t._v(" "+t._s(t._f("capitalize")(s.tlp_level))+" ")])]}},{key:"item.is_in_the_wild",fn:function(e){var s=e.item;return[a("span",[t._v(t._s(t.transform_true_false(s.is_in_the_wild)))])]}},{key:"item.is_in_the_news",fn:function(e){var s=e.item;return[a("span",[t._v(t._s(t.transform_true_false(s.is_in_the_news)))])]}},{key:"item.modified",fn:function(e){var s=e.item;return[a("span",[t._v(t._s(t.moment(s.modified).format("YYYY-MM-DD")))])]}},{key:"item.action",fn:function(e){var s=e.item;return["public"!=s.scope?a("v-icon",{staticClass:"mdi mdi-pencil",attrs:{small:"",color:"orange"},on:{click:function(e){return t.loadThreat(s)}}}):t._e(),"public"!=s.scope?a("v-icon",{staticClass:"mdi mdi-delete",attrs:{small:"",color:"red"},on:{click:function(e){return t.deleteThreat(s)}}}):t._e()]}},{key:"expanded-item",fn:function(e){var s=e.headers,i=e.item;return[a("td",{attrs:{colspan:s.length}},[t._v(t._s(i.notes))])]}}],null,!0)}),[a("v-btn",{attrs:{absolute:"",dark:"",fab:"",bottom:"",left:"",color:"deep-orange"},on:{click:function(e){t.dialog_threat=!0}}},[a("v-icon",[t._v("mdi-plus")])],1)],this.showManageMetadataButtons()?a("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.dialog_threat,callback:function(e){t.dialog_threat=e},expression:"dialog_threat"}},[a("DialogThreat",t._g({attrs:{vuln_id:t.vuln_id,editedItem:this.editedItem},on:{addThreat:t.addThreat,editThreat:t.editThreat}},t.$listeners))],1):t._e()],2)},qs=[],Js=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v(" "+t._s(t.title_form)+" ")])]),a("v-card-text",[a("v-form",{ref:"form"},[a("v-container",[a("v-row",[a("v-col",[a("v-text-field",{attrs:{label:"link"},model:{value:t.item.link,callback:function(e){t.$set(t.item,"link",e)},expression:"item.link"}})],1)],1),a("v-row",[a("v-col",{attrs:{cols:"12",md:"6"}},[a("v-select",{attrs:{label:"Trust Level",items:t.defaultMetadata.trust_level_items},model:{value:t.item.trust_level,callback:function(e){t.$set(t.item,"trust_level",e)},expression:"item.trust_level"}})],1),a("v-col",{attrs:{cols:"12",md:"6"}},[a("v-select",{attrs:{label:"TLP Level",items:t.defaultMetadata.tlp_level_items},model:{value:t.item.tlp_level,callback:function(e){t.$set(t.item,"tlp_level",e)},expression:"item.tlp_level"}})],1)],1),a("v-row",[a("v-col",{attrs:{cols:"12",md:"6"}},[a("v-select",{attrs:{label:"In the News?",items:t.defaultMetadata.is_in_the_news_items,"item-text":"text","item-value":"value"},model:{value:t.item.is_in_the_news,callback:function(e){t.$set(t.item,"is_in_the_news",e)},expression:"item.is_in_the_news"}})],1),a("v-col",{attrs:{cols:"12",md:"6"}},[a("v-select",{attrs:{label:"In The Wild",items:t.defaultMetadata.is_in_the_wild_items},model:{value:t.item.is_in_the_wild,callback:function(e){t.$set(t.item,"is_in_the_wild",e)},expression:"item.is_in_the_wild"}})],1)],1),a("v-row",[a("v-col",[a("v-text-field",{attrs:{label:"Source"},model:{value:t.item.source,callback:function(e){t.$set(t.item,"source",e)},expression:"item.source"}}),a("v-textarea",{attrs:{label:"Notes",hint:"Insert notes about this entry",rows:"3"},model:{value:t.item.notes,callback:function(e){t.$set(t.item,"notes",e)},expression:"item.notes"}})],1)],1),a("v-btn",{attrs:{color:"success"},on:{click:t.saveThreat}},[t._v("Save")]),a("v-btn",{attrs:{color:"warning",type:"reset"}},[t._v("Reset")])],1)],1)],1),a("v-card-actions",[a("v-spacer")],1)],1)},Ks=[],Gs={props:{vuln_id:String|Number,editedItem:Object},watch:{editedItem:{immediate:!0,handler(){this.resetItemValue()}}},data:()=>({defaultMetadata:{link:"https://",trust_level:"high",tlp_level:"white",is_in_the_wild:!1,is_in_the_news:!1,source:"manual",notes:"",trust_level_items:["unknown","low","medium","high"],tlp_level_items:["white","green","amber","red","black"],is_in_the_wild_items:[{text:"Yes",value:!0},{text:"No",value:!1}],is_in_the_news_items:[{text:"Yes",value:!0},{text:"No",value:!1}]},item:{link:"",trust_level:"",tlp_level:"",is_in_the_wild:!1,is_in_the_news:!1,source:"",notes:"",modified:""}}),computed:{title_form(){return 0===Object.keys(this.editedItem).length?"New Threat":"Edit Threat"}},methods:{saveThreat(){this.item.modified=new Date,0===Object.keys(this.editedItem).length?this.$emit("addThreat",this.item):this.$emit("editThreat",this.item)},setDefaultValue(){this.item={link:this.defaultMetadata.link,trust_level:this.defaultMetadata.trust_level,tlp_level:this.defaultMetadata.tlp_level,is_in_the_wild:this.defaultMetadata.is_in_the_wild,is_in_the_news:this.defaultMetadata.is_in_the_news,source:this.defaultMetadata.source,notes:"",modified:""}},resetItemValue(){0===Object.keys(this.editedItem).length?this.setDefaultValue():this.item={link:this.editedItem.link,trust_level:this.editedItem.trust_level,tlp_level:this.editedItem.tlp_level,is_in_the_wild:this.editedItem.is_in_the_wild,is_in_the_news:this.editedItem.is_in_the_news,source:this.editedItem.source,notes:this.editedItem.notes,modified:this.editedItem.modified}}}},Zs=Gs,Qs=Object(l["a"])(Zs,Js,Ks,!1,null,null,null),ti=Qs.exports;d()(Qs,{VBtn:V["a"],VCard:S["a"],VCardActions:T["b"],VCardText:T["d"],VCardTitle:T["e"],VCol:le["a"],VContainer:P["a"],VForm:$["a"],VRow:de["a"],VSelect:We["a"],VSpacer:B["a"],VTextField:O["a"],VTextarea:$e["a"]});var ei={props:{vuln_id:String|Number},components:{DialogThreat:ti},mixins:[Tt,_e],data:()=>({expanded:[],threats:[],threat_headers:[{text:"Scope",value:"scope"},{text:"Link",value:"link"},{text:"Trust level",value:"trust_level"},{text:"TLP",value:"tlp_level",align:"center"},{text:"Source",value:"source",align:"center"},{text:"In the Wild ?",value:"is_in_the_wild",align:"center"},{text:"In the News ?",value:"is_in_the_news",align:"center"},{text:"Last update",value:"modified",align:"center"},{text:"Actions",value:"action",sortable:!1}],editedItem:{},dialog_threat:!1}),mounted(){this.getDataFromApi()},watch:{dialog_threat:{immediate:!0,handler(){!1===this.dialog_threat&&(this.editedItem={})}}},methods:{getDataFromApi(){return new Promise((t,e)=>{let a=this.getThreats();setTimeout(()=>{this.loading=!1,t({threats:a})},300)})},getThreats(){this.loading=!0,this.$api.get("/api/vulns/"+this.vuln_id+"/threats").then(t=>(t&&200===t.status&&(this.threats=t.data),this.threats)).catch(t=>{this.threats=[],this.loading=!1,y.a.fire({title:"Error",text:"unable to get related threats activity",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}),this.loading=!1},loadThreat(t){this.editedItem=t,this.dialog_threat=!0},deleteThreat(t){this.$api.get("/api/vulns/"+this.vuln_id+"/threats/"+t.id+"/del").then(t=>{if(t){const t={open:!0,color:"success",text:"Threat activity successfuly deleted."};this.$emit("OpenSnackBar",t),this.getThreats()}else{const t={open:!0,color:"error",text:"Unable to delete the threat activity"};this.$emit("OpenSnackBar",t)}}).catch(t=>{this.loading=!1,y.a.fire({title:"Error",text:"Unable to delete related threat activity",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}),this.$emit("UpdateCounter",this.vuln_id)},addThreat(t){this.$api.post("/api/vulns/"+this.vuln_id+"/threats/add",t).then(t=>{if(t&&200===t.status){const t={open:!0,color:"success",text:"Threat activity successfuly saved."};this.$emit("OpenSnackBar",t),this.getThreats(),this.$emit("UpdateCounter",this.vuln_id)}else{const t={open:!0,color:"error",text:"Unable to save the exploit metadata."};this.$emit("OpenSnackBar",t)}}).catch(t=>{this.loading=!1,y.a.fire({title:"Error",text:"Unable to save related threat activity",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}),this.dialog_threat=!1},editThreat(t){var e=t;e["id"]=this.editedItem["id"],e["maturity"]="",this.$api.post("/api/vulns/"+this.vuln_id+"/threats/edit",e).then(t=>{if(t&&200===t.status){const t={open:!0,color:"success",text:"Threat activity successfuly saved."};this.$emit("OpenSnackBar",t),this.getThreats()}else{const t={open:!0,color:"error",text:"Unable to save the threat activity."};this.$emit("OpenSnackBar",t)}}).catch(t=>{this.loading=!1,y.a.fire({title:"Error",text:"Unable to save related threat activity",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}),this.dialog_threat=!1},transform_true_false(t){return!1===t?"No":"Yes"},showManageMetadataButtons(){let t=JSON.parse(this.getUserProfile());return null==t||!("manage_metadata"in t)||t.manage_metadata}}},ai=ei,si=Object(l["a"])(ai,Ws,qs,!1,null,null,null),ii=si.exports;d()(si,{VBtn:V["a"],VCard:S["a"],VChip:Z["a"],VDataTable:zt["a"],VDialog:Xt["a"],VIcon:et["a"]});var oi=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{fluid:""}},[a("v-col",[a("v-textarea",{attrs:{outlined:"",name:"input-comment",label:"Comment",hint:"Put comment on this vulnerability"},model:{value:t.comment,callback:function(e){t.comment=e},expression:"comment"}}),a("v-btn",{attrs:{tile:"",color:"success"},on:{click:function(e){return t.editComment()}}},[a("v-icon",{attrs:{left:""}},[t._v("mdi-pencil")]),t._v(" Save ")],1)],1)],1)},ni=[],ri={props:{vuln_id:String|Number},data:()=>({comment:""}),mounted(){this.getDataFromApi()},methods:{getDataFromApi(t){return new Promise((e,a)=>{let s=this.getComment(t);setTimeout(()=>{this.loading=!1,e({comment:s})},300)})},getComment(){this.loading=!0,this.$api.get("/api/vulns/"+this.vuln_id+"/comment").then(t=>(t&&200===t.status&&(this.comment=t.data),this.comment)).catch(t=>{this.comment="",this.loading=!1,y.a.fire({title:"Error",text:"unable to get comment",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}),this.loading=!1},editComment(){this.$api.post("/api/vulns/"+this.vuln_id+"/comment/edit",{comment:this.comment}).then(t=>{if(t&&200===t.status){var e={open:!0,color:"success",text:"Comment successfuly modified."};this.$emit("OpenSnackBar",e)}else{e={open:!0,color:"error",text:"Unable to modify the comment."};this.$emit("OpenSnackBar",e)}}).catch(t=>{this.loading=!1,y.a.fire({title:"Error",text:"Unable to modify the comment.",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})}}},li=ri,ci=Object(l["a"])(li,oi,ni,!1,null,null,null),di=ci.exports;d()(ci,{VBtn:V["a"],VCol:le["a"],VContainer:P["a"],VIcon:et["a"],VTextarea:$e["a"]});var ui=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-snackbar",{attrs:{timeout:3e3,color:t.snack.color,dense:""},model:{value:t.snack.open,callback:function(e){t.$set(t.snack,"open",e)},expression:"snack.open"}},[t._v(" "+t._s(t.snack.text)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack.open=!1}}},[t._v("Close")])],1)},vi=[],mi={props:{snack:Object}},hi=mi,pi=Object(l["a"])(hi,ui,vi,!1,null,null,null),_i=pi.exports;d()(pi,{VBtn:V["a"],VSnackbar:M["a"]});var gi={mixins:[Tt],components:{VulnDetails:Ms,VulnerabilityExploit:Hs,VulnerabilityThreat:ii,VulnerabilityComment:di,SnackBar:_i},data:()=>({vuln_id:"",snack:{open:!1,color:"",text:""},counter:{count_exploit:0,count_threat:0}}),beforeRouteUpdate(t){this.vuln_id=t.params.vuln_id},mounted(){this.vuln_id=this.$router.currentRoute.params.vuln_id,this.getDataFromApi(this.vuln_id)},computed:{count_exploit(){return 0===this.counter.count_exploit?"0":this.counter.count_exploit},count_threat(){return 0===this.counter.count_threat?"0":this.counter.count_threat}},methods:{modifySnackBar(t){this.snack=t},getDataFromApi(t){return new Promise((e,a)=>{let s=this.getCountThreatsExploits(t);setTimeout(()=>{this.loading=!1,e({counter:s})},300)})},getCountThreatsExploits(t){this.loading=!0,this.$api.get("/api/vulns/"+t+"/counter").then(t=>(t&&200===t.status&&(this.counter=t.data),this.counter)).catch(t=>{this.counter={count_exploit:0,count_threat:0},this.loading=!1,y.a.fire({title:"Error",text:"Unable to get counter",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}),this.loading=!1}}},fi=gi,bi=Object(l["a"])(fi,Ta,Ia,!1,null,null,null),ki=bi.exports;d()(bi,{VBadge:Ze["a"],VTab:Ie["a"],VTabItem:Pe["a"],VTabs:Ee["a"]});var xi=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-tabs",{attrs:{left:"","background-color":"white",color:"deep-orange accent-4"}},[a("v-tab",[t._v("Summary")]),a("v-tab",[this.exploits.length>0?a("v-badge",{attrs:{color:"deep-orange",content:this.exploits.length}},[t._v("Exploits")]):t._e(),0==this.exploits.length?a("v-badge",{attrs:{color:"grey",content:"0"}},[t._v("Exploits")]):t._e()],1),a("v-tab",[this.threats.length>0?a("v-badge",{attrs:{color:"deep-orange",content:this.threats.length}},[t._v("Threat activities")]):t._e(),0==this.threats.length?a("v-badge",{attrs:{color:"grey",content:"0"}},[t._v("Threat activities")]):t._e()],1),a("v-tab-item",[a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md9:""}},[a("v-flex",[a("v-card",{attrs:{color:"grey lighten-5"}},[a("v-card-title",{staticClass:"title",attrs:{primary:""}},[a("v-container",{staticClass:"grey lighten-5"},[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"pa-2",attrs:{md:"auto"}},[t._v(" Vuln ID: PH-"+t._s(t.$route.params.vuln_id)+" ")]),a("v-col",{staticClass:"pa-2",attrs:{md:"auto"}},[a("v-icon",{attrs:{color:"deep-orange",title:"Download as JSON file"},on:{click:function(e){return t.downloadVuln(t.$route.params.vuln_id,"json")}}},[t._v("mdi-download")])],1),a("v-col",{staticClass:"pa-2"})],1)],1)],1),a("v-card-text",[a("v-list",{attrs:{subheader:"",color:"grey lighten-5"}},[a("v-list-item",[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("CVE")]),t._v(" "+t._s(this.vuln.cveid)+" ")],1)],1),a("v-list-item",[a("v-list-item-content",{staticClass:"d-inline"},[a("v-list-item-subtitle",[t._v("CVSSv2")]),a("v-chip",{attrs:{small:"",label:"",color:t.getCVSSColor(this.vuln.cvss)}},[t._v(" "+t._s(this.vuln.cvss)+" ")]),t._v(" - "+t._s(this.vuln.cvss_vector)+" ")],1)],1),a("v-list-item",[a("v-list-item-content",{staticClass:"d-inline"},[a("v-list-item-subtitle",[t._v("CVSSv3")]),a("v-chip",{attrs:{small:"",label:"",color:t.getCVSSColor(this.vuln.cvss3)}},[t._v(" "+t._s(this.vuln.cvss3)+" ")]),t._v(" - "+t._s(this.vuln.cvss3_vector)+" ")],1)],1),a("v-list-item",[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("Summary")]),t._v(" "+t._s(this.vuln.summary)+" ")],1)],1),""!=this.vuln.cwe_id?a("v-list-item",{attrs:{href:"https://cwe.mitre.org/data/definitions/"+this.vuln.cwe_id.replace("CWE-","")+".html",target:"_blank"}},[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("CWE")]),t._v(" "+t._s(this.vuln.cwe_id)+" - "+t._s(this.vuln.cwe_name)+" ")],1)],1):t._e(),""!=this.vuln.cwe_refs&&"MITRE-ATTACK"in this.vuln.cwe_refs?a("v-list-item",[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("Mitre ATT&CK techniques")]),a("ul",{attrs:{id:"v-for-cwe_refs"}},t._l(this.vuln.cwe_refs["MITRE-ATTACK"],(function(e){return a("li",{attrs:{link:""}},[a("a",{attrs:{href:e["url"],target:"_blank"}},[t._v(" "+t._s(e["external_id"])+" - "+t._s(e["description"]))])])})),0)],1)],1):t._e(),"undefined"===typeof this.vuln.reflinks||this.vuln.reflinks.length>0?a("v-list-item",[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("Links")]),a("ul",{attrs:{id:"v-for-reflinks"}},t._l(this.vuln.reflinks,(function(e){return a("li",{key:e,attrs:{link:""}},[a("a",{attrs:{href:e,target:"_blank"}},[t._v(" "+t._s(e)+" ")])])})),0)],1)],1):t._e(),a("v-list-item",[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("Vulnerable product(s) - "+t._s(this.vuln.vulnerable_products.length)+" CPE")]),a("ul",{attrs:{id:"v-for-cpe"}},t._l(this.vuln.vulnerable_products,(function(e){return a("li",[t._v(" "+t._s(e)+" ")])})),0)],1)],1),a("v-list-item",[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("Vulnerable package(s)")]),a("ul",{attrs:{id:"v-for-package"}},[t._l(this.vuln.vulnerable_packages_versions,(function(e,s){return[t._l(e,(function(e,i){return t._l(e,(function(e,o){return a("li",[a("v-chip",{staticClass:"package-chip",attrs:{label:"",small:""}},[t._v(t._s(s)+":"+t._s(i)+" ")]),t._v(" affected: "+t._s(e.affected_versions)+", patched: "+t._s(e.patched_versions)+" ")],1)}))}))]}))],2)],1)],1)],1)],1)],1)],1)],1),a("v-flex",{attrs:{md3:""}},[a("v-flex",[this.ratings.score>=0?a("v-card",{attrs:{color:t.getRatingColor(t.vprating)},on:{click:function(e){return t.viewRating()}}},[a("v-card-title",{staticClass:"title"},[t._v("Rating Scores")]),a("v-card-text",[a("v-row",{attrs:{justify:"center"}},[a("span",{staticClass:"display-3 font-weight-bold"},[t._v(t._s(t.vprating))]),t._v("/100 ")])],1)],1):t._e()],1),a("v-flex",[a("v-card",{attrs:{color:"grey lighten-5"}},[a("v-card-title",{staticClass:"title",attrs:{primary:""}},[t._v("Metrics")]),a("v-card-text",[a("v-switch",{staticStyle:{"margin-top":"0px"},attrs:{color:"deep-orange",readonly:"","hide-details":"",label:"Exploitable"},on:{click:function(e){return t.toggleMetric()}},model:{value:t.is_exploitable,callback:function(e){t.is_exploitable=e},expression:"is_exploitable"}}),a("v-switch",{staticStyle:{"margin-top":"0px"},attrs:{color:"deep-orange",readonly:"","hide-details":"",label:"Confirmed"},model:{value:t.is_confirmed,callback:function(e){t.is_confirmed=e},expression:"is_confirmed"}}),a("v-switch",{staticStyle:{"margin-top":"0px"},attrs:{color:"deep-orange",readonly:"","hide-details":"",label:"Relayed in the News"},model:{value:t.is_in_the_news,callback:function(e){t.is_in_the_news=e},expression:"is_in_the_news"}}),a("v-switch",{staticStyle:{"margin-top":"0px"},attrs:{color:"deep-orange",readonly:"","hide-details":"",label:"Exploited in the Wild"},model:{value:t.is_in_the_wild,callback:function(e){t.is_in_the_wild=e},expression:"is_in_the_wild"}})],1)],1)],1),a("v-flex",[a("v-card",{attrs:{color:"grey lighten-5",height:"100%"}},[a("v-card-title",{staticClass:"title",attrs:{primary:""}},[t._v("Access")]),a("v-card-text",[t._v(" Authentication: "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(this.vuln.access.authentication))]),a("br"),t._v(" Complexity: "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(this.vuln.access.complexity))]),a("br"),t._v(" Vector: "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(this.vuln.access.vector))])])],1)],1),a("v-flex",[a("v-card",{attrs:{color:"grey lighten-5",height:"100%"}},[a("v-card-title",{staticClass:"title",attrs:{primary:""}},[t._v("Impact")]),a("v-card-text",[t._v(" Confidentiality: "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(this.vuln.impact.confidentiality))]),a("br"),t._v(" Integrity: "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(this.vuln.impact.integrity))]),a("br"),t._v(" Availability: "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(this.vuln.impact.availability))])])],1)],1)],1)],1),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor,dense:""},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1),a("v-tab-item",[a("v-card",{attrs:{color:"grey lighten-5"}},[a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.exploit_headers,items:t.exploits,"item-key":"link","multi-sort":"","show-expand":"",expanded:t.expanded},on:{"update:expanded":function(e){t.expanded=e}},scopedSlots:t._u([{key:"item.scope",fn:function(e){var s=e.item;return["public"==s.scope?a("v-icon",{attrs:{color:"green"}},[t._v("mdi-lock-open-variant")]):a("v-icon",{attrs:{color:"orange darken-2"}},[t._v("mdi-lock")])]}},{key:"item.link",fn:function(e){var s=e.item;return[a("a",{attrs:{href:s.link,target:"_blank"}},[t._v(t._s(s.link))])]}},{key:"item.relevancy_level",fn:function(e){var s=e.item;return[t._l(1,(function(e){return 1==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"yellow"}}):t._e()})),t._l(4,(function(e){return 1==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six-outline",attrs:{"x-small":"",color:"grey"}}):t._e()})),t._l(2,(function(e){return 2==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"orange"}}):t._e()})),t._l(3,(function(e){return 2==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six-outline",attrs:{"x-small":"",color:"grey"}}):t._e()})),t._l(3,(function(e){return 3==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"orange darken-4"}}):t._e()})),t._l(2,(function(e){return 3==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six-outline",attrs:{"x-small":"",color:"grey"}}):t._e()})),t._l(4,(function(e){return 4==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"red"}}):t._e()})),t._l(1,(function(e){return 4==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six-outline",attrs:{"x-small":"",color:"grey"}}):t._e()})),t._l(5,(function(e){return 5==s.relevancy_level?a("v-icon",{key:e,staticClass:"mdi mdi-clock-time-six",attrs:{"x-small":"",color:"red darken-4"}}):t._e()}))]}},{key:"item.trust_level",fn:function(e){var a=e.item;return[t._v(" "+t._s(t._f("capitalize")(a.trust_level))+" ")]}},{key:"item.tlp_level",fn:function(e){var s=e.item;return[a("v-chip",{staticClass:"ma-2",attrs:{label:"",outlined:"",small:"",color:t.getTLPColor(s.tlp_level)}},[t._v(" "+t._s(t._f("capitalize")(s.tlp_level))+" ")])]}},{key:"item.modified",fn:function(e){var s=e.item;return[a("span",[t._v(t._s(t.moment(s.modified).format("YYYY-MM-DD")))])]}},{key:"expanded-item",fn:function(e){var s=e.headers,i=e.item;return[a("td",{attrs:{colspan:s.length}},[t._v(t._s(i.notes))])]}}])})],1),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1),a("v-tab-item",[a("v-card",[a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.threat_headers,items:t.threats,"item-key":"id","multi-sort":"","show-expand":"",expanded:t.expanded},on:{"update:expanded":function(e){t.expanded=e}},scopedSlots:t._u([{key:"item.scope",fn:function(e){var s=e.item;return["public"==s.scope?a("v-icon",{attrs:{color:"green"}},[t._v("mdi-lock-open-variant")]):a("v-icon",{attrs:{color:"orange darken-2"}},[t._v("mdi-lock")])]}},{key:"item.link",fn:function(e){var s=e.item;return[a("a",{attrs:{href:s.link,target:"_blank"}},[t._v(t._s(s.link))])]}},{key:"item.trust_level",fn:function(e){var a=e.item;return[t._v(" "+t._s(t._f("capitalize")(a.trust_level))+" ")]}},{key:"item.tlp_level",fn:function(e){var s=e.item;return[a("v-chip",{staticClass:"ma-2",attrs:{label:"",outlined:"",small:"",color:t.getTLPColor(s.tlp_level)}},[t._v(" "+t._s(t._f("capitalize")(s.tlp_level))+" ")])]}},{key:"item.modified",fn:function(e){var s=e.item;return[a("span",[t._v(t._s(t.moment(s.modified).format("YYYY-MM-DD")))])]}},{key:"expanded-item",fn:function(e){var s=e.headers,i=e.item;return[a("td",{attrs:{colspan:s.length}},[t._v(t._s(i.notes))])]}}])})],1),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1)},yi=[],wi={name:"VulnDetailsPublic",mixins:[_e,Tt,Oe],components:{DialogVulnAddEdit:pa},data:()=>({expanded:[],vuln_id:"",vuln:{cwe_id:"UNKWNOWN",cwe_refs:{},impact:{confidentiality:"",integrity:"",availability:""},access:{authentication:"",complexity:"",vector:""},reflinks:[],vulnerable_products:[]},ratings:{score:0,cvssv2adj:0},threats:[],threat_headers:[{text:"Scope",value:"scope"},{text:"Link",value:"link"},{text:"Trust level",value:"trust_level"},{text:"TLP",value:"tlp_level",align:"center"},{text:"Source",value:"source",align:"center"},{text:"In the Wild ?",value:"is_in_the_wild",align:"center"},{text:"In the News ?",value:"is_in_the_news",align:"center"},{text:"Last update",value:"modified",align:"center"}],exploits:[],exploit_headers:[{text:"Scope",value:"scope"},{text:"Link",value:"link"},{text:"TLP",value:"tlp_level",align:"center"},{text:"Relevancy",value:"relevancy_level"},{text:"Trust",value:"trust_level"},{text:"Source",value:"source",align:"center"},{text:"Last update",value:"modified",align:"center"},{text:"",value:"data-table-expand"}],editedIndex:-1,editedItem:{},dialog_sendmail:!1,notification_data:{emails:""},snack:!1,snackColor:"",snackText:""}),beforeRouteUpdate(t){this.vuln_id=t.params.vuln_id},mounted(){this.vuln_id=this.$router.currentRoute.params.vuln_id,this.editedItem=this.defaultMetadata,this.getDataFromApi(this.vuln_id)},computed:{is_exploitable(){return this.vuln.is_exploitable},is_confirmed(){return this.vuln.is_confirmed},is_in_the_news(){return this.vuln.is_in_the_news},is_in_the_wild(){return this.vuln.is_in_the_wild},vprating(){return this.vuln.score},cvssv2adj(){return this.ratings.cvssv2adj},vuln_vector(){let t="";t+=this.vuln.cvss_vector,this.vuln.is_confirmed&&(t+="/CL:Y"),ie()(this.vuln.published).isValid()&&(t+="/VX:"+ie()().diff(ie()(this.vuln.published),"days"));let e,a,s,i=["unknown","private","public"],o=["X","R","U"],n=["unknown","unproven","poc","functional"],r=["X","U","P","F"],l=["unknown","low","medium","high","trusted"],c=["X","L","M","H","H"],d=0,u=0,v=0,m=0;for(let h=0;h<this.exploits.length;h++)e=i.indexOf(this.exploits[h].availability),e>d&&(d=e),a=n.indexOf(this.exploits[h].maturity),a>u&&(u=a),s=l.indexOf(this.exploits[h].trust_level),s>v&&(v=s),ie()(this.exploits[h].published).isValid()&&ie()().diff(ie()(this.exploits[h].published),"days")>m&&(m=ie()().diff(ie()(this.exploits[h].published),"days"));return t+="/EA:"+o[d],t+="/EM:"+r[u],t+="/ET:"+c[v],t+="/EX:"+m,this.is_in_the_news&&(t+="/N:Y"),this.is_in_the_wild&&(t+="/W:Y"),t}},methods:{getDataFromApi(t){return new Promise((e,a)=>{let s=this.getVulnDetails(t),i=this.getExploits(t),o=this.getThreats(t);setTimeout(()=>{this.loading=!1,e({vuln:s,exploits:i,threats:o})},300)})},getVulnDetails(t){this.loading=!0,this.$api.get("/api/public/vulns/"+t+"/").then(t=>(this.vuln=t.data,this.vuln)).catch(t=>{this.vuln={},this.loading=!1,y.a.fire({title:"Error",text:"unable to get vuln details",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}),this.loading=!1},getExploits(t){this.loading=!0,this.$api.get("/api/public/vulns/"+t+"/exploits").then(t=>(t&&200===t.status&&(this.exploits=t.data),this.exploits)).catch(t=>{this.exploits={},this.loading=!1,y.a.fire({title:"Error",text:"unable to get related exploits",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}),this.loading=!1},getThreats(t){this.loading=!0,this.$api.get("/api/public/vulns/"+t+"/threats").then(t=>(t&&200===t.status&&(this.threats=t.data),this.threats)).catch(t=>{this.threats={},this.loading=!1,y.a.fire({title:"Error",text:"unable to get related threats",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}),this.loading=!1},downloadVuln(t,e="json"){this.$api.get("/api/public/vulns/"+t+"/export/"+e,{responseType:"arraybuffer"}).then(a=>{this.forceFileDownload(a,"vuln_export_"+t+"."+e),this.snack=!0,this.snackColor="success",this.snackText="Vulnerability details available."}).catch(t=>{this.snack=!0,this.snackColor="error",this.snackText="Unable to download vulnerability details."}),this.loading=!1},loadExploit(t){this.editedIndex=this.exploits.indexOf(t),this.editedItem=Object.assign({},this.defaultMetadata),this.editedItem.id=t.id,this.editedItem.availability=t.availability,this.editedItem.link=t.link,this.editedItem.maturity=t.maturity,this.editedItem.notes=t.notes,this.editedItem.source=t.source,this.editedItem.tlp_level=t.tlp_level,this.editedItem.trust_level=t.trust_level,this.dialog_exploit=!0},loadThreat(t){this.editedIndex=this.threats.indexOf(t),this.editedItem=Object.assign({},this.defaultMetadata),this.editedItem.id=t.id,this.editedItem.link=t.link,this.editedItem.notes=t.notes,this.editedItem.source=t.source,this.editedItem.tlp_level=t.tlp_level,this.editedItem.trust_level=t.trust_level,this.editedItem.is_in_the_news=0==t.is_in_the_news?0:1,this.editedItem.is_in_the_wild=0==t.is_in_the_wild?0:1,this.dialog_threat=!0},viewRating(){this.$router.push({name:"Ratings",query:{vector:this.vuln_vector}})},toggleMetric(t){this.snack=!0,this.snackColor="error",this.snackText="Unable to change the metrics - Insufficient privileges"}}},Ci=wi,Vi=(a("5e09"),Object(l["a"])(Ci,xi,yi,!1,null,null,null)),Si=Vi.exports;d()(Vi,{VBadge:Ze["a"],VBtn:V["a"],VCard:S["a"],VCardText:T["d"],VCardTitle:T["e"],VChip:Z["a"],VCol:le["a"],VContainer:P["a"],VDataTable:zt["a"],VFlex:E["a"],VIcon:et["a"],VLayout:A["a"],VList:at["a"],VListItem:it["a"],VListItemContent:nt["g"],VListItemSubtitle:nt["j"],VRow:de["a"],VSnackbar:M["a"],VSwitch:ue["a"],VTab:Ie["a"],VTabItem:Pe["a"],VTabs:Ee["a"]});var Ti=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-card",[a("v-card-title",[t._v(" Exploits metadata "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers,items:t.exploits.results,options:t.options,"server-items-length":t.exploits.count,search:t.search,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"id"},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.vp",fn:function(e){var s=e.item;return[a("span",[t._v(t._s(t.getVendorProduct(s.vp)))])]}},{key:"item.updated_at",fn:function(e){var s=e.item;return[a("span",[t._v(t._s(t.moment(s.updated_at).format("YYYY-MM-DD")))])]}},{key:"item.action",fn:function(e){var s=e.item;return[a("v-icon",{staticClass:"mdi mdi-eye",attrs:{small:"",color:"blue"},on:{click:function(e){return t.viewVuln(s.vuln_id)}}})]}}])}),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1)},Ii=[],Pi={name:"exploits",data:()=>({exploits:[],loading:!0,limit:20,only_monitored:!1,search:"",options:{},selected:[],headers:[{text:"Link",value:"link"},{text:"Products",value:"vp",sortable:!1},{text:"Last update",value:"updated_at"},{text:"Actions",value:"action",sortable:!1}],rowsPerPageItems:[5,10,20,50,100],snack:!1,snackColor:"",snackText:""}),watch:{search:$t.a.debounce((function(t){this.search=t,this.options.page=1,this.getDataFromApi()}),500),only_monitored:{handler(){this.getDataFromApi()},deep:!0},options:{handler(){this.getDataFromApi()},deep:!0}},methods:{getDataFromApi(){return this.loading=!0,new Promise((t,e)=>{const{sortBy:a,sortDesc:s,page:i,itemsPerPage:o}=this.options;this.limit=o;let n=this.getExploits(i,this.limit,a,s);setTimeout(()=>{t({items:n})},300)})},getExploits(t,e,a,s){let i="";a.length>0&&(i=!0===s[0]?"&sorted_by=-"+a:"&sorted_by="+a),this.$api.get("/api/exploits?limit="+e+"&page="+t+"&search="+this.search+i).then(t=>(this.loading=!1,this.exploits=t.data,this.exploits)).catch(t=>{this.exploits=[],y.a.fire({title:"Error",text:"Unable to get exploits",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})},viewVuln(t){this.$router.push({path:"/vulns/"+t})},getVendorProduct(t){if(null==t)return"";var e,a,s=Array();for(e of t)a=e.split(":")[4].replace(/_/g," ")+" ("+e.split(":")[3].replace(/_/g," ")+")",s.push(a);return s=[...new Set(s)],s.join(", ")}}},Ei=Pi,$i=Object(l["a"])(Ei,Ti,Ii,!1,null,null,null),Ai=$i.exports;d()($i,{VBtn:V["a"],VCard:S["a"],VCardTitle:T["e"],VDataTable:zt["a"],VIcon:et["a"],VSnackbar:M["a"],VSpacer:B["a"],VTextField:O["a"]});var Di=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[!0===t.loading?a("div",{staticClass:"loading"},[t._v("Loading…")]):t._e(),a("v-card",[a("v-card-title",[t._v(" Vendors "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers,items:t.vendors.results,options:t.options,"server-items-length":t.vendors.count,search:t.search,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"vendor","show-select":""},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.actions",fn:function(e){var s=e.item;return[a("v-icon",{staticClass:"mdi mdi-eye",attrs:{small:"",color:"blue"},on:{click:function(e){return t.viewProducts(s.vendor)}}})]}},{key:"item.monitored",fn:function(e){var s=e.item;return[s.monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:function(e){return t.toggleMonitored(s)}}},[t._v("Yes")]):t._e(),s.monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:function(e){return t.toggleMonitored(s)}}},[t._v("No")])]}}])}),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1)},Mi=[],Bi={name:"vendors",data:()=>({vendors:[],totalvendors:0,loading:!0,limit:20,search:"",options:{},selected:[],headers:[{text:"Vendor",value:"vendor"},{text:"Actions",value:"actions"}],rowsPerPageItems:[5,10,20,50,100]}),mounted(){},watch:{search:{handler(t){this.search=t,this.options.page=1,this.getDataFromApi().then(t=>{})},deep:!0},options:{handler(){this.getDataFromApi().then(t=>{})},deep:!0}},methods:{getDataFromApi(){return this.loading=!0,new Promise((t,e)=>{const{sortBy:a,sortDesc:s,page:i,itemsPerPage:o}=this.options;this.search.trim().toLowerCase();this.limit=o;let n=this.getvendors(i,this.limit,a,s);setTimeout(()=>{this.loading=!1,t({items:n})},300)})},getvendors(t,e,a,s){this.loading=!0;let i="";a.length>0&&(i=!0===s[0]?"sorted_by=-"+a:"sorted_by="+a),this.$api.get("/api/kb/vendors?limit="+e+"&page="+t+"&vendor__icontains="+this.search+"&"+i).then(t=>(this.vendors=t.data,this.vendors)).catch(t=>{this.vendors=[],this.loading=!1,y.a.fire({title:"Error",text:"unable to get vendors",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}),this.loading=!1},viewProducts(t){this.$router.push({name:"KBProductVersions",params:{vendor_name:t}})}}},Oi=Bi,ji=Object(l["a"])(Oi,Di,Mi,!1,null,null,null);ji.exports;d()(ji,{VBtn:V["a"],VCard:S["a"],VCardTitle:T["e"],VChip:Z["a"],VDataTable:zt["a"],VIcon:et["a"],VSnackbar:M["a"],VSpacer:B["a"],VTextField:O["a"]});var Ui=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-card",[a("v-card-title",[a("v-container",[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"pa-2",attrs:{md:"auto"}},[t._v(" Products ")]),a("v-col",{staticClass:"pa-2"},[this.only_monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:t.toggleProductMonitored}},[t._v("Show all")]):t._e(),this.only_monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:t.toggleProductMonitored}},[t._v("Show monitored only")])],1),a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)],1),a("v-spacer")],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers,items:t.products.results,options:t.options,"server-items-length":t.products.count,search:t.search,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"items-per-page":t.rowsPerPage,"item-key":"item","show-select":""},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.monitored",fn:function(e){var s=e.item;return[s.monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:function(e){return t.toggleMonitored(s)}}},[t._v("Yes")]):t._e(),s.monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:function(e){return t.toggleMonitored(s)}}},[t._v("No")])]}},{key:"item.updated_at",fn:function(e){var s=e.item;return[a("span",[t._v(t._s(t.moment(s.updated_at).format("YYYY-MM-DD")))])]}},{key:"item.action",fn:function(e){var s=e.item;return[a("v-icon",{staticClass:"mdi mdi-eye",attrs:{small:"",color:"blue"},on:{click:function(e){return t.viewProduct(s.id)}}})]}}])}),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1)},Fi=[],Li={name:"products",data:()=>({products:[],loading:!0,limit:20,totalproducts:0,only_monitored:!1,search:"",options:{},selected:[],headers:[{text:"Vendor",value:"vendor"},{text:"Product",value:"name"},{text:"Monitored",value:"monitored",align:"center",sortable:!1},{text:"Last update",value:"updated_at"},{text:"Actions",value:"action",sortable:!1}],rowsPerPageItems:[5,10,20,50,100],rowsPerPage:10,snack:!1,snackColor:"",snackText:""}),mounted(){},watch:{search:$t.a.debounce((function(t){this.search=t,this.options.page=1,this.getDataFromApi()}),500),only_monitored:{handler(){this.getDataFromApi()},deep:!0},options:{handler(){this.getDataFromApi()},deep:!0}},methods:{getDataFromApi(){return this.loading=!0,new Promise((t,e)=>{const{sortBy:a,sortDesc:s,page:i,itemsPerPage:o}=this.options;this.limit=o;let n=this.getProducts(i,this.limit,a,s);setTimeout(()=>{t({items:n})},300)})},getProducts(t,e,a,s){let i="";a.length>0&&(i=!0===s[0]?"&sorted_by=-"+a:"&sorted_by="+a);let o=this.only_monitored?"&monitored=true":"";this.$api.get("/api/kb/products/?limit="+e+"&page="+t+"&search="+this.search+i+o).then(t=>(this.loading=!1,this.products=t.data,this.products)).catch(t=>{this.products=[],y.a.fire({title:"Error",text:"unable to get products",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})},toggleMonitored(t){let e={vendor_name:t.vendor,product_name:t.name,monitored:!t.monitored,organization_id:localStorage.getItem("org_id")};this.$api.post("/api/monitor/product/toggle",e).then(e=>{this.loading=!1,e?(t.monitored=!t.monitored,this.snack=!0,this.snackColor="success",this.snackText="Monitoring status successfuly updated."):(this.snack=!0,this.snackColor="error",this.snackText="Unable to change the monitoring status")}).catch(t=>{this.loading=!1,y.a.fire({title:"Error",text:"Unable to change the monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:2e3})})},toggleProductMonitored(){this.only_monitored=!this.only_monitored},viewProduct(t){this.$router.push({path:"/product/"+t})}}},Ni=Li,Ri=Object(l["a"])(Ni,Ui,Fi,!1,null,null,null),Yi=Ri.exports;d()(Ri,{VBtn:V["a"],VCard:S["a"],VCardTitle:T["e"],VChip:Z["a"],VCol:le["a"],VContainer:P["a"],VDataTable:zt["a"],VIcon:et["a"],VRow:de["a"],VSnackbar:M["a"],VSpacer:B["a"],VTextField:O["a"]});var zi=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md4:""}},[a("v-card",{attrs:{color:"deep-orange"}},[a("v-card-title",[t._v("Vulnerabilities")]),a("v-card-subtitle",{attrs:{primary:""}},[t._v("CVE, 0days, ...")]),a("v-card-text",{staticClass:"display-2 text-center"},[t._v(" "+t._s(t.stats.vulns.count)+" ")])],1),a("v-card",{staticClass:"mt-1",attrs:{elevation:"0"}},[a("v-card-text",{staticClass:"display-1 text-center"},[a("v-chip",{staticClass:"mx-1",attrs:{color:"deep-orange","text-color":"white"}},[t._v(" Exploitable "),a("v-avatar",{staticClass:"white black--text font-weight-bold",attrs:{right:""}},[t._v(" "+t._s(t.stats.vulns.exploitable)+" ")])],1),a("v-chip",{staticClass:"mx-1",attrs:{color:"deep-orange","text-color":"white"}},[t._v(" Remote "),a("v-avatar",{staticClass:"white black--text font-weight-bold",attrs:{right:""}},[t._v(" "+t._s(t.stats.vulns.remote)+" ")])],1)],1)],1)],1),a("v-flex",{attrs:{md4:""}},[a("v-card",{attrs:{color:"lime"}},[a("v-card-title",{attrs:{primary:""}},[t._v("Metadata")]),a("v-card-subtitle",{attrs:{primary:""}},[t._v("Exploits, Threats activities, News, Blog posts")]),a("v-card-text",{staticClass:"display-2 text-center"},[t._v(" "+t._s(t.stats.metadata.count)+" ")])],1),a("v-card",{staticClass:"mt-1",attrs:{elevation:"0"}},[a("v-card-text",{staticClass:"display-1 text-center"},[a("v-chip",{staticClass:"mx-1",attrs:{color:"lime","text-color":"black"}},[t._v(" Exploits "),a("v-avatar",{staticClass:"white black--text font-weight-bold",attrs:{right:""}},[t._v(" "+t._s(t.stats.metadata.exploits)+" ")])],1),a("v-chip",{staticClass:"mx-1",attrs:{color:"lime","text-color":"black"}},[t._v(" Threat "),a("v-avatar",{staticClass:"white black--text font-weight-bold",attrs:{right:""}},[t._v(" "+t._s(t.stats.metadata.threats)+" ")])],1)],1)],1)],1),a("v-flex",{attrs:{md4:""}},[a("v-card",{attrs:{color:"teal"}},[a("v-card-title",{attrs:{primary:""}},[t._v("Monitored items")]),a("v-card-subtitle",{attrs:{primary:""}},[t._v("Vendors, Products, Vulnerabilites, Bulletins")]),a("v-card-text",{staticClass:"display-2 text-center"},[t._v(" "+t._s(t.stats.monitored.count)+" ")])],1),a("v-card",{staticClass:"mt-1",attrs:{elevation:"0"}},[a("v-card-text",{staticClass:"display-1 text-center"},[a("v-chip",{staticClass:"mx-1",attrs:{color:"teal","text-color":"black"}},[t._v(" Vendors "),a("v-avatar",{staticClass:"white black--text font-weight-bold",attrs:{right:""}},[t._v(" "+t._s(t.stats.monitored.vendors)+" ")])],1),a("v-chip",{staticClass:"mx-1",attrs:{color:"teal","text-color":"black"}},[t._v(" Products "),a("v-avatar",{staticClass:"white black--text font-weight-bold",attrs:{right:""}},[t._v(" "+t._s(t.stats.monitored.products)+" ")])],1),a("v-chip",{staticClass:"mx-1",attrs:{color:"teal","text-color":"black"}},[t._v(" Packages "),a("v-avatar",{staticClass:"white black--text font-weight-bold",attrs:{right:""}},[t._v(" "+t._s(t.stats.monitored.packages)+" ")])],1),a("v-chip",{staticClass:"mx-1",attrs:{color:"teal","text-color":"black"}},[t._v(" Vulnerabilities "),a("v-avatar",{staticClass:"white black--text font-weight-bold",attrs:{right:""}},[t._v(" "+t._s(t.stats.monitored.vulnerabilities)+" ")])],1)],1)],1)],1)],1)],1),a("v-tabs",{attrs:{left:"","background-color":"white",color:"deep-orange accent-4"}},[a("v-tab",[t._v("Vendors")]),a("v-tab",[t._v("Products")]),a("v-tab",[t._v("Packages")]),a("v-tab",[t._v("Vulns")]),a("v-tab-item",[a("v-card",[a("v-card-title",[a("v-container",[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"pa-2 mr-4",attrs:{md:"auto"}},[t._v(" Monitored Vendors "),a("v-menu",{attrs:{bottom:"",right:"","offset-x":!0},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,i=e.attrs;return[a("v-btn",t._g(t._b({attrs:{icon:"",outlined:"","x-small":"",color:"deep-orange"}},"v-btn",i,!1),s),[a("v-icon",[t._v("mdi-dots-horizontal")])],1)]}}])},[a("v-list",[a("v-list-item",{on:{click:function(e){return t.goToPage("/vendors")}}},[a("v-list-item-title",[t._v("Add new vendors")])],1),a("v-list-item",[a("v-list-item-title",[a("input",{attrs:{type:"button",id:"import_monitored",value:"Import monitored",onclick:"document.getElementById('file').click();"}}),a("input",{ref:"upload",staticStyle:{display:"none"},attrs:{id:"file",type:"file",name:"file-upload",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"},on:{change:t.onImportFileChange}})])],1),a("v-list-item",{on:{click:function(e){return t.exportMonitored("vendors")}}},[a("v-list-item-title",[t._v("Export monitored Vendors")])],1),a("v-list-item",{on:{click:function(e){return t.exportMonitored("all")}}},[a("v-list-item-title",[t._v("Export all monitored")])],1)],1)],1)],1),a("v-text-field",{staticClass:"pt-0",attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":"",md:"6"},model:{value:t.search_vendors,callback:function(e){t.search_vendors=e},expression:"search_vendors"}})],1)],1),a("v-spacer")],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers_vendors,items:t.vendors.results,options:t.options_vendors,"server-items-length":t.vendors.count,search:t.search_vendors,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"items-per-page":t.rowsPerPage,"item-key":"name","show-select":""},on:{"update:options":function(e){t.options_vendors=e}},scopedSlots:t._u([{key:"item.products_count",fn:function(e){var s=e.item;return[a("v-chip",{attrs:{small:"",color:"lightgrey"}},[t._v(t._s(s.products_count))])]}},{key:"item.updated_at",fn:function(e){var s=e.item;return[a("span",[t._v(t._s(t.moment(s.updated_at).format("YYYY-MM-DD")))])]}},{key:"item.action",fn:function(e){var s=e.item;return[a("v-icon",{staticClass:"mdi mdi-eye",attrs:{color:"blue",title:"View details"},on:{click:function(e){return t.viewVendor(s.id)}}}),a("v-icon",{staticClass:"mdi mdi-delete",attrs:{color:"red",title:"Remove from monitoring"},on:{click:function(e){return t.removeVendor(s)}}})]}}])}),a("v-btn",{attrs:{absolute:"",dark:"",fab:"",bottom:"",left:"",color:"deep-orange"},on:{click:function(e){return t.goToPage("/vendors")}}},[a("v-icon",[t._v("mdi-plus")])],1),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1),a("v-tab-item",[a("v-card",[a("v-card-title",[a("v-container",[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"pa-2 mr-4",attrs:{md:"auto"}},[t._v(" Monitored Products "),a("v-menu",{attrs:{bottom:"",right:"","offset-x":!0},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,i=e.attrs;return[a("v-btn",t._g(t._b({attrs:{icon:"",outlined:"","x-small":"",color:"deep-orange"}},"v-btn",i,!1),s),[a("v-icon",[t._v("mdi-dots-horizontal")])],1)]}}])},[a("v-list",[a("v-list-item",{on:{click:function(e){return t.goToPage("/vendors")}}},[a("v-list-item-title",[t._v("Add new product(s)")])],1),a("v-list-item",[a("v-list-item-title",[a("input",{attrs:{type:"button",id:"import_monitored",value:"Import monitored",onclick:"document.getElementById('file').click();"}}),a("input",{ref:"upload",staticStyle:{display:"none"},attrs:{id:"file",type:"file",name:"file-upload",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"},on:{change:t.onImportFileChange}})])],1),a("v-list-item",{on:{click:function(e){return t.exportMonitored("products")}}},[a("v-list-item-title",[t._v("Export monitored Products")])],1),a("v-list-item",{on:{click:function(e){return t.exportMonitored("all")}}},[a("v-list-item-title",[t._v("Export all monitored")])],1)],1)],1)],1),a("v-text-field",{staticClass:"pt-0",attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search_products,callback:function(e){t.search_products=e},expression:"search_products"}})],1)],1),a("v-spacer")],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers_products,items:t.products.results,options:t.options_products,"server-items-length":t.products.count,search:t.search_products,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"items-per-page":t.rowsPerPage,"item-key":"id","show-select":""},on:{"update:options":function(e){t.options_products=e}},scopedSlots:t._u([{key:"item.updated_at",fn:function(e){var s=e.item;return[a("span",[t._v(t._s(t.moment(s.updated_at).format("YYYY-MM-DD")))])]}},{key:"item.action",fn:function(e){var s=e.item;return[a("v-icon",{staticClass:"mdi mdi-eye",attrs:{color:"blue"},on:{click:function(e){return t.viewProduct(s.id)}}}),a("v-icon",{staticClass:"mdi mdi-delete",attrs:{color:"red",title:"Remove from monitoring"},on:{click:function(e){return t.removeProduct(s)}}})]}}])}),a("v-btn",{attrs:{absolute:"",dark:"",fab:"",bottom:"",left:"",color:"deep-orange"},on:{click:function(e){return t.goToPage("/vendors")}}},[a("v-icon",[t._v("mdi-plus")])],1),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1),a("v-tab-item",[a("v-card",[a("v-card-title",[a("v-container",[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"pa-2 mr-4",attrs:{md:"auto"}},[t._v(" Monitored Packages "),a("v-menu",{attrs:{bottom:"",right:"","offset-x":!0},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,i=e.attrs;return[a("v-btn",t._g(t._b({attrs:{icon:"",outlined:"","x-small":"",color:"deep-orange"}},"v-btn",i,!1),s),[a("v-icon",[t._v("mdi-dots-horizontal")])],1)]}}])},[a("v-list",[a("v-list-item",{on:{click:function(e){return t.goToPage("/packages")}}},[a("v-list-item-title",[t._v("Add new package(s)")])],1),a("v-list-item",[a("v-list-item-title",[a("input",{attrs:{type:"button",id:"import_monitored",value:"Import monitored",onclick:"document.getElementById('file').click();"}}),a("input",{ref:"upload",staticStyle:{display:"none"},attrs:{id:"file",type:"file",name:"file-upload",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"},on:{change:t.onImportFileChange}})])],1),a("v-list-item",{on:{click:function(e){return t.exportMonitored("packages")}}},[a("v-list-item-title",[t._v("Export monitored Packages")])],1),a("v-list-item",{on:{click:function(e){return t.exportMonitored("all")}}},[a("v-list-item-title",[t._v("Export all monitored")])],1)],1)],1)],1),a("v-text-field",{staticClass:"pt-0",attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search_packages,callback:function(e){t.search_packages=e},expression:"search_packages"}})],1)],1),a("v-spacer")],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers_packages,items:t.packages.results,options:t.options_packages,"server-items-length":t.packages.count,search:t.search_packages,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"items-per-page":t.rowsPerPage,"item-key":"id","show-select":""},on:{"update:options":function(e){t.options_packages=e}},scopedSlots:t._u([{key:"item.updated_at",fn:function(e){var s=e.item;return[a("span",[t._v(t._s(t.moment(s.updated_at).format("YYYY-MM-DD")))])]}},{key:"item.action",fn:function(e){var s=e.item;return[a("v-icon",{staticClass:"mdi mdi-eye",attrs:{color:"blue"},on:{click:function(e){return t.viewPackage(s.id)}}}),a("v-icon",{staticClass:"mdi mdi-delete",attrs:{color:"red",title:"Remove from monitoring"},on:{click:function(e){return t.removePackage(s)}}})]}}])}),a("v-btn",{attrs:{absolute:"",dark:"",fab:"",bottom:"",left:"",color:"deep-orange"},on:{click:function(e){return t.goToPage("/packages")}}},[a("v-icon",[t._v("mdi-plus")])],1),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1),a("v-tab-item",[a("v-card",[a("v-card-title",[a("v-container",[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"pa-2 mr-4",attrs:{md:"auto"}},[t._v(" Monitored Vulns "),a("v-menu",{attrs:{bottom:"",right:"","offset-x":!0},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,i=e.attrs;return[a("v-btn",t._g(t._b({attrs:{icon:"",outlined:"","x-small":"",color:"deep-orange"}},"v-btn",i,!1),s),[a("v-icon",[t._v("mdi-dots-horizontal")])],1)]}}])},[a("v-list",[a("v-list-item",{on:{click:function(e){return t.goToPage("/vulns")}}},[a("v-list-item-title",[t._v("Add new vuln(s)")])],1),a("v-list-item",[a("v-list-item-title",[a("input",{attrs:{type:"button",id:"import_monitored",value:"Import monitored",onclick:"document.getElementById('file').click();"}}),a("input",{ref:"upload",staticStyle:{display:"none"},attrs:{id:"file",type:"file",name:"file-upload",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"},on:{change:t.onImportFileChange}})])],1),a("v-list-item",{on:{click:function(e){return t.exportMonitored("vulns")}}},[a("v-list-item-title",[t._v("Export monitored Vulns")])],1),a("v-list-item",{on:{click:function(e){return t.exportMonitored("all")}}},[a("v-list-item-title",[t._v("Export all monitored")])],1)],1)],1)],1),a("v-text-field",{staticClass:"pt-0",attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search_vulns,callback:function(e){t.search_vulns=e},expression:"search_vulns"}})],1)],1),a("v-spacer")],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers_vulns,items:t.vulns.results,options:t.options_vulns,"server-items-length":t.vulns.count,search:t.search_vulns,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"items-per-page":t.rowsPerPage,"item-key":"item","show-select":""},on:{"update:options":function(e){t.options_vulns=e}},scopedSlots:t._u([{key:"item.score",fn:function(e){var s=e.item;return[a("v-chip",{staticClass:"text-center font-weight-bold",attrs:{color:t.getRatingColor(s.score),label:""}},[t._v(t._s(s.score)+"/100")]),a("br"),a("span",{staticClass:"text-caption"},[t._v("CVSSv2: "+t._s(s.cvss))]),a("br"),a("span",{staticClass:"text-caption"},[t._v("CVSSv3: "+t._s(s.cvss3))])]}},{key:"item.summary",fn:function(e){var s=e.item;return[a("div",{staticClass:"py-2"},[a("div",{staticClass:"pb-2"},[a("span",{staticClass:"deep-orange--text font-weight-medium"},[t._v(t._s(s.cveid))]),t._v(" / PH-"+t._s(s.id)+" "),a("v-btn",{attrs:{color:"deep-orange",icon:"",small:""}},[a("v-icon",{attrs:{title:"View details"},on:{click:function(e){return t.viewVuln(s.id)}}},[t._v("mdi-arrow-right-bold-circle-outline")])],1),a("v-btn",{attrs:{color:"deep-orange",icon:"",small:""}},[a("v-icon",{attrs:{title:"Remove from monitoring details"},on:{click:function(e){return t.removeVuln(s)}}},[t._v("mdi-delete")])],1)],1),a("div",[t._v(" "+t._s(s.summary)+" ")]),t._l(s.products,(function(e){return a("v-chip",{key:e.id,staticClass:"vendor-chip",attrs:{label:"",small:"",link:""},on:{click:function(a){return t.$router.push({path:"/product/"+e.id})}}},[t._v(" "+t._s(e.vendor)+": "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(e.name))])])}))],2)]}},{key:"item.metadata",fn:function(e){var s=e.item;return[a("v-chip",{staticClass:"font-weight-bold",attrs:{label:"",link:"",small:"",color:s.exploit_count>0?"deep-orange":"grey",title:"Is exploitable?"}},[t._v(t._s(s.exploit_count))]),a("v-btn",{attrs:{color:"NETWORK"==s.access.vector?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Is exploitable remotely?"}},[t._v("mdi-cloud")])],1),a("v-btn",{attrs:{color:"NONE"==s.access.authentication?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Require authentication?"}},[t._v("mdi-shield-account")])],1),a("v-btn",{attrs:{color:s.is_in_the_news||s.is_in_the_wild?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Is in the news or exploited in the wild?"}},[t._v("mdi-star")])],1)]}},{key:"item.updated_at",fn:function(e){var s=e.item;return[a("span",[t._v(t._s(t.moment(s.updated_at).format("YYYY-MM-DD, hh:mm")))])]}}])}),a("v-btn",{attrs:{absolute:"",dark:"",fab:"",bottom:"",left:"",color:"deep-orange"},on:{click:function(e){return t.goToPage("/vulns")}}},[a("v-icon",[t._v("mdi-plus")])],1),a("v-snackbar",{attrs:{timeout:t.snackTimeout,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1)],1)],1)},Xi=[],Hi={name:"Monitoring",mixins:[Tt,Oe],data:()=>({stats:{vulns:{count:"",exploitable:"",remote:""},metadata:{exploits:"",threats:""},monitored:{vendors:"",products:"",packages:"",vulnerabilities:""}},loading_stats:!0,vendors:[],products:[],packages:[],vulns:[],loading:!0,limit:20,search_vendors:"",search_products:"",search_packages:"",search_vulns:"",options_vendors:{},options_products:{},options_packages:{},options_vulns:{},headers_vendors:[{text:"Vendor",value:"name"},{text:"# Products",value:"products_count",align:"center",sortable:!1},{text:"Last update",value:"updated_at"},{text:"Actions",value:"action",sortable:!1}],headers_products:[{text:"Vendor",value:"vendor"},{text:"Product",value:"name"},{text:"Last update",value:"updated_at"},{text:"Actions",value:"action",sortable:!1}],headers_packages:[{text:"Type",value:"type"},{text:"Package",value:"name"},{text:"Last update",value:"updated_at"},{text:"Actions",value:"action",sortable:!1}],headers_vulns:[{text:"Score",value:"score",align:"center",width:"10%"},{text:"Summary",value:"summary"},{text:"Metadata",value:"metadata",align:"center",width:"8%",sortable:!1},{text:"Last update",value:"updated_at",align:"center",width:"12%"}],rowsPerPageItems:[5,10,20,50,100],rowsPerPage:10,snack:!1,snackColor:"",snackText:"",snackTimeout:3e3}),mounted(){this.getMonitoredStats()},watch:{search_vendors:$t.a.debounce((function(t){this.search_vendors=t,this.options_vendors.page=1,this.getDataVendors()}),500),search_products:$t.a.debounce((function(t){this.search_products=t,this.options_products.page=1,this.getDataProducts()}),500),search_packages:$t.a.debounce((function(t){this.search_packages=t,this.options_packages.page=1,this.getDataPackages()}),500),search_vulns:$t.a.debounce((function(t){this.search_vulns=t,this.options_vulns.page=1,this.getDataVulns()}),500),options_vendors:{handler(){this.getDataVendors()},deep:!0},options_products:{handler(){this.getDataProducts()},deep:!0},options_packages:{handler(){this.getDataPackages()},deep:!0},options_vulns:{handler(){this.getDataVulns()},deep:!0}},methods:{getDataVendors(){return this.loading=!0,new Promise((t,e)=>{const{sortBy:a,sortDesc:s,page:i,itemsPerPage:o}=this.options_vendors;this.limit=o;let n=this.getVendors(i,this.limit,a,s);setTimeout(()=>{t({items:n})},300)})},getDataProducts(){return this.loading=!0,new Promise((t,e)=>{const{sortBy:a,sortDesc:s,page:i,itemsPerPage:o}=this.options_products;this.limit=o;let n=this.getProducts(i,this.limit,a,s);setTimeout(()=>{t({items:n})},300)})},getDataPackages(){return this.loading=!0,new Promise((t,e)=>{const{sortBy:a,sortDesc:s,page:i,itemsPerPage:o}=this.options_packages;this.limit=o;let n=this.getPackages(i,this.limit,a,s);setTimeout(()=>{t({items:n})},300)})},getDataVulns(){return this.loading=!0,new Promise((t,e)=>{const{sortBy:a,sortDesc:s,page:i,itemsPerPage:o}=this.options_vulns;this.limit=o;let n=this.getVulns(i,this.limit,a,s);setTimeout(()=>{t({items:n})},300)})},getVendors(t,e,a,s){let i="";a.length>0&&(i=!0===s[0]?"&sorted_by=-"+a:"&sorted_by="+a),this.$api.get("/api/kb/vendors/?monitored=true&limit="+e+"&page="+t+"&search="+this.search_vendors+i).then(t=>(this.loading=!1,this.vendors=t.data,this.products)).catch(t=>{this.vendors=[],y.a.fire({title:"Error",text:"unable to get vendors",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})},getProducts(t,e,a,s){let i="";a.length>0&&(i=!0===s[0]?"&sorted_by=-"+a:"&sorted_by="+a),this.$api.get("/api/kb/products/?monitored=true&limit="+e+"&page="+t+"&search="+this.search_products+i).then(t=>(this.loading=!1,this.products=t.data,this.products)).catch(t=>{this.products=[],y.a.fire({title:"Error",text:"unable to get products",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})},getPackages(t,e,a,s){let i="";a.length>0&&(i=!0===s[0]?"&sorted_by=-"+a:"&sorted_by="+a),this.$api.get("/api/kb/packages/?monitored=true&limit="+e+"&page="+t+"&name="+this.search_packages+i).then(t=>(this.loading=!1,this.packages=t.data,this.packages)).catch(t=>{this.packages=[],y.a.fire({title:"Error",text:"Unable to get packages",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})},getVulns(t,e,a,s){let i="";a.length>0&&(i=!0===s[0]?"&sorted_by=-"+a:"&sorted_by="+a),this.$api.get("/api/vulns/?monitored=true&limit="+e+"&page="+t+"&search="+this.search_products+i).then(t=>(this.loading=!1,this.vulns=t.data,this.vulns)).catch(t=>{this.vulns=[],y.a.fire({title:"Error",text:"unable to get vulns",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})},viewVendor(t){this.$router.push({path:"/vendor/"+t})},removeVendor(t){let e={vendor_name:t.name,monitored:!1,organization_id:localStorage.getItem("org_id")};this.$api.post("/api/monitor/vendor/toggle",e).then(e=>{this.loading=!1,e?(t.monitored=!t.monitored,this.snack=!0,this.snackColor="success",this.snackText="Monitoring status successfuly updated.",this.options_vendors.page=1,this.getDataVendors(),this.getMonitoredStats()):(this.snack=!0,this.snackColor="error",this.snackText="Unable to change the monitoring status")}).catch(t=>{this.loading=!1,y.a.fire({title:"Error",text:"Unable to change the monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:2e3})})},viewProduct(t){this.$router.push({path:"/product/"+t})},removeProduct(t){let e={vendor_name:t.vendor,product_name:t.name,monitored:!1,organization_id:localStorage.getItem("org_id")};this.$api.post("/api/monitor/product/toggle",e).then(e=>{this.loading=!1,e?(t.monitored=!t.monitored,this.snack=!0,this.snackColor="success",this.snackText="Monitoring status successfuly updated.",this.getDataProducts(),this.getMonitoredStats()):(this.snack=!0,this.snackColor="error",this.snackText="Unable to change the monitoring status")}).catch(t=>{this.loading=!1,y.a.fire({title:"Error",text:"Unable to change the monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:2e3})})},viewPackage(t){this.$router.push({path:"/packages/"+t})},removePackage(t){let e={package_id:t.id,monitored:!1,organization_id:localStorage.getItem("org_id")};this.$api.post("/api/monitor/package/toggle",e).then(e=>{this.loading=!1,e?(t.monitored=!t.monitored,this.snack=!0,this.snackColor="success",this.snackText="Monitoring status successfuly updated.",this.getDataPackages(),this.getMonitoredStats()):(this.snack=!0,this.snackColor="error",this.snackText="Unable to change the monitoring status")}).catch(t=>{this.loading=!1,y.a.fire({title:"Error",text:"Unable to change the monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:2e3})})},viewVuln(t){this.$router.push({path:"/vulns/"+t})},removeVuln(t){let e={monitored:!1,vuln_id:t.id,organization_id:localStorage.getItem("org_id")};this.$api.put("/api/vulns/"+t.id+"/toggle",e).then(e=>{e?(t.monitored=!t.monitored,this.snack=!0,this.snackColor="success",this.snackText="Vulnerability monitoring successfuly updated.",this.getDataVulns(),this.getMonitoredStats()):(this.snack=!0,this.snackColor="error",this.snackText="Unable to change the vulnerability monitoring status")}).catch(t=>{this.loading=!1,y.a.fire({title:"Error",text:"Unable to change the vulnerability monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})},goToPage(t){this.$router.push({path:t})},exportMonitored(t){this.snack=!0,this.snackColor="warning",this.snackText="Preparing export...",this.$api.get("/api/monitor/export/"+t).then(e=>{this.forceFileDownload(e,"ph_export_monitored_"+t+".csv"),this.snack=!0,this.snackColor="success",this.snackText="Monitored assets successfuly exported"}).catch(t=>{this.snack=!0,this.snackColor="error",this.snackText="Unable to export monitored assets"})},onImportFileChange(t){var e=t.target.files||t.dataTransfer.files;if(!e.length)return;const a=new FormData;a.append("file",e[0]),this.snack=!0,this.snackColor="warning",this.snackText="Importing...",this.$api.post("/api/monitor/import",a).then(t=>{this.snack=!0,this.snackColor="success",this.snackText="Monitored assets successfuly uploaded",this.options_vendors.page=1}).catch(t=>{this.snack=!0,this.snackColor="error",this.snackText="Unable to import monitored assets"})},async getMonitoredStats(){await this.$api.get("/api/vulns/stats/monitored").then(t=>{t&&200===t.status&&(this.stats=t.data,this.loading_stats=!1)}).catch(t=>{this.snack=!0,this.snackColor="error",this.snackText="Unable to get stats."})}}},Wi=Hi,qi=(a("3c0c"),a("8212")),Ji=Object(l["a"])(Wi,zi,Xi,!1,null,null,null),Ki=Ji.exports;d()(Ji,{VAvatar:qi["a"],VBtn:V["a"],VCard:S["a"],VCardSubtitle:T["c"],VCardText:T["d"],VCardTitle:T["e"],VChip:Z["a"],VCol:le["a"],VContainer:P["a"],VDataTable:zt["a"],VFlex:E["a"],VIcon:et["a"],VLayout:A["a"],VList:at["a"],VListItem:it["a"],VListItemTitle:nt["k"],VMenu:xt["a"],VRow:de["a"],VSnackbar:M["a"],VSpacer:B["a"],VTab:Ie["a"],VTabItem:Pe["a"],VTabs:Ee["a"],VTextField:O["a"]});var Gi=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-tabs",{attrs:{left:"","background-color":"white",color:"deep-orange accent-4"}},[a("v-tab",[t._v("By Vendors")]),a("v-tab",[t._v("By Products")]),a("v-tab-item",[a("v-card",[a("v-card-title",[a("v-container",[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"pa-2",attrs:{md:"auto"}},[t._v(" Vendors ")]),a("v-col",{staticClass:"pa-2"},[this.only_monitored_vendors?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:t.toggleVendorMonitored}},[t._v("Show all")]):t._e(),this.only_monitored_vendors?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:t.toggleVendorMonitored}},[t._v("Show monitored only")])],1),a("v-text-field",{staticClass:"pt-0",attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search_vendors,callback:function(e){t.search_vendors=e},expression:"search_vendors"}})],1)],1),a("v-spacer")],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers_vendors,items:t.vendors.results,options:t.options_vendors,"server-items-length":t.vendors.count,search:t.search_vendors,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"items-per-page":t.rowsPerPage},on:{"update:options":function(e){t.options_vendors=e}},scopedSlots:t._u([{key:"item.products_count",fn:function(e){var s=e.item;return[a("v-chip",{attrs:{small:"",color:"lightgrey"}},[t._v(t._s(s.products_count))])]}},{key:"item.monitored",fn:function(e){var s=e.item;return[s.monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:function(e){return t.toggleMonitoredVendor(s)}}},[t._v("Yes")]):t._e(),s.monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:function(e){return t.toggleMonitoredVendor(s)}}},[t._v("No")])]}},{key:"item.updated_at",fn:function(e){var s=e.item;return[a("span",[t._v(t._s(t.moment(s.updated_at).format("YYYY-MM-DD")))])]}},{key:"item.action",fn:function(e){var s=e.item;return[a("v-icon",{staticClass:"mdi mdi-eye",attrs:{small:"",color:"blue"},on:{click:function(e){return t.viewVendor(s.id)}}})]}}])}),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1),a("v-tab-item",[a("v-card",[a("v-card-title",[a("v-container",[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"pa-2",attrs:{md:"auto"}},[t._v(" Products ")]),a("v-col",{staticClass:"pa-2"},[this.only_monitored_products?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:t.toggleProductMonitored}},[t._v("Show all")]):t._e(),this.only_monitored_products?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:t.toggleProductMonitored}},[t._v("Show monitored only")])],1),a("v-text-field",{staticClass:"pt-0",attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search_products,callback:function(e){t.search_products=e},expression:"search_products"}})],1)],1),a("v-spacer")],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers_products,items:t.products.results,options:t.options_products,"server-items-length":t.products.count,search:t.search_products,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"items-per-page":t.rowsPerPage},on:{"update:options":function(e){t.options_products=e}},scopedSlots:t._u([{key:"item.monitored",fn:function(e){var s=e.item;return[s.monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:function(e){return t.toggleMonitoredProduct(s)}}},[t._v("Yes")]):t._e(),s.monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:function(e){return t.toggleMonitoredProduct(s)}}},[t._v("No")])]}},{key:"item.updated_at",fn:function(e){var s=e.item;return[a("span",[t._v(t._s(t.moment(s.updated_at).format("YYYY-MM-DD")))])]}},{key:"item.action",fn:function(e){var s=e.item;return[a("v-icon",{staticClass:"mdi mdi-eye",attrs:{small:"",color:"blue"},on:{click:function(e){return t.viewProduct(s.id)}}})]}}])}),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1)],1)],1)},Zi=[],Qi={name:"VendorsProducts",data:()=>({vendors:[],products:[],loading:!0,limit:20,only_monitored_vendors:!1,only_monitored_products:!1,search_vendors:"",search_products:"",options_vendors:{},options_products:{},headers_vendors:[{text:"Vendor",value:"name"},{text:"# Products",value:"products_count",align:"center",sortable:!1},{text:"Monitored",value:"monitored",align:"center",sortable:!1},{text:"Last update",value:"updated_at"},{text:"Actions",value:"action",sortable:!1}],headers_products:[{text:"Vendor",value:"vendor"},{text:"Product",value:"name"},{text:"Monitored",value:"monitored",align:"center",sortable:!1},{text:"Last update",value:"updated_at"},{text:"Actions",value:"action",sortable:!1}],rowsPerPageItems:[5,10,20,50,100],rowsPerPage:10,snack:!1,snackColor:"",snackText:""}),mounted(){},watch:{search_vendors:$t.a.debounce((function(t){this.search_vendors=t,this.options_vendors.page=1,this.getDataVendors()}),500),search_products:$t.a.debounce((function(t){this.search_products=t,this.options_products.page=1,this.getDataProducts()}),500),only_monitored_vendors:{handler(){this.getDataVendors()},deep:!0},only_monitored_products:{handler(){this.getDataProducts()},deep:!0},options_vendors:{handler(){this.getDataVendors()},deep:!0},options_products:{handler(){this.getDataProducts()},deep:!0}},methods:{getDataVendors(){return this.loading=!0,new Promise((t,e)=>{const{sortBy:a,sortDesc:s,page:i,itemsPerPage:o}=this.options_vendors;this.limit=o;let n=this.getVendors(i,this.limit,a,s);setTimeout(()=>{t({items:n})},300)})},getDataProducts(){return this.loading=!0,new Promise((t,e)=>{const{sortBy:a,sortDesc:s,page:i,itemsPerPage:o}=this.options_products;this.limit=o;let n=this.getProducts(i,this.limit,a,s);setTimeout(()=>{t({items:n})},300)})},getVendors(t,e,a,s){let i="";a.length>0&&(i=!0===s[0]?"&sorted_by=-"+a:"&sorted_by="+a);let o=this.only_monitored_vendors?"&monitored=true":"";this.$api.get("/api/kb/vendors/?limit="+e+"&page="+t+"&search="+this.search_vendors+i+o).then(t=>(this.loading=!1,this.vendors=t.data,this.products)).catch(t=>{this.vendors=[],y.a.fire({title:"Error",text:"unable to get vendors",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})},getProducts(t,e,a,s){let i="";a.length>0&&(i=!0===s[0]?"&sorted_by=-"+a:"&sorted_by="+a);let o=this.only_monitored_products?"&monitored=true":"";this.$api.get("/api/kb/products/?limit="+e+"&page="+t+"&search="+this.search_products+i+o).then(t=>(this.loading=!1,this.products=t.data,this.products)).catch(t=>{this.products=[],y.a.fire({title:"Error",text:"unable to get products",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})},toggleMonitoredVendor(t){let e={vendor_name:t.name,monitored:!t.monitored,organization_id:localStorage.getItem("org_id")};this.$api.post("/api/monitor/vendor/toggle",e).then(e=>{this.loading=!1,e?(t.monitored=!t.monitored,this.snack=!0,this.snackColor="success",this.snackText="Monitoring status successfuly updated."):(this.snack=!0,this.snackColor="error",this.snackText="Unable to change the monitoring status")}).catch(t=>{this.loading=!1,y.a.fire({title:"Error",text:"Unable to change the monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:2e3})})},toggleMonitoredProduct(t){let e={vendor_name:t.vendor,product_name:t.name,monitored:!t.monitored,organization_id:localStorage.getItem("org_id")};this.$api.post("/api/monitor/product/toggle",e).then(e=>{this.loading=!1,e?(t.monitored=!t.monitored,this.snack=!0,this.snackColor="success",this.snackText="Monitoring status successfuly updated."):(this.snack=!0,this.snackColor="error",this.snackText="Unable to change the monitoring status")}).catch(t=>{this.loading=!1,y.a.fire({title:"Error",text:"Unable to change the monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:2e3})})},toggleVendorMonitored(){this.only_monitored_vendors=!this.only_monitored_vendors,this.options_vendors.page=1},toggleProductMonitored(){this.only_monitored_products=!this.only_monitored_products,this.options_products.page=1},viewVendor(t){this.$router.push({path:"/vendor/"+t})},viewProduct(t){this.$router.push({path:"/product/"+t})}}},to=Qi,eo=Object(l["a"])(to,Gi,Zi,!1,null,null,null),ao=eo.exports;d()(eo,{VBtn:V["a"],VCard:S["a"],VCardTitle:T["e"],VChip:Z["a"],VCol:le["a"],VContainer:P["a"],VDataTable:zt["a"],VIcon:et["a"],VRow:de["a"],VSnackbar:M["a"],VSpacer:B["a"],VTab:Ie["a"],VTabItem:Pe["a"],VTabs:Ee["a"],VTextField:O["a"]});var so=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-tabs",{attrs:{left:"","background-color":"white",color:"deep-orange accent-4"}},[a("v-tab",[t._v("Details")]),a("v-tab",[t._v("Products")]),a("v-tab-item",[a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md3:"","d-flex":"","align-stretch":""}},[a("v-card",{staticClass:"flex-grow-1",attrs:{color:"grey lighten-5"}},[a("v-card-title",[a("v-col",{staticClass:"pa-2",attrs:{md:"auto"}},[t._v(" Overview ")]),a("v-col",{staticClass:"pa-2"},[t.vendor.monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:t.toggleMonitored}},[t._v("Monitored")]):t._e(),t.vendor.monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:t.toggleMonitored}},[t._v("Not monitored")])],1)],1),a("v-card-text",[a("span",{staticClass:"font-weight-bold"},[t._v("Name:")]),t._v(" "+t._s(t.vendor.name)),a("br")])],1)],1),a("v-flex",{attrs:{md3:"","d-flex":"","align-stretch":""}},[a("v-card",{staticClass:"flex-grow-1",attrs:{color:"grey lighten-5"}},[a("v-col",{staticClass:"pa-2",attrs:{md:"auto"}},[a("v-card-title",[t._v("Statistics")])],1),a("v-card-text",[a("span",{staticClass:"font-weight-bold"},[t._v("Vulnerabilities: ")]),a("v-chip",{attrs:{color:"deep-orange white--text",content:this.vulns.count,small:""}},[t._v(t._s(t.vulns.count))]),a("br"),a("span",{staticClass:"font-weight-bold"},[t._v("Products: ")]),a("v-chip",{attrs:{color:"deep-orange white--text",small:""}},[t._v(t._s(t.vendor.products_count))])],1)],1)],1)],1),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md12:""}},[a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.vulns_headers,items:t.vulns.results,options:t.options_vulns,"server-items-length":t.vulns.count,"items-per-page":t.limit_vulns,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading_vulns:t.loading_vulns,"item-key":"id","multi-sort":""},on:{"update:options":function(e){t.options_vulns=e}},scopedSlots:t._u([{key:"item.score",fn:function(e){var s=e.item;return[a("v-chip",{staticClass:"text-center font-weight-bold",attrs:{color:t.getRatingColor(s.score),label:""}},[t._v(t._s(s.score)+"/100")]),a("br"),a("span",{staticClass:"text-caption"},[t._v("CVSSv2: "+t._s(s.cvss))]),a("br"),a("span",{staticClass:"text-caption"},[t._v("CVSSv3: "+t._s(s.cvss3))])]}},{key:"item.summary",fn:function(e){var s=e.item;return[a("div",{staticClass:"py-2"},[a("div",{staticClass:"pb-2"},[a("span",{staticClass:"deep-orange--text font-weight-medium"},[t._v(t._s(s.cveid))]),t._v(" / PH-"+t._s(s.id)+" "),a("v-btn",{attrs:{color:"deep-orange",icon:"",small:""}},[a("v-icon",{attrs:{title:"View details"},on:{click:function(e){return t.viewVuln(s.id)}}},[t._v("mdi-arrow-right-bold-circle-outline")])],1)],1),a("div",[t._v(" "+t._s(s.summary)+" ")]),t._l(s.products,(function(e){return a("v-chip",{key:e.id,staticClass:"vendor-chip",attrs:{label:"",small:"",link:""},on:{click:function(a){return t.$router.push({path:"/product/"+e.id})}}},[t._v(" "+t._s(e.vendor)+": "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(e.name))])])}))],2)]}},{key:"item.metadata",fn:function(e){var s=e.item;return[a("v-chip",{staticClass:"font-weight-bold",attrs:{label:"",link:"",small:"",color:s.exploit_count>0?"deep-orange":"grey",title:"Is exploitable?"}},[t._v(t._s(s.exploit_count))]),a("v-btn",{attrs:{color:"NETWORK"==s.access.vector?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Is exploitable remotely?"}},[t._v("mdi-cloud")])],1),a("v-btn",{attrs:{color:"NONE"==s.access.authentication?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Require authentication?"}},[t._v("mdi-shield-account")])],1),a("v-btn",{attrs:{color:s.is_in_the_news||s.is_in_the_wild?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Is in the news or exploited in the wild?"}},[t._v("mdi-star")])],1)]}},{key:"item.updated_at",fn:function(e){var s=e.item;return[a("span",[t._v(t._s(t.moment(s.updated_at).format("YYYY-MM-DD, hh:mm:ss")))])]}}])})],1)],1)],1),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1),a("v-tab-item",[a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md12:""}},[a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.products_headers,items:t.products.results,options:t.options_products,"server-items-length":t.products.count,"items-per-page":t.limit_products,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading_vulns:t.loading_vulns,"item-key":"id","multi-sort":""},on:{"update:options":function(e){t.options_products=e}},scopedSlots:t._u([{key:"item.monitored",fn:function(e){var s=e.item;return[s.monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:function(e){return t.toggleMonitoredProduct(s)}}},[t._v("Yes")]):t._e(),s.monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:function(e){return t.toggleMonitoredProduct(s)}}},[t._v("No")])]}},{key:"item.updated_at",fn:function(e){var s=e.item;return[a("span",[t._v(t._s(t.moment(s.updated_at).format("YYYY-MM-DD, hh:mm:ss")))])]}},{key:"item.action",fn:function(e){var s=e.item;return[a("v-icon",{staticClass:"mdi mdi-eye",attrs:{small:"",color:"blue"},on:{click:function(e){return t.viewProduct(s.id)}}})]}}])})],1)],1)],1),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1)},io=[],oo={name:"vendordetails",mixins:[Tt],data:()=>({loading_vulns:!0,loading_products:!0,vendor_id:"",vendor:{},products:[],vulns:{results:[]},limit_vulns:20,limit_products:20,options_vulns:{},options_products:{},vulns_headers:[{text:"Score",value:"score",align:"center",width:"10%"},{text:"Summary",value:"summary"},{text:"Metadata",value:"metadata",align:"center",width:"9%",sortable:!1},{text:"Last update",value:"updated_at",align:"center",width:"10%"}],products_headers:[{text:"Product Name",value:"name"},{text:"Monitored",value:"monitored"},{text:"Last update",value:"updated_at",align:"center"},{text:"Actions",value:"action",sortable:!1,align:"center"}],rowsPerPageItems:[5,10,20,50,100],snack:!1,snackColor:"",snackText:""}),watch:{options_vulns:{handler(){this.getDataVendor(this.vendor_id)},deep:!0},options_products:{handler(){this.getDataProducts(this.vendor_id)},deep:!0}},beforeRouteUpdate(t){this.vendor_id=t.params.vendor_id},mounted(){this.vendor_id=this.$router.currentRoute.params.vendor_id,this.options_products.page=1,this.options_vulns.page=1},methods:{getDataVendor(t){return this.loading_vulns=!0,new Promise((e,a)=>{const{sortBy:s,sortDesc:i,page:o,itemsPerPage:n}=this.options_vulns;this.limit_vulns=n;let r=this.getVendor(t),l=this.getVulns(t,o,this.limit_vulns,s,i);setTimeout(()=>{e({vendor:r,vulns:l})},300)})},getDataProducts(t){return this.loading_vulns=!0,new Promise((e,a)=>{const{sortBy:s,sortDesc:i,page:o,itemsPerPage:n}=this.options_products;this.limit_products=n;let r=this.getProducts(t,o,this.limit_vulns,s,i);setTimeout(()=>{e({products:r})},300)})},getVendor(t){this.loading_vulns=!0,this.$api.get("/api/kb/vendors/"+t).then(t=>(this.vendor=t.data,this.vendor)).catch(t=>{this.vendor={},this.loading_vulns=!1,y.a.fire({title:"Error",text:"Unable to get vendor details",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}),this.loading_vulns=!1},getProducts(t,e,a,s="",i){this.loading_products=!0;let o="";s.length>0&&(o=!0===i[0]?"sorted_by=-"+s:"sorted_by="+s),this.$api.get("/api/kb/products/?vendor_id="+t+"&limit="+a+"&page="+e+"&"+o).then(t=>(this.products=t.data,this.products)).catch(t=>{this.products=[],this.loading_vulns=!1,y.a.fire({title:"Error",text:"Unable to get products",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}),this.loading_products=!1},viewVuln(t){this.$router.push({path:"/vulns/"+t})},viewProduct(t){this.$router.push({path:"/product/"+t})},getVulns(t,e,a,s="",i){this.loading_vulns=!0;let o="";s.length>0&&(o=!0===i[0]?"sorted_by=-"+s:"sorted_by="+s),this.$api.get("/api/vulns/?vendor="+t+"&limit="+a+"&page="+e+"&"+o).then(t=>(this.vulns=t.data,this.vulns)).catch(t=>{vulns={results:[]},this.loading_vulns=!1,y.a.fire({title:"Error",text:"Unable to get vulns",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}),this.loading_vulns=!1},toggleMonitored(){let t={vendor_name:this.vendor.name,monitored:!this.vendor.monitored,organization_id:localStorage.getItem("org_id")};this.$api.post("/api/monitor/vendor/toggle",t).then(t=>{this.loading_vulns=!1,t?(this.vendor.monitored=!this.vendor.monitored,this.snack=!0,this.snackColor="success",this.snackText="Monitoring status successfuly updated."):(this.snack=!0,this.snackColor="error",this.snackText="Unable to change the monitoring status")}).catch(t=>{this.loading_vulns=!1,y.a.fire({title:"Error",text:"Unable to change the monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:2e3})})},toggleMonitoredProduct(t){let e={vendor_name:this.vendor.name,product_name:t.name,monitored:!t.monitored,organization_id:localStorage.getItem("org_id")};this.$api.post("/api/monitor/product/toggle",e).then(e=>{this.loading=!1,e?(t.monitored=!t.monitored,this.snack=!0,this.snackColor="success",this.snackText="Monitoring status successfuly updated."):(this.snack=!0,this.snackColor="error",this.snackText="Unable to change the monitoring status")}).catch(t=>{this.loading=!1,y.a.fire({title:"Error",text:"Unable to change the monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:2e3})})}}},no=oo,ro=Object(l["a"])(no,so,io,!1,null,null,null),lo=ro.exports;d()(ro,{VBtn:V["a"],VCard:S["a"],VCardText:T["d"],VCardTitle:T["e"],VChip:Z["a"],VCol:le["a"],VContainer:P["a"],VDataTable:zt["a"],VFlex:E["a"],VIcon:et["a"],VLayout:A["a"],VSnackbar:M["a"],VTab:Ie["a"],VTabItem:Pe["a"],VTabs:Ee["a"]});var co=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-tabs",{attrs:{left:"","background-color":"white",color:"deep-orange accent-4"}},[a("v-tab",[t._v("Details")]),a("v-tab",[t._v("Timeline")]),a("v-tab-item",[a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md3:"","d-flex":"","align-stretch":""}},[a("v-card",{staticClass:"flex-grow-1",attrs:{color:"grey lighten-5"}},[a("v-card-title",[a("v-col",{staticClass:"pa-2",attrs:{md:"auto"}},[t._v(" Information ")]),a("v-col",{staticClass:"pa-2"},[t.product.monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:t.toggleMonitored}},[t._v("Monitored")]):t._e(),t.product.monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:t.toggleMonitored}},[t._v("Not monitored")])],1)],1),a("v-card-text",[a("span",{staticClass:"font-weight-bold"},[t._v("Name:")]),t._v(" "+t._s(t.product.name)),a("br"),a("span",{staticClass:"font-weight-bold"},[t._v("Vendor:")]),t._v(" "),a("a",{on:{click:function(e){return t.viewVendor(t.product.vendor_id)}}},[t._v(t._s(t.product.vendor))])])],1)],1),a("v-flex",{attrs:{md3:"","d-flex":"","align-stretch":""}},[a("v-card",{staticClass:"flex-grow-1",attrs:{color:"grey lighten-5"}},[a("v-card-title",[t._v("Statistics")]),a("v-card-text",[a("span",{staticClass:"font-weight-bold"},[t._v("Vulnerabilities: ")]),a("v-chip",{attrs:{color:"deep-orange white--text",content:this.vulns.count,small:""}},[t._v(t._s(t.vulns.count))]),a("br"),a("span",{staticClass:"font-weight-bold"},[t._v("Versions: ")]),a("v-chip",{attrs:{color:"deep-orange white--text",small:""}},[t._v(t._s(t.cpes.length))])],1)],1)],1),a("v-flex",{attrs:{md6:"","d-flex":"","align-stretch":""}},[a("v-card",{staticClass:"flex-grow-1",attrs:{color:"grey lighten-5"}},[a("v-card-title",[t._v(" Known versions "),a("v-icon",{staticClass:"ml-2",attrs:{small:"",link:"",title:"Reset selection"},on:{click:function(e){t.filter_version=null,t.select_pv=[]}}},[t._v(" mdi-reload ")])],1),a("v-card-text",[a("v-chip-group",{attrs:{"active-class":"deep-orange--text text--accent-4"},model:{value:t.select_pv,callback:function(e){t.select_pv=e},expression:"select_pv"}},t._l(t.cpes,(function(e){return a("v-chip",{key:e.id,attrs:{small:"",label:"",outlined:""},on:{click:function(a){t.filter_version=e.version}}},[t._v(t._s(e.version)+" ")])})),1)],1)],1)],1)],1),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md12:""}},[a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.vulns_headers,items:t.vulns.results,options:t.options,"server-items-length":t.vulns.count,search:t.search,"items-per-page":20,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"id","multi-sort":""},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.score",fn:function(e){var s=e.item;return[a("v-chip",{staticClass:"text-center font-weight-bold",attrs:{color:t.getRatingColor(s.score),label:""}},[t._v(t._s(s.score)+"/100")]),a("br"),a("span",{staticClass:"text-caption"},[t._v("CVSSv2: "+t._s(s.cvss))]),a("br"),a("span",{staticClass:"text-caption"},[t._v("CVSSv3: "+t._s(s.cvss3))])]}},{key:"item.summary",fn:function(e){var s=e.item;return[a("div",{staticClass:"py-2"},[a("div",{staticClass:"pb-2"},[a("span",{staticClass:"deep-orange--text font-weight-medium"},[t._v(t._s(s.cveid))]),t._v(" / PH-"+t._s(s.id)+" "),a("v-btn",{attrs:{color:"deep-orange",icon:"",small:""}},[a("v-icon",{attrs:{title:"View details"},on:{click:function(e){return t.viewVuln(s.id)}}},[t._v("mdi-arrow-right-bold-circle-outline")])],1)],1),a("div",[t._v(" "+t._s(s.summary)+" ")]),t._l(s.products,(function(e){return a("v-chip",{key:e.id,staticClass:"vendor-chip",attrs:{label:"",small:"",link:""},on:{click:function(a){return t.viewProduct(e.id)}}},[t._v(" "+t._s(e.vendor)+": "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s(e.name))])])}))],2)]}},{key:"item.metadata",fn:function(e){var s=e.item;return[a("v-chip",{staticClass:"font-weight-bold",attrs:{label:"",link:"",small:"",color:s.exploit_count>0?"deep-orange":"grey",title:"Is exploitable?"}},[t._v(t._s(s.exploit_count))]),a("v-btn",{attrs:{color:"NETWORK"==s.access.vector?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Is exploitable remotely?"}},[t._v("mdi-cloud")])],1),a("v-btn",{attrs:{color:"NONE"==s.access.authentication?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Require authentication?"}},[t._v("mdi-shield-account")])],1),a("v-btn",{attrs:{color:s.is_in_the_news||s.is_in_the_wild?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Is in the news or exploited in the wild?"}},[t._v("mdi-star")])],1)]}},{key:"item.updated_at",fn:function(e){var s=e.item;return[a("span",[t._v(t._s(t.moment(s.updated_at).format("YYYY-MM-DD, hh:mm:ss")))])]}}])})],1)],1)],1)],1),a("v-tab-item",[a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[t._v(" Soon available. ")])],1)],1)],1)},uo=[],vo={name:"productdetails",mixins:[Tt],components:{VClamp:St["a"]},data:()=>({loading:!0,product_id:"",product:{},select_pv:[],vulns:{results:[]},cpes:[],limit:20,search:"",filter_version:null,options:{},selected:[],vulns_headers:[{text:"Score",value:"score",align:"center",width:"10%"},{text:"Summary",value:"summary"},{text:"Metadata",value:"metadata",align:"center",width:"9%",sortable:!1},{text:"Last update",value:"updated_at",align:"center",width:"10%"}],rowsPerPageItems:[5,10,20,50,100],snack:!1,snackColor:"",snackText:""}),watch:{options:{handler(){this.getDataFromApi(this.product_id)},deep:!0},filter_version:{handler(){this.getDataFromApi(this.product_id)},deep:!0}},beforeRouteUpdate(t,e){this.product_id=t.params.product_id},mounted(){this.product_id=this.$router.currentRoute.params.product_id,this.options.page=1},methods:{getDataFromApi(t){return this.loading=!0,new Promise((e,a)=>{const{sortBy:s,sortDesc:i,page:o,itemsPerPage:n}=this.options;this.limit=n;let r=this.getProduct(t),l=this.getVulns(t,o,this.limit,s,i);setTimeout(()=>{e({product:r,vulns:l})},300)})},getProduct(t){this.$api.get("/api/kb/detailed-products/"+t).then(t=>(this.product=t.data,this.cpes=this.product.versions,this.product)).catch(t=>{this.product={},this.loading=!1,y.a.fire({title:"Error",text:"unable to get product details",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})},viewVuln(t){this.$router.push({name:"VulnDetails",params:{vuln_id:t}})},viewProduct(t){const e="/product/"+t;this.$route.path!=e&&(this.product_id=t,this.$router.push({path:e}))},getVulns(t,e,a,s="",i){let o="";s.length>0&&(o=!0===i[0]?"sorted_by=-"+s:"sorted_by="+s);let n="/api/vulns/?product="+t+"&limit="+a+"&page="+e+"&"+o;null!=this.filter_version&&""!=this.filter_version&&(n+="&product_version="+this.filter_version+"&vendor_name="+this.product.vendor+"&product_name="+this.product.name),this.$api.get(n).then(t=>(this.vulns=t.data,this.loading=!1,this.vulns)).catch(t=>{vulns={results:[]},y.a.fire({title:"Error",text:"unable to get vulns",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}),this.loading=!1},toggleMonitored(){let t={vendor_name:this.product.vendor,product_name:this.product.name,monitored:!this.product.monitored,organization_id:localStorage.getItem("org_id")};this.$api.post("/api/monitor/product/toggle",t).then(t=>{t?(this.product.monitored=!this.product.monitored,this.snack=!0,this.snackColor="success",this.snackText="Monitoring status successfuly updated."):(this.snack=!0,this.snackColor="error",this.snackText="Unable to change the monitoring status")}).catch(t=>{y.a.fire({title:"Error",text:"Unable to change the monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:2e3})})},viewVendor(t){this.$router.push({path:"/vendor/"+t})}}},mo=vo,ho=a("ef9a"),po=Object(l["a"])(mo,co,uo,!1,null,null,null),_o=po.exports;d()(po,{VBtn:V["a"],VCard:S["a"],VCardText:T["d"],VCardTitle:T["e"],VChip:Z["a"],VChipGroup:ho["a"],VCol:le["a"],VContainer:P["a"],VDataTable:zt["a"],VFlex:E["a"],VIcon:et["a"],VLayout:A["a"],VTab:Ie["a"],VTabItem:Pe["a"],VTabs:Ee["a"]});var go=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-card",[a("v-card-title",[a("v-container",[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"pa-2",attrs:{md:"auto"}},[t._v(" Packages ")]),a("v-col",{staticClass:"pa-2"},[this.only_monitored_packages?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:t.togglePackageMonitored}},[t._v("Show all")]):t._e(),this.only_monitored_packages?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:t.togglePackageMonitored}},[t._v("Show monitored only")])],1),a("v-text-field",{staticClass:"pt-0",attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search_packages,callback:function(e){t.search_packages=e},expression:"search_packages"}})],1)],1),a("v-spacer")],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers_packages,items:t.packages.results,options:t.options_packages,"server-items-length":t.packages.count,search:t.search_packages,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"items-per-page":t.rowsPerPage},on:{"update:options":function(e){t.options_packages=e}},scopedSlots:t._u([{key:"item.monitored",fn:function(e){var s=e.item;return[s.monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:function(e){return t.toggleMonitoredPackage(s)}}},[t._v("Yes")]):t._e(),s.monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:function(e){return t.toggleMonitoredPackage(s)}}},[t._v("No")])]}},{key:"item.updated_at",fn:function(e){var s=e.item;return[a("span",[t._v(t._s(t.moment(s.updated_at).format("YYYY-MM-DD")))])]}},{key:"item.action",fn:function(e){var s=e.item;return[a("v-icon",{staticClass:"mdi mdi-eye",attrs:{small:"",color:"blue"},on:{click:function(e){return t.viewPackage(s.id)}}})]}}])}),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1)},fo=[],bo={name:"Packages",data:()=>({packages:[],loading:!0,limit:20,only_monitored_packages:!1,search_packages:"",options_packages:{},headers_packages:[{text:"Type",value:"type"},{text:"Package",value:"name"},{text:"Monitored",value:"monitored",align:"center",sortable:!1},{text:"Last update",value:"updated_at"},{text:"Actions",value:"action",sortable:!1}],rowsPerPageItems:[5,10,20,50,100],rowsPerPage:10,snack:!1,snackColor:"",snackText:""}),mounted(){},watch:{search_packages:$t.a.debounce((function(t){this.search_packages=t,this.options_packages.page=1,this.getDataPackages()}),500),only_monitored_packages:{handler(){this.getDataPackages()},deep:!0},options_packages:{handler(){this.getDataPackages()},deep:!0}},methods:{getDataPackages(){return this.loading=!0,new Promise((t,e)=>{const{sortBy:a,sortDesc:s,page:i,itemsPerPage:o}=this.options_packages;this.limit=o;let n=this.getPackages(i,this.limit,a,s);setTimeout(()=>{t({items:n})},300)})},getPackages(t,e,a,s){let i="";a.length>0&&(i=!0===s[0]?"&sorted_by=-"+a:"&sorted_by="+a);let o=this.only_monitored_packages?"&monitored=true":"";this.$api.get("/api/kb/packages/?limit="+e+"&page="+t+"&name__icontains="+this.search_packages+i+o).then(t=>(this.loading=!1,this.packages=t.data,this.packages)).catch(t=>{this.packages=[],y.a.fire({title:"Error",text:"Unable to get packages",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})},toggleMonitoredPackage(t){let e={package_id:t.id,monitored:!t.monitored,organization_id:localStorage.getItem("org_id")};this.$api.post("/api/monitor/package/toggle",e).then(e=>{this.loading=!1,e?(t.monitored=!t.monitored,this.snack=!0,this.snackColor="success",this.snackText="Monitoring status successfuly updated."):(this.snack=!0,this.snackColor="error",this.snackText="Unable to change the monitoring status")}).catch(t=>{this.loading=!1,y.a.fire({title:"Error",text:"Unable to change the monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:2e3})})},togglePackageMonitored(){this.only_monitored_packages=!this.only_monitored_packages,this.options_packages.page=1},viewPackage(t){this.$router.push({path:"/packages/"+t})}}},ko=bo,xo=Object(l["a"])(ko,go,fo,!1,null,null,null),yo=xo.exports;d()(xo,{VBtn:V["a"],VCard:S["a"],VCardTitle:T["e"],VChip:Z["a"],VCol:le["a"],VContainer:P["a"],VDataTable:zt["a"],VIcon:et["a"],VRow:de["a"],VSnackbar:M["a"],VSpacer:B["a"],VTextField:O["a"]});var wo=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-tabs",{attrs:{left:"","background-color":"white",color:"deep-orange accent-4"}},[a("v-tab",[t._v("Details")]),a("v-tab",[t._v("Timeline")]),a("v-tab-item",[a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md3:"","d-flex":"","align-stretch":""}},[a("v-card",{staticClass:"flex-grow-1",attrs:{color:"grey lighten-5"}},[a("v-card-title",[a("v-col",{staticClass:"pa-2",attrs:{md:"auto"}},[t._v(" Information ")]),a("v-col",{staticClass:"pa-2"},[t.package.monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:t.toggleMonitored}},[t._v("Monitored")]):t._e(),t.package.monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:t.toggleMonitored}},[t._v("Not monitored")])],1)],1),a("v-card-text",[a("span",{staticClass:"font-weight-bold"},[t._v("Type:")]),t._v(" "+t._s(t.package.type)),a("br"),a("span",{staticClass:"font-weight-bold"},[t._v("Name:")]),t._v(" "+t._s(t.package.name)),a("br")])],1)],1),a("v-flex",{attrs:{md3:"","d-flex":"","align-stretch":""}},[a("v-card",{staticClass:"flex-grow-1",attrs:{color:"grey lighten-5"}},[a("v-card-title",[t._v("Statistics")]),a("v-card-text",[a("span",{staticClass:"font-weight-bold"},[t._v("Vulnerabilities: ")]),a("v-chip",{attrs:{color:"deep-orange white--text",content:this.vulns.count,small:""}},[t._v(t._s(t.vulns.count))]),a("br")],1)],1)],1),a("v-flex",{attrs:{md6:"","d-flex":"","align-stretch":""}},[a("v-card",{staticClass:"flex-grow-1",attrs:{color:"grey lighten-5"}},[a("v-card-title",[t._v(" Known versions "),a("v-icon",{staticClass:"ml-2",attrs:{small:"",link:"",title:"Reset selection"},on:{click:function(e){t.filter_version=null,t.select_pv=[]}}},[t._v(" mdi-reload ")])],1),a("v-card-text")],1)],1)],1),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md12:""}},[a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.vulns_headers,items:t.vulns.results,options:t.options,"server-items-length":t.vulns.count,search:t.search,"items-per-page":20,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"id","multi-sort":""},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.score",fn:function(e){var s=e.item;return[a("v-chip",{staticClass:"text-center font-weight-bold",attrs:{color:t.getRatingColor(s.score),label:""}},[t._v(t._s(s.score)+"/100")]),a("br"),a("span",{staticClass:"text-caption"},[t._v("CVSSv2: "+t._s(s.cvss))]),a("br"),a("span",{staticClass:"text-caption"},[t._v("CVSSv3: "+t._s(s.cvss3))])]}},{key:"item.summary",fn:function(e){var s=e.item;return[a("div",{staticClass:"py-2"},[a("div",{staticClass:"pb-2"},[a("span",{staticClass:"deep-orange--text font-weight-medium"},[t._v(t._s(s.cveid))]),t._v(" / PH-"+t._s(s.id)+" "),a("v-btn",{attrs:{color:"deep-orange",icon:"",small:""}},[a("v-icon",{attrs:{title:"View details"},on:{click:function(e){return t.viewVuln(s.id)}}},[t._v("mdi-arrow-right-bold-circle-outline")])],1)],1),a("div",[t._v(" "+t._s(s.summary)+" ")])])]}},{key:"item.metadata",fn:function(e){var s=e.item;return[a("v-chip",{staticClass:"font-weight-bold",attrs:{label:"",link:"",small:"",color:s.exploit_count>0?"deep-orange":"grey",title:"Is exploitable?"}},[t._v(t._s(s.exploit_count))]),a("v-btn",{attrs:{color:"NETWORK"==s.access.vector?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Is exploitable remotely?"}},[t._v("mdi-cloud")])],1),a("v-btn",{attrs:{color:"NONE"==s.access.authentication?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Require authentication?"}},[t._v("mdi-shield-account")])],1),a("v-btn",{attrs:{color:s.is_in_the_news||s.is_in_the_wild?"deep-orange":"grey",icon:"",small:""}},[a("v-icon",{attrs:{title:"Is in the news or exploited in the wild?"}},[t._v("mdi-star")])],1)]}},{key:"item.updated_at",fn:function(e){var s=e.item;return[a("span",[t._v(t._s(t.moment(s.updated_at).format("YYYY-MM-DD, hh:mm:ss")))])]}}])})],1)],1)],1)],1),a("v-tab-item",[a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[t._v(" Soon available. ")])],1)],1)],1)},Co=[],Vo={name:"PackageDetails",mixins:[Tt],data:()=>({loading:!0,package_id:"",package:{},select_p:[],vulns:{results:[]},limit:20,search:"",filter_version:null,options:{},selected:[],vulns_headers:[{text:"Score",value:"score",align:"center",width:"10%"},{text:"Summary",value:"summary"},{text:"Metadata",value:"metadata",align:"center",width:"9%",sortable:!1},{text:"Last update",value:"updated_at",align:"center",width:"10%"}],rowsPerPageItems:[5,10,20,50,100],snack:!1,snackColor:"",snackText:""}),watch:{options:{handler(){this.getDataFromApi(this.package_id)},deep:!0},filter_version:{handler(){this.getDataFromApi(this.package_id)},deep:!0}},beforeRouteUpdate(t,e){this.package_id=t.params.package_id},mounted(){this.package_id=this.$router.currentRoute.params.package_id,this.options.page=1},methods:{getDataFromApi(t){return this.loading=!0,new Promise((e,a)=>{const{sortBy:s,sortDesc:i,page:o,itemsPerPage:n}=this.options;this.limit=n;let r=this.getPackage(t),l=this.getVulns(t,o,this.limit,s,i);setTimeout(()=>{e({pkg:r,vulns:l})},300)})},getPackage(t){this.$api.get("/api/kb/packages/"+t).then(t=>(this.package=t.data,this.package)).catch(t=>{this.package={},this.loading=!1,y.a.fire({title:"Error",text:"Unable to get package details",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})},viewVuln(t){this.$router.push({name:"VulnDetails",params:{vuln_id:t}})},getVulns(t,e,a,s="",i){let o="";s.length>0&&(o=!0===i[0]?"sorted_by=-"+s:"sorted_by="+s);let n="/api/vulns/?package="+t+"&limit="+a+"&page="+e+"&"+o;this.$api.get(n).then(t=>(this.vulns=t.data,this.loading=!1,this.vulns)).catch(t=>{vulns={results:[]},y.a.fire({title:"Error",text:"Unable to get vulns",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}),this.loading=!1},toggleMonitored(){let t={package_id:this.package.id,monitored:!this.package.monitored,organization_id:localStorage.getItem("org_id")};this.$api.post("/api/monitor/package/toggle",t).then(t=>{t?(this.package.monitored=!this.package.monitored,this.snack=!0,this.snackColor="success",this.snackText="Monitoring status successfuly updated."):(this.snack=!0,this.snackColor="error",this.snackText="Unable to change the monitoring status")}).catch(t=>{y.a.fire({title:"Error",text:"Unable to change the monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:2e3})})}}},So=Vo,To=Object(l["a"])(So,wo,Co,!1,null,null,null),Io=To.exports;d()(To,{VBtn:V["a"],VCard:S["a"],VCardText:T["d"],VCardTitle:T["e"],VChip:Z["a"],VCol:le["a"],VContainer:P["a"],VDataTable:zt["a"],VFlex:E["a"],VIcon:et["a"],VLayout:A["a"],VTab:Ie["a"],VTabItem:Pe["a"],VTabs:Ee["a"]});var Po=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-card",[a("v-card-title",[t._v(" CVE "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers,items:t.cves.results,"items-per-page":20,options:t.options,"server-items-length":t.cves.count,search:t.search,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"cve_id","show-select":"","multi-sort":""},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.summary",fn:function(e){var s=e.item;return[a("v-clamp",{attrs:{autoresize:"","max-lines":1},scopedSlots:t._u([{key:"after",fn:function(e){var s=e.toggle,i=e.expanded,o=e.clamped;return i||o?a("button",{staticClass:"toggle btn btn-sm",on:{click:s}},[t._v(" "+t._s(" more")+" ")]):t._e()}}],null,!0)},[t._v(" "+t._s(s.summary)+" ")])]}},{key:"item.monitored",fn:function(e){var s=e.item;return[s.monitored?a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"deep-orange"},on:{click:function(e){return t.toggleMonitored(s)}}},[t._v("Yes")]):t._e(),s.monitored?t._e():a("v-chip",{attrs:{small:"",label:"",outlined:"",color:"grey"},on:{click:function(e){return t.toggleMonitored(s)}}},[t._v("No")])]}},{key:"item.modified",fn:function(e){var s=e.item;return[a("span",[t._v(t._s(t.moment(s.modified).format("YYYY-MM-DD")))])]}}])}),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1)},Eo=[],$o={name:"cves",components:{VClamp:St["a"]},data:()=>({cves:[],totalcves:0,loading:!0,limit:20,search:"",options:{},selected:[],headers:[{text:"CVE-ID",value:"cve_id",width:"150px"},{text:"Summary",value:"summary",sortable:!1},{text:"CVSS",value:"cvss",align:"center"},{text:"CVSS Vector",value:"cvss_vector",align:"center",sortable:!1},{text:"Modified",value:"modified",align:"center"}],rowsPerPageItems:[5,10,20,50,100],snack:!1,snackColor:"",snackText:""}),mounted(){},watch:{search:{handler(t){this.search=t,this.options.page=1,this.getDataFromApi().then(t=>{})},deep:!0},options:{handler(){this.getDataFromApi().then(t=>{})},deep:!0}},methods:{getDataFromApi(){return this.loading=!0,new Promise((t,e)=>{const{sortBy:a,sortDesc:s,page:i,itemsPerPage:o}=this.options;this.search.trim().toLowerCase();this.limit=o;let n=this.getcves(i,this.limit,a,s);setTimeout(()=>{t({items:n})},300)})},getcves(t,e,a,s){let i="";a.length>0&&(i=!0===s[0]?"&sorted_by=-"+a:"&sorted_by="+a),this.$api.get("/api/kb/cve?limit="+e+"&page="+t+i+"&search="+this.search).then(t=>(this.cves=t.data,this.loading=!1,this.cves)).catch(t=>{this.cves=[],this.loading=!1,y.a.fire({title:"Error",text:"unable to get cves",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})},toggleMonitored(t){let e={monitored:!t.monitored};this.$api.put("/api/kb/vendor/"+t.id+"/",e).then(e=>{e?(t.monitored=!t.monitored,this.snack=!0,this.snackColor="success",this.snackText="Monitoring status successfuly updated."):(this.snack=!0,this.snackColor="error",this.snackText="Unable to change the monitoring status"),this.loading=!1}).catch(t=>{this.loading=!1,y.a.fire({title:"Error",text:"Unable to change the monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})}}},Ao=$o,Do=Object(l["a"])(Ao,Po,Eo,!1,null,null,null),Mo=Do.exports;d()(Do,{VBtn:V["a"],VCard:S["a"],VCardTitle:T["e"],VChip:Z["a"],VDataTable:zt["a"],VSnackbar:M["a"],VSpacer:B["a"],VTextField:O["a"]});var Bo=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[!0===t.loading?a("div",{staticClass:"loading"},[t._v("Loading…")]):t._e(),a("v-card",[a("v-card-title",[t._v(" Bulletins "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers,items:t.bulletins.results,options:t.options,"server-items-length":t.bulletins.count,search:t.search,"footer-props":{"items-per-page-options":t.rowsPerPageItems},loading:t.loading,"item-key":"publicid","show-select":"","multi-sort":""},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.title",fn:function(e){var s=e.item;return[a("v-clamp",{attrs:{autoresize:"","max-lines":1},scopedSlots:t._u([{key:"after",fn:function(e){var s=e.toggle,i=e.expanded,o=e.clamped;return i||o?a("button",{staticClass:"toggle btn btn-sm",on:{click:s}},[t._v(" "+t._s(" more")+" ")]):t._e()}}],null,!0)},[t._v(" "+t._s(s.title)+" ")])]}},{key:"item.published",fn:function(e){var s=e.item;return[a("span",[t._v(t._s(t.moment(s.published).format("YYYY-MM-DD")))])]}}])}),a("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.snack=!1}}},[t._v("Close")])],1)],1)],1)},Oo=[],jo={name:"bulletins",components:{VClamp:St["a"]},data:()=>({bulletins:[],totalbulletins:0,loading:!0,limit:20,search:"",options:{},selected:[],headers:[{text:"ID",value:"publicid",width:"150px"},{text:"Vendor",value:"vendor"},{text:"Title",value:"title"},{text:"Severity",value:"severity"},{text:"Published",value:"published"}],rowsPerPageItems:[5,10,20,50,100],snack:!1,snackColor:"",snackText:""}),mounted(){},watch:{search:{handler(t){this.search=t,this.options.page=1,this.getDataFromApi()},deep:!0},options:{handler(){this.getDataFromApi()},deep:!0}},methods:{getDataFromApi(){return this.loading=!0,new Promise((t,e)=>{const{sortBy:a,sortDesc:s,page:i,itemsPerPage:o}=this.options;this.search.trim().toLowerCase();this.limit=o;let n=this.getbulletins(i,this.limit,a,s);setTimeout(()=>{this.loading=!1,t({items:n})},300)})},getbulletins(t,e,a,s){this.loading=!0;let i="";a.length>0&&(i=!0===s[0]?"sorted_by=-"+a:"sorted_by="+a),this.$api.get("/api/kb/bulletins?limit="+e+"&page="+t+"&"+i+"&search="+this.search).then(t=>(this.bulletins=t.data,this.bulletins)).catch(t=>{this.bulletins=[],this.loading=!1,y.a.fire({title:"Error",text:"unable to get bulletins",showConfirmButton:!1,showCloseButton:!1,timer:3e3})}),this.loading=!1},toggleMonitored(t){let e={monitored:!t.monitored};this.$api.put("/api/kb/bulletin/"+t.id+"/",e).then(e=>{e?(t.monitored=!t.monitored,this.snack=!0,this.snackColor="success",this.snackText="Monitoring status successfuly updated."):(this.snack=!0,this.snackColor="error",this.snackText="Unable to change the monitoring status")}).catch(t=>{this.loading=!1,y.a.fire({title:"Error",text:"Unable to change the monitoring status",showConfirmButton:!1,showCloseButton:!1,timer:3e3})})}}},Uo=jo,Fo=Object(l["a"])(Uo,Bo,Oo,!1,null,null,null),Lo=Fo.exports;d()(Fo,{VBtn:V["a"],VCard:S["a"],VCardTitle:T["e"],VDataTable:zt["a"],VSnackbar:M["a"],VSpacer:B["a"],VTextField:O["a"]});var No=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{fluid:""}},[a("p",{staticClass:"title"},[t._v("Usage")]),a("p",{staticClass:"subtitle-1"},[t._v("General information")]),a("p",{staticClass:"body-2"},[t._v(" CanPatch is an open-source platform supporting a vulnerability watch process for IT assets (OS, middleware, application, Web CMS, Java/.Net/Node library, network devices, IoT, ...). Vulnerabilities, exploits and threats information are collected from various OSINT feeds. ")]),a("p",{staticClass:"subtitle-1"},[t._v("Monitoring")]),a("p",{staticClass:"body-2"},[t._v(" Vendors, products, packages and vulnerabilities could be monitored. New data or changes are then identified and reported to users. Be careful when enabling/disabling monitoring on a vendor. Monitoring will be enabled/disabled on all related products, regardless of previous monitoring status. ")]),a("p",{staticClass:"subtitle-1"},[t._v("Organizations")]),a("p",{staticClass:"body-2"},[t._v(' An organization (or "Team") is a group of users sharing lists of monitored vendors, products, packages or vulnerabilities. An user could be member of several organizations. An user is able to add and edit exploits or threats references. These submissions remain private within the context of the organization. ')]),a("p",{staticClass:"subtitle-1"},[t._v("Alerting")]),a("p",{staticClass:"body-2"},[t._v(" Alerts could be sent on key events like changes in monitored assets or periodic reporting. Several notification systems could be enabled depending of your configuration, including email, Slack and Feedly. Contacts and endpoints are configured "),a("a",{attrs:{href:"#/settings"}},[t._v("here")]),t._v(". ")]),a("p",{staticClass:"subtitle-1"},[t._v("REST-API")]),a("p",{staticClass:"body-2"},[t._v(" All features and data are available through REST-API using JWT or Token header authentication. See "),a("a",{attrs:{href:"/api/docs/swagger"}},[t._v("Swagger")]),t._v(", "),a("a",{attrs:{href:"/api/docs/redoc"}},[t._v("ReDoc")]),t._v(" and "),a("a",{attrs:{href:"/api/docs/swagger/?format=openapi"}},[t._v("JSON OpenAPI")]),t._v(" for details. A throttling policy is set on API for preventing abuses. API tokens could be created, renewed or deleted in the Settings menu. ")]),a("p",{staticClass:"body-2"},[t._v(" Example:"),a("br"),a("code",[t._v("curl 'https://hears.patrowl.io/api/vulns/' -H 'Authorization: Token e36700fd50c1eab4cfef08936ff7421b093c13bb'")])]),a("p",{staticClass:"title"},[t._v("Updates")]),a("p",{staticClass:"body-2"},[t._v(" Information, news and updates are regularly posted on Canaris.in "),a("a",{attrs:{href:"https://twitter.com/canaris_india",target:"_blank"}},[t._v("Twitter")]),t._v(" account. ")]),a("p",{staticClass:"title"},[t._v("Contributing")]),a("p",{staticClass:"body-2"},[t._v(" CanPatch is an open-source project. All users and contributors are part of the Patrowl's community. We welcome your contributions. Please feel free to fork the code, play with it, make some patches and send us pull requests via issues. ")]),a("p",{staticClass:"title"},[t._v("More questions ?")]),a("p",{staticClass:"body-2"},[t._v(" Feel free to reach us in your prefered manner:"),a("br"),t._v(" - Send an email at "),a("a",{attrs:{href:"mailto:getsupport@canaris.in"}},[t._v("getsupport@canaris.in")]),a("br"),t._v(" - Fill an issue on "),a("a",{attrs:{href:"https://github.com/canaris-in/CanPatch/issues",target:"_blank"}},[t._v("GitHub")]),a("br"),t._v(" - Chat on "),a("a",{attrs:{href:"https://gitter.im/CanPatch/Support",target:"_blank"}},[t._v("Gitter CanPatch/Support")])]),a("p",{staticClass:"title"},[t._v("Copyright")]),a("p",{staticClass:"body-2"},[t._v(" Copyright (C) 2020-"+t._s((new Date).getFullYear())+" Patrowl SAS ")]),a("p",{staticClass:"title"},[t._v("Version")]),a("p",{staticClass:"body-2"},[t._v(" "+t._s(t.app_version)+" ")])])},Ro=[],Yo={name:"Help",data:()=>({app_version:"1.0.0-RC1"}),mounted(){this.app_version=W.version},methods:{}},zo=Yo,Xo=Object(l["a"])(zo,No,Ro,!1,null,null,null),Ho=Xo.exports;d()(Xo,{VContainer:P["a"]});var Wo=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("v-container",{attrs:{fluid:"","fill-height":""}},[a("v-layout",{attrs:{"align-center":"","justify-center":""}},[a("div",{staticClass:"text-md-center"},[a("h1",[t._v("404")]),a("h2",{staticClass:"my-3 headline"},[t._v("Sorry, page not found")]),a("div",[a("v-btn",{attrs:{color:"primary"},on:{click:t.goBack}},[t._v("Take me back!")]),a("v-btn",{attrs:{color:"primary"},on:{click:t.goHome}},[t._v("Go Home")])],1)])])],1)],1)},qo=[],Jo={methods:{goBack(){this.$router.go(-1)},goHome(){this.$router.push({path:"/"})}}},Ko=Jo,Go=(a("3d91"),Object(l["a"])(Ko,Wo,qo,!1,null,"7cd99d3d",null)),Zo=Go.exports;d()(Go,{VApp:u["a"],VBtn:V["a"],VContainer:P["a"],VLayout:A["a"]}),s["a"].use(f["a"]);const Qo=[{path:"/auth",name:"AuthLayout",component:U},{path:"/auth-sso",name:"AuthSSOLayout",component:z},{path:"/registration",name:"UserRegistrationLayout",component:_t},{path:"/",component:wt,redirect:"/homepage",children:[{path:"homepage",name:"Homepage",component:Wt},{path:"help",name:"Help",component:Ho},{path:"alerts",name:"Alerts",component:Qt},{path:"ratings",name:"Ratings",component:me},{path:"monitoring",name:"Monitoring",component:Ki},{path:"settings",name:"Settings",component:De},{path:"search",name:"Search",component:ea},{path:"search/:appsearch",name:"SearchData",component:ea,props:!0},{path:"/products",name:"KBProducts",component:Yi},{path:"product",name:"ProductDetails",component:_o},{path:"product/:product_id",name:"ProductDetailsData",component:_o},{path:"/vendors",name:"VendorsProducts",component:ao},{path:"/vendor/:vendor_id",name:"VendorDetails",component:lo},{path:"/packages",name:"Packages",component:yo},{path:"/packages/:package_id",name:"PackageDetails",component:Io},{path:"/kb/cves",name:"KBCVE",component:Mo},{path:"/kb/bulletins",name:"KBBulletins",component:Lo},{path:"/vulns",name:"Vulns",component:ka},{path:"/vulns/:vuln_id",name:"Vuln",component:ki},{path:"/exploits",name:"Exploits",component:Ai},{path:"/test-as",name:"AdvancedSearch",component:Je}]},{path:"/public",component:dt,redirect:"/public/vulns",children:[{path:"/public/search",name:"SearchPublic",component:ra},{path:"/public/search/:appsearch",name:"SearchDataPublic",component:ra,props:!0},{path:"/public/vulns",name:"VulnsPublic",component:Sa},{path:"/public/vulns/:vuln_id",name:"VulnDetailsPublic",component:Si}]},{path:"*",component:Zo}],tn=new f["a"]({base:"/",routes:Qo});tn.beforeEach((t,e,a)=>{null==localStorage.getItem("org_id")&&(localStorage.removeItem("authToken"),localStorage.removeItem("username"),localStorage.removeItem("is_admin"),localStorage.removeItem("is_org_admin"),localStorage.removeItem("orgs"),localStorage.removeItem("org_id"),localStorage.removeItem("org_name")),null!==localStorage.getItem("authToken")||"/auth"===t.path||"/auth-sso"===t.path||"/registration"===t.path||"/help"===t.path||"/public"===t.path||t.path.startsWith("/public/vulns")||t.path.startsWith("/public/search")?a():a("/auth")});var en=tn,an=a("2f62"),sn=a("bc3a"),on=a.n(sn),nn=a("130e"),rn=a("1232");s["a"].use(an["a"]),s["a"].use(nn["a"],on.a);const ln=()=>({authUser:{},isAuthenticated:!1,jwt_auth_token:localStorage.getItem("authToken"),jwt_refresh_token:localStorage.getItem("refreshToken"),endpoints:{obtainJWT:"/auth-jwt/obtain_jwt_token/",refreshJWT:"/auth-jwt/refresh_jwt_token/"}});var cn=new an["a"].Store({state:{authUser:{},isAuthenticated:!1,jwt_auth_token:localStorage.getItem("authToken"),jwt_refresh_token:localStorage.getItem("refreshToken"),endpoints:{obtainJWT:"/auth-jwt/obtain_jwt_token/",refreshJWT:"/auth-jwt/refresh_jwt_token/"}},mutations:{setAuthUser(t,{authUser:e,isAuthenticated:a}){s["a"].set(t,"authUser",e),s["a"].set(t,"isAuthenticated",a)},updateToken(t,e){localStorage.setItem("authToken",e),t.jwt_auth_token=e},removeToken(t){localStorage.removeItem("authToken"),t.jwt_auth_token=null},resetState(t){Object.assign(t,ln()),localStorage.clear()}},actions:{obtainToken(t,e){const a={username:t,password:e};this.$api.post(this.state.endpoints.obtainJWT,a).then(t=>{this.commit("updateToken",t.data.access)}).catch(t=>{console.log(t)})},refreshToken(){const t={token:this.state.jwt_refresh_token};this.$api.post(this.state.endpoints.refreshJWT,t).then(t=>{this.commit("updateToken",t.data.access)}).catch(t=>{console.log(t)})},inspectToken(){const t=this.state.jwt_auth_token;if(t){const e=Object(rn["a"])(t),a=e.exp,s=decode.orig_iat;a-Date.now()/1e3<1800&&Date.now()/1e3-s<628200?this.dispatch("refreshToken"):Date.now()}}},modules:{}});s["a"].filter("capitalize",(function(t){return t?(t=t.toString(),t.charAt(0).toUpperCase()+t.slice(1)):""})),s["a"].filter("truncate",(function(t,e,a){a=a||"...";var s=document.createElement("div");s.innerHTML=t;var i=s.textContent;return i.length>e?i.slice(0,e)+a:i}));var dn=a("9eed"),un=a.n(dn);s["a"].use(un.a,{vuetify:g}),s["a"].use(p.a),on.a.interceptors.response.use(t=>t,t=>{t.response}),on.a.interceptors.request.use(t=>(cn.state.jwt_auth_token&&(t.headers.Authorization="JWT "+cn.state.jwt_auth_token),t),t=>Promise.reject(t)),on.a.defaults.xsrfCookieName="csrftoken",on.a.defaults.xsrfHeaderName="X-CSRFTOKEN";const vn=a("24f8"),mn=on.a.create({httpsAgent:new vn.Agent({rejectUnauthorized:!1})});mn.interceptors.response.use(t=>t,async t=>{t.config;return 401===t.response.status&&"token_not_valid"===t.response.data.code?(cn.commit("resetState"),void en.push("/auth")):Promise.reject(t)}),mn.interceptors.request.use(t=>(cn.state.jwt_auth_token&&(t.headers.Authorization="JWT "+cn.state.jwt_auth_token),t),t=>Promise.reject(t)),mn.defaults.xsrfCookieName="csrftoken",mn.defaults.xsrfHeaderName="X-CSRFTOKEN",s["a"].prototype.$api=mn,s["a"].prototype.moment=ie.a,s["a"].config.productionTip=!1,new s["a"]({vuetify:g,router:en,VueSession:p.a,store:cn,render:t=>t(m)}).$mount("#app"),s["a"].filter("capitalize",(function(t){return t?(t=t.toString(),t.charAt(0).toUpperCase()+t.slice(1)):""}))},"5e09":function(t,e,a){"use strict";a("a6cc")},"64ae":function(t,e,a){},"6ab0":function(t,e,a){"use strict";a("22c2")},8083:function(t,e,a){"use strict";a("19ec")},8248:function(t){t.exports=JSON.parse('{"version":"1.0.0","edition":"Standard","build":""}')},a6cc:function(t,e,a){},a6f5:function(t,e,a){"use strict";a("3369")},c2fc:function(t,e,a){"use strict";a("1256")},cf05:function(t,e,a){t.exports=a.p+"static/img/logo.a4903dd7.png"},cf25:function(t,e,a){"use strict";a("fea6")},d5c3:function(t,e,a){},f748:function(t,e,a){},f880:function(t,e,a){"use strict";a("26a5")},fea6:function(t,e,a){}});
//# sourceMappingURL=app.2b1f200d.js.map